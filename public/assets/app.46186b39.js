/*! For license information please see app.46186b39.js.LICENSE.txt */
(()=>{var e={23166:()=>{up.compiler("#proseBody",(function(e){Array.from(e.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]")).map((function(e){var t=document.createElement("a");t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("href","#".concat(e.id)),t.setAttribute("class","hidden md:block md:absolute md:-left-8 top-2 opacity-0 group-hover:opacity-100 text-slate-600 duration-300"),t.innerHTML='<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9.243 3.03a1 1 0 01.727 1.213L9.53 6h2.94l.56-2.243a1 1 0 111.94.486L14.53 6H17a1 1 0 110 2h-2.97l-1 4H15a1 1 0 110 2h-2.47l-.56 2.242a1 1 0 11-1.94-.485L10.47 14H7.53l-.56 2.242a1 1 0 11-1.94-.485L5.47 14H3a1 1 0 110-2h2.97l1-4H5a1 1 0 110-2h2.47l.56-2.243a1 1 0 011.213-.727zM9.03 8l-1 4h2.938l1-4H9.031z" clip-rule="evenodd"></path></svg>',e.classList.add("relative"),e.classList.add("group"),e.appendChild(t)}))})),window.onTranscriptToggle=function(){var e=document.getElementById("transcriptCutoffBtn"),t=Array.from(document.querySelectorAll(".prose .transcript.cutoff"));e.parentElement.classList.toggle("active"),t.map((function(e){return e.classList.toggle("active")}))}},31014:()=>{up.network.config.autoCache=function(){return!1}},88939:()=>{"use strict";function e(e){this.content=e}e.prototype={constructor:e,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(t,r,n){var i=n&&n!=t?this.remove(n):this,s=i.find(t),o=i.content.slice();return-1==s?o.push(n||t,r):(o[s+1]=r,n&&(o[s]=n)),new e(o)},remove:function(t){var r=this.find(t);if(-1==r)return this;var n=this.content.slice();return n.splice(r,2),new e(n)},addToStart:function(t,r){return new e([t,r].concat(this.remove(t).content))},addToEnd:function(t,r){var n=this.remove(t).content.slice();return n.push(t,r),new e(n)},addBefore:function(t,r,n){var i=this.remove(r),s=i.content.slice(),o=i.find(t);return s.splice(-1==o?s.length:o,0,r,n),new e(s)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(t){return(t=e.from(t)).size?new e(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=e.from(t)).size?new e(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var r=this;t=e.from(t);for(var n=0;n<t.content.length;n+=2)r=r.remove(t.content[n]);return r},toObject:function(){var e={};return this.forEach((function(t,r){e[t]=r})),e},get size(){return this.content.length>>1}},e.from=function(t){if(t instanceof e)return t;var r=[];if(t)for(var n in t)r.push(n,t[n]);return new e(r)};const t=e;function r(e,t,n){for(let i=0;;i++){if(i==e.childCount||i==t.childCount)return e.childCount==t.childCount?null:n;let s=e.child(i),o=t.child(i);if(s!=o){if(!s.sameMarkup(o))return n;if(s.isText&&s.text!=o.text){for(let e=0;s.text[e]==o.text[e];e++)n++;return n}if(s.content.size||o.content.size){let e=r(s.content,o.content,n+1);if(null!=e)return e}n+=s.nodeSize}else n+=s.nodeSize}}function n(e,t,r,i){for(let s=e.childCount,o=t.childCount;;){if(0==s||0==o)return s==o?null:{a:r,b:i};let a=e.child(--s),l=t.child(--o),u=a.nodeSize;if(a!=l){if(!a.sameMarkup(l))return{a:r,b:i};if(a.isText&&a.text!=l.text){let e=0,t=Math.min(a.text.length,l.text.length);for(;e<t&&a.text[a.text.length-e-1]==l.text[l.text.length-e-1];)e++,r--,i--;return{a:r,b:i}}if(a.content.size||l.content.size){let e=n(a.content,l.content,r-1,i-1);if(e)return e}r-=u,i-=u}else r-=u,i-=u}}class i{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,r,n=0,i){for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&!1!==r(a,n+o,i||null,s)&&a.content.size){let i=o+1;a.nodesBetween(Math.max(0,e-i),Math.min(a.content.size,t-i),r,n+i)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,n){let i="",s=!0;return this.nodesBetween(e,t,((o,a)=>{o.isText?(i+=o.text.slice(Math.max(e,a)-a,t-a),s=!r):o.isLeaf?(n?i+="function"==typeof n?n(o):n:o.type.spec.leafText&&(i+=o.type.spec.leafText(o)),s=!r):!s&&o.isBlock&&(i+=r,s=!0)}),0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,n=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(n[n.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)n.push(e.content[s]);return new i(n,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let r=[],n=0;if(t>e)for(let i=0,s=0;s<t;i++){let o=this.content[i],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),r.push(o),n+=o.nodeSize),s=a}return new i(r,n)}cutByIndex(e,t){return e==t?i.empty:0==e&&t==this.content.length?this:new i(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let n=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return n[e]=t,new i(n,s)}addToStart(e){return new i([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new i(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let n=this.content[t];e(n,r,t),r+=n.nodeSize}}findDiffStart(e,t=0){return r(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return n(this,e,t,r)}findIndex(e,t=-1){if(0==e)return o(0,e);if(e==this.size)return o(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=n+this.child(r).nodeSize;if(i>=e)return i==e||t>0?o(r+1,i):o(r,n);n=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((e=>e.toJSON())):null}static fromJSON(e,t){if(!t)return i.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new i(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return i.empty;let t,r=0;for(let n=0;n<e.length;n++){let i=e[n];r+=i.nodeSize,n&&i.isText&&e[n-1].sameMarkup(i)?(t||(t=e.slice(0,n)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new i(t||e,r)}static from(e){if(!e)return i.empty;if(e instanceof i)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new i([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}i.empty=new i([],0);const s={index:0,offset:0};function o(e,t){return s.index=e,s.offset=t,s}function a(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!a(e[r],t[r]))return!1}else{for(let r in e)if(!(r in t)||!a(e[r],t[r]))return!1;for(let r in t)if(!(r in e))return!1}return!0}class l{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let n=0;n<e.length;n++){let i=e[n];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,n));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,n)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&a(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return l.none;if(e instanceof l)return[e];let t=e.slice();return t.sort(((e,t)=>e.type.rank-t.type.rank)),t}}l.none=[];class u extends Error{}class c{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=h(this.content,e+this.openStart,t);return r&&new c(r,this.openStart,this.openEnd)}removeBetween(e,t){return new c(d(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return c.empty;let r=t.openStart||0,n=t.openEnd||0;if("number"!=typeof r||"number"!=typeof n)throw new RangeError("Invalid input for Slice.fromJSON");return new c(i.fromJSON(e,t.content),r,n)}static maxOpen(e,t=!0){let r=0,n=0;for(let n=e.firstChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.firstChild)r++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)n++;return new c(e,r,n)}}function d(e,t,r){let{index:n,offset:i}=e.findIndex(t),s=e.maybeChild(n),{index:o,offset:a}=e.findIndex(r);if(i==t||s.isText){if(a!=r&&!e.child(o).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(n!=o)throw new RangeError("Removing non-flat range");return e.replaceChild(n,s.copy(d(s.content,t-i-1,r-i-1)))}function h(e,t,r,n){let{index:i,offset:s}=e.findIndex(t),o=e.maybeChild(i);if(s==t||o.isText)return n&&!n.canReplace(i,i,r)?null:e.cut(0,t).append(r).append(e.cut(t));let a=h(o.content,t-s-1,r);return a&&e.replaceChild(i,o.copy(a))}function f(e,t,r){if(r.openStart>e.depth)throw new u("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new u("Inconsistent open depths");return p(e,t,r,0)}function p(e,t,r,n){let s=e.index(n),o=e.node(n);if(s==t.index(n)&&n<e.depth-r.openStart){let i=p(e,t,r,n+1);return o.copy(o.content.replaceChild(s,i))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=n||t.depth!=n){let{start:s,end:a}=function(e,t){let r=t.depth-e.openStart,n=t.node(r).copy(e.content);for(let e=r-1;e>=0;e--)n=t.node(e).copy(i.from(n));return{start:n.resolveNoCache(e.openStart+r),end:n.resolveNoCache(n.content.size-e.openEnd-r)}}(r,e);return b(o,x(e,s,a,t,n))}{let n=e.parent,i=n.content;return b(n,i.cut(0,e.parentOffset).append(r.content).append(i.cut(t.parentOffset)))}}return b(o,w(e,t,n))}function m(e,t){if(!t.type.compatibleContent(e.type))throw new u("Cannot join "+t.type.name+" onto "+e.type.name)}function g(e,t,r){let n=e.node(r);return m(n,t.node(r)),n}function y(e,t){let r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function v(e,t,r,n){let i=(t||e).node(r),s=0,o=t?t.index(r):i.childCount;e&&(s=e.index(r),e.depth>r?s++:e.textOffset&&(y(e.nodeAfter,n),s++));for(let e=s;e<o;e++)y(i.child(e),n);t&&t.depth==r&&t.textOffset&&y(t.nodeBefore,n)}function b(e,t){return e.type.checkContent(t),e.copy(t)}function x(e,t,r,n,s){let o=e.depth>s&&g(e,t,s+1),a=n.depth>s&&g(r,n,s+1),l=[];return v(null,e,s,l),o&&a&&t.index(s)==r.index(s)?(m(o,a),y(b(o,x(e,t,r,n,s+1)),l)):(o&&y(b(o,w(e,t,s+1)),l),v(t,r,s,l),a&&y(b(a,w(r,n,s+1)),l)),v(n,null,s,l),new i(l)}function w(e,t,r){let n=[];if(v(null,e,r,n),e.depth>r){y(b(g(e,t,r+1),w(e,t,r+1)),n)}return v(t,null,r,n),new i(n)}c.empty=new c(i.empty,0,0);class E{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],n=e.child(t);return r?e.child(t).cut(r):n}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[3*t],n=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)n+=r.child(t).nodeSize;return n}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return l.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),n=e.maybeChild(t);if(!r){let e=r;r=n,n=e}let i=r.marks;for(var s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||n&&i[s].isInSet(n.marks)||(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,n=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)!1!==r[i].type.spec.inclusive||n&&r[i].isInSet(n.marks)||(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new D(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],n=0,i=t;for(let t=e;;){let{index:e,offset:s}=t.content.findIndex(i),o=i-s;if(r.push(t,e,n+s),!o)break;if(t=t.child(e),t.isText)break;i=o-1,n+=s+1}return new E(t,r,i)}static resolveCached(e,t){for(let r=0;r<S.length;r++){let n=S[r];if(n.pos==t&&n.doc==e)return n}let r=S[T]=E.resolve(e,t);return T=(T+1)%A,r}}let S=[],T=0,A=12;class D{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const N=Object.create(null);class C{constructor(e,t,r,n=l.none){this.type=e,this.attrs=t,this.marks=n,this.content=r||i.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,n=0){this.content.nodesBetween(e,t,r,n,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,n){return this.content.textBetween(e,t,r,n)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&a(this.attrs,t||e.defaultAttrs||N)&&l.sameSet(this.marks,r||l.none)}copy(e=null){return e==this.content?this:new C(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new C(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return c.empty;let n=this.resolve(e),i=this.resolve(t),s=r?0:n.sharedDepth(t),o=n.start(s),a=n.node(s).content.cut(n.pos-o,i.pos-o);return new c(a,n.depth-s,i.depth-s)}replace(e,t,r){return f(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:n}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(n==e||t.isText)return t;e-=n+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let n=this.content.child(t-1);return{node:n,index:t-1,offset:r-n.nodeSize}}resolve(e){return E.resolveCached(this,e)}resolveNoCache(e){return E.resolve(this,e)}rangeHasMark(e,t,r){let n=!1;return t>e&&this.nodesBetween(e,t,(e=>(r.isInSet(e.marks)&&(n=!0),!n))),n}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),M(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=i.empty,n=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,n,s),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let e=n;e<s;e++)if(!this.type.allowsMarks(r.child(e).marks))return!1;return!0}canReplaceWith(e,t,r,n){if(n&&!this.type.allowsMarks(n))return!1;let i=this.contentMatchAt(e).matchType(r),s=i&&i.matchFragment(this.content,t);return!!s&&s.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=l.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!l.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map((e=>e.type.name))}`);this.content.forEach((e=>e.check()))}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((e=>e.toJSON()))),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let n=i.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,n,r)}}C.prototype.text=void 0;class k extends C{constructor(e,t,r,n){if(super(e,t,null,n),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):M(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new k(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new k(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function M(e,t){for(let r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}class O{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new _(e,t);if(null==r.next)return O.empty;let n=L(r);r.next&&r.err("Unexpected trailing text");let i=function(e){let t=Object.create(null);return r(U(e,0));function r(n){let i=[];n.forEach((t=>{e[t].forEach((({term:t,to:r})=>{if(!t)return;let n;for(let e=0;e<i.length;e++)i[e][0]==t&&(n=i[e][1]);U(e,r).forEach((e=>{n||i.push([t,n=[]]),-1==n.indexOf(e)&&n.push(e)}))}))}));let s=t[n.join(",")]=new O(n.indexOf(e.length-1)>-1);for(let e=0;e<i.length;e++){let n=i[e][1].sort(B);s.next.push({type:i[e][0],next:t[n.join(",")]||r(n)})}return s}}(function(e){let t=[[]];return i(s(e,0),r()),t;function r(){return t.push([])-1}function n(e,r,n){let i={term:n,to:r};return t[e].push(i),i}function i(e,t){e.forEach((e=>e.to=t))}function s(e,t){if("choice"==e.type)return e.exprs.reduce(((e,r)=>e.concat(s(r,t))),[]);if("seq"!=e.type){if("star"==e.type){let o=r();return n(t,o),i(s(e.expr,o),o),[n(o)]}if("plus"==e.type){let o=r();return i(s(e.expr,t),o),i(s(e.expr,o),o),[n(o)]}if("opt"==e.type)return[n(t)].concat(s(e.expr,t));if("range"==e.type){let o=t;for(let t=0;t<e.min;t++){let t=r();i(s(e.expr,o),t),o=t}if(-1==e.max)i(s(e.expr,o),o);else for(let t=e.min;t<e.max;t++){let t=r();n(o,t),i(s(e.expr,o),t),o=t}return[n(o)]}if("name"==e.type)return[n(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let n=0;;n++){let o=s(e.exprs[n],t);if(n==e.exprs.length-1)return o;i(o,t=r())}}}(n));return function(e,t){for(let r=0,n=[e];r<n.length;r++){let e=n[r],i=!e.validEnd,s=[];for(let t=0;t<e.next.length;t++){let{type:r,next:o}=e.next[t];s.push(r.name),!i||r.isText||r.hasRequiredAttrs()||(i=!1),-1==n.indexOf(o)&&n.push(o)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let n=this;for(let i=t;n&&i<r;i++)n=n.matchType(e.child(i).type);return n}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let n=[this];return function s(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return i.from(a.map((e=>e.createAndFill())));for(let e=0;e<o.next.length;e++){let{type:t,next:r}=o.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==n.indexOf(r)){n.push(r);let e=s(r,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let n=r.shift(),i=n.match;if(i.matchType(e)){let e=[];for(let t=n;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<i.next.length;e++){let{type:s,next:o}=i.next[e];s.isLeaf||s.hasRequiredAttrs()||s.name in t||n.type&&!o.validEnd||(r.push({match:s.contentMatch,type:s,via:n}),t[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(r){e.push(r);for(let n=0;n<r.next.length;n++)-1==e.indexOf(r.next[n].next)&&t(r.next[n].next)}(this),e.map(((t,r)=>{let n=r+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)n+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return n})).join("\n")}}O.empty=new O(!0);class _{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function L(e){let t=[];do{t.push(R(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function R(e){let t=[];do{t.push(I(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function I(e){let t=function(e){if(e.eat("(")){let t=L(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let r=e.nodeTypes,n=r[t];if(n)return[n];let i=[];for(let e in r){let n=r[e];n.groups.indexOf(t)>-1&&i.push(n)}0==i.length&&e.err("No node type or group '"+t+"' found");return i}(e,e.next).map((t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t})));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=P(e,t)}return t}function F(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function P(e,t){let r=F(e),n=r;return e.eat(",")&&(n="}"!=e.next?F(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function B(e,t){return t-e}function U(e,t){let r=[];return function t(n){let i=e[n];if(1==i.length&&!i[0].term)return t(i[0].to);r.push(n);for(let e=0;e<i.length;e++){let{term:n,to:s}=i[e];n||-1!=r.indexOf(s)||t(s)}}(t),r.sort(B)}function $(e){let t=Object.create(null);for(let r in e){let n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function j(e,t){let r=Object.create(null);for(let n in e){let i=t&&t[n];if(void 0===i){let t=e[n];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+n);i=t.default}r[n]=i}return r}function z(e){let t=Object.create(null);if(e)for(let r in e)t[r]=new H(e[r]);return t}class q{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=z(r.attrs),this.defaultAttrs=$(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==O.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:j(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new C(this,this.computeAttrs(e),i.from(t),l.setFrom(r))}createChecked(e=null,t,r){return t=i.from(t),this.checkContent(t),new C(this,this.computeAttrs(e),t,l.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),(t=i.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let n=this.contentMatch.matchFragment(t),s=n&&n.fillBefore(i.empty,!0);return s?new C(this,e,t.append(s),l.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:l.none:e}static compile(e,t){let r=Object.create(null);e.forEach(((e,n)=>r[e]=new q(e,t,n)));let n=t.spec.topNode||"doc";if(!r[n])throw new RangeError("Schema is missing its top node type ('"+n+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let e in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class H{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class V{constructor(e,t,r,n){this.name=e,this.rank=t,this.schema=r,this.spec=n,this.attrs=z(n.attrs),this.excluded=null;let i=$(this.attrs);this.instance=i?new l(this,i):null}create(e=null){return!e&&this.instance?this.instance:new l(this,j(this.attrs,e))}static compile(e,t){let r=Object.create(null),n=0;return e.forEach(((e,i)=>r[e]=new V(e,n++,t,i))),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class G{constructor(e){this.cached=Object.create(null);let r=this.spec={};for(let t in e)r[t]=e[t];r.nodes=t.from(e.nodes),r.marks=t.from(e.marks||{}),this.nodes=q.compile(this.spec.nodes,this),this.marks=V.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw new RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",i=t.spec.marks;t.contentMatch=n[r]||(n[r]=O.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.markSet="_"==i?null:i?W(this,i.split(" ")):""!=i&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],r=t.spec.excludes;t.excluded=null==r?[t]:""==r?[]:W(this,r.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,n){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof q))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,r,n)}text(e,t){let r=this.nodes.text;return new k(r,r.defaultAttrs,e,l.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return C.fromJSON(this,e)}markFromJSON(e){return l.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function W(e,t){let r=[];for(let n=0;n<t.length;n++){let i=t[n],s=e.marks[i],o=s;if(s)r.push(s);else for(let t in e.marks){let n=e.marks[t];("_"==i||n.spec.group&&n.spec.group.split(" ").indexOf(i)>-1)&&r.push(o=n)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}class K{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((e=>{e.tag?this.tags.push(e):e.style&&this.styles.push(e)})),this.normalizeLists=!this.tags.some((t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let r=e.nodes[t.node];return r.contentMatch.matchType(r)}))}parse(e,t={}){let r=new ee(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new ee(this,t,!0);return r.addAll(e,t.from,t.to),c.maxOpen(r.finish())}matchTag(e,t,r){for(let n=r?this.tags.indexOf(r)+1:0;n<this.tags.length;n++){let r=this.tags[n];if(te(e,r.tag)&&(void 0===r.namespace||e.namespaceURI==r.namespace)&&(!r.context||t.matchesContext(r.context))){if(r.getAttrs){let t=r.getAttrs(e);if(!1===t)continue;r.attrs=t||void 0}return r}}}matchStyle(e,t,r,n){for(let i=n?this.styles.indexOf(n)+1:0;i<this.styles.length;i++){let n=this.styles[i],s=n.style;if(!(0!=s.indexOf(e)||n.context&&!r.matchesContext(n.context)||s.length>e.length&&(61!=s.charCodeAt(e.length)||s.slice(e.length+1)!=t))){if(n.getAttrs){let e=n.getAttrs(t);if(!1===e)continue;n.attrs=e||void 0}return n}}}static schemaRules(e){let t=[];function r(e){let r=null==e.priority?50:e.priority,n=0;for(;n<t.length;n++){let e=t[n];if((null==e.priority?50:e.priority)<r)break}t.splice(n,0,e)}for(let t in e.marks){let n=e.marks[t].spec.parseDOM;n&&n.forEach((e=>{r(e=re(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)}))}for(let t in e.nodes){let n=e.nodes[t].spec.parseDOM;n&&n.forEach((e=>{r(e=re(e)),e.node||e.ignore||e.mark||(e.node=t)}))}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new K(e,K.schemaRules(e)))}}const Y={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},J={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Z={ol:!0,ul:!0};function X(e,t,r){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&r}class Q{constructor(e,t,r,n,i,s,o){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=n,this.solid=i,this.options=o,this.content=[],this.activeMarks=l.none,this.stashMarks=[],this.match=s||(4&o?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(i.from(e));if(!t){let t,r=this.type.contentMatch;return(t=r.findWrapping(e.type))?(this.match=r,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let r=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=r.withText(r.text.slice(0,r.text.length-e[0].length))}}let t=i.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(i.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let n=r[t];(this.type?this.type.allowsMarkType(n.type):ne(n.type,e))&&!n.isInSet(this.activeMarks)&&(this.activeMarks=n.addToSet(this.activeMarks),this.pendingMarks=n.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Y.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ee{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let n,i=t.topNode,s=X(null,t.preserveWhitespace,0)|(r?4:0);n=i?new Q(i.type,i.attrs,l.none,l.none,!0,t.topMatch||i.type.contentMatch,s):new Q(r?null:e.schema.topNodeType,null,l.none,l.none,!0,null,s),this.nodes=[n],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){3==e.nodeType?this.addTextNode(e):1==e.nodeType&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let n=this.readStyles(function(e){let t,r=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;t=r.exec(e);)n.push(t[1],t[2].trim());return n}(r));if(!n)return;let[i,s]=n,o=this.top;for(let e=0;e<s.length;e++)this.removePendingMark(s[e],o);for(let e=0;e<i.length;e++)this.addPendingMark(i[e]);t();for(let e=0;e<i.length;e++)this.removePendingMark(i[e],o);for(let e=0;e<s.length;e++)this.addPendingMark(s[e])}addTextNode(e){let t=e.nodeValue,r=this.top;if(2&r.options||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&r.options)t=2&r.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let n=r.content[r.content.length-1],i=e.previousSibling;(!n||i&&"BR"==i.nodeName||n.isText&&/[ \t\r\n\u000c]$/.test(n.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r,n=e.nodeName.toLowerCase();Z.hasOwnProperty(n)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,r=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&Z.hasOwnProperty(e)&&r?(r.appendChild(t),t=r):"li"==e?r=t:e&&(r=null)}}(e);let i=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(r=this.parser.matchTag(e,this,t));if(i?i.ignore:J.hasOwnProperty(n))this.findInside(e),this.ignoreFallback(e);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(e=i.skip);let t,r=this.top,s=this.needsBlock;if(Y.hasOwnProperty(n))r.content.length&&r.content[0].isInline&&this.open&&(this.open--,r=this.top),t=!0,r.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);i&&i.skip?this.addAll(e):this.withStyleRules(e,(()=>this.addAll(e))),t&&this.sync(r),this.needsBlock=s}else this.withStyleRules(e,(()=>{this.addElementByRule(e,i,!1===i.consuming?r:void 0)}))}leafFallback(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}ignoreFallback(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=l.none,r=l.none;for(let n=0;n<e.length;n+=2)for(let i;;){let s=this.parser.matchStyle(e[n],e[n+1],this,i);if(!s)break;if(s.ignore)return null;if(s.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach((e=>{s.clearMark(e)&&(r=e.addToSet(r))})):t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),!1!==s.consuming)break;i=s}return[t,r]}addElementByRule(e,t,r){let n,i,s;if(t.node)i=this.parser.schema.nodes[t.node],i.isLeaf?this.insertNode(i.create(t.attrs))||this.leafFallback(e):n=this.enter(i,t.attrs||null,t.preserveWhitespace);else{s=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(s)}let o=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((e=>this.insertNode(e)));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r)}n&&this.sync(o)&&this.open--,s&&this.removePendingMark(s,o)}addAll(e,t,r){let n=t||0;for(let i=t?e.childNodes[t]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++n)this.findAtPoint(e,n),this.addDOM(i);this.findAtPoint(e,n)}findPlace(e){let t,r;for(let n=this.open;n>=0;n--){let i=this.nodes[n],s=i.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,r=i,!s.length))break;if(i.solid)break}if(!t)return!1;this.sync(r);for(let e=0;e<t.length;e++)this.enterInner(t[e],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let n=0;n<e.marks.length;n++)t.type&&!t.type.allowsMarkType(e.marks[n].type)||(r=e.marks[n].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let n=this.findPlace(e.create(t));return n&&this.enterInner(e,t,!0,r),n}enterInner(e,t=null,r=!1,n){this.closeExtra();let i=this.top;i.applyPending(e),i.match=i.match&&i.match.matchType(e);let s=X(e,n,i.options);4&i.options&&0==i.content.length&&(s|=4),this.nodes.push(new Q(e,t,i.activeMarks,i.pendingMarks,r,null,s)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let t=r.length-1;t>=0;t--)e+=r[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let n=0;n<this.find.length;n++)if(null==this.find[n].pos&&1==e.nodeType&&e.contains(this.find[n].node)){t.compareDocumentPosition(this.find[n].node)&(r?2:4)&&(this.find[n].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,n=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(n?0:1),s=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=i;o--)if(s(e-1,o))return!0;return!1}{let e=o>0||0==o&&n?this.nodes[o].type:r&&o>=i?r.node(o-i).type:null;if(!e||e.name!=a&&-1==e.groups.indexOf(a))return!1;o--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}addPendingMark(e){let t=function(e,t){for(let r=0;r<t.length;r++)if(e.eq(t[r]))return t[r]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let n=this.nodes[r];if(n.pendingMarks.lastIndexOf(e)>-1)n.pendingMarks=e.removeFromSet(n.pendingMarks);else{n.activeMarks=e.removeFromSet(n.activeMarks);let t=n.popFromStashMark(e);t&&n.type&&n.type.allowsMarkType(t.type)&&(n.activeMarks=t.addToSet(n.activeMarks))}if(n==t)break}}}function te(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function re(e){let t={};for(let r in e)t[r]=e[r];return t}function ne(e,t){let r=t.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(e))continue;let s=[],o=e=>{s.push(e);for(let r=0;r<e.edgeCount;r++){let{type:n,next:i}=e.edge(r);if(n==t)return!0;if(s.indexOf(i)<0&&o(i))return!0}};if(o(i.contentMatch))return!0}}class ie{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=oe(t).createDocumentFragment());let n=r,i=[];return e.forEach((e=>{if(i.length||e.marks.length){let r=0,s=0;for(;r<i.length&&s<e.marks.length;){let t=e.marks[s];if(this.marks[t.type.name]){if(!t.eq(i[r][0])||!1===t.type.spec.spanning)break;r++,s++}else s++}for(;r<i.length;)n=i.pop()[1];for(;s<e.marks.length;){let r=e.marks[s++],o=this.serializeMark(r,e.isInline,t);o&&(i.push([r,n]),n.appendChild(o.dom),n=o.contentDOM||o.dom)}}n.appendChild(this.serializeNodeInner(e,t))})),r}serializeNodeInner(e,t){let{dom:r,contentDOM:n}=ie.renderSpec(oe(t),this.nodes[e.type.name](e));if(n){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,n)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let n=e.marks.length-1;n>=0;n--){let i=this.serializeMark(e.marks[n],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let n=this.marks[e.type.name];return n&&ie.renderSpec(oe(r),n(e,t))}static renderSpec(e,t,r=null){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let n,i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o=r?e.createElementNS(r,i):e.createElement(i),a=t[1],l=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a)){l=2;for(let e in a)if(null!=a[e]){let t=e.indexOf(" ");t>0?o.setAttributeNS(e.slice(0,t),e.slice(t+1),a[e]):o.setAttribute(e,a[e])}}for(let i=l;i<t.length;i++){let s=t[i];if(0===s){if(i<t.length-1||i>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:o,contentDOM:o}}{let{dom:t,contentDOM:i}=ie.renderSpec(e,s,r);if(o.appendChild(t),i){if(n)throw new RangeError("Multiple content holes");n=i}}}return{dom:o,contentDOM:n}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ie(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=se(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return se(e.marks)}}function se(e){let t={};for(let r in e){let n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function oe(e){return e.document||window.document}const ae=Math.pow(2,16);function le(e,t){return e+t*ae}function ue(e){return 65535&e}class ce{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class de{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&de.empty)return de.empty}recover(e){let t=0,r=ue(e);if(!this.inverted)for(let e=0;e<r;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*r]+t+function(e){return(e-(65535&e))/ae}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let n=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?n:0);if(a>e)break;let l=this.ranges[o+i],u=this.ranges[o+s],c=a+l;if(e<=c){let i=a+n+((l?e==a?-1:e==c?1:t:t)<0?0:u);if(r)return i;let s=e==(t<0?a:c)?null:le(o/3,e-a),d=e==a?2:e==c?1:4;return(t<0?e!=a:e!=c)&&(d|=8),new ce(i,d,s)}n+=u-l}return r?e+n:new ce(e+n,0,null)}touches(e,t){let r=0,n=ue(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let o=this.ranges[t]-(this.inverted?r:0);if(o>e)break;let a=this.ranges[t+i];if(e<=o+a&&t==3*n)return!0;r+=this.ranges[t+s]-a}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,i=0;n<this.ranges.length;n+=3){let s=this.ranges[n],o=s-(this.inverted?i:0),a=s+(this.inverted?0:i),l=this.ranges[n+t],u=this.ranges[n+r];e(o,o+l,a,a+u),i+=u-l}}invert(){return new de(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?de.empty:new de(e<0?[0,-e,0]:[0,0,e])}}de.empty=new de([]);class he{constructor(e=[],t,r=0,n=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=n}slice(e=0,t=this.maps.length){return new he(this.maps,this.mirror,e,t)}copy(){return new he(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let n=e.getMirror(t);this.appendMap(e.maps[t],null!=n&&n<t?r+n:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let n=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=n&&n>t?r-n-1:void 0)}}invert(){let e=new he;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let n=0;for(let r=this.from;r<this.to;r++){let i=this.maps[r].mapResult(e,t);if(null!=i.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this.maps[t].recover(i.recover);continue}}n|=i.delInfo,e=i.pos}return r?e:new ce(e,n,null)}}const fe=Object.create(null);class pe{getMap(){return de.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=fe[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in fe)throw new RangeError("Duplicate use of step JSON ID "+e);return fe[e]=t,t.prototype.jsonID=e,t}}class me{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new me(e,null)}static fail(e){return new me(null,e)}static fromReplace(e,t,r,n){try{return me.ok(e.replace(t,r,n))}catch(e){if(e instanceof u)return me.fail(e.message);throw e}}}function ge(e,t,r){let n=[];for(let i=0;i<e.childCount;i++){let s=e.child(i);s.content.size&&(s=s.copy(ge(s.content,t,s))),s.isInline&&(s=t(s,r,i)),n.push(s)}return i.fromArray(n)}class ye extends pe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),n=r.node(r.sharedDepth(this.to)),i=new c(ge(t.content,((e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e),n),t.openStart,t.openEnd);return me.fromReplace(e,this.from,this.to,i)}invert(){return new ve(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ye(t.pos,r.pos,this.mark)}merge(e){return e instanceof ye&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ye(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ye(t.from,t.to,e.markFromJSON(t.mark))}}pe.jsonID("addMark",ye);class ve extends pe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new c(ge(t.content,(e=>e.mark(this.mark.removeFromSet(e.marks))),e),t.openStart,t.openEnd);return me.fromReplace(e,this.from,this.to,r)}invert(){return new ye(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ve(t.pos,r.pos,this.mark)}merge(e){return e instanceof ve&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ve(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ve(t.from,t.to,e.markFromJSON(t.mark))}}pe.jsonID("removeMark",ve);class be extends pe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return me.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return me.fromReplace(e,this.pos,this.pos+1,new c(i.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(e))return new be(this.pos,t.marks[r]);return new be(this.pos,this.mark)}}return new xe(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new be(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new be(t.pos,e.markFromJSON(t.mark))}}pe.jsonID("addNodeMark",be);class xe extends pe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return me.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return me.fromReplace(e,this.pos,this.pos+1,new c(i.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new be(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new xe(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new xe(t.pos,e.markFromJSON(t.mark))}}pe.jsonID("removeNodeMark",xe);class we extends pe{constructor(e,t,r,n=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=n}apply(e){return this.structure&&Se(e,this.from,this.to)?me.fail("Structure replace would overwrite content"):me.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new de([this.from,this.to-this.from,this.slice.size])}invert(e){return new we(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new we(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof we)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?c.empty:new c(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new we(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?c.empty:new c(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new we(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new we(t.from,t.to,c.fromJSON(e,t.slice),!!t.structure)}}pe.jsonID("replace",we);class Ee extends pe{constructor(e,t,r,n,i,s,o=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=n,this.slice=i,this.insert=s,this.structure=o}apply(e){if(this.structure&&(Se(e,this.from,this.gapFrom)||Se(e,this.gapTo,this.to)))return me.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return me.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?me.fromReplace(e,this.from,this.to,r):me.fail("Content does not fit in gap")}getMap(){return new de([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ee(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),n=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||n<t.pos||i>r.pos?null:new Ee(t.pos,r.pos,n,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ee(t.from,t.to,t.gapFrom,t.gapTo,c.fromJSON(e,t.slice),t.insert,!!t.structure)}}function Se(e,t,r){let n=e.resolve(t),i=r-t,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let e=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function Te(e,t,r){return(0==t||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function Ae(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let r=e.depth;;--r){let n=e.$from.node(r),i=e.$from.index(r),s=e.$to.indexAfter(r);if(r<e.depth&&n.canReplace(i,s,t))return r;if(0==r||n.type.spec.isolating||!Te(n,i,s))break}return null}function De(e,t,r=null,n=e){let i=function(e,t){let{parent:r,startIndex:n,endIndex:i}=e,s=r.contentMatchAt(n).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return r.canReplaceWith(n,i,o)?s:null}(e,t),s=i&&function(e,t){let{parent:r,startIndex:n,endIndex:i}=e,s=r.child(n),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let e=n;a&&e<i;e++)a=a.matchType(r.child(e).type);return a&&a.validEnd?o:null}(n,t);return s?i.map(Ne).concat({type:t,attrs:r}).concat(s.map(Ne)):null}function Ne(e){return{type:e,attrs:null}}function Ce(e,t,r=1,n){let i=e.resolve(t),s=i.depth-r,o=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let e=i.depth-1,t=r-2;e>s;e--,t--){let r=i.node(e),s=i.index(e);if(r.type.spec.isolating)return!1;let o=r.content.cutByIndex(s,r.childCount),a=n&&n[t+1];a&&(o=o.replaceChild(0,a.type.create(a.attrs)));let l=n&&n[t]||r;if(!r.canReplace(s+1,r.childCount)||!l.type.validContent(o))return!1}let a=i.indexAfter(s),l=n&&n[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function ke(e,t){let r=e.resolve(t),n=r.index();return Me(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function Me(e,t){return!(!e||!t||e.isLeaf||!e.canAppend(t))}function Oe(e,t,r=-1){let n=e.resolve(t);for(let e=n.depth;;e--){let i,s,o=n.index(e);if(e==n.depth?(i=n.nodeBefore,s=n.nodeAfter):r>0?(i=n.node(e+1),o++,s=n.node(e).maybeChild(o)):(i=n.node(e).maybeChild(o-1),s=n.node(e+1)),i&&!i.isTextblock&&Me(i,s)&&n.node(e).canReplace(o,o+1))return t;if(0==e)break;t=r<0?n.before(e):n.after(e)}}function _e(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let i=r.content;for(let e=0;e<r.openStart;e++)i=i.firstChild.content;for(let e=1;e<=(0==r.openStart&&r.size?2:1);e++)for(let t=n.depth;t>=0;t--){let r=t==n.depth?0:n.pos<=(n.start(t+1)+n.end(t+1))/2?-1:1,s=n.index(t)+(r>0?1:0),o=n.node(t),a=!1;if(1==e)a=o.canReplace(s,s,i);else{let e=o.contentMatchAt(s).findWrapping(i.firstChild.type);a=e&&o.canReplaceWith(s,s,e[0])}if(a)return 0==r?n.pos:r<0?n.before(t+1):n.after(t+1)}return null}function Le(e,t,r=t,n=c.empty){if(t==r&&!n.size)return null;let i=e.resolve(t),s=e.resolve(r);return Re(i,s,n)?new we(t,r,n):new Ie(i,s,n).fit()}function Re(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}pe.jsonID("replaceAround",Ee);class Ie{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=i.empty;for(let t=0;t<=e.depth;t++){let r=e.node(t);this.frontier.push({type:r.type,match:r.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=i.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,n=this.close(e<0?this.$to:r.doc.resolve(e));if(!n)return null;let i=this.placed,s=r.depth,o=n.depth;for(;s&&o&&1==i.childCount;)i=i.firstChild.content,s--,o--;let a=new c(i,s,o);return e>-1?new Ee(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new we(r.pos,n.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,n=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(n=0),i.type.spec.isolating&&n<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=1==t?e:this.unplaced.openStart;r>=0;r--){let e,n=null;r?(n=Be(this.unplaced.content,r-1).firstChild,e=n.content):e=this.unplaced.content;let s=e.firstChild;for(let e=this.depth;e>=0;e--){let o,{type:a,match:l}=this.frontier[e],u=null;if(1==t&&(s?l.matchType(s.type)||(u=l.fillBefore(i.from(s),!1)):n&&a.compatibleContent(n.type)))return{sliceDepth:r,frontierDepth:e,parent:n,inject:u};if(2==t&&s&&(o=l.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:e,parent:n,wrap:o};if(n&&l.matchType(n.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,n=Be(e,t);return!(!n.childCount||n.firstChild.isLeaf)&&(this.unplaced=new c(e,t+1,Math.max(r,n.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,n=Be(e,t);if(n.childCount<=1&&t>0){let i=e.size-t<=t+n.size;this.unplaced=new c(Fe(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new c(Fe(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:n,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let e=0;e<s.length;e++)this.openFrontierNode(s[e]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,u=0,d=[],{match:h,type:f}=this.frontier[t];if(n){for(let e=0;e<n.childCount;e++)d.push(n.child(e));h=h.matchFragment(n)}let p=a.size+e-(o.content.size-o.openEnd);for(;u<a.childCount;){let e=a.child(u),t=h.matchType(e.type);if(!t)break;u++,(u>1||0==l||e.content.size)&&(h=t,d.push(Ue(e.mark(f.allowedMarks(e.marks)),1==u?l:0,u==a.childCount?p:-1)))}let m=u==a.childCount;m||(p=-1),this.placed=Pe(this.placed,t,i.from(d)),this.frontier[t].match=h,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=a;e<p;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=m?0==e?c.empty:new c(Fe(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new c(Fe(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!$e(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,n=this.$to.after(r);for(;r>1&&n==this.$to.end(--r);)++n;return n}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:n}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=$e(e,t,n,r,i);if(s){for(let r=t-1;r>=0;r--){let{match:t,type:n}=this.frontier[r],i=$e(e,r,n,t,!0);if(!i||i.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Pe(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let t=e.node(r),n=t.type.contentMatch.fillBefore(t.content,!0,e.index(r));this.openFrontierNode(t.type,t.attrs,n)}return e}openFrontierNode(e,t=null,r){let n=this.frontier[this.depth];n.match=n.match.matchType(e),this.placed=Pe(this.placed,this.depth,i.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(i.empty,!0);e.childCount&&(this.placed=Pe(this.placed,this.frontier.length,e))}}function Fe(e,t,r){return 0==t?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(Fe(e.firstChild.content,t-1,r)))}function Pe(e,t,r){return 0==t?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(Pe(e.lastChild.content,t-1,r)))}function Be(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function Ue(e,t,r){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,Ue(n.firstChild,t-1,1==n.childCount?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(i.empty,!0)))),e.copy(n)}function $e(e,t,r,n,i){let s=e.node(t),o=i?e.indexAfter(t):e.index(t);if(o==s.childCount&&!r.compatibleContent(s.type))return null;let a=n.fillBefore(s.content,!0,o);return a&&!function(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}(r,s.content,o)?a:null}function je(e,t,r,n,s){if(t<r){let i=e.firstChild;e=e.replaceChild(0,i.copy(je(i.content,t+1,r,n,i)))}if(t>n){let t=s.contentMatchAt(0),r=t.fillBefore(e).append(e);e=r.append(t.matchFragment(r).fillBefore(i.empty,!0))}return e}function ze(e,t){let r=[];for(let n=Math.min(e.depth,t.depth);n>=0;n--){let i=e.start(n);if(i<e.pos-(e.depth-n)||t.end(n)>t.pos+(t.depth-n)||e.node(n).type.spec.isolating||t.node(n).type.spec.isolating)break;(i==t.start(n)||n==e.depth&&n==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&n&&t.start(n-1)==i-1)&&r.push(n)}return r}class qe extends pe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return me.fail("No node at attribute step's position");let r=Object.create(null);for(let e in t.attrs)r[e]=t.attrs[e];r[this.attr]=this.value;let n=t.type.create(r,null,t.marks);return me.fromReplace(e,this.pos,this.pos+1,new c(i.from(n),0,t.isLeaf?0:1))}getMap(){return de.empty}invert(e){return new qe(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new qe(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new qe(t.pos,t.attr,t.value)}}pe.jsonID("attr",qe);class He extends pe{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return me.ok(r)}getMap(){return de.empty}invert(e){return new He(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new He(t.attr,t.value)}}pe.jsonID("docAttr",He);let Ve=class extends Error{};Ve=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r},(Ve.prototype=Object.create(Error.prototype)).constructor=Ve,Ve.prototype.name="TransformError";class Ge{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new he}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ve(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=c.empty){let n=Le(this.doc,e,t,r);return n&&this.step(n),this}replaceWith(e,t,r){return this.replace(e,t,new c(i.from(r),0,0))}delete(e,t){return this.replace(e,t,c.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return function(e,t,r,n){if(!n.size)return e.deleteRange(t,r);let i=e.doc.resolve(t),s=e.doc.resolve(r);if(Re(i,s,n))return e.step(new we(t,r,n));let o=ze(i,e.doc.resolve(r));0==o[o.length-1]&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let e=i.depth,t=i.pos-1;e>0;e--,t--){let r=i.node(e).type.spec;if(r.defining||r.definingAsContext||r.isolating)break;o.indexOf(e)>-1?a=e:i.before(e)==t&&o.splice(1,0,-e)}let l=o.indexOf(a),u=[],d=n.openStart;for(let e=n.content,t=0;;t++){let r=e.firstChild;if(u.push(r),t==n.openStart)break;e=r.content}for(let e=d-1;e>=0;e--){let t=u[e],r=(h=t.type).spec.defining||h.spec.definingForContent;if(r&&!t.sameMarkup(i.node(Math.abs(a)-1)))d=e;else if(r||!t.type.isTextblock)break}var h;for(let t=n.openStart;t>=0;t--){let a=(t+d+1)%(n.openStart+1),h=u[a];if(h)for(let t=0;t<o.length;t++){let u=o[(t+l)%o.length],d=!0;u<0&&(d=!1,u=-u);let f=i.node(u-1),p=i.index(u-1);if(f.canReplaceWith(p,p,h.type,h.marks))return e.replace(i.before(u),d?s.after(u):r,new c(je(n.content,0,n.openStart,a),a,n.openEnd))}}let f=e.steps.length;for(let a=o.length-1;a>=0&&(e.replace(t,r,n),!(e.steps.length>f));a--){let e=o[a];e<0||(t=i.before(e),r=s.after(e))}}(this,e,t,r),this}replaceRangeWith(e,t,r){return function(e,t,r,n){if(!n.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let i=function(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(0==n.parentOffset)for(let e=n.depth-1;e>=0;e--){let t=n.index(e);if(n.node(e).canReplaceWith(t,t,r))return n.before(e+1);if(t>0)return null}if(n.parentOffset==n.parent.content.size)for(let e=n.depth-1;e>=0;e--){let t=n.indexAfter(e);if(n.node(e).canReplaceWith(t,t,r))return n.after(e+1);if(t<n.node(e).childCount)return null}return null}(e.doc,t,n.type);null!=i&&(t=r=i)}e.replaceRange(t,r,new c(i.from(n),0,0))}(this,e,t,r),this}deleteRange(e,t){return function(e,t,r){let n=e.doc.resolve(t),i=e.doc.resolve(r),s=ze(n,i);for(let t=0;t<s.length;t++){let r=s[t],o=t==s.length-1;if(o&&0==r||n.node(r).type.contentMatch.validEnd)return e.delete(n.start(r),i.end(r));if(r>0&&(o||n.node(r-1).canReplace(n.index(r-1),i.indexAfter(r-1))))return e.delete(n.before(r),i.after(r))}for(let s=1;s<=n.depth&&s<=i.depth;s++)if(t-n.start(s)==n.depth-s&&r>n.end(s)&&i.end(s)-r!=i.depth-s)return e.delete(n.before(s),r);e.delete(t,r)}(this,e,t),this}lift(e,t){return function(e,t,r){let{$from:n,$to:s,depth:o}=t,a=n.before(o+1),l=s.after(o+1),u=a,d=l,h=i.empty,f=0;for(let e=o,t=!1;e>r;e--)t||n.index(e)>0?(t=!0,h=i.from(n.node(e).copy(h)),f++):u--;let p=i.empty,m=0;for(let e=o,t=!1;e>r;e--)t||s.after(e+1)<s.end(e)?(t=!0,p=i.from(s.node(e).copy(p)),m++):d++;e.step(new Ee(u,d,a,l,new c(h.append(p),f,m),h.size-f,!0))}(this,e,t),this}join(e,t=1){return function(e,t,r){let n=new we(t-r,t+r,c.empty,!0);e.step(n)}(this,e,t),this}wrap(e,t){return function(e,t,r){let n=i.empty;for(let e=r.length-1;e>=0;e--){if(n.size){let t=r[e].type.contentMatch.matchFragment(n);if(!t||!t.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=i.from(r[e].type.create(r[e].attrs,n))}let s=t.start,o=t.end;e.step(new Ee(s,o,s,o,new c(n,0,0),r.length,!0))}(this,e,t),this}setBlockType(e,t=e,r,n=null){return function(e,t,r,n,s){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=e.steps.length;e.doc.nodesBetween(t,r,((t,r)=>{if(t.isTextblock&&!t.hasMarkup(n,s)&&function(e,t,r){let n=e.resolve(t),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}(e.doc,e.mapping.slice(o).map(r),n)){e.clearIncompatible(e.mapping.slice(o).map(r,1),n);let a=e.mapping.slice(o),l=a.map(r,1),u=a.map(r+t.nodeSize,1);return e.step(new Ee(l,u,l+1,u-1,new c(i.from(n.create(s,null,t.marks)),0,0),1,!0)),!1}}))}(this,e,t,r,n),this}setNodeMarkup(e,t,r=null,n){return function(e,t,r,n,s){let o=e.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");r||(r=o.type);let a=r.create(n,null,s||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,a);if(!r.validContent(o.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new Ee(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new c(i.from(a),0,0),1,!0))}(this,e,t,r,n),this}setNodeAttribute(e,t,r){return this.step(new qe(e,t,r)),this}setDocAttribute(e,t){return this.step(new He(e,t)),this}addNodeMark(e,t){return this.step(new be(e,t)),this}removeNodeMark(e,t){if(!(t instanceof l)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(r.marks)))return this}return this.step(new xe(e,t)),this}split(e,t=1,r){return function(e,t,r=1,n){let s=e.doc.resolve(t),o=i.empty,a=i.empty;for(let e=s.depth,t=s.depth-r,l=r-1;e>t;e--,l--){o=i.from(s.node(e).copy(o));let t=n&&n[l];a=i.from(t?t.type.create(t.attrs,a):s.node(e).copy(a))}e.step(new we(t,t,new c(o.append(a),r,r),!0))}(this,e,t,r),this}addMark(e,t,r){return function(e,t,r,n){let i,s,o=[],a=[];e.doc.nodesBetween(t,r,((e,l,u)=>{if(!e.isInline)return;let c=e.marks;if(!n.isInSet(c)&&u.type.allowsMarkType(n.type)){let u=Math.max(l,t),d=Math.min(l+e.nodeSize,r),h=n.addToSet(c);for(let e=0;e<c.length;e++)c[e].isInSet(h)||(i&&i.to==u&&i.mark.eq(c[e])?i.to=d:o.push(i=new ve(u,d,c[e])));s&&s.to==u?s.to=d:a.push(s=new ye(u,d,n))}})),o.forEach((t=>e.step(t))),a.forEach((t=>e.step(t)))}(this,e,t,r),this}removeMark(e,t,r){return function(e,t,r,n){let i=[],s=0;e.doc.nodesBetween(t,r,((e,o)=>{if(!e.isInline)return;s++;let a=null;if(n instanceof V){let t,r=e.marks;for(;t=n.isInSet(r);)(a||(a=[])).push(t),r=t.removeFromSet(r)}else n?n.isInSet(e.marks)&&(a=[n]):a=e.marks;if(a&&a.length){let n=Math.min(o+e.nodeSize,r);for(let e=0;e<a.length;e++){let r,l=a[e];for(let e=0;e<i.length;e++){let t=i[e];t.step==s-1&&l.eq(i[e].style)&&(r=t)}r?(r.to=n,r.step=s):i.push({style:l,from:Math.max(o,t),to:n,step:s})}}})),i.forEach((t=>e.step(new ve(t.from,t.to,t.style))))}(this,e,t,r),this}clearIncompatible(e,t,r){return function(e,t,r,n=r.contentMatch){let s=e.doc.nodeAt(t),o=[],a=t+1;for(let t=0;t<s.childCount;t++){let l=s.child(t),u=a+l.nodeSize,d=n.matchType(l.type);if(d){n=d;for(let t=0;t<l.marks.length;t++)r.allowsMarkType(l.marks[t].type)||e.step(new ve(a,u,l.marks[t]));if(l.isText&&!r.spec.code){let e,t,n=/\r?\n|\r/g;for(;e=n.exec(l.text);)t||(t=new c(i.from(r.schema.text(" ",r.allowedMarks(l.marks))),0,0)),o.push(new we(a+e.index,a+e.index+e[0].length,t))}}else o.push(new we(a,u,c.empty));a=u}if(!n.validEnd){let t=n.fillBefore(i.empty,!0);e.replace(a,a,new c(t,0,0))}for(let t=o.length-1;t>=0;t--)e.step(o[t])}(this,e,t,r),this}}const We=Object.create(null);class Ke{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new Ye(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=c.empty){let r=t.content.lastChild,n=null;for(let e=0;e<t.openEnd;e++)n=r,r=r.lastChild;let i=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],u=e.mapping.slice(i);e.replaceRange(u.map(a.pos),u.map(l.pos),o?c.empty:t),0==o&&st(e,i,(r?r.isInline:n&&n.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,n=this.ranges;for(let i=0;i<n.length;i++){let{$from:s,$to:o}=n[i],a=e.mapping.slice(r),l=a.map(s.pos),u=a.map(o.pos);i?e.deleteRange(l,u):(e.replaceRangeWith(l,u,t),st(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let n=e.parent.inlineContent?new Xe(e):it(e.node(0),e.parent,e.pos,e.index(),t,r);if(n)return n;for(let n=e.depth-1;n>=0;n--){let i=t<0?it(e.node(0),e.node(n),e.before(n+1),e.index(n),t,r):it(e.node(0),e.node(n),e.after(n+1),e.index(n)+1,t,r);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new rt(e.node(0))}static atStart(e){return it(e,e,0,0,1)||new rt(e)}static atEnd(e){return it(e,e,e.content.size,e.childCount,-1)||new rt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=We[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in We)throw new RangeError("Duplicate use of selection JSON ID "+e);return We[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Xe.between(this.$anchor,this.$head).getBookmark()}}Ke.prototype.visible=!0;class Ye{constructor(e,t){this.$from=e,this.$to=t}}let Je=!1;function Ze(e){Je||e.parent.inlineContent||(Je=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Xe extends Ke{constructor(e,t=e){Ze(e),Ze(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Ke.near(r);let n=e.resolve(t.map(this.anchor));return new Xe(n.parent.inlineContent?n:r,r)}replace(e,t=c.empty){if(super.replace(e,t),t==c.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Xe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Qe(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Xe(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let n=e.resolve(t);return new this(n,r==t?n:e.resolve(r))}static between(e,t,r){let n=e.pos-t.pos;if(r&&!n||(r=n>=0?1:-1),!t.parent.inlineContent){let e=Ke.findFrom(t,r,!0)||Ke.findFrom(t,-r,!0);if(!e)return Ke.near(t,r);t=e.$head}return e.parent.inlineContent||(0==n||(e=(Ke.findFrom(e,-r,!0)||Ke.findFrom(e,r,!0)).$anchor).pos<t.pos!=n<0)&&(e=t),new Xe(e,t)}}Ke.jsonID("text",Xe);class Qe{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Qe(e.map(this.anchor),e.map(this.head))}resolve(e){return Xe.between(e.resolve(this.anchor),e.resolve(this.head))}}class et extends Ke{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:n}=t.mapResult(this.anchor),i=e.resolve(n);return r?Ke.near(i):new et(i)}content(){return new c(i.from(this.node),0,0)}eq(e){return e instanceof et&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new tt(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new et(e.resolve(t.anchor))}static create(e,t){return new et(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}et.prototype.visible=!1,Ke.jsonID("node",et);class tt{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Qe(r,r):new tt(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&et.isSelectable(r)?new et(t):Ke.near(t)}}class rt extends Ke{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=c.empty){if(t==c.empty){e.delete(0,e.doc.content.size);let t=Ke.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new rt(e)}map(e){return new rt(e)}eq(e){return e instanceof rt}getBookmark(){return nt}}Ke.jsonID("all",rt);const nt={map(){return this},resolve:e=>new rt(e)};function it(e,t,r,n,i,s=!1){if(t.inlineContent)return Xe.create(e,r);for(let o=n-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let n=t.child(o);if(n.isAtom){if(!s&&et.isSelectable(n))return et.create(e,r-(i<0?n.nodeSize:0))}else{let t=it(e,n,r+i,i<0?n.childCount:0,i,s);if(t)return t}r+=n.nodeSize*i}return null}function st(e,t,r){let n=e.steps.length-1;if(n<t)return;let i,s=e.steps[n];(s instanceof we||s instanceof Ee)&&(e.mapping.maps[n].forEach(((e,t,r,n)=>{null==i&&(i=n)})),e.setSelection(Ke.near(e.doc.resolve(i),r)))}class ot extends Ge{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return l.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||l.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let n=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(n.text(e),!0):this.deleteSelection();{if(null==r&&(r=t),r=null==r?t:r,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let e=this.doc.resolve(t);i=r==t?e.marks():e.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,n.text(e,i)),this.selection.empty||this.setSelection(Ke.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function at(e,t){return t&&e?e.bind(t):e}class lt{constructor(e,t,r){this.name=e,this.init=at(t.init,r),this.apply=at(t.apply,r)}}const ut=[new lt("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new lt("selection",{init:(e,t)=>e.selection||Ke.atStart(t.doc),apply:e=>e.selection}),new lt("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,r,n)=>n.selection.$cursor?e.storedMarks:null}),new lt("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class ct{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ut.slice(),t&&t.forEach((e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new lt(e.key,e.spec.state,e))}))}}class dt{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let t=this.config.plugins[r];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),n=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=n?n[s].n:0,l=n?n[s].state:this,u=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!n){n=[];for(let e=0;e<this.config.plugins.length;e++)n.push(e<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}n&&(n[s]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new dt(this.config),r=this.config.fields;for(let n=0;n<r.length;n++){let i=r[n];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new ot(this)}static create(e){let t=new ct(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new dt(t);for(let n=0;n<t.fields.length;n++)r[t.fields[n].name]=t.fields[n].init(e,r);return r}reconfigure(e){let t=new ct(this.schema,e.plugins),r=t.fields,n=new dt(t);for(let t=0;t<r.length;t++){let i=r[t].name;n[i]=this.hasOwnProperty(i)?this[i]:r[t].init(e,n)}return n}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((e=>e.toJSON()))),e&&"object"==typeof e)for(let r in e){if("doc"==r||"selection"==r)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let n=e[r],i=n.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(n,this[n.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let n=new ct(e.schema,e.plugins),i=new dt(n);return n.fields.forEach((n=>{if("doc"==n.name)i.doc=C.fromJSON(e.schema,t.doc);else if("selection"==n.name)i.selection=Ke.fromJSON(i.doc,t.selection);else if("storedMarks"==n.name)t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let s in r){let o=r[s],a=o.spec.state;if(o.key==n.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,s))return void(i[n.name]=a.fromJSON.call(o,e,t[s],i))}i[n.name]=n.init(e,i)}})),i}}function ht(e,t,r){for(let n in e){let i=e[n];i instanceof Function?i=i.bind(t):"handleDOMEvents"==n&&(i=ht(i,t,{})),r[n]=i}return r}class ft{constructor(e){this.spec=e,this.props={},e.props&&ht(e.props,this,this.props),this.key=e.key?e.key.key:mt("plugin")}getState(e){return e[this.key]}}const pt=Object.create(null);function mt(e){return e in pt?e+"$"+ ++pt[e]:(pt[e]=0,e+"$")}class gt{constructor(e="key"){this.key=mt(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const yt=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},vt=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let bt=null;const xt=function(e,t,r){let n=bt||(bt=document.createRange());return n.setEnd(e,null==r?e.nodeValue.length:r),n.setStart(e,t||0),n},wt=function(e,t,r,n){return r&&(St(e,t,r,n,-1)||St(e,t,r,n,1))},Et=/^(img|br|input|textarea|hr)$/i;function St(e,t,r,n,i){for(;;){if(e==r&&t==n)return!0;if(t==(i<0?0:Tt(e))){let r=e.parentNode;if(!r||1!=r.nodeType||At(e)||Et.test(e.nodeName)||"false"==e.contentEditable)return!1;t=yt(e)+(i<0?0:1),e=r}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Tt(e):0}}}function Tt(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function At(e){let t;for(let r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const Dt=function(e){return e.focusNode&&wt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Nt(e,t){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}const Ct="undefined"!=typeof navigator?navigator:null,kt="undefined"!=typeof document?document:null,Mt=Ct&&Ct.userAgent||"",Ot=/Edge\/(\d+)/.exec(Mt),_t=/MSIE \d/.exec(Mt),Lt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mt),Rt=!!(_t||Lt||Ot),It=_t?document.documentMode:Lt?+Lt[1]:Ot?+Ot[1]:0,Ft=!Rt&&/gecko\/(\d+)/i.test(Mt);Ft&&(/Firefox\/(\d+)/.exec(Mt)||[0,0])[1];const Pt=!Rt&&/Chrome\/(\d+)/.exec(Mt),Bt=!!Pt,Ut=Pt?+Pt[1]:0,$t=!Rt&&!!Ct&&/Apple Computer/.test(Ct.vendor),jt=$t&&(/Mobile\/\w+/.test(Mt)||!!Ct&&Ct.maxTouchPoints>2),zt=jt||!!Ct&&/Mac/.test(Ct.platform),qt=!!Ct&&/Win/.test(Ct.platform),Ht=/Android \d/.test(Mt),Vt=!!kt&&"webkitFontSmoothing"in kt.documentElement.style,Gt=Vt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Wt(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Kt(e,t){return"number"==typeof e?e:e[t]}function Yt(e){let t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function Jt(e,t,r){let n=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let o=r||e.dom;o;o=vt(o)){if(1!=o.nodeType)continue;let e=o,r=e==s.body,a=r?Wt(s):Yt(e),l=0,u=0;if(t.top<a.top+Kt(n,"top")?u=-(a.top-t.top+Kt(i,"top")):t.bottom>a.bottom-Kt(n,"bottom")&&(u=t.bottom-t.top>a.bottom-a.top?t.top+Kt(i,"top")-a.top:t.bottom-a.bottom+Kt(i,"bottom")),t.left<a.left+Kt(n,"left")?l=-(a.left-t.left+Kt(i,"left")):t.right>a.right-Kt(n,"right")&&(l=t.right-a.right+Kt(i,"right")),l||u)if(r)s.defaultView.scrollBy(l,u);else{let r=e.scrollLeft,n=e.scrollTop;u&&(e.scrollTop+=u),l&&(e.scrollLeft+=l);let i=e.scrollLeft-r,s=e.scrollTop-n;t={left:t.left-i,top:t.top-s,right:t.right-i,bottom:t.bottom-s}}if(r||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function Zt(e){let t=[],r=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=r);n=vt(n));return t}function Xt(e,t){for(let r=0;r<e.length;r++){let{dom:n,top:i,left:s}=e[r];n.scrollTop!=i+t&&(n.scrollTop=i+t),n.scrollLeft!=s&&(n.scrollLeft=s)}}let Qt=null;function er(e,t){let r,n,i,s,o=2e8,a=0,l=t.top,u=t.top;for(let c=e.firstChild,d=0;c;c=c.nextSibling,d++){let e;if(1==c.nodeType)e=c.getClientRects();else{if(3!=c.nodeType)continue;e=xt(c).getClientRects()}for(let h=0;h<e.length;h++){let f=e[h];if(f.top<=l&&f.bottom>=u){l=Math.max(f.bottom,l),u=Math.min(f.top,u);let e=f.left>t.left?f.left-t.left:f.right<t.left?t.left-f.right:0;if(e<o){r=c,o=e,n=e&&3==r.nodeType?{left:f.right<t.left?f.right:f.left,top:t.top}:t,1==c.nodeType&&e&&(a=d+(t.left>=(f.left+f.right)/2?1:0));continue}}else f.top>t.top&&!i&&f.left<=t.left&&f.right>=t.left&&(i=c,s={left:Math.max(f.left,Math.min(f.right,t.left)),top:f.top});!r&&(t.left>=f.right&&t.top>=f.top||t.left>=f.left&&t.top>=f.bottom)&&(a=d+1)}}return!r&&i&&(r=i,n=s,o=0),r&&3==r.nodeType?function(e,t){let r=e.nodeValue.length,n=document.createRange();for(let i=0;i<r;i++){n.setEnd(e,i+1),n.setStart(e,i);let r=sr(n,1);if(r.top!=r.bottom&&tr(t,r))return{node:e,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:e,offset:0}}(r,n):!r||o&&1==r.nodeType?{node:e,offset:a}:er(r,n)}function tr(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function rr(e,t,r){let n=e.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),s=i;;){let r=e.childNodes[s];if(1==r.nodeType){let e=r.getClientRects();for(let n=0;n<e.length;n++){let i=e[n];if(tr(t,i))return rr(r,t,i)}}if((s=(s+1)%n)==i)break}return e}function nr(e,t){let r,n=e.dom.ownerDocument,i=0,s=function(e,t,r){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,r);if(n)return{node:n.offsetNode,offset:n.offset}}catch(e){}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,r);if(n)return{node:n.startContainer,offset:n.startOffset}}}(n,t.left,t.top);s&&({node:r,offset:i}=s);let o,a=(e.root.elementFromPoint?e.root:n).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let r=e.dom.getBoundingClientRect();if(!tr(t,r))return null;if(a=rr(e.dom,t,r),!a)return null}if($t)for(let e=a;r&&e;e=vt(e))e.draggable&&(r=void 0);if(a=function(e,t){let r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}(a,t),r){if(Ft&&1==r.nodeType&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let e,n=r.childNodes[i];"IMG"==n.nodeName&&(e=n.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&i++}let n;Vt&&i&&1==r.nodeType&&1==(n=r.childNodes[i-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&i--,r==e.dom&&i==r.childNodes.length-1&&1==r.lastChild.nodeType&&t.top>r.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:0!=i&&1==r.nodeType&&"BR"==r.childNodes[i-1].nodeName||(o=function(e,t,r,n){let i=-1;for(let r=t,s=!1;r!=e.dom;){let t=e.docView.nearestDesc(r,!0);if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent&&!s||!t.contentDOM)){let e=t.dom.getBoundingClientRect();if(t.node.isBlock&&t.parent&&!s&&(s=!0,e.left>n.left||e.top>n.top?i=t.posBefore:(e.right<n.left||e.bottom<n.top)&&(i=t.posAfter)),!t.contentDOM&&i<0&&!t.node.isText)return(t.node.isBlock?n.top<(e.top+e.bottom)/2:n.left<(e.left+e.right)/2)?t.posBefore:t.posAfter}r=t.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,r,-1)}(e,r,i,t))}null==o&&(o=function(e,t,r){let{node:n,offset:i}=er(t,r),s=-1;if(1==n.nodeType&&!n.firstChild){let e=n.getBoundingClientRect();s=e.left!=e.right&&r.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(n,i,s)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function ir(e){return e.top<e.bottom||e.left<e.right}function sr(e,t){let r=e.getClientRects();if(r.length){let e=r[t<0?0:r.length-1];if(ir(e))return e}return Array.prototype.find.call(r,ir)||e.getBoundingClientRect()}const or=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ar(e,t,r){let{node:n,offset:i,atom:s}=e.docView.domFromPos(t,r<0?-1:1),o=Vt||Ft;if(3==n.nodeType){if(!o||!or.test(n.nodeValue)&&(r<0?i:i!=n.nodeValue.length)){let e=i,t=i,s=r<0?1:-1;return r<0&&!i?(t++,s=-1):r>=0&&i==n.nodeValue.length?(e--,s=1):r<0?e--:t++,lr(sr(xt(n,e,t),s),s<0)}{let e=sr(xt(n,i,i),r);if(Ft&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let t=sr(xt(n,i-1,i-1),-1);if(t.top==e.top){let r=sr(xt(n,i,i+1),-1);if(r.top!=e.top)return lr(r,r.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&i&&(r<0||i==Tt(n))){let e=n.childNodes[i-1];if(1==e.nodeType)return ur(e.getBoundingClientRect(),!1)}if(null==s&&i<Tt(n)){let e=n.childNodes[i];if(1==e.nodeType)return ur(e.getBoundingClientRect(),!0)}return ur(n.getBoundingClientRect(),r>=0)}if(null==s&&i&&(r<0||i==Tt(n))){let e=n.childNodes[i-1],t=3==e.nodeType?xt(e,Tt(e)-(o?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return lr(sr(t,1),!1)}if(null==s&&i<Tt(n)){let e=n.childNodes[i];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?xt(e,0,o?0:1):1==e.nodeType?e:null:null;if(t)return lr(sr(t,-1),!0)}return lr(sr(3==n.nodeType?xt(n):n,-r),r>=0)}function lr(e,t){if(0==e.width)return e;let r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function ur(e,t){if(0==e.height)return e;let r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function cr(e,t,r){let n=e.state,i=e.root.activeElement;n!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),i!=e.dom&&i&&i.focus()}}const dr=/[\u0590-\u08ac]/;let hr=null,fr=null,pr=!1;function mr(e,t,r){return hr==t&&fr==r?pr:(hr=t,fr=r,pr="up"==r||"down"==r?function(e,t,r){let n=t.selection,i="up"==r?n.$from:n.$to;return cr(e,t,(()=>{let{node:t}=e.docView.domFromPos(i.pos,"up"==r?-1:1);for(;;){let r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.contentDOM||r.dom;break}t=r.dom.parentNode}let n=ar(e,i.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=xt(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let i=t[e];if(i.bottom>i.top+1&&("up"==r?n.top-i.top>2*(i.bottom-n.top):i.bottom-n.bottom>2*(n.bottom-i.top)))return!1}}return!0}))}(e,t,r):function(e,t,r){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,s=!i,o=i==n.parent.content.size,a=e.domSelection();return dr.test(n.parent.textContent)&&a.modify?cr(e,t,(()=>{let{focusNode:t,focusOffset:i,anchorNode:s,anchorOffset:o}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",r,"character");let u=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:c,focusOffset:d}=e.domSelectionRange(),h=c&&!u.contains(1==c.nodeType?c:c.parentNode)||t==c&&i==d;try{a.collapse(s,o),t&&(t!=s||i!=o)&&a.extend&&a.extend(t,i)}catch(e){}return null!=l&&(a.caretBidiLevel=l),h})):"left"==r||"backward"==r?s:o}(e,t,r))}class gr{constructor(e,t,r,n){this.parent=e,this.children=t,this.dom=r,this.contentDOM=n,this.dirty=0,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let n=this.children[t];if(n==e)return r;r+=n.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(r<0){let r,n;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(n=r.pmViewDesc)||n.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(n)+n.size:this.posAtStart}{let r,n;if(e==this.contentDOM)r=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.nextSibling}for(;r&&(!(n=r.pmViewDesc)||n.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(n):this.posAtEnd}}let n;if(e==this.dom&&this.contentDOM)n=t>yt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))n=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){n=!1;break}if(t.previousSibling)break}if(null==n&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){n=!0;break}if(t.nextSibling)break}}return(null==n?r>0:n)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,n=e;n;n=n.parentNode){let i,s=this.getDesc(n);if(s&&(!t||s.node)){if(!r||!(i=s.nodeDOM)||(1==i.nodeType?i.contains(1==e.nodeType?e:e.parentNode):i==e))return s;r=!1}}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,r){for(let n=e;n;n=n.parentNode){let i=this.getDesc(n);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let n=this.children[t],i=r+n.size;if(r==e&&i!=r){for(;!n.border&&n.children.length;)n=n.children[0];return n}if(e<i)return n.descAt(e-r-n.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,n=0;for(let t=0;r<this.children.length;r++){let i=this.children[r],s=t+i.size;if(s>e||i instanceof Sr){n=e-t;break}t=s}if(n)return this.children[r].domFromPos(n-this.children[r].border,t);for(let e;r&&!(e=this.children[r-1]).size&&e instanceof yr&&e.side>=0;r--);if(t<=0){let e,n=!0;for(;e=r?this.children[r-1]:null,e&&e.dom.parentNode!=this.contentDOM;r--,n=!1);return e&&t&&n&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?yt(e.dom)+1:0}}{let e,n=!0;for(;e=r<this.children.length?this.children[r]:null,e&&e.dom.parentNode!=this.contentDOM;r++,n=!1);return e&&n&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?yt(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let n=-1,i=-1;for(let s=r,o=0;;o++){let r=this.children[o],a=s+r.size;if(-1==n&&e<=a){let i=s+r.border;if(e>=i&&t<=a-r.border&&r.node&&r.contentDOM&&this.contentDOM.contains(r.contentDOM))return r.parseRange(e,t,i);e=s;for(let t=o;t>0;t--){let r=this.children[t-1];if(r.size&&r.dom.parentNode==this.contentDOM&&!r.emptyChildAt(1)){n=yt(r.dom)+1;break}e-=r.size}-1==n&&(n=0)}if(n>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let r=this.children[e];if(r.size&&r.dom.parentNode==this.contentDOM&&!r.emptyChildAt(-1)){i=yt(r.dom);break}t+=r.size}-1==i&&(i=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:t,fromOffset:n,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(1!=t.nodeType||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,n=!1){let i=Math.min(e,t),s=Math.max(e,t);for(let o=0,a=0;o<this.children.length;o++){let l=this.children[o],u=a+l.size;if(i>a&&s<u)return l.setSelection(e-a-l.border,t-a-l.border,r,n);a=u}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=r.getSelection(),u=!1;if((Ft||$t)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let t,r=e;r;r=r.parentNode){if(t=r.nextSibling){"BR"==t.nodeName&&(o=a={node:t.parentNode,offset:yt(t)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let r=e.childNodes[t-1];u=r&&("BR"==r.nodeName||"false"==r.contentEditable)}}if(Ft&&l.focusNode&&l.focusNode!=a.node&&1==l.focusNode.nodeType){let e=l.focusNode.childNodes[l.focusOffset];e&&"false"==e.contentEditable&&(n=!0)}if(!(n||u&&$t)&&wt(o.node,o.offset,l.anchorNode,l.anchorOffset)&&wt(a.node,a.offset,l.focusNode,l.focusOffset))return;let c=!1;if((l.extend||e==t)&&!u){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),c=!0}catch(e){}}if(!c){if(e>t){let e=o;o=a,a=e}let r=document.createRange();r.setEnd(a.node,a.offset),r.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(r)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,n=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let n=r+i.border,o=s-i.border;if(e>=n&&t<=o)return this.dirty=e==r||t==s?2:1,void(e!=n||t!=o||!i.contentLost&&i.dom.parentNode==this.contentDOM?i.markDirty(e-n,t-n):i.dirty=3);i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?3:2}r=s}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=1==e?2:1;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class yr extends gr{constructor(e,t,r,n){let i,s=t.type.toDOM;if("function"==typeof s&&(s=s(r,(()=>i?i.parent?i.parent.posBeforeChild(i):void 0:n))),!t.type.spec.raw){if(1!=s.nodeType){let e=document.createElement("span");e.appendChild(s),s=e}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class vr extends gr{constructor(e,t,r,n){super(e,[],t,null),this.textDOM=r,this.text=n}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class br extends gr{constructor(e,t,r,n){super(e,[],r,n),this.mark=t}static create(e,t,r,n){let i=n.nodeViews[t.type.name],s=i&&i(t,n,r);return s&&s.dom||(s=ie.renderSpec(document,t.type.spec.toDOM(t,r))),new br(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,r){let n=br.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;t<s&&(i=Fr(i,t,s,r)),e>0&&(i=Fr(i,0,e,r));for(let e=0;e<i.length;e++)i[e].parent=n;return n.children=i,n}}class xr extends gr{constructor(e,t,r,n,i,s,o,a,l){super(e,[],i,s),this.node=t,this.outerDeco=r,this.innerDeco=n,this.nodeDOM=o}static create(e,t,r,n,i,s){let o,a=i.nodeViews[t.type.name],l=a&&a(t,i,(()=>o?o.parent?o.parent.posBeforeChild(o):void 0:s),r,n),u=l&&l.dom,c=l&&l.contentDOM;if(t.isText)if(u){if(3!=u.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else u=document.createTextNode(t.text);else u||({dom:u,contentDOM:c}=ie.renderSpec(document,t.type.spec.toDOM(t)));c||t.isText||"BR"==u.nodeName||(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let d=u;return u=Or(u,r,t),l?o=new Tr(e,t,r,n,u,c||null,d,l,i,s+1):t.isText?new Er(e,t,r,n,u,d,i):new xr(e,t,r,n,u,c||null,d,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>i.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,r){return 0==this.dirty&&e.eq(this.node)&&_r(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,n=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,o=i&&i.pos<0,a=new Rr(this,s&&s.node,e);!function(e,t,r,n){let i=t.locals(e),s=0;if(0==i.length){for(let r=0;r<e.childCount;r++){let o=e.child(r);n(o,i,t.forChild(s,o),r),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let u=0;;){let c,d,h,f;for(;o<i.length&&i[o].to==s;){let e=i[o++];e.widget&&(c?(d||(d=[c])).push(e):c=e)}if(c)if(d){d.sort(Ir);for(let e=0;e<d.length;e++)r(d[e],u,!!l)}else r(c,u,!!l);if(l)f=-1,h=l,l=null;else{if(!(u<e.childCount))break;f=u,h=e.child(u++)}for(let e=0;e<a.length;e++)a[e].to<=s&&a.splice(e--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let p=s+h.nodeSize;if(h.isText){let e=p;o<i.length&&i[o].from<e&&(e=i[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<p&&(l=h.cut(e-s),h=h.cut(0,e-s),p=e,f=-1)}n(h,h.isInline&&!h.isLeaf?a.filter((e=>!e.inline)):a.slice(),t.forChild(s,h),f),s=p}}(this.node,this.innerDeco,((t,i,s)=>{t.spec.marks?a.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&a.syncToMarks(i==this.node.childCount?l.none:this.node.child(i).marks,r,e),a.placeWidget(t,e,n)}),((t,s,l,u)=>{let c;a.syncToMarks(t.marks,r,e),a.findNodeMatch(t,s,l,u)||o&&e.state.selection.from>n&&e.state.selection.to<n+t.nodeSize&&(c=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(t,s,l,c,e)||a.updateNextNode(t,s,l,e,u,n)||a.addNode(t,s,l,e,n),n+=t.nodeSize})),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),Ar(this.contentDOM,this.children,e),jt&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:r,to:n}=e.state.selection;if(!(e.state.selection instanceof Xe)||r<t||n>t+this.node.content.size)return null;let i=e.domSelectionRange(),s=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=Tt(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let e=s.nodeValue,i=function(e,t,r,n){for(let i=0,s=0;i<e.childCount&&s<=n;){let o=e.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<e.childCount;){let t=e.child(i++);if(s+=t.nodeSize,!t.isText)break;l+=t.text}if(s>=r){if(s>=n&&l.slice(n-t.length-a,n-a)==t)return n-t.length;let e=a<n?l.lastIndexOf(t,n-a-1):-1;if(e>=0&&e+t.length+a>=r)return a+e;if(r==n&&l.length>=n+t.length-a&&l.slice(n-a,n-a+t.length)==t)return n}}return-1}(this.node.content,e,r-t,n-t);return i<0?null:{node:s,pos:i,text:e}}return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:n}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new vr(this,i,t,n);e.input.compositionNodes.push(s),this.children=Fr(this.children,r,r+n.length,e,s)}update(e,t,r,n){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,r,n),!0)}updateInner(e,t,r,n){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(n,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(_r(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,r=this.dom;this.dom=kr(this.dom,this.nodeDOM,Cr(this.outerDeco,this.node,t),Cr(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function wr(e,t,r,n,i){Or(n,t,e);let s=new xr(void 0,e,t,r,n,n,n,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Er extends xr{constructor(e,t,r,n,i,s,o){super(e,t,r,n,i,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,n){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,n.trackWrites==this.nodeDOM&&(n.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,r){let n=this.node.cut(e,t),i=document.createTextNode(n.text);return new Er(this.parent,n,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}}class Sr extends gr{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class Tr extends xr{constructor(e,t,r,n,i,s,o,a,l,u){super(e,t,r,n,i,s,o,l,u),this.spec=a}update(e,t,r,n){if(3==this.dirty)return!1;if(this.spec.update){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,n),i}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,r,n)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,n){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,n)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Ar(e,t,r){let n=e.firstChild,i=!1;for(let s=0;s<t.length;s++){let o=t[s],a=o.dom;if(a.parentNode==e){for(;a!=n;)n=Lr(n),i=!0;n=n.nextSibling}else i=!0,e.insertBefore(a,n);if(o instanceof br){let t=n?n.previousSibling:e.lastChild;Ar(o.contentDOM,o.children,r),n=t?t.nextSibling:e.firstChild}}for(;n;)n=Lr(n),i=!0;i&&r.trackWrites==e&&(r.trackWrites=null)}const Dr=function(e){e&&(this.nodeName=e)};Dr.prototype=Object.create(null);const Nr=[new Dr];function Cr(e,t,r){if(0==e.length)return Nr;let n=r?Nr[0]:new Dr,i=[n];for(let s=0;s<e.length;s++){let o=e[s].type.attrs;if(o){o.nodeName&&i.push(n=new Dr(o.nodeName));for(let e in o){let s=o[e];null!=s&&(r&&1==i.length&&i.push(n=new Dr(t.isInline?"span":"div")),"class"==e?n.class=(n.class?n.class+" ":"")+s:"style"==e?n.style=(n.style?n.style+";":"")+s:"nodeName"!=e&&(n[e]=s))}}}return i}function kr(e,t,r,n){if(r==Nr&&n==Nr)return t;let i=t;for(let t=0;t<n.length;t++){let s=n[t],o=r[t];if(t){let t;o&&o.nodeName==s.nodeName&&i!=e&&(t=i.parentNode)&&t.nodeName.toLowerCase()==s.nodeName||(t=document.createElement(s.nodeName),t.pmIsDeco=!0,t.appendChild(i),o=Nr[0]),i=t}Mr(i,o||Nr[0],s)}return i}function Mr(e,t,r){for(let n in t)"class"==n||"style"==n||"nodeName"==n||n in r||e.removeAttribute(n);for(let n in r)"class"!=n&&"style"!=n&&"nodeName"!=n&&r[n]!=t[n]&&e.setAttribute(n,r[n]);if(t.class!=r.class){let n=t.class?t.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let t=0;t<n.length;t++)-1==i.indexOf(n[t])&&e.classList.remove(n[t]);for(let t=0;t<i.length;t++)-1==n.indexOf(i[t])&&e.classList.add(i[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=r.style){if(t.style){let r,n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}r.style&&(e.style.cssText+=r.style)}}function Or(e,t,r){return kr(e,e,Nr,Cr(t,r,1!=e.nodeType))}function _r(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function Lr(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Rr{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let r=t,n=r.children.length,i=e.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(n){let e=r.children[n-1];if(!(e instanceof br)){a=e,n--;break}r=e,n=e.children.length}else{if(r==t)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=a.node;if(l){if(l!=e.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let n=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;n<s&&(n==i-1?this.top:this.stack[n+1<<1]).matchesMark(e[n])&&!1!==e[n].type.spec.spanning;)n++;for(;n<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let n=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let r=this.top.children[t];if(r.matchesMark(e[i])&&!this.isLocked(r.dom)){n=t;break}}if(n>-1)n>this.index&&(this.changed=!0,this.destroyBetween(this.index,n)),this.top=this.top.children[this.index];else{let n=br.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,n),this.top=n,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,n){let i,s=-1;if(n>=this.preMatch.index&&(i=this.preMatch.matches[n-this.preMatch.index]).parent==this.top&&i.matchesNode(e,t,r))s=this.top.children.indexOf(i,this.index);else for(let n=this.index,i=Math.min(this.top.children.length,n+5);n<i;n++){let i=this.top.children[n];if(i.matchesNode(e,t,r)&&!this.preMatch.matched.has(i)){s=n;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,n,i){let s=this.top.children[n];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(e,t,r,i)&&(this.destroyBetween(this.index,n),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,r,n,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof xr){let l=this.preMatch.matched.get(a);if(null!=l&&l!=i)return!1;let u,c=a.dom,d=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&_r(t,a.outerDeco));if(!d&&a.update(e,t,r,n))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(u=this.recreateWrapper(a,e,t,r,n,s)))return this.top.children[this.index]=u,u.contentDOM&&(u.dirty=2,u.updateChildren(n,s+1),u.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,n,i,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let o=xr.create(this.top,t,r,n,i,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let e of o.children)e.parent=o}return e.destroy(),o}addNode(e,t,r,n,i){let s=xr.create(this.top,e,t,r,n,i);s.contentDOM&&s.updateChildren(n,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let n=this.index<this.top.children.length?this.top.children[this.index]:null;if(!n||!n.matchesWidget(e)||e!=n.widget&&n.widget.type.toDOM.parentNode){let n=new yr(this.top,e,t,r);this.top.children.splice(this.index++,0,n),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof br;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Er)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&(($t||Bt)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);"IMG"==e&&(r.className="ProseMirror-separator",r.alt=""),"BR"==e&&(r.className="ProseMirror-trailingBreak");let n=new Sr(this.top,[],r,null);t!=this.top?t.children.push(n):t.children.splice(this.index++,0,n),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function Ir(e,t){return e.type.side-t.type.side}function Fr(e,t,r,n,i){let s=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],u=a,c=a+=l.size;u>=r||c<=t?s.push(l):(u<t&&s.push(l.slice(0,t-u,n)),i&&(s.push(i),i=void 0),c>r&&s.push(l.slice(r-u,l.size,n)))}return s}function Pr(e,t=null){let r=e.domSelectionRange(),n=e.state.doc;if(!r.focusNode)return null;let i=e.docView.nearestDesc(r.focusNode),s=i&&0==i.size,o=e.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(o<0)return null;let a,l,u=n.resolve(o);if(Dt(r)){for(a=u;i&&!i.node;)i=i.parent;let e=i.node;if(i&&e.isAtom&&et.isSelectable(e)&&i.parent&&(!e.isInline||!function(e,t,r){for(let n=0==t,i=t==Tt(e);n||i;){if(e==r)return!0;let t=yt(e);if(!(e=e.parentNode))return!1;n=n&&0==t,i=i&&t==Tt(e)}}(r.focusNode,r.focusOffset,i.dom))){let e=i.posBefore;l=new et(o==e?u:n.resolve(e))}}else{let t=e.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(t<0)return null;a=n.resolve(t)}if(!l){l=Gr(e,a,u,"pointer"==t||e.state.selection.head<u.pos&&!s?1:-1)}return l}function Br(e){return e.editable?e.hasFocus():Kr(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Ur(e,t=!1){let r=e.state.selection;if(Hr(e,r),Br(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Bt){let t=e.domSelectionRange(),r=e.domObserver.currentSelection;if(t.anchorNode&&r.anchorNode&&wt(t.anchorNode,t.anchorOffset,r.anchorNode,r.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),r=document.createRange(),n=e.cursorWrapper.dom,i="IMG"==n.nodeName;i?r.setEnd(n.parentNode,yt(n)+1):r.setEnd(n,0);r.collapse(!1),t.removeAllRanges(),t.addRange(r),!i&&!e.state.selection.visible&&Rt&&It<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let n,i,{anchor:s,head:o}=r;!$r||r instanceof Xe||(r.$from.parent.inlineContent||(n=jr(e,r.from)),r.empty||r.$from.parent.inlineContent||(i=jr(e,r.to))),e.docView.setSelection(s,o,e.root,t),$r&&(n&&qr(n),i&&qr(i)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let r=e.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{r.anchorNode==n&&r.anchorOffset==i||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout((()=>{Br(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const $r=$t||Bt&&Ut<63;function jr(e,t){let{node:r,offset:n}=e.docView.domFromPos(t,0),i=n<r.childNodes.length?r.childNodes[n]:null,s=n?r.childNodes[n-1]:null;if($t&&i&&"false"==i.contentEditable)return zr(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return zr(i);if(s)return zr(s)}}function zr(e){return e.contentEditable="true",$t&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function qr(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Hr(e,t){if(t instanceof et){let r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(Vr(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else Vr(e)}function Vr(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Gr(e,t,r,n){return e.someProp("createSelectionBetween",(n=>n(e,t,r)))||Xe.between(t,r,n)}function Wr(e){return!(e.editable&&!e.hasFocus())&&Kr(e)}function Kr(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function Yr(e,t){let{$anchor:r,$head:n}=e.selection,i=t>0?r.max(n):r.min(n),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Ke.findFrom(s,t)}function Jr(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Zr(e,t,r){let n=e.state.selection;if(!(n instanceof Xe)){if(n instanceof et&&n.node.isInline)return Jr(e,new Xe(t>0?n.$to:n.$from));{let r=Yr(e.state,t);return!!r&&Jr(e,r)}}if(r.indexOf("s")>-1){let{$head:r}=n,i=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=e.state.doc.resolve(r.pos+i.nodeSize*(t<0?-1:1));return Jr(e,new Xe(n.$anchor,s))}if(!n.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let r=Yr(e.state,t);return!!(r&&r instanceof et)&&Jr(e,r)}if(!(zt&&r.indexOf("m")>-1)){let r,i=n.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText)return!1;let o=t<0?i.pos-s.nodeSize:i.pos;return!!(s.isAtom||(r=e.docView.descAt(o))&&!r.contentDOM)&&(et.isSelectable(s)?Jr(e,new et(t<0?e.state.doc.resolve(i.pos-s.nodeSize):i)):!!Vt&&Jr(e,new Xe(e.state.doc.resolve(t<0?o:o+s.nodeSize))))}}function Xr(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Qr(e,t){let r=e.pmViewDesc;return r&&0==r.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function en(e,t){return t<0?function(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let i,s,o=!1;Ft&&1==r.nodeType&&n<Xr(r)&&Qr(r.childNodes[n],-1)&&(o=!0);for(;;)if(n>0){if(1!=r.nodeType)break;{let e=r.childNodes[n-1];if(Qr(e,-1))i=r,s=--n;else{if(3!=e.nodeType)break;r=e,n=r.nodeValue.length}}}else{if(tn(r))break;{let t=r.previousSibling;for(;t&&Qr(t,-1);)i=r.parentNode,s=yt(t),t=t.previousSibling;if(t)r=t,n=Xr(r);else{if(r=r.parentNode,r==e.dom)break;n=0}}}o?rn(e,r,n):i&&rn(e,i,s)}(e):function(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let i,s,o=Xr(r);for(;;)if(n<o){if(1!=r.nodeType)break;if(!Qr(r.childNodes[n],1))break;i=r,s=++n}else{if(tn(r))break;{let t=r.nextSibling;for(;t&&Qr(t,1);)i=t.parentNode,s=yt(t)+1,t=t.nextSibling;if(t)r=t,n=0,o=Xr(r);else{if(r=r.parentNode,r==e.dom)break;n=o=0}}}i&&rn(e,i,s)}(e)}function tn(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function rn(e,t,r){if(3!=t.nodeType){let e,n;(n=function(e,t){for(;e&&t==e.childNodes.length&&!At(e);)t=yt(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let r=e.childNodes[t];if(3==r.nodeType)return r;if(1==r.nodeType&&"false"==r.contentEditable)break;e=r,t=0}}(t,r))?(t=n,r=0):(e=function(e,t){for(;e&&!t&&!At(e);)t=yt(e),e=e.parentNode;for(;e&&t;){let r=e.childNodes[t-1];if(3==r.nodeType)return r;if(1==r.nodeType&&"false"==r.contentEditable)break;t=(e=r).childNodes.length}}(t,r))&&(t=e,r=e.nodeValue.length)}let n=e.domSelection();if(Dt(n)){let e=document.createRange();e.setEnd(t,r),e.setStart(t,r),n.removeAllRanges(),n.addRange(e)}else n.extend&&n.extend(t,r);e.domObserver.setCurSelection();let{state:i}=e;setTimeout((()=>{e.state==i&&Ur(e)}),50)}function nn(e,t){let r=e.state.doc.resolve(t);if(!Bt&&!qt&&r.parent.inlineContent){let n=e.coordsAtPos(t);if(t>r.start()){let r=e.coordsAtPos(t-1),i=(r.top+r.bottom)/2;if(i>n.top&&i<n.bottom&&Math.abs(r.left-n.left)>1)return r.left<n.left?"ltr":"rtl"}if(t<r.end()){let r=e.coordsAtPos(t+1),i=(r.top+r.bottom)/2;if(i>n.top&&i<n.bottom&&Math.abs(r.left-n.left)>1)return r.left>n.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function sn(e,t,r){let n=e.state.selection;if(n instanceof Xe&&!n.empty||r.indexOf("s")>-1)return!1;if(zt&&r.indexOf("m")>-1)return!1;let{$from:i,$to:s}=n;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let r=Yr(e.state,t);if(r&&r instanceof et)return Jr(e,r)}if(!i.parent.inlineContent){let r=t<0?i:s,o=n instanceof rt?Ke.near(r,t):Ke.findFrom(r,t);return!!o&&Jr(e,o)}return!1}function on(e,t){if(!(e.state.selection instanceof Xe))return!0;let{$head:r,$anchor:n,empty:i}=e.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){let n=e.state.tr;return t<0?n.delete(r.pos-s.nodeSize,r.pos):n.delete(r.pos,r.pos+s.nodeSize),e.dispatch(n),!0}return!1}function an(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function ln(e,t){let r=t.keyCode,n=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==r||zt&&72==r&&"c"==n)return on(e,-1)||en(e,-1);if(46==r&&!t.shiftKey||zt&&68==r&&"c"==n)return on(e,1)||en(e,1);if(13==r||27==r)return!0;if(37==r||zt&&66==r&&"c"==n){let t=37==r?"ltr"==nn(e,e.state.selection.from)?-1:1:-1;return Zr(e,t,n)||en(e,t)}if(39==r||zt&&70==r&&"c"==n){let t=39==r?"ltr"==nn(e,e.state.selection.from)?1:-1:1;return Zr(e,t,n)||en(e,t)}return 38==r||zt&&80==r&&"c"==n?sn(e,-1,n)||en(e,-1):40==r||zt&&78==r&&"c"==n?function(e){if(!$t||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(t&&1==t.nodeType&&0==r&&t.firstChild&&"false"==t.firstChild.contentEditable){let r=t.firstChild;an(e,r,"true"),setTimeout((()=>an(e,r,"false")),20)}return!1}(e)||sn(e,1,n)||en(e,1):n==(zt?"m":"c")&&(66==r||73==r||89==r||90==r)}function un(e,t){e.someProp("transformCopied",(r=>{t=r(t,e)}));let r=[],{content:n,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&1==n.childCount&&1==n.firstChild.childCount;){i--,s--;let e=n.firstChild;r.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),n=e.content}let o=e.someProp("clipboardSerializer")||ie.fromSchema(e.state.schema),a=bn(),l=a.createElement("div");l.appendChild(o.serializeFragment(n,{document:a}));let u,c=l.firstChild,d=0;for(;c&&1==c.nodeType&&(u=yn[c.nodeName.toLowerCase()]);){for(let e=u.length-1;e>=0;e--){let t=a.createElement(u[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),d++}c=l.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(r)}`),{dom:l,text:e.someProp("clipboardTextSerializer",(r=>r(t,e)))||t.content.textBetween(0,t.content.size,"\n\n")}}function cn(e,t,r,n,s){let o,a,l=s.parent.type.spec.code;if(!r&&!t)return null;let u=t&&(n||l||!r);if(u){if(e.someProp("transformPastedText",(r=>{t=r(t,l||n,e)})),l)return t?new c(i.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):c.empty;let r=e.someProp("clipboardTextParser",(r=>r(t,s,n,e)));if(r)a=r;else{let r=s.marks(),{schema:n}=e.state,i=ie.fromSchema(n);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((e=>{let t=o.appendChild(document.createElement("p"));e&&t.appendChild(i.serializeNode(n.text(e,r)))}))}}else e.someProp("transformPastedHTML",(t=>{r=t(r,e)})),o=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let r,n=bn().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(e);(r=i&&yn[i[1].toLowerCase()])&&(e=r.map((e=>"<"+e+">")).join("")+e+r.map((e=>"</"+e+">")).reverse().join(""));if(n.innerHTML=e,r)for(let e=0;e<r.length;e++)n=n.querySelector(r[e])||n;return n}(r),Vt&&function(e){let t=e.querySelectorAll(Bt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<t.length;r++){let n=t[r];1==n.childNodes.length&&" "==n.textContent&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}(o);let d=o&&o.querySelector("[data-pm-slice]"),h=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let e=+h[3];e>0;e--){let e=o.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;o=e}if(!a){let t=e.someProp("clipboardParser")||e.someProp("domParser")||K.fromSchema(e.state.schema);a=t.parseSlice(o,{preserveWhitespace:!(!u&&!h),context:s,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||dn.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(h)a=function(e,t){if(!e.size)return e;let r,n=e.content.firstChild.type.schema;try{r=JSON.parse(t)}catch(t){return e}let{content:s,openStart:o,openEnd:a}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;s=i.from(t.create(r[e+1],s)),o++,a++}return new c(s,o,a)}(gn(a,+h[1],+h[2]),h[4]);else if(a=c.maxOpen(function(e,t){if(e.childCount<2)return e;for(let r=t.depth;r>=0;r--){let n,s=t.node(r).contentMatchAt(t.index(r)),o=[];if(e.forEach((e=>{if(!o)return;let t,r=s.findWrapping(e.type);if(!r)return o=null;if(t=o.length&&n.length&&fn(r,n,e,o[o.length-1],0))o[o.length-1]=t;else{o.length&&(o[o.length-1]=pn(o[o.length-1],n.length));let t=hn(e,r);o.push(t),s=s.matchType(t.type),n=r}})),o)return i.from(o)}return e}(a.content,s),!0),a.openStart||a.openEnd){let e=0,t=0;for(let t=a.content.firstChild;e<a.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=a.content.lastChild;t<a.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);a=gn(a,e,t)}return e.someProp("transformPasted",(t=>{a=t(a,e)})),a}const dn=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function hn(e,t,r=0){for(let n=t.length-1;n>=r;n--)e=t[n].create(null,i.from(e));return e}function fn(e,t,r,n,s){if(s<e.length&&s<t.length&&e[s]==t[s]){let o=fn(e,t,r,n.lastChild,s+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(s==e.length-1?r.type:e[s+1]))return n.copy(n.content.append(i.from(hn(r,e,s+1))))}}function pn(e,t){if(0==t)return e;let r=e.content.replaceChild(e.childCount-1,pn(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(i.empty,!0);return e.copy(r.append(n))}function mn(e,t,r,n,s,o){let a=t<0?e.firstChild:e.lastChild,l=a.content;return e.childCount>1&&(o=0),s<n-1&&(l=mn(l,t,r,n,s+1,o)),s>=r&&(l=t<0?a.contentMatchAt(0).fillBefore(l,o<=s).append(l):l.append(a.contentMatchAt(a.childCount).fillBefore(i.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(l))}function gn(e,t,r){return t<e.openStart&&(e=new c(mn(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),r<e.openEnd&&(e=new c(mn(e.content,1,r,e.openEnd,0,0),e.openStart,r)),e}const yn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let vn=null;function bn(){return vn||(vn=document.implementation.createHTMLDocument("title"))}const xn={},wn={},En={touchstart:!0,touchmove:!0};class Sn{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Tn(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function An(e){e.someProp("handleDOMEvents",(t=>{for(let r in t)e.input.eventHandlers[r]||e.dom.addEventListener(r,e.input.eventHandlers[r]=t=>Dn(e,t))}))}function Dn(e,t){return e.someProp("handleDOMEvents",(r=>{let n=r[t.type];return!!n&&(n(e,t)||t.defaultPrevented)}))}function Nn(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target;r!=e.dom;r=r.parentNode)if(!r||11==r.nodeType||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}function Cn(e){return{left:e.clientX,top:e.clientY}}function kn(e,t,r,n,i){if(-1==n)return!1;let s=e.state.doc.resolve(n);for(let n=s.depth+1;n>0;n--)if(e.someProp(t,(t=>n>s.depth?t(e,r,s.nodeAfter,s.before(n),i,!0):t(e,r,s.node(n),s.before(n),i,!1))))return!0;return!1}function Mn(e,t,r){e.focused||e.focus();let n=e.state.tr.setSelection(t);"pointer"==r&&n.setMeta("pointer",!0),e.dispatch(n)}function On(e,t,r,n,i){return kn(e,"handleClickOn",t,r,n)||e.someProp("handleClick",(r=>r(e,t,n)))||(i?function(e,t){if(-1==t)return!1;let r,n,i=e.state.selection;i instanceof et&&(r=i.node);let s=e.state.doc.resolve(t);for(let e=s.depth+1;e>0;e--){let t=e>s.depth?s.nodeAfter:s.node(e);if(et.isSelectable(t)){n=r&&i.$from.depth>0&&e>=i.$from.depth&&s.before(i.$from.depth+1)==i.$from.pos?s.before(i.$from.depth):s.before(e);break}}return null!=n&&(Mn(e,et.create(e.state.doc,n),"pointer"),!0)}(e,r):function(e,t){if(-1==t)return!1;let r=e.state.doc.resolve(t),n=r.nodeAfter;return!!(n&&n.isAtom&&et.isSelectable(n))&&(Mn(e,new et(r),"pointer"),!0)}(e,r))}function _n(e,t,r,n){return kn(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",(r=>r(e,t,n)))}function Ln(e,t,r,n){return kn(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",(r=>r(e,t,n)))||function(e,t,r){if(0!=r.button)return!1;let n=e.state.doc;if(-1==t)return!!n.inlineContent&&(Mn(e,Xe.create(n,0,n.content.size),"pointer"),!0);let i=n.resolve(t);for(let t=i.depth+1;t>0;t--){let r=t>i.depth?i.nodeAfter:i.node(t),s=i.before(t);if(r.inlineContent)Mn(e,Xe.create(n,s+1,s+1+r.content.size),"pointer");else{if(!et.isSelectable(r))continue;Mn(e,et.create(n,s),"pointer")}return!0}}(e,r,n)}function Rn(e){return jn(e)}wn.keydown=(e,t)=>{let r=t;if(e.input.shiftKey=16==r.keyCode||r.shiftKey,!Pn(e,r)&&(e.input.lastKeyCode=r.keyCode,e.input.lastKeyCodeTime=Date.now(),!Ht||!Bt||13!=r.keyCode))if(229!=r.keyCode&&e.domObserver.forceFlush(),!jt||13!=r.keyCode||r.ctrlKey||r.altKey||r.metaKey)e.someProp("handleKeyDown",(t=>t(e,r)))||ln(e,r)?r.preventDefault():Tn(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout((()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",(t=>t(e,Nt(13,"Enter")))),e.input.lastIOSEnter=0)}),200)}},wn.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},wn.keypress=(e,t)=>{let r=t;if(Pn(e,r)||!r.charCode||r.ctrlKey&&!r.altKey||zt&&r.metaKey)return;if(e.someProp("handleKeyPress",(t=>t(e,r))))return void r.preventDefault();let n=e.state.selection;if(!(n instanceof Xe&&n.$from.sameParent(n.$to))){let t=String.fromCharCode(r.charCode);/[\r\n]/.test(t)||e.someProp("handleTextInput",(r=>r(e,n.$from.pos,n.$to.pos,t)))||e.dispatch(e.state.tr.insertText(t).scrollIntoView()),r.preventDefault()}};const In=zt?"metaKey":"ctrlKey";xn.mousedown=(e,t)=>{let r=t;e.input.shiftKey=r.shiftKey;let n=Rn(e),i=Date.now(),s="singleClick";i-e.input.lastClick.time<500&&function(e,t){let r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}(r,e.input.lastClick)&&!r[In]&&("singleClick"==e.input.lastClick.type?s="doubleClick":"doubleClick"==e.input.lastClick.type&&(s="tripleClick")),e.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:s};let o=e.posAtCoords(Cn(r));o&&("singleClick"==s?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Fn(e,o,r,!!n)):("doubleClick"==s?_n:Ln)(e,o.pos,o.inside,r)?r.preventDefault():Tn(e,"pointer"))};class Fn{constructor(e,t,r,n){let i,s;if(this.view=e,this.pos=t,this.event=r,this.flushed=n,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[In],this.allowDefault=r.shiftKey,t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let r=e.state.doc.resolve(t.pos);i=r.parent,s=r.depth?r.before():0}const o=n?null:r.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a?a.dom:null;let{selection:l}=e.state;(0==r.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||l instanceof et&&l.from<=s&&l.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Ft||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Tn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((()=>Ur(this.view))),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Cn(e))),this.updateAllowDefault(e),this.allowDefault||!t?Tn(this.view,"pointer"):On(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||$t&&this.mightDrag&&!this.mightDrag.node.isAtom||Bt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Mn(this.view,Ke.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Tn(this.view,"pointer")}move(e){this.updateAllowDefault(e),Tn(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Pn(e,t){return!!e.composing||!!($t&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}xn.touchstart=e=>{e.input.lastTouch=Date.now(),Rn(e),Tn(e,"pointer")},xn.touchmove=e=>{e.input.lastTouch=Date.now(),Tn(e,"pointer")},xn.contextmenu=e=>Rn(e);const Bn=Ht?5e3:-1;function Un(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout((()=>jn(e)),t))}function $n(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function jn(e,t=!1){if(!(Ht&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),$n(e),t||e.docView&&e.docView.dirty){let t=Pr(e);return t&&!t.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(t)):e.updateState(e.state),!0}return!1}}wn.compositionstart=wn.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,r=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some((e=>!1===e.type.spec.inclusive))))e.markCursor=e.state.storedMarks||r.marks(),jn(e,!0),e.markCursor=null;else if(jn(e),Ft&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let t=e.domSelectionRange();for(let r=t.focusNode,n=t.focusOffset;r&&1==r.nodeType&&0!=n;){let t=n<0?r.lastChild:r.childNodes[n-1];if(!t)break;if(3==t.nodeType){e.domSelection().collapse(t,t.nodeValue.length);break}r=t,n=-1}}e.input.composing=!0}Un(e,Bn)},wn.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionPendingChanges&&Promise.resolve().then((()=>e.domObserver.flush())),e.input.compositionID++,Un(e,20))};const zn=Rt&&It<15||jt&&Gt<604;function qn(e,t,r,n,i){let s=cn(e,t,r,n,e.state.selection.$from);if(e.someProp("handlePaste",(t=>t(e,i,s||c.empty))))return!0;if(!s)return!1;let o=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(s),a=o?e.state.tr.replaceSelectionWith(o,n):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Hn(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let r=e.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}xn.copy=wn.cut=(e,t)=>{let r=t,n=e.state.selection,i="cut"==r.type;if(n.empty)return;let s=zn?null:r.clipboardData,o=n.content(),{dom:a,text:l}=un(e,o);s?(r.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout((()=>{r.parentNode&&r.parentNode.removeChild(r),e.focus()}),50)}(e,a),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},wn.paste=(e,t)=>{let r=t;if(e.composing&&!Ht)return;let n=zn?null:r.clipboardData,i=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&qn(e,Hn(n),n.getData("text/html"),i,r)?r.preventDefault():function(e,t){if(!e.dom.parentNode)return;let r=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout((()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?qn(e,n.value,null,i,t):qn(e,n.textContent,n.innerHTML,i,t)}),50)}(e,r)};class Vn{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Gn=zt?"altKey":"ctrlKey";xn.dragstart=(e,t)=>{let r=t,n=e.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i,s=e.state.selection,o=s.empty?null:e.posAtCoords(Cn(r));if(o&&o.pos>=s.from&&o.pos<=(s instanceof et?s.to-1:s.to));else if(n&&n.mightDrag)i=et.create(e.state.doc,n.mightDrag.pos);else if(r.target&&1==r.target.nodeType){let t=e.docView.nearestDesc(r.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(i=et.create(e.state.doc,t.posBefore))}let a=(i||e.state.selection).content(),{dom:l,text:u}=un(e,a);r.dataTransfer.clearData(),r.dataTransfer.setData(zn?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",zn||r.dataTransfer.setData("text/plain",u),e.dragging=new Vn(a,!r[Gn],i)},xn.dragend=e=>{let t=e.dragging;window.setTimeout((()=>{e.dragging==t&&(e.dragging=null)}),50)},wn.dragover=wn.dragenter=(e,t)=>t.preventDefault(),wn.drop=(e,t)=>{let r=t,n=e.dragging;if(e.dragging=null,!r.dataTransfer)return;let i=e.posAtCoords(Cn(r));if(!i)return;let s=e.state.doc.resolve(i.pos),o=n&&n.slice;o?e.someProp("transformPasted",(t=>{o=t(o,e)})):o=cn(e,Hn(r.dataTransfer),zn?null:r.dataTransfer.getData("text/html"),!1,s);let a=!(!n||r[Gn]);if(e.someProp("handleDrop",(t=>t(e,r,o||c.empty,a))))return void r.preventDefault();if(!o)return;r.preventDefault();let l=o?_e(e.state.doc,s.pos,o):s.pos;null==l&&(l=s.pos);let u=e.state.tr;if(a){let{node:e}=n;e?e.replace(u):u.deleteSelection()}let d=u.mapping.map(l),h=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,f=u.doc;if(h?u.replaceRangeWith(d,d,o.content.firstChild):u.replaceRange(d,d,o),u.doc.eq(f))return;let p=u.doc.resolve(d);if(h&&et.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new et(p));else{let t=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach(((e,r,n,i)=>t=i)),u.setSelection(Gr(e,p,u.doc.resolve(t)))}e.focus(),e.dispatch(u.setMeta("uiEvent","drop"))},xn.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Ur(e)}),20))},xn.blur=(e,t)=>{let r=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),r.relatedTarget&&e.dom.contains(r.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},xn.beforeinput=(e,t)=>{if(Bt&&Ht&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout((()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",(t=>t(e,Nt(8,"Backspace")))))return;let{$cursor:r}=e.state.selection;r&&r.pos>0&&e.dispatch(e.state.tr.delete(r.pos-1,r.pos).scrollIntoView())}),50)}};for(let e in wn)xn[e]=wn[e];function Wn(e,t){if(e==t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}class Kn{constructor(e,t){this.toDOM=e,this.spec=t||Qn,this.side=this.spec.side||0}map(e,t,r,n){let{pos:i,deleted:s}=e.mapResult(t.from+n,this.side<0?-1:1);return s?null:new Zn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Kn&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Wn(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Yn{constructor(e,t){this.attrs=e,this.spec=t||Qn}map(e,t,r,n){let i=e.map(t.from+n,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+n,this.spec.inclusiveEnd?1:-1)-r;return i>=s?null:new Zn(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Yn&&Wn(this.attrs,e.attrs)&&Wn(this.spec,e.spec)}static is(e){return e.type instanceof Yn}destroy(){}}class Jn{constructor(e,t){this.attrs=e,this.spec=t||Qn}map(e,t,r,n){let i=e.mapResult(t.from+n,1);if(i.deleted)return null;let s=e.mapResult(t.to+n,-1);return s.deleted||s.pos<=i.pos?null:new Zn(i.pos-r,s.pos-r,this)}valid(e,t){let r,{index:n,offset:i}=e.content.findIndex(t.from);return i==t.from&&!(r=e.child(n)).isText&&i+r.nodeSize==t.to}eq(e){return this==e||e instanceof Jn&&Wn(this.attrs,e.attrs)&&Wn(this.spec,e.spec)}destroy(){}}class Zn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Zn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Zn(e,e,new Kn(t,r))}static inline(e,t,r,n){return new Zn(e,t,new Yn(r,n))}static node(e,t,r,n){return new Zn(e,t,new Jn(r,n))}get spec(){return this.type.spec}get inline(){return this.type instanceof Yn}get widget(){return this.type instanceof Kn}}const Xn=[],Qn={};class ei{constructor(e,t){this.local=e.length?e:Xn,this.children=t.length?t:Xn}static create(e,t){return t.length?oi(t,e,0,Qn):ti}find(e,t,r){let n=[];return this.findInner(null==e?0:e,null==t?1e9:t,n,0,r),n}findInner(e,t,r,n,i){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!i||i(o.spec))&&r.push(o.copy(o.from+n,o.to+n))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,r,n+o,i)}}map(e,t,r){return this==ti||0==e.maps.length?this:this.mapInner(e,t,0,0,r||Qn)}mapInner(e,t,r,n,i){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,r,n);a&&a.type.valid(t,a)?(s||(s=[])).push(a):i.onRemove&&i.onRemove(this.local[o].spec)}return this.children.length?function(e,t,r,n,i,s,o){let a=e.slice();for(let e=0,t=s;e<r.maps.length;e++){let n=0;r.maps[e].forEach(((e,r,s,o)=>{let l=o-s-(r-e);for(let o=0;o<a.length;o+=3){let u=a[o+1];if(u<0||e>u+t-n)continue;let c=a[o]+t-n;r>=c?a[o+1]=e<=c?-2:-1:s>=i&&l&&(a[o]+=l,a[o+1]+=l)}n+=l})),t=r.maps[e].map(t,-1)}let l=!1;for(let t=0;t<a.length;t+=3)if(a[t+1]<0){if(-2==a[t+1]){l=!0,a[t+1]=-1;continue}let u=r.map(e[t]+s),c=u-i;if(c<0||c>=n.content.size){l=!0;continue}let d=r.map(e[t+1]+s,-1)-i,{index:h,offset:f}=n.content.findIndex(c),p=n.maybeChild(h);if(p&&f==c&&f+p.nodeSize==d){let n=a[t+2].mapInner(r,p,u+1,e[t]+s+1,o);n!=ti?(a[t]=c,a[t+1]=d,a[t+2]=n):(a[t+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,r,n,i,s,o){function a(e,t){for(let s=0;s<e.local.length;s++){let a=e.local[s].map(n,i,t);a?r.push(a):o.onRemove&&o.onRemove(e.local[s].spec)}for(let r=0;r<e.children.length;r+=3)a(e.children[r+2],e.children[r]+t+1)}for(let r=0;r<e.length;r+=3)-1==e[r+1]&&a(e[r+2],t[r]+s+1);return r}(a,e,t,r,i,s,o),u=oi(l,n,0,o);t=u.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<u.children.length;e+=3){let r=u.children[e];for(;t<a.length&&a[t]<r;)t+=3;a.splice(t,0,u.children[e],u.children[e+1],u.children[e+2])}}return new ei(t.sort(ai),a)}(this.children,s||[],e,t,r,n,i):s?new ei(s.sort(ai),Xn):ti}add(e,t){return t.length?this==ti?ei.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let n,i=0;e.forEach(((e,s)=>{let o,a=s+r;if(o=ii(t,e,a)){for(n||(n=this.children.slice());i<n.length&&n[i]<s;)i+=3;n[i]==s?n[i+2]=n[i+2].addInner(e,o,a+1):n.splice(i,0,s,s+e.nodeSize,oi(o,e,a+1,Qn)),i+=3}}));let s=ni(i?si(t):t,-r);for(let t=0;t<s.length;t++)s[t].type.valid(e,s[t])||s.splice(t--,1);return new ei(s.length?this.local.concat(s).sort(ai):this.local,n||this.children)}remove(e){return 0==e.length||this==ti?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,n=this.local;for(let n=0;n<r.length;n+=3){let i,s=r[n]+t,o=r[n+1]+t;for(let t,r=0;r<e.length;r++)(t=e[r])&&t.from>s&&t.to<o&&(e[r]=null,(i||(i=[])).push(t));if(!i)continue;r==this.children&&(r=this.children.slice());let a=r[n+2].removeInner(i,s+1);a!=ti?r[n+2]=a:(r.splice(n,3),n-=3)}if(n.length)for(let r,i=0;i<e.length;i++)if(r=e[i])for(let e=0;e<n.length;e++)n[e].eq(r,t)&&(n==this.local&&(n=this.local.slice()),n.splice(e--,1));return r==this.children&&n==this.local?this:n.length||r.length?new ei(n,r):ti}forChild(e,t){if(this==ti)return this;if(t.isLeaf)return ei.empty;let r,n;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(r=this.children[t+2]);break}let i=e+1,s=i+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<s&&t.to>i&&t.type instanceof Yn){let e=Math.max(i,t.from)-i,r=Math.min(s,t.to)-i;e<r&&(n||(n=[])).push(t.copy(e,r))}}if(n){let e=new ei(n.sort(ai),Xn);return r?new ri([e,r]):e}return r||ti}eq(e){if(this==e)return!0;if(!(e instanceof ei)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return li(this.localsInner(e))}localsInner(e){if(this==ti)return Xn;if(e.inlineContent||!this.local.some(Yn.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof Yn||t.push(this.local[e]);return t}}ei.empty=new ei([],[]),ei.removeOverlap=li;const ti=ei.empty;class ri{constructor(e){this.members=e}map(e,t){const r=this.members.map((r=>r.map(e,t,Qn)));return ri.from(r)}forChild(e,t){if(t.isLeaf)return ei.empty;let r=[];for(let n=0;n<this.members.length;n++){let i=this.members[n].forChild(e,t);i!=ti&&(i instanceof ri?r=r.concat(i.members):r.push(i))}return ri.from(r)}eq(e){if(!(e instanceof ri)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let n=0;n<this.members.length;n++){let i=this.members[n].localsInner(e);if(i.length)if(t){r&&(t=t.slice(),r=!1);for(let e=0;e<i.length;e++)t.push(i[e])}else t=i}return t?li(r?t:t.sort(ai)):Xn}static from(e){switch(e.length){case 0:return ti;case 1:return e[0];default:return new ri(e.every((e=>e instanceof ei))?e:e.reduce(((e,t)=>e.concat(t instanceof ei?t:t.members)),[]))}}}function ni(e,t){if(!t||!e.length)return e;let r=[];for(let n=0;n<e.length;n++){let i=e[n];r.push(new Zn(i.from+t,i.to+t,i.type))}return r}function ii(e,t,r){if(t.isLeaf)return null;let n=r+t.nodeSize,i=null;for(let t,s=0;s<e.length;s++)(t=e[s])&&t.from>r&&t.to<n&&((i||(i=[])).push(t),e[s]=null);return i}function si(e){let t=[];for(let r=0;r<e.length;r++)null!=e[r]&&t.push(e[r]);return t}function oi(e,t,r,n){let i=[],s=!1;t.forEach(((t,o)=>{let a=ii(e,t,o+r);if(a){s=!0;let e=oi(a,t,r+o+1,n);e!=ti&&i.push(o,o+t.nodeSize,e)}}));let o=ni(s?si(e):e,-r).sort(ai);for(let e=0;e<o.length;e++)o[e].type.valid(t,o[e])||(n.onRemove&&n.onRemove(o[e].spec),o.splice(e--,1));return o.length||i.length?new ei(o,i):ti}function ai(e,t){return e.from-t.from||e.to-t.to}function li(e){let t=e;for(let r=0;r<t.length-1;r++){let n=t[r];if(n.from!=n.to)for(let i=r+1;i<t.length;i++){let s=t[i];if(s.from!=n.from){s.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,s.from),ui(t,i,n.copy(s.from,n.to)));break}s.to!=n.to&&(t==e&&(t=e.slice()),t[i]=s.copy(s.from,n.to),ui(t,i+1,s.copy(n.to,s.to)))}}return t}function ui(e,t,r){for(;t<e.length&&ai(r,e[t])>0;)t++;e.splice(t,0,r)}function ci(e){let t=[];return e.someProp("decorations",(r=>{let n=r(e.state);n&&n!=ti&&t.push(n)})),e.cursorWrapper&&t.push(ei.create(e.state.doc,[e.cursorWrapper.deco])),ri.from(t)}const di={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},hi=Rt&&It<=11;class fi{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class pi{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new fi,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver((e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);Rt&&It<=11&&e.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),hi&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((()=>{this.flushingSoon=-1,this.flush()}),20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,di)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout((()=>this.flush()),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout((()=>this.suppressingSelectionUpdates=!1),50)}onSelectionChange(){if(Wr(this.view)){if(this.suppressingSelectionUpdates)return Ur(this.view);if(Rt&&It<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&wt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,r=new Set;for(let t=e.focusNode;t;t=vt(t))r.add(t);for(let n=e.anchorNode;n;n=vt(n))if(r.has(n)){t=n;break}let n=t&&this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Wr(e)&&!this.ignoreSelectionChange(r),i=-1,s=-1,o=!1,a=[];if(e.editable)for(let e=0;e<t.length;e++){let r=this.registerMutation(t[e],a);r&&(i=i<0?r.from:Math.min(r.from,i),s=s<0?r.to:Math.max(r.to,s),r.typeOver&&(o=!0))}if(Ft&&a.length>1){let e=a.filter((e=>"BR"==e.nodeName));if(2==e.length){let t=e[0],r=e[1];t.parentNode&&t.parentNode.parentNode==r.parentNode?r.remove():t.remove()}}let l=null;i<0&&n&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Dt(r)&&(l=Pr(e))&&l.eq(Ke.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ur(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||n)&&(i>-1&&(e.docView.markDirty(i,s),function(e){if(mi.has(e))return;if(mi.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=Ft,gi)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),gi=!0}}(e)),this.handleDOMChange(i,s,o,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ur(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(r==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!r||r.ignoreMutation(e))return null;if("childList"==e.type){for(let r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let n=e.previousSibling,i=e.nextSibling;if(Rt&&It<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:r,nextSibling:s}=e.addedNodes[t];(!r||Array.prototype.indexOf.call(e.addedNodes,r)<0)&&(n=r),(!s||Array.prototype.indexOf.call(e.addedNodes,s)<0)&&(i=s)}let s=n&&n.parentNode==e.target?yt(n)+1:0,o=r.localPosFromDOM(e.target,s,-1),a=i&&i.parentNode==e.target?yt(i):e.target.childNodes.length;return{from:o,to:r.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let mi=new WeakMap,gi=!1;function yi(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if($t&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||$t&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const vi=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function bi(e,t,r,n,s){let o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,r=Pr(e,t);if(r&&!e.state.selection.eq(r)){if(Bt&&Ht&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",(t=>t(e,Nt(13,"Enter")))))return;let n=e.state.tr.setSelection(r);"pointer"==t?n.setMeta("pointer",!0):"key"==t&&n.scrollIntoView(),o&&n.setMeta("composition",o),e.dispatch(n)}return}let a=e.state.doc.resolve(t),l=a.sharedDepth(r);t=a.before(l+1),r=e.state.doc.resolve(r).after(l+1);let u,c,d=e.state.selection,h=function(e,t,r){let n,{node:i,fromOffset:s,toOffset:o,from:a,to:l}=e.docView.parseRange(t,r),u=e.domSelectionRange(),c=u.anchorNode;if(c&&e.dom.contains(1==c.nodeType?c:c.parentNode)&&(n=[{node:c,offset:u.anchorOffset}],Dt(u)||n.push({node:u.focusNode,offset:u.focusOffset})),Bt&&8===e.input.lastKeyCode)for(let e=o;e>s;e--){let t=i.childNodes[e-1],r=t.pmViewDesc;if("BR"==t.nodeName&&!r){o=e;break}if(!r||r.size)break}let d=e.state.doc,h=e.someProp("domParser")||K.fromSchema(e.state.schema),f=d.resolve(a),p=null,m=h.parse(i,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:n,ruleFromNode:yi,context:f});if(n&&null!=n[0].pos){let e=n[0].pos,t=n[1]&&n[1].pos;null==t&&(t=e),p={anchor:e+a,head:t+a}}return{doc:m,sel:p,from:a,to:l}}(e,t,r),f=e.state.doc,p=f.slice(h.from,h.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(u=e.state.selection.to,c="end"):(u=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let m=function(e,t,r,n,i){let s=e.findDiffStart(t,r);if(null==s)return null;let{a:o,b:a}=e.findDiffEnd(t,r+e.size,r+t.size);if("end"==i){n-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.size<t.size){let e=n<=s&&n>=o?s-n:0;s-=e,s&&s<t.size&&Ei(t.textBetween(s-1,s+1))&&(s+=e?1:-1),a=s+(a-o),o=s}else if(a<s){let t=n<=s&&n>=a?s-n:0;s-=t,s&&s<e.size&&Ei(e.textBetween(s-1,s+1))&&(s+=t?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(p.content,h.doc.content,h.from,u,c);if((jt&&e.input.lastIOSEnter>Date.now()-225||Ht)&&s.some((e=>1==e.nodeType&&!vi.test(e.nodeName)))&&(!m||m.endA>=m.endB)&&e.someProp("handleKeyDown",(t=>t(e,Nt(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(!m){if(!(n&&d instanceof Xe&&!d.empty&&d.$head.sameParent(d.$anchor))||e.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let t=xi(e,e.state.doc,h.sel);if(t&&!t.eq(e.state.selection)){let r=e.state.tr.setSelection(t);o&&r.setMeta("composition",o),e.dispatch(r)}}return}m={start:d.from,endA:d.to,endB:d.to}}if(Bt&&e.cursorWrapper&&h.sel&&h.sel.anchor==e.cursorWrapper.deco.from&&h.sel.head==h.sel.anchor){let e=m.endB-m.start;h.sel={anchor:h.sel.anchor+e,head:h.sel.anchor+e}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&m.start==m.endB&&e.state.selection instanceof Xe&&(m.start>e.state.selection.from&&m.start<=e.state.selection.from+2&&e.state.selection.from>=h.from?m.start=e.state.selection.from:m.endA<e.state.selection.to&&m.endA>=e.state.selection.to-2&&e.state.selection.to<=h.to&&(m.endB+=e.state.selection.to-m.endA,m.endA=e.state.selection.to)),Rt&&It<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>h.from&&"  "==h.doc.textBetween(m.start-h.from-1,m.start-h.from+1)&&(m.start--,m.endA--,m.endB--);let g,y=h.doc.resolveNoCache(m.start-h.from),v=h.doc.resolveNoCache(m.endB-h.from),b=f.resolve(m.start),x=y.sameParent(v)&&y.parent.inlineContent&&b.end()>=m.endA;if((jt&&e.input.lastIOSEnter>Date.now()-225&&(!x||s.some((e=>"DIV"==e.nodeName||"P"==e.nodeName)))||!x&&y.pos<h.doc.content.size&&!y.sameParent(v)&&(g=Ke.findFrom(h.doc.resolve(y.pos+1),1,!0))&&g.head==v.pos)&&e.someProp("handleKeyDown",(t=>t(e,Nt(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>m.start&&function(e,t,r,n,i){if(!n.parent.isTextblock||r-t<=i.pos-n.pos||wi(n,!0,!1)<i.pos)return!1;let s=e.resolve(t);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=e.resolve(wi(s,!0,!0));return!(!o.parent.isTextblock||o.pos>r||wi(o,!0,!1)<r)&&n.parent.content.cut(n.parentOffset).eq(o.parent.content)}(f,m.start,m.endA,y,v)&&e.someProp("handleKeyDown",(t=>t(e,Nt(8,"Backspace")))))return void(Ht&&Bt&&e.domObserver.suppressSelectionUpdates());Bt&&Ht&&m.endB==m.start&&(e.input.lastAndroidDelete=Date.now()),Ht&&!x&&y.start()!=v.start()&&0==v.parentOffset&&y.depth==v.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==m.endA&&(m.endB-=2,v=h.doc.resolveNoCache(m.endB-h.from),setTimeout((()=>{e.someProp("handleKeyDown",(function(t){return t(e,Nt(13,"Enter"))}))}),20));let w,E,S,T=m.start,A=m.endA;if(x)if(y.pos==v.pos)Rt&&It<=11&&0==y.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((()=>Ur(e)),20)),w=e.state.tr.delete(T,A),E=f.resolve(m.start).marksAcross(f.resolve(m.endA));else if(m.endA==m.endB&&(S=function(e,t){let r,n,s,o=e.firstChild.marks,a=t.firstChild.marks,l=o,u=a;for(let e=0;e<a.length;e++)l=a[e].removeFromSet(l);for(let e=0;e<o.length;e++)u=o[e].removeFromSet(u);if(1==l.length&&0==u.length)n=l[0],r="add",s=e=>e.mark(n.addToSet(e.marks));else{if(0!=l.length||1!=u.length)return null;n=u[0],r="remove",s=e=>e.mark(n.removeFromSet(e.marks))}let c=[];for(let e=0;e<t.childCount;e++)c.push(s(t.child(e)));if(i.from(c).eq(e))return{mark:n,type:r}}(y.parent.content.cut(y.parentOffset,v.parentOffset),b.parent.content.cut(b.parentOffset,m.endA-b.start()))))w=e.state.tr,"add"==S.type?w.addMark(T,A,S.mark):w.removeMark(T,A,S.mark);else if(y.parent.child(y.index()).isText&&y.index()==v.index()-(v.textOffset?0:1)){let t=y.parent.textBetween(y.parentOffset,v.parentOffset);if(e.someProp("handleTextInput",(r=>r(e,T,A,t))))return;w=e.state.tr.insertText(t,T,A)}if(w||(w=e.state.tr.replace(T,A,h.doc.slice(m.start-h.from,m.endB-h.from))),h.sel){let t=xi(e,w.doc,h.sel);t&&!(Bt&&Ht&&e.composing&&t.empty&&(m.start!=m.endB||e.input.lastAndroidDelete<Date.now()-100)&&(t.head==T||t.head==w.mapping.map(A)-1)||Rt&&t.empty&&t.head==T)&&w.setSelection(t)}E&&w.ensureMarks(E),o&&w.setMeta("composition",o),e.dispatch(w.scrollIntoView())}function xi(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:Gr(e,t.resolve(r.anchor),t.resolve(r.head))}function wi(e,t,r){let n=e.depth,i=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,i++,t=!1;if(r){let t=e.node(n).maybeChild(e.indexAfter(n));for(;t&&!t.isLeaf;)t=t.firstChild,i++}return i}function Ei(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),r=e.charCodeAt(1);return t>=56320&&t<=57343&&r>=55296&&r<=56319}class Si{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Sn,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Ci),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Di(this),Ai(this),this.nodeViews=Ni(this),this.docView=wr(this.state.doc,Ti(this),ci(this),this.dom,this),this.domObserver=new pi(this,((e,t,r,n)=>bi(this,e,t,r,n))),this.domObserver.start(),function(e){for(let t in xn){let r=xn[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!Nn(e,t)||Dn(e,t)||!e.editable&&t.type in wn||r(e,t)},En[t]?{passive:!0}:void 0)}$t&&e.dom.addEventListener("input",(()=>null)),An(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&An(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Ci),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let n=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&($n(this),s=!0),this.state=e;let o=n.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=Ni(this);(function(e,t){let r=0,n=0;for(let n in e){if(e[n]!=t[n])return!0;r++}for(let e in t)n++;return r!=n})(e,this.nodeViews)&&(this.nodeViews=e,i=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&An(this),this.editable=Di(this),Ai(this);let a=ci(this),l=Ti(this),u=n.plugins==e.plugins||n.doc.eq(e.doc)?e.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",c=i||!this.docView.matchesNode(e.doc,l,a);!c&&e.selection.eq(n.selection)||(s=!0);let d="preserve"==u&&s&&null==this.dom.style.overflowAnchor&&function(e){let t,r,n=e.dom.getBoundingClientRect(),i=Math.max(0,n.top);for(let s=(n.left+n.right)/2,o=i+1;o<Math.min(innerHeight,n.bottom);o+=5){let n=e.root.elementFromPoint(s,o);if(!n||n==e.dom||!e.dom.contains(n))continue;let a=n.getBoundingClientRect();if(a.top>=i-20){t=n,r=a.top;break}}return{refDOM:t,refTop:r,stack:Zt(e.dom)}}(this);if(s){this.domObserver.stop();let t=c&&(Rt||Bt)&&!this.composing&&!n.selection.empty&&!e.selection.empty&&function(e,t){let r=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(r)!=t.$anchor.start(r)}(n.selection,e.selection);if(c){let r=Bt?this.trackWrites=this.domSelectionRange().focusNode:null;!i&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=wr(e.doc,l,a,this.dom,this)),r&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),r=e.domSelectionRange();return wt(t.node,t.offset,r.anchorNode,r.anchorOffset)}(this))?Ur(this,t):(Hr(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),(null===(r=this.dragging)||void 0===r?void 0:r.node)&&!n.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,n),"reset"==u?this.dom.scrollTop=0:"to selection"==u?this.scrollToSelection():d&&function({refDOM:e,refTop:t,stack:r}){let n=e?e.getBoundingClientRect().top:0;Xt(r,0==n?0:n-t)}(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",(e=>e(this))));else if(this.state.selection instanceof et){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Jt(this,t.getBoundingClientRect(),e)}else Jt(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let r=e.node,n=-1;if(this.state.doc.nodeAt(r.from)==r.node)n=r.from;else{let e=r.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==r.node&&(n=e)}this.dragging=new Vn(e.slice,e.move,n<0?void 0:et.create(this.state.doc,n))}someProp(e,t){let r,n=this._props&&this._props[e];if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n].props[e];if(null!=i&&(r=t?t(i):i))return r}let i=this.state.plugins;if(i)for(let n=0;n<i.length;n++){let s=i[n].props[e];if(null!=s&&(r=t?t(s):s))return r}}hasFocus(){if(Rt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Qt)return e.focus(Qt);let t=Zt(e);e.focus(null==Qt?{get preventScroll(){return Qt={preventScroll:!0},!0}}:void 0),Qt||(Qt=!1,Xt(t,0))}(this.dom),Ur(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return e||document}updateRoot(){this._root=null}posAtCoords(e){return nr(this,e)}coordsAtPos(e,t=1){return ar(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let n=this.docView.posFromDOM(e,t,r);if(null==n)throw new RangeError("DOM position not inside the editor");return n}endOfTextblock(e,t){return mr(this,t||this.state,e)}pasteHTML(e,t){return qn(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return qn(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ci(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){Dn(e,t)||!xn[t.type]||!e.editable&&t.type in wn||xn[t.type](e,t)}(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return $t&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function(e){let t;function r(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0);let n=t.startContainer,i=t.startOffset,s=t.endContainer,o=t.endOffset,a=e.domAtPos(e.state.selection.anchor);return wt(a.node,a.offset,s,o)&&([n,i,s,o]=[s,o,n,i]),{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Ti(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",(r=>{if("function"==typeof r&&(r=r(e.state)),r)for(let e in r)"class"==e?t.class+=" "+r[e]:"style"==e?t.style=(t.style?t.style+";":"")+r[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(r[e]))})),t.translate||(t.translate="no"),[Zn.node(0,e.state.doc.content.size,t)]}function Ai(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Zn.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Di(e){return!e.someProp("editable",(t=>!1===t(e.state)))}function Ni(e){let t=Object.create(null);function r(e){for(let r in e)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=e[r])}return e.someProp("nodeViews",r),e.someProp("markViews",r),t}function Ci(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var ki={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Mi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Oi="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),_i="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Li=0;Li<10;Li++)ki[48+Li]=ki[96+Li]=String(Li);for(Li=1;Li<=24;Li++)ki[Li+111]="F"+Li;for(Li=65;Li<=90;Li++)ki[Li]=String.fromCharCode(Li+32),Mi[Li]=String.fromCharCode(Li);for(var Ri in ki)Mi.hasOwnProperty(Ri)||(Mi[Ri]=ki[Ri]);const Ii="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Fi(e){let t,r,n,i,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let e=0;e<s.length-1;e++){let o=s[e];if(/^(cmd|meta|m)$/i.test(o))i=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))r=!0;else if(/^s(hift)?$/i.test(o))n=!0;else{if(!/^mod$/i.test(o))throw new Error("Unrecognized modifier name: "+o);Ii?i=!0:r=!0}}return t&&(o="Alt-"+o),r&&(o="Ctrl-"+o),i&&(o="Meta-"+o),n&&(o="Shift-"+o),o}function Pi(e,t,r=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),r&&t.shiftKey&&(e="Shift-"+e),e}function Bi(e){let t=function(e){let t=Object.create(null);for(let r in e)t[Fi(r)]=e[r];return t}(e);return function(e,r){let n,i=function(e){var t=!(Oi&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||_i&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Mi:ki)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(r),s=t[Pi(i,r)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==i.length&&" "!=i){if(r.shiftKey){let n=t[Pi(i,r,!1)];if(n&&n(e.state,e.dispatch,e))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(n=ki[r.keyCode])&&n!=i){let i=t[Pi(n,r)];if(i&&i(e.state,e.dispatch,e))return!0}}return!1}}const Ui=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function $i(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("backward",e):r.parentOffset>0)?null:r}const ji=(e,t,r)=>{let n=$i(e,r);if(!n)return!1;let i=Hi(n);if(!i){let r=n.blockRange(),i=r&&Ae(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&rs(e,i,t))return!0;if(0==n.parent.content.size&&(zi(s,"end")||et.isSelectable(s))){let r=Le(e.doc,n.before(),n.after(),c.empty);if(r&&r.slice.size<r.to-r.from){if(t){let n=e.tr.step(r);n.setSelection(zi(s,"end")?Ke.findFrom(n.doc.resolve(n.mapping.map(i.pos,-1)),-1):et.create(n.doc,i.pos-s.nodeSize)),t(n.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=n.depth-1)&&(t&&t(e.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0)};function zi(e,t,r=!1){for(let n=e;n;n="start"==t?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&1!=n.childCount)return!1}return!1}const qi=(e,t,r)=>{let{$head:n,empty:i}=e.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):n.parentOffset>0)return!1;s=Hi(n)}let o=s&&s.nodeBefore;return!(!o||!et.isSelectable(o))&&(t&&t(e.tr.setSelection(et.create(e.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Hi(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Vi(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)?null:r}const Gi=(e,t,r)=>{let n=Vi(e,r);if(!n)return!1;let i=Ki(n);if(!i)return!1;let s=i.nodeAfter;if(rs(e,i,t))return!0;if(0==n.parent.content.size&&(zi(s,"start")||et.isSelectable(s))){let r=Le(e.doc,n.before(),n.after(),c.empty);if(r&&r.slice.size<r.to-r.from){if(t){let n=e.tr.step(r);n.setSelection(zi(s,"start")?Ke.findFrom(n.doc.resolve(n.mapping.map(i.pos)),1):et.create(n.doc,n.mapping.map(i.pos))),t(n.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=n.depth-1)&&(t&&t(e.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0)},Wi=(e,t,r)=>{let{$head:n,empty:i}=e.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;s=Ki(n)}let o=s&&s.nodeAfter;return!(!o||!et.isSelectable(o))&&(t&&t(e.tr.setSelection(et.create(e.doc,s.pos)).scrollIntoView()),!0)};function Ki(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}const Yi=(e,t)=>{let{$head:r,$anchor:n}=e.selection;return!(!r.parent.type.spec.code||!r.sameParent(n))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function Ji(e){for(let t=0;t<e.edgeCount;t++){let{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const Zi=(e,t)=>{let{$head:r,$anchor:n}=e.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),s=r.indexAfter(-1),o=Ji(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let n=r.after(),i=e.tr.replaceWith(n,n,o.createAndFill());i.setSelection(Ke.near(i.doc.resolve(n),1)),t(i.scrollIntoView())}return!0},Xi=(e,t)=>{let r=e.selection,{$from:n,$to:i}=r;if(r instanceof rt||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=Ji(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let r=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=e.tr.insert(r,s.createAndFill());o.setSelection(Xe.create(o.doc,r+1)),t(o.scrollIntoView())}return!0},Qi=(e,t)=>{let{$cursor:r}=e.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let n=r.before();if(Ce(e.doc,n))return t&&t(e.tr.split(n).scrollIntoView()),!0}let n=r.blockRange(),i=n&&Ae(n);return null!=i&&(t&&t(e.tr.lift(n,i).scrollIntoView()),!0)};const es=(e,t)=>{let{$from:r,$to:n}=e.selection;if(e.selection instanceof et&&e.selection.node.isBlock)return!(!r.parentOffset||!Ce(e.doc,r.pos)||(t&&t(e.tr.split(r.pos).scrollIntoView()),0));if(!r.parent.isBlock)return!1;if(t){let i=n.parentOffset==n.parent.content.size,s=e.tr;(e.selection instanceof Xe||e.selection instanceof rt)&&s.deleteSelection();let o=0==r.depth?null:Ji(r.node(-1).contentMatchAt(r.indexAfter(-1))),a=ts&&ts(n.parent,i),l=a?[a]:i&&o?[{type:o}]:void 0,u=Ce(s.doc,s.mapping.map(r.pos),1,l);if(l||u||!Ce(s.doc,s.mapping.map(r.pos),1,o?[{type:o}]:void 0)||(o&&(l=[{type:o}]),u=!0),u&&(s.split(s.mapping.map(r.pos),1,l),!i&&!r.parentOffset&&r.parent.type!=o)){let e=s.mapping.map(r.before()),t=s.doc.resolve(e);o&&r.node(-1).canReplaceWith(t.index(),t.index()+1,o)&&s.setNodeMarkup(s.mapping.map(r.before()),o)}t(s.scrollIntoView())}return!0};var ts;function rs(e,t,r){let n,s,o=t.nodeBefore,a=t.nodeAfter;if(o.type.spec.isolating||a.type.spec.isolating)return!1;if(function(e,t,r){let n=t.nodeBefore,i=t.nodeAfter,s=t.index();return!(!(n&&i&&n.type.compatibleContent(i.type))||(!n.content.size&&t.parent.canReplace(s-1,s)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(s,s+1)||!i.isTextblock&&!ke(e.doc,t.pos)||(r&&r(e.tr.clearIncompatible(t.pos,n.type,n.contentMatchAt(n.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,r))return!0;let l=t.parent.canReplace(t.index(),t.index()+1);if(l&&(n=(s=o.contentMatchAt(o.childCount)).findWrapping(a.type))&&s.matchType(n[0]||a.type).validEnd){if(r){let s=t.pos+a.nodeSize,l=i.empty;for(let e=n.length-1;e>=0;e--)l=i.from(n[e].create(null,l));l=i.from(o.copy(l));let u=e.tr.step(new Ee(t.pos-1,s,t.pos,s,new c(l,1,0),n.length,!0)),d=s+2*n.length;ke(u.doc,d)&&u.join(d),r(u.scrollIntoView())}return!0}let u=Ke.findFrom(t,1),d=u&&u.$from.blockRange(u.$to),h=d&&Ae(d);if(null!=h&&h>=t.depth)return r&&r(e.tr.lift(d,h).scrollIntoView()),!0;if(l&&zi(a,"start",!0)&&zi(o,"end")){let n=o,s=[];for(;s.push(n),!n.isTextblock;)n=n.lastChild;let l=a,u=1;for(;!l.isTextblock;l=l.firstChild)u++;if(n.canReplace(n.childCount,n.childCount,l.content)){if(r){let n=i.empty;for(let e=s.length-1;e>=0;e--)n=i.from(s[e].copy(n));r(e.tr.step(new Ee(t.pos-s.length,t.pos+a.nodeSize,t.pos+u,t.pos+a.nodeSize-u,new c(n,s.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ns(e){return function(t,r){let n=t.selection,i=e<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return!!i.node(s).isTextblock&&(r&&r(t.tr.setSelection(Xe.create(t.doc,e<0?i.start(s):i.end(s)))),!0)}}const is=ns(-1),ss=ns(1);function as(e,t=null){return function(r,n){let i=!1;for(let n=0;n<r.selection.ranges.length&&!i;n++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[n];r.doc.nodesBetween(s,o,((n,s)=>{if(i)return!1;if(n.isTextblock&&!n.hasMarkup(e,t))if(n.type==e)i=!0;else{let t=r.doc.resolve(s),n=t.index();i=t.parent.canReplaceWith(n,n+1,e)}}))}if(!i)return!1;if(n){let i=r.tr;for(let n=0;n<r.selection.ranges.length;n++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[n];i.setBlockType(s,o,e,t)}n(i.scrollIntoView())}return!0}}function ls(...e){return function(t,r,n){for(let i=0;i<e.length;i++)if(e[i](t,r,n))return!0;return!1}}let us=ls(Ui,ji,qi),cs=ls(Ui,Gi,Wi);const ds={Enter:ls(Yi,Xi,Qi,es),"Mod-Enter":Zi,Backspace:us,"Mod-Backspace":us,"Shift-Backspace":us,Delete:cs,"Mod-Delete":cs,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new rt(e.doc))),!0)},hs={"Ctrl-h":ds.Backspace,"Alt-Backspace":ds["Mod-Backspace"],"Ctrl-d":ds.Delete,"Ctrl-Alt-Backspace":ds["Mod-Delete"],"Alt-Delete":ds["Mod-Delete"],"Alt-d":ds["Mod-Delete"],"Ctrl-a":is,"Ctrl-e":ss};for(let e in ds)hs[e]=ds[e];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function fs(e,t=null){return function(r,n){let{$from:s,$to:o}=r.selection,a=s.blockRange(o),l=!1,u=a;if(!a)return!1;if(a.depth>=2&&s.node(a.depth-1).type.compatibleContent(e)&&0==a.startIndex){if(0==s.index(a.depth-1))return!1;let e=r.doc.resolve(a.start-2);u=new D(e,e,a.depth),a.endIndex<a.parent.childCount&&(a=new D(s,r.doc.resolve(o.end(a.depth)),a.depth)),l=!0}let d=De(u,e,t,a);return!!d&&(n&&n(function(e,t,r,n,s){let o=i.empty;for(let e=r.length-1;e>=0;e--)o=i.from(r[e].type.create(r[e].attrs,o));e.step(new Ee(t.start-(n?2:0),t.end,t.start,t.end,new c(o,0,0),r.length,!0));let a=0;for(let e=0;e<r.length;e++)r[e].type==s&&(a=e+1);let l=r.length-a,u=t.start+r.length-(n?2:0),d=t.parent;for(let r=t.startIndex,n=t.endIndex,i=!0;r<n;r++,i=!1)!i&&Ce(e.doc,u,l)&&(e.split(u,l),u+=2*l),u+=d.child(r).nodeSize;return e}(r.tr,a,d,l,e).scrollIntoView()),!0)}}function ps(e){return function(t,r){let{$from:n,$to:s}=t.selection,o=n.blockRange(s,(t=>t.childCount>0&&t.firstChild.type==e));return!!o&&(!r||(n.node(o.depth-1).type==e?function(e,t,r,n){let s=e.tr,o=n.end,a=n.$to.end(n.depth);o<a&&(s.step(new Ee(o-1,a,o,a,new c(i.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new D(s.doc.resolve(n.$from.pos),s.doc.resolve(a),n.depth));const l=Ae(n);if(null==l)return!1;s.lift(n,l);let u=s.mapping.map(o,-1)-1;ke(s.doc,u)&&s.join(u);return t(s.scrollIntoView()),!0}(t,r,e,o):function(e,t,r){let n=e.tr,s=r.parent;for(let e=r.end,t=r.endIndex-1,i=r.startIndex;t>i;t--)e-=s.child(t).nodeSize,n.delete(e-1,e+1);let o=n.doc.resolve(r.start),a=o.nodeAfter;if(n.mapping.map(r.end)!=r.start+o.nodeAfter.nodeSize)return!1;let l=0==r.startIndex,u=r.endIndex==s.childCount,d=o.node(-1),h=o.index(-1);if(!d.canReplace(h+(l?0:1),h+1,a.content.append(u?i.empty:i.from(s))))return!1;let f=o.pos,p=f+a.nodeSize;return n.step(new Ee(f-(l?1:0),p+(u?1:0),f+1,p-1,new c((l?i.empty:i.from(s.copy(i.empty))).append(u?i.empty:i.from(s.copy(i.empty))),l?0:1,u?0:1),l?0:1)),t(n.scrollIntoView()),!0}(t,r,o)))}}function ms(e){const{state:t,transaction:r}=e;let{selection:n}=r,{doc:i}=r,{storedMarks:s}=r;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,s=r.storedMarks,r}}}class gs{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:n}=t,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,(...e)=>{const r=t(...e)(s);return i.getMeta("preventDispatch")||this.hasCustomState||n.dispatch(i),r}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:n,state:i}=this,{view:s}=n,o=[],a=!!e,l=e||i.tr,u={...Object.fromEntries(Object.entries(r).map((([e,r])=>[e,(...e)=>{const n=this.buildProps(l,t),i=r(...e)(n);return o.push(i),u}]))),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(l),o.every((e=>!0===e)))};return u}createCan(e){const{rawCommands:t,state:r}=this,n=e||r.tr,i=this.buildProps(n,false),s=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])));return{...s,chain:()=>this.createChain(n,false)}}buildProps(e,t=!0){const{rawCommands:r,editor:n,state:i}=this,{view:s}=n,o={tr:e,editor:n,view:s,state:ms({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map((([e,t])=>[e,(...e)=>t(...e)(o)])))}};return o}}class ys{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach((e=>e.apply(this,t))),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter((e=>e!==t)):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function vs(e,t,r){if(void 0===e.config[t]&&e.parent)return vs(e.parent,t,r);if("function"==typeof e.config[t]){return e.config[t].bind({...r,parent:e.parent?vs(e.parent,t,r):null})}return e.config[t]}function bs(e){return{baseExtensions:e.filter((e=>"extension"===e.type)),nodeExtensions:e.filter((e=>"node"===e.type)),markExtensions:e.filter((e=>"mark"===e.type))}}function xs(e){const t=[],{nodeExtensions:r,markExtensions:n}=bs(e),i=[...r,...n],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach((e=>{const r=vs(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage});if(!r)return;r().forEach((e=>{e.types.forEach((r=>{Object.entries(e.attributes).forEach((([e,n])=>{t.push({type:r,name:e,attribute:{...s,...n}})}))}))}))})),i.forEach((e=>{const r={name:e.name,options:e.options,storage:e.storage},n=vs(e,"addAttributes",r);if(!n)return;const i=n();Object.entries(i).forEach((([r,n])=>{const i={...s,...n};"function"==typeof(null==i?void 0:i.default)&&(i.default=i.default()),(null==i?void 0:i.isRequired)&&void 0===(null==i?void 0:i.default)&&delete i.default,t.push({type:e.name,name:r,attribute:i})}))})),t}function ws(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function Es(...e){return e.filter((e=>!!e)).reduce(((e,t)=>{const r={...e};return Object.entries(t).forEach((([e,t])=>{if(r[e])if("class"===e){const n=t?t.split(" "):[],i=r[e]?r[e].split(" "):[],s=n.filter((e=>!i.includes(e)));r[e]=[...i,...s].join(" ")}else r[e]="style"===e?[r[e],t].join("; "):t;else r[e]=t})),r}),{})}function Ss(e,t){return t.filter((e=>e.attribute.rendered)).map((t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]})).reduce(((e,t)=>Es(e,t)),{})}function Ts(e){return"function"==typeof e}function As(e,t=void 0,...r){return Ts(e)?t?e.bind(t)(...r):e(...r):e}function Ds(e,t){return e.style?e:{...e,getAttrs:r=>{const n=e.getAttrs?e.getAttrs(r):e.attrs;if(!1===n)return!1;const i=t.reduce(((e,t)=>{const n=t.attribute.parseHTML?t.attribute.parseHTML(r):function(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(r.getAttribute(t.name));return null==n?e:{...e,[t.name]:n}}),{});return{...n,...i}}}}function Ns(e){return Object.fromEntries(Object.entries(e).filter((([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t)))}function Cs(e,t){var r;const n=xs(e),{nodeExtensions:i,markExtensions:s}=bs(e),o=null===(r=i.find((e=>vs(e,"topNode"))))||void 0===r?void 0:r.name,a=Object.fromEntries(i.map((r=>{const i=n.filter((e=>e.type===r.name)),s={name:r.name,options:r.options,storage:r.storage,editor:t},o=Ns({...e.reduce(((e,t)=>{const n=vs(t,"extendNodeSchema",s);return{...e,...n?n(r):{}}}),{}),content:As(vs(r,"content",s)),marks:As(vs(r,"marks",s)),group:As(vs(r,"group",s)),inline:As(vs(r,"inline",s)),atom:As(vs(r,"atom",s)),selectable:As(vs(r,"selectable",s)),draggable:As(vs(r,"draggable",s)),code:As(vs(r,"code",s)),defining:As(vs(r,"defining",s)),isolating:As(vs(r,"isolating",s)),attrs:Object.fromEntries(i.map((e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),a=As(vs(r,"parseHTML",s));a&&(o.parseDOM=a.map((e=>Ds(e,i))));const l=vs(r,"renderHTML",s);l&&(o.toDOM=e=>l({node:e,HTMLAttributes:Ss(e,i)}));const u=vs(r,"renderText",s);return u&&(o.toText=u),[r.name,o]}))),l=Object.fromEntries(s.map((r=>{const i=n.filter((e=>e.type===r.name)),s={name:r.name,options:r.options,storage:r.storage,editor:t},o=Ns({...e.reduce(((e,t)=>{const n=vs(t,"extendMarkSchema",s);return{...e,...n?n(r):{}}}),{}),inclusive:As(vs(r,"inclusive",s)),excludes:As(vs(r,"excludes",s)),group:As(vs(r,"group",s)),spanning:As(vs(r,"spanning",s)),code:As(vs(r,"code",s)),attrs:Object.fromEntries(i.map((e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),a=As(vs(r,"parseHTML",s));a&&(o.parseDOM=a.map((e=>Ds(e,i))));const l=vs(r,"renderHTML",s);return l&&(o.toDOM=e=>l({mark:e,HTMLAttributes:Ss(e,i)})),[r.name,o]})));return new G({topNode:o,nodes:a,marks:l})}function ks(e,t){return t.nodes[e]||t.marks[e]||null}function Ms(e,t){return Array.isArray(t)?t.some((t=>("string"==typeof t?t:t.name)===e.name)):t}const Os=(e,t=500)=>{let r="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,((e,t,i,s)=>{var o,a;const l=(null===(a=(o=e.type.spec).toText)||void 0===a?void 0:a.call(o,{node:e,pos:t,parent:i,index:s}))||e.textContent||"%leaf%";r+=l.slice(0,Math.max(0,n-t))})),r};function _s(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class Ls{constructor(e){this.find=e.find,this.handler=e.handler}}const Rs=(e,t)=>{if(_s(t))return t.exec(e);const r=t(e);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=e,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function Is(e){var t;const{editor:r,from:n,to:i,text:s,rules:o,plugin:a}=e,{view:l}=r;if(l.composing)return!1;const u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(null===(t=u.nodeBefore||u.nodeAfter)||void 0===t?void 0:t.marks.find((e=>e.type.spec.code))))return!1;let c=!1;const d=Os(u)+s;return o.forEach((e=>{if(c)return;const t=Rs(d,e.find);if(!t)return;const o=l.state.tr,u=ms({state:l.state,transaction:o}),h={from:n-(t[0].length-s.length),to:i},{commands:f,chain:p,can:m}=new gs({editor:r,state:u});null!==e.handler({state:u,range:h,match:t,commands:f,chain:p,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:n,to:i,text:s}),l.dispatch(o),c=!0)})),c}function Fs(e){const{editor:t,rules:r}=e,n=new ft({state:{init:()=>null,apply(e,t){const r=e.getMeta(n);return r||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(e,i,s,o)=>Is({editor:t,from:i,to:s,text:o,rules:r,plugin:n}),handleDOMEvents:{compositionend:e=>(setTimeout((()=>{const{$cursor:i}=e.state.selection;i&&Is({editor:t,from:i.pos,to:i.pos,text:"",rules:r,plugin:n})})),!1)},handleKeyDown(e,i){if("Enter"!==i.key)return!1;const{$cursor:s}=e.state.selection;return!!s&&Is({editor:t,from:s.pos,to:s.pos,text:"\n",rules:r,plugin:n})}},isInputRules:!0});return n}class Ps{constructor(e){this.find=e.find,this.handler=e.handler}}const Bs=(e,t)=>{if(_s(t))return[...e.matchAll(t)];const r=t(e);return r?r.map((t=>{const r=[t.text];return r.index=t.index,r.input=e,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),r.push(t.replaceWith)),r})):[]};function Us(e){const{editor:t,rules:r}=e;let n=null,i=!1,s=!1,o=new ClipboardEvent("paste"),a=new DragEvent("drop");const l=r.map((e=>new ft({view(e){const t=t=>{var r;n=(null===(r=e.dom.parentElement)||void 0===r?void 0:r.contains(t.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",t),{destroy(){window.removeEventListener("dragstart",t)}}},props:{handleDOMEvents:{drop:(e,t)=>(s=n===e.dom.parentElement,a=t,!1),paste:(e,t)=>{var r;const n=null===(r=t.clipboardData)||void 0===r?void 0:r.getData("text/html");return o=t,i=!!(null==n?void 0:n.includes("data-pm-slice")),!1}}},appendTransaction:(r,n,l)=>{const u=r[0],c="paste"===u.getMeta("uiEvent")&&!i,d="drop"===u.getMeta("uiEvent")&&!s;if(!c&&!d)return;const h=n.doc.content.findDiffStart(l.doc.content),f=n.doc.content.findDiffEnd(l.doc.content);if("number"!=typeof h||!f||h===f.b)return;const p=l.tr,m=ms({state:l,transaction:p}),g=function(e){const{editor:t,state:r,from:n,to:i,rule:s,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:u,can:c}=new gs({editor:t,state:r}),d=[];return r.doc.nodesBetween(n,i,((e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const h=Math.max(n,t),f=Math.min(i,t+e.content.size),p=e.textBetween(h-t,f-t,void 0,"￼");Bs(p,s.find).forEach((e=>{if(void 0===e.index)return;const t=h+e.index+1,n=t+e[0].length,i={from:r.tr.mapping.map(t),to:r.tr.mapping.map(n)},f=s.handler({state:r,range:i,match:e,commands:l,chain:u,can:c,pasteEvent:o,dropEvent:a});d.push(f)}))})),d.every((e=>null!==e))}({editor:t,state:m,from:Math.max(h-1,0),to:f.b-1,rule:e,pasteEvent:o,dropEvent:a});return g&&p.steps.length?(a=new DragEvent("drop"),o=new ClipboardEvent("paste"),p):void 0}})));return l}class $s{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=$s.resolve(e),this.schema=Cs(this.extensions,t),this.extensions.forEach((e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ks(e.name,this.schema)};if("mark"===e.type){(null===(t=As(vs(e,"keepOnSplit",r)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const n=vs(e,"onBeforeCreate",r);n&&this.editor.on("beforeCreate",n);const i=vs(e,"onCreate",r);i&&this.editor.on("create",i);const s=vs(e,"onUpdate",r);s&&this.editor.on("update",s);const o=vs(e,"onSelectionUpdate",r);o&&this.editor.on("selectionUpdate",o);const a=vs(e,"onTransaction",r);a&&this.editor.on("transaction",a);const l=vs(e,"onFocus",r);l&&this.editor.on("focus",l);const u=vs(e,"onBlur",r);u&&this.editor.on("blur",u);const c=vs(e,"onDestroy",r);c&&this.editor.on("destroy",c)}))}static resolve(e){const t=$s.sort($s.flatten(e)),r=function(e){const t=e.filter(((t,r)=>e.indexOf(t)!==r));return[...new Set(t)]}(t.map((e=>e.name)));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map((e=>`'${e}'`)).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map((e=>{const t=vs(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e})).flat(10)}static sort(e){return e.sort(((e,t)=>{const r=vs(e,"priority")||100,n=vs(t,"priority")||100;return r>n?-1:r<n?1:0}))}get commands(){return this.extensions.reduce(((e,t)=>{const r=vs(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ks(t.name,this.schema)});return r?{...e,...r()}:e}),{})}get plugins(){const{editor:e}=this,t=$s.sort([...this.extensions].reverse()),r=[],n=[],i=t.map((t=>{const i={name:t.name,options:t.options,storage:t.storage,editor:e,type:ks(t.name,this.schema)},s=[],o=vs(t,"addKeyboardShortcuts",i);let a={};if("mark"===t.type&&t.config.exitable&&(a.ArrowRight=()=>Fo.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map((([t,r])=>[t,()=>r({editor:e})])));a={...a,...t}}const l=new ft({props:{handleKeyDown:Bi(a)}});s.push(l);const u=vs(t,"addInputRules",i);Ms(t,e.options.enableInputRules)&&u&&r.push(...u());const c=vs(t,"addPasteRules",i);Ms(t,e.options.enablePasteRules)&&c&&n.push(...c());const d=vs(t,"addProseMirrorPlugins",i);if(d){const e=d();s.push(...e)}return s})).flat();return[Fs({editor:e,rules:r}),...Us({editor:e,rules:n}),...i]}get attributes(){return xs(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=bs(this.extensions);return Object.fromEntries(t.filter((e=>!!vs(e,"addNodeView"))).map((t=>{const r=this.attributes.filter((e=>e.type===t.name)),n={name:t.name,options:t.options,storage:t.storage,editor:e,type:ws(t.name,this.schema)},i=vs(t,"addNodeView",n);if(!i)return[];return[t.name,(n,s,o,a)=>{const l=Ss(n,r);return i()({editor:e,node:n,getPos:o,decorations:a,HTMLAttributes:l,extension:t})}]})))}}function js(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function zs(e,t){const r={...e};return js(e)&&js(t)&&Object.keys(t).forEach((n=>{js(t[n])?n in e?r[n]=zs(e[n],t[n]):Object.assign(r,{[n]:t[n]}):Object.assign(r,{[n]:t[n]})})),r}class qs{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=As(vs(this,"addOptions",{name:this.name}))),this.storage=As(vs(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new qs(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new qs(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=As(vs(t,"addOptions",{name:t.name})),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}}function Hs(e,t,r){const{from:n,to:i}=t,{blockSeparator:s="\n\n",textSerializers:o={}}=r||{};let a="",l=!0;return e.nodesBetween(n,i,((e,r,u,c)=>{var d;const h=null==o?void 0:o[e.type.name];h?(e.isBlock&&!l&&(a+=s,l=!0),u&&(a+=h({node:e,pos:r,parent:u,index:c,range:t}))):e.isText?(a+=null===(d=null==e?void 0:e.text)||void 0===d?void 0:d.slice(Math.max(n,r)-r,i-r),l=!1):e.isBlock&&!l&&(a+=s,l=!0)})),a}function Vs(e){return Object.fromEntries(Object.entries(e.nodes).filter((([,e])=>e.spec.toText)).map((([e,t])=>[e,t.spec.toText])))}const Gs=qs.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ft({key:new gt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:r}=e,{doc:n,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map((e=>e.$from.pos))),a=Math.max(...s.map((e=>e.$to.pos)));return Hs(n,{from:o,to:a},{textSerializers:Vs(r)})}}})]}});function Ws(e,t,r={strict:!0}){const n=Object.keys(t);return!n.length||n.every((n=>r.strict?t[n]===e[n]:_s(t[n])?t[n].test(e[n]):t[n]===e[n]))}function Ks(e,t,r={}){return e.find((e=>e.type===t&&Ws(e.attrs,r)))}function Ys(e,t,r={}){return!!Ks(e,t,r)}function Js(e,t,r={}){if(!e||!t)return;let n=e.parent.childAfter(e.parentOffset);if(e.parentOffset===n.offset&&0!==n.offset&&(n=e.parent.childBefore(e.parentOffset)),!n.node)return;const i=Ks([...n.node.marks],t,r);if(!i)return;let s=n.index,o=e.start()+n.offset,a=s+1,l=o+n.node.nodeSize;for(Ks([...n.node.marks],t,r);s>0&&i.isInSet(e.parent.child(s-1).marks);)s-=1,o-=e.parent.child(s).nodeSize;for(;a<e.parent.childCount&&Ys([...e.parent.child(a).marks],t,r);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Zs(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function Xs(e){return e instanceof Xe}function Qs(e=0,t=0,r=0){return Math.min(Math.max(e,t),r)}function eo(e,t=null){if(!t)return null;const r=Ke.atStart(e),n=Ke.atEnd(e);if("start"===t||!0===t)return r;if("end"===t)return n;const i=r.from,s=n.to;return"all"===t?Xe.create(e,Qs(0,i,s),Qs(e.content.size,i,s)):Xe.create(e,Qs(t,i,s),Qs(t,i,s))}function to(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function ro(e){const t=`<body>${e}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function no(e,t,r){if(r={slice:!0,parseOptions:{},...r},"object"==typeof e&&null!==e)try{return Array.isArray(e)&&e.length>0?i.fromArray(e.map((e=>t.nodeFromJSON(e)))):t.nodeFromJSON(e)}catch(n){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",n),no("",t,r)}if("string"==typeof e){const n=K.fromSchema(t);return r.slice?n.parseSlice(ro(e),r.parseOptions).content:n.parse(ro(e),r.parseOptions)}return no("",t,r)}function io(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function so(e,t,r={}){const{from:n,to:i,empty:s}=e.selection,o=t?ws(t,e.schema):null,a=[];e.doc.nodesBetween(n,i,((e,t)=>{if(e.isText)return;const r=Math.max(n,t),s=Math.min(i,t+e.nodeSize);a.push({node:e,from:r,to:s})}));const l=i-n,u=a.filter((e=>!o||o.name===e.node.type.name)).filter((e=>Ws(e.node.attrs,r,{strict:!1})));if(s)return!!u.length;return u.reduce(((e,t)=>e+t.to-t.from),0)>=l}function oo(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function ao(e,t){const r="string"==typeof t?[t]:t;return Object.keys(e).reduce(((t,n)=>(r.includes(n)||(t[n]=e[n]),t)),{})}function lo(e,t,r={}){return no(e,t,{slice:!1,parseOptions:r})}function uo(e,t){const r=Zs(t,e.schema),{from:n,to:i,empty:s}=e.selection,o=[];s?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,i,(e=>{o.push(...e.marks)}));const a=o.find((e=>e.type.name===r.name));return a?{...a.attrs}:{}}function co(e){return t=>function(e,t){for(let r=e.depth;r>0;r-=1){const n=e.node(r);if(t(n))return{pos:r>0?e.before(r):0,start:e.start(r),depth:r,node:n}}}(t.$from,e)}function ho(e,t){const r=ie.fromSchema(t).serializeFragment(e),n=document.implementation.createHTMLDocument().createElement("div");return n.appendChild(r),n.innerHTML}function fo(e,t){return Hs(e,{from:0,to:e.content.size},t)}function po(e,t){const r=oo("string"==typeof t?t:t.name,e.schema);return"node"===r?function(e,t){const r=ws(t,e.schema),{from:n,to:i}=e.selection,s=[];e.doc.nodesBetween(n,i,(e=>{s.push(e)}));const o=s.reverse().find((e=>e.type.name===r.name));return o?{...o.attrs}:{}}(e,t):"mark"===r?uo(e,t):{}}function mo(e){const t=function(e,t=JSON.stringify){const r={};return e.filter((e=>{const n=t(e);return!Object.prototype.hasOwnProperty.call(r,n)&&(r[n]=!0)}))}(e);return 1===t.length?t:t.filter(((e,r)=>{const n=t.filter(((e,t)=>t!==r));return!n.some((t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to))}))}function go(e,t,r){const n=[];return e===t?r.resolve(e).marks().forEach((t=>{const i=Js(r.resolve(e-1),t.type);i&&n.push({mark:t,...i})})):r.nodesBetween(e,t,((e,t)=>{n.push(...e.marks.map((r=>({from:t,to:t+e.nodeSize,mark:r}))))})),n}function yo(e,t,r){return Object.fromEntries(Object.entries(r).filter((([r])=>{const n=e.find((e=>e.type===t&&e.name===r));return!!n&&n.attribute.keepOnSplit})))}function vo(e,t,r={}){const{empty:n,ranges:i}=e.selection,s=t?Zs(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter((e=>!s||s.name===e.type.name)).find((e=>Ws(e.attrs,r,{strict:!1})));let o=0;const a=[];if(i.forEach((({$from:t,$to:r})=>{const n=t.pos,i=r.pos;e.doc.nodesBetween(n,i,((e,t)=>{if(!e.isText&&!e.marks.length)return;const r=Math.max(n,t),s=Math.min(i,t+e.nodeSize);o+=s-r,a.push(...e.marks.map((e=>({mark:e,from:r,to:s}))))}))})),0===o)return!1;const l=a.filter((e=>!s||s.name===e.mark.type.name)).filter((e=>Ws(e.mark.attrs,r,{strict:!1}))).reduce(((e,t)=>e+t.to-t.from),0),u=a.filter((e=>!s||e.mark.type!==s&&e.mark.type.excludes(s))).reduce(((e,t)=>e+t.to-t.from),0);return(l>0?l+u:l)>=o}function bo(e,t){const{nodeExtensions:r}=bs(t),n=r.find((t=>t.name===e));if(!n)return!1;const i=As(vs(n,"group",{name:n.name,options:n.options,storage:n.storage}));return"string"==typeof i&&i.split(" ").includes("list")}function xo(e,t){const r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(r){const n=r.filter((e=>null==t?void 0:t.includes(e.type.name)));e.tr.ensureMarks(n)}}const wo=(e,t)=>{const r=co((e=>e.type===t))(e.selection);if(!r)return!0;const n=e.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(void 0===n)return!0;const i=e.doc.nodeAt(n);return r.node.type!==(null==i?void 0:i.type)||!ke(e.doc,r.pos)||(e.join(r.pos),!0)},Eo=(e,t)=>{const r=co((e=>e.type===t))(e.selection);if(!r)return!0;const n=e.doc.resolve(r.start).after(r.depth);if(void 0===n)return!0;const i=e.doc.nodeAt(n);return r.node.type!==(null==i?void 0:i.type)||!ke(e.doc,n)||(e.join(n),!0)};var So=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame((()=>{var r;e.isDestroyed||(t.dom.blur(),null===(r=null===window||void 0===window?void 0:window.getSelection())||void 0===r||r.removeAllRanges())})),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:r})=>{const{selection:n}=t,{ranges:i}=n;return!r||(i.forEach((({$from:r,$to:n})=>{e.doc.nodesBetween(r.pos,n.pos,((e,r)=>{if(e.type.isText)return;const{doc:n,mapping:i}=t,s=n.resolve(i.map(r)),o=n.resolve(i.map(r+e.nodeSize)),a=s.blockRange(o);if(!a)return;const l=Ae(a);if(e.type.isTextblock){const{defaultType:e}=s.parent.contentMatchAt(s.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)}))})),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>Xi(e,t),cut:(e,t)=>({editor:r,tr:n})=>{const{state:i}=r,s=i.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);const o=n.mapping.map(t);return n.insert(o,s.content),n.setSelection(new Xe(n.doc.resolve(o-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{const{selection:r}=e,n=r.$anchor.node();if(n.content.size>0)return!1;const i=e.selection.$anchor;for(let r=i.depth;r>0;r-=1){if(i.node(r).type===n.type){if(t){const t=i.before(r),n=i.after(r);e.delete(t,n).scrollIntoView()}return!0}}return!1},deleteNode:e=>({tr:t,state:r,dispatch:n})=>{const i=ws(e,r.schema),s=t.selection.$anchor;for(let e=s.depth;e>0;e-=1){if(s.node(e).type===i){if(n){const r=s.before(e),n=s.after(e);t.delete(r,n).scrollIntoView()}return!0}}return!1},deleteRange:e=>({tr:t,dispatch:r})=>{const{from:n,to:i}=e;return r&&t.delete(n,i),!0},deleteSelection:()=>({state:e,dispatch:t})=>Ui(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>Zi(e,t),extendMarkRange:(e,t={})=>({tr:r,state:n,dispatch:i})=>{const s=Zs(e,n.schema),{doc:o,selection:a}=r,{$from:l,from:u,to:c}=a;if(i){const e=Js(l,s,t);if(e&&e.from<=u&&e.to>=c){const t=Xe.create(o,e.from,e.to);r.setSelection(t)}}return!0},first:e=>t=>{const r="function"==typeof e?e(t):e;for(let e=0;e<r.length;e+=1)if(r[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:r,view:n,tr:i,dispatch:s})=>{t={scrollIntoView:!0,...t};const o=()=>{to()&&n.dom.focus(),requestAnimationFrame((()=>{r.isDestroyed||(n.focus(),(null==t?void 0:t.scrollIntoView)&&r.commands.scrollIntoView())}))};if(n.hasFocus()&&null===e||!1===e)return!0;if(s&&null===e&&!Xs(r.state.selection))return o(),!0;const a=eo(i.doc,e)||r.state.selection,l=r.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},forEach:(e,t)=>r=>e.every(((e,n)=>t(e,{...r,index:n}))),insertContent:(e,t)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},e,t),insertContentAt:(e,t,r)=>({tr:n,dispatch:i,editor:s})=>{if(i){r={parseOptions:{},updateSelection:!0,...r};const i=no(t,s.schema,{parseOptions:{preserveWhitespace:"full",...r.parseOptions}});if("<>"===i.toString())return!0;let{from:o,to:a}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},l=!0,u=!0;if((i.toString().startsWith("<")?i:[i]).forEach((e=>{e.check(),l=!!l&&(e.isText&&0===e.marks.length),u=!!u&&e.isBlock})),o===a&&u){const{parent:e}=n.doc.resolve(o);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(o-=1,a+=1)}l?Array.isArray(t)?n.insertText(t.map((e=>e.text||"")).join(""),o,a):"object"==typeof t&&t&&t.text?n.insertText(t.text,o,a):n.insertText(t,o,a):n.replaceWith(o,a,i),r.updateSelection&&function(e,t,r){const n=e.steps.length-1;if(n<t)return;const i=e.steps[n];if(!(i instanceof we||i instanceof Ee))return;const s=e.mapping.maps[n];let o=0;s.forEach(((e,t,r,n)=>{0===o&&(o=n)})),e.setSelection(Ke.near(e.doc.resolve(o),r))}(n,n.steps.length-1,-1)}return!0},joinUp:()=>({state:e,dispatch:t})=>((e,t)=>{let r,n=e.selection,i=n instanceof et;if(i){if(n.node.isTextblock||!ke(e.doc,n.from))return!1;r=n.from}else if(r=Oe(e.doc,n.from,-1),null==r)return!1;if(t){let n=e.tr.join(r);i&&n.setSelection(et.create(n.doc,r-e.doc.resolve(r).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0})(e,t),joinDown:()=>({state:e,dispatch:t})=>((e,t)=>{let r,n=e.selection;if(n instanceof et){if(n.node.isTextblock||!ke(e.doc,n.to))return!1;r=n.to}else if(r=Oe(e.doc,n.to,1),null==r)return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0})(e,t),joinBackward:()=>({state:e,dispatch:t})=>ji(e,t),joinForward:()=>({state:e,dispatch:t})=>Gi(e,t),joinItemBackward:()=>({tr:e,state:t,dispatch:r})=>{try{const n=Oe(t.doc,t.selection.$from.pos,-1);return null!=n&&(e.join(n,2),r&&r(e),!0)}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:r})=>{try{const n=Oe(e.doc,e.selection.$from.pos,1);return null!=n&&(r.join(n,2),t&&t(r),!0)}catch(e){return!1}},keyboardShortcut:e=>({editor:t,view:r,tr:n,dispatch:i})=>{const s=function(e){const t=e.split(/-(?!$)/);let r,n,i,s,o=t[t.length-1];"Space"===o&&(o=" ");for(let e=0;e<t.length-1;e+=1){const o=t[e];if(/^(cmd|meta|m)$/i.test(o))s=!0;else if(/^a(lt)?$/i.test(o))r=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))i=!0;else{if(!/^mod$/i.test(o))throw new Error(`Unrecognized modifier name: ${o}`);to()||io()?s=!0:n=!0}}return r&&(o=`Alt-${o}`),n&&(o=`Ctrl-${o}`),s&&(o=`Meta-${o}`),i&&(o=`Shift-${o}`),o}(e).split(/-(?!$)/),o=s.find((e=>!["Alt","Ctrl","Meta","Shift"].includes(e))),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction((()=>{r.someProp("handleKeyDown",(e=>e(r,a)))}));return null==l||l.steps.forEach((e=>{const t=e.map(n.mapping);t&&i&&n.maybeStep(t)})),!0},lift:(e,t={})=>({state:r,dispatch:n})=>!!so(r,ws(e,r.schema),t)&&((e,t)=>{let{$from:r,$to:n}=e.selection,i=r.blockRange(n),s=i&&Ae(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)})(r,n),liftEmptyBlock:()=>({state:e,dispatch:t})=>Qi(e,t),liftListItem:e=>({state:t,dispatch:r})=>ps(ws(e,t.schema))(t,r),newlineInCode:()=>({state:e,dispatch:t})=>Yi(e,t),resetAttributes:(e,t)=>({tr:r,state:n,dispatch:i})=>{let s=null,o=null;const a=oo("string"==typeof e?e:e.name,n.schema);return!!a&&("node"===a&&(s=ws(e,n.schema)),"mark"===a&&(o=Zs(e,n.schema)),i&&r.selection.ranges.forEach((e=>{n.doc.nodesBetween(e.$from.pos,e.$to.pos,((e,n)=>{s&&s===e.type&&r.setNodeMarkup(n,void 0,ao(e.attrs,t)),o&&e.marks.length&&e.marks.forEach((i=>{o===i.type&&r.addMark(n,n+e.nodeSize,o.create(ao(i.attrs,t)))}))}))})),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),selectNodeBackward:()=>({state:e,dispatch:t})=>qi(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>Wi(e,t),selectParentNode:()=>({state:e,dispatch:t})=>((e,t)=>{let r,{$from:n,to:i}=e.selection,s=n.sharedDepth(i);return 0!=s&&(r=n.before(s),t&&t(e.tr.setSelection(et.create(e.doc,r))),!0)})(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>ss(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>is(e,t),setContent:(e,t=!1,r={})=>({tr:n,editor:i,dispatch:s})=>{const{doc:o}=n,a=lo(e,i.schema,r);return s&&n.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!t),!0},setMark:(e,t={})=>({tr:r,state:n,dispatch:i})=>{const{selection:s}=r,{empty:o,ranges:a}=s,l=Zs(e,n.schema);if(i)if(o){const e=uo(n,l);r.addStoredMark(l.create({...e,...t}))}else a.forEach((e=>{const i=e.$from.pos,s=e.$to.pos;n.doc.nodesBetween(i,s,((e,n)=>{const o=Math.max(n,i),a=Math.min(n+e.nodeSize,s);e.marks.find((e=>e.type===l))?e.marks.forEach((e=>{l===e.type&&r.addMark(o,a,l.create({...e.attrs,...t}))})):r.addMark(o,a,l.create(t))}))}));return function(e,t,r){var n;const{selection:i}=t;let s=null;if(Xs(i)&&(s=i.$cursor),s){const t=null!==(n=e.storedMarks)&&void 0!==n?n:s.marks();return!!r.isInSet(t)||!t.some((e=>e.type.excludes(r)))}const{ranges:o}=i;return o.some((({$from:t,$to:n})=>{let i=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(r);return e.doc.nodesBetween(t.pos,n.pos,((e,t,n)=>{if(i)return!1;if(e.isInline){const t=!n||n.type.allowsMarkType(r),s=!!r.isInSet(e.marks)||!e.marks.some((e=>e.type.excludes(r)));i=t&&s}return!i})),i}))}(n,r,l)},setMeta:(e,t)=>({tr:r})=>(r.setMeta(e,t),!0),setNode:(e,t={})=>({state:r,dispatch:n,chain:i})=>{const s=ws(e,r.schema);return s.isTextblock?i().command((({commands:e})=>!!as(s,t)(r)||e.clearNodes())).command((({state:e})=>as(s,t)(e,n))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:r})=>{if(r){const{doc:r}=t,n=Qs(e,0,r.content.size),i=et.create(r,n);t.setSelection(i)}return!0},setTextSelection:e=>({tr:t,dispatch:r})=>{if(r){const{doc:r}=t,{from:n,to:i}="number"==typeof e?{from:e,to:e}:e,s=Xe.atStart(r).from,o=Xe.atEnd(r).to,a=Qs(n,s,o),l=Qs(i,s,o),u=Xe.create(r,a,l);t.setSelection(u)}return!0},sinkListItem:e=>({state:t,dispatch:r})=>{const n=ws(e,t.schema);return(s=n,function(e,t){let{$from:r,$to:n}=e.selection,o=r.blockRange(n,(e=>e.childCount>0&&e.firstChild.type==s));if(!o)return!1;let a=o.startIndex;if(0==a)return!1;let l=o.parent,u=l.child(a-1);if(u.type!=s)return!1;if(t){let r=u.lastChild&&u.lastChild.type==l.type,n=i.from(r?s.create():null),a=new c(i.from(s.create(null,i.from(l.type.create(null,n)))),r?3:1,0),d=o.start,h=o.end;t(e.tr.step(new Ee(d-(r?3:1),h,d,h,a,1,!0)).scrollIntoView())}return!0})(t,r);var s},splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:r,dispatch:n,editor:i})=>{const{selection:s,doc:o}=t,{$from:a,$to:l}=s,u=yo(i.extensionManager.attributes,a.node().type.name,a.node().attrs);if(s instanceof et&&s.node.isBlock)return!(!a.parentOffset||!Ce(o,a.pos))&&(n&&(e&&xo(r,i.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(n){const n=l.parentOffset===l.parent.content.size;s instanceof Xe&&t.deleteSelection();const o=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let c=n&&o?[{type:o,attrs:u}]:void 0,d=Ce(t.doc,t.mapping.map(a.pos),1,c);if(c||d||!Ce(t.doc,t.mapping.map(a.pos),1,o?[{type:o}]:void 0)||(d=!0,c=o?[{type:o,attrs:u}]:void 0),d&&(t.split(t.mapping.map(a.pos),1,c),o&&!n&&!a.parentOffset&&a.parent.type!==o)){const e=t.mapping.map(a.before()),r=t.doc.resolve(e);a.node(-1).canReplaceWith(r.index(),r.index()+1,o)&&t.setNodeMarkup(t.mapping.map(a.before()),o)}e&&xo(r,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:e=>({tr:t,state:r,dispatch:n,editor:s})=>{var o;const a=ws(e,r.schema),{$from:l,$to:u}=r.selection,d=r.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(u))return!1;const h=l.node(-1);if(h.type!==a)return!1;const f=s.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(n){let e=i.empty;const r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=i.from(l.node(t).copy(e));const n=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,s=yo(f,l.node().type.name,l.node().attrs),u=(null===(o=a.contentMatch.defaultType)||void 0===o?void 0:o.createAndFill(s))||void 0;e=e.append(i.from(a.createAndFill(null,u)||void 0));const d=l.before(l.depth-(r-1));t.replace(d,l.after(-n),new c(e,4-r,0));let h=-1;t.doc.nodesBetween(d,t.doc.content.size,((e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)})),h>-1&&t.setSelection(Xe.near(t.doc.resolve(h))),t.scrollIntoView()}return!0}const p=u.pos===l.end()?h.contentMatchAt(0).defaultType:null,m=yo(f,h.type.name,h.attrs),g=yo(f,l.node().type.name,l.node().attrs);t.delete(l.pos,u.pos);const y=p?[{type:a,attrs:m},{type:p,attrs:g}]:[{type:a,attrs:m}];if(!Ce(t.doc,l.pos,2))return!1;if(n){const{selection:e,storedMarks:i}=r,{splittableMarks:o}=s.extensionManager,a=i||e.$to.parentOffset&&e.$from.marks();if(t.split(l.pos,2,y).scrollIntoView(),!a||!n)return!0;const u=a.filter((e=>o.includes(e.type.name)));t.ensureMarks(u)}return!0},toggleList:(e,t,r,n={})=>({editor:i,tr:s,state:o,dispatch:a,chain:l,commands:u,can:c})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,f=ws(e,o.schema),p=ws(t,o.schema),{selection:m,storedMarks:g}=o,{$from:y,$to:v}=m,b=y.blockRange(v),x=g||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const w=co((e=>bo(e.type.name,d)))(m);if(b.depth>=1&&w&&b.depth-w.depth<=1){if(w.node.type===f)return u.liftListItem(p);if(bo(w.node.type.name,d)&&f.validContent(w.node.content)&&a)return l().command((()=>(s.setNodeMarkup(w.pos,f),!0))).command((()=>wo(s,f))).command((()=>Eo(s,f))).run()}return r&&x&&a?l().command((()=>{const e=c().wrapInList(f,n),t=x.filter((e=>h.includes(e.type.name)));return s.ensureMarks(t),!!e||u.clearNodes()})).wrapInList(f,n).command((()=>wo(s,f))).command((()=>Eo(s,f))).run():l().command((()=>!!c().wrapInList(f,n)||u.clearNodes())).wrapInList(f,n).command((()=>wo(s,f))).command((()=>Eo(s,f))).run()},toggleMark:(e,t={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:s=!1}=r,o=Zs(e,n.schema);return vo(n,o,t)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,t)},toggleNode:(e,t,r={})=>({state:n,commands:i})=>{const s=ws(e,n.schema),o=ws(t,n.schema);return so(n,s,r)?i.setNode(o):i.setNode(s,r)},toggleWrap:(e,t={})=>({state:r,commands:n})=>{const i=ws(e,r.schema);return so(r,i,t)?n.lift(i):n.wrapIn(i,t)},undoInputRule:()=>({state:e,dispatch:t})=>{const r=e.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let s;if(i.spec.isInputRules&&(s=i.getState(e))){if(t){const t=e.tr,r=s.transform;for(let e=r.steps.length-1;e>=0;e-=1)t.step(r.steps[e].invert(r.docs[e]));if(s.text){const r=t.doc.resolve(s.from).marks();t.replaceWith(s.from,s.to,e.schema.text(s.text,r))}else t.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{const{selection:r}=e,{empty:n,ranges:i}=r;return n||t&&i.forEach((t=>{e.removeMark(t.$from.pos,t.$to.pos)})),!0},unsetMark:(e,t={})=>({tr:r,state:n,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=r,l=Zs(e,n.schema),{$from:u,empty:c,ranges:d}=a;if(!i)return!0;if(c&&o){let{from:e,to:t}=a;const n=null===(s=u.marks().find((e=>e.type===l)))||void 0===s?void 0:s.attrs,i=Js(u,l,n);i&&(e=i.from,t=i.to),r.removeMark(e,t,l)}else d.forEach((e=>{r.removeMark(e.$from.pos,e.$to.pos,l)}));return r.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:r,state:n,dispatch:i})=>{let s=null,o=null;const a=oo("string"==typeof e?e:e.name,n.schema);return!!a&&("node"===a&&(s=ws(e,n.schema)),"mark"===a&&(o=Zs(e,n.schema)),i&&r.selection.ranges.forEach((e=>{const i=e.$from.pos,a=e.$to.pos;n.doc.nodesBetween(i,a,((e,n)=>{s&&s===e.type&&r.setNodeMarkup(n,void 0,{...e.attrs,...t}),o&&e.marks.length&&e.marks.forEach((s=>{if(o===s.type){const l=Math.max(n,i),u=Math.min(n+e.nodeSize,a);r.addMark(l,u,o.create({...s.attrs,...t}))}}))}))})),!0)},wrapIn:(e,t={})=>({state:r,dispatch:n})=>function(e,t=null){return function(r,n){let{$from:i,$to:s}=r.selection,o=i.blockRange(s),a=o&&De(o,e,t);return!!a&&(n&&n(r.tr.wrap(o,a).scrollIntoView()),!0)}}(ws(e,r.schema),t)(r,n),wrapInList:(e,t={})=>({state:r,dispatch:n})=>fs(ws(e,r.schema),t)(r,n)});const To=qs.create({name:"commands",addCommands:()=>({...So})}),Ao=qs.create({name:"editable",addProseMirrorPlugins(){return[new ft({key:new gt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Do=qs.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new ft({key:new gt("focusEvents"),props:{handleDOMEvents:{focus:(t,r)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,r)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),No=qs.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first((({commands:e})=>[()=>e.undoInputRule(),()=>e.command((({tr:t})=>{const{selection:r,doc:n}=t,{empty:i,$anchor:s}=r,{pos:o,parent:a}=s,l=s.parent.isTextblock?t.doc.resolve(o-1):s,u=l.parent.type.spec.isolating,c=s.pos-s.parentOffset,d=u&&1===l.parent.childCount?c===s.pos:Ke.atStart(n).from===o;return!(!(i&&d&&a.type.isTextblock)||a.textContent.length)&&e.clearNodes()})),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()])),t=()=>this.editor.commands.first((({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()])),r={Enter:()=>this.editor.commands.first((({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},n={...r},i={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return to()||io()?i:n},addProseMirrorPlugins(){return[new ft({key:new gt("clearDocument"),appendTransaction:(e,t,r)=>{if(!(e.some((e=>e.docChanged))&&!t.doc.eq(r.doc)))return;const{empty:n,from:i,to:s}=t.selection,o=Ke.atStart(t.doc).from,a=Ke.atEnd(t.doc).to;if(n||!(i===o&&s===a))return;if(!(0===r.doc.textBetween(0,r.doc.content.size," "," ").length))return;const l=r.tr,u=ms({state:r,transaction:l}),{commands:c}=new gs({editor:this.editor,state:u});return c.clearNodes(),l.steps.length?l:void 0}})]}}),Co=qs.create({name:"tabindex",addProseMirrorPlugins(){return[new ft({key:new gt("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var ko=Object.freeze({__proto__:null,ClipboardTextSerializer:Gs,Commands:To,Editable:Ao,FocusEvents:Do,Keymap:No,Tabindex:Co});class Mo extends ys{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,r){const n=document.querySelector(`style[data-tiptap-style${r?`-${r}`:""}]`);if(null!==n)return n;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style"+(r?`-${r}`:""),""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Ts(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:r});this.view.updateState(n)}unregisterPlugin(e){if(this.isDestroyed)return;const t="string"==typeof e?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter((e=>!e.key.startsWith(t)))});this.view.updateState(r)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(ko):[],...this.options.extensions].filter((e=>["extension","node","mark"].includes(null==e?void 0:e.type)));this.extensionManager=new $s(e,this)}createCommandManager(){this.commandManager=new gs({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=lo(this.options.content,this.schema,this.options.parseOptions),t=eo(e,this.options.autofocus);this.view=new Si(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:dt.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach((e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)})):void(this.capturedTransaction=e);const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const n=e.getMeta("focus"),i=e.getMeta("blur");n&&this.emit("focus",{editor:this,event:n.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return po(this.state,e)}isActive(e,t){const r="string"==typeof e?e:null,n="string"==typeof e?t:e;return function(e,t,r={}){if(!t)return so(e,null,r)||vo(e,null,r);const n=oo(t,e.schema);return"node"===n?so(e,t,r):"mark"===n&&vo(e,t,r)}(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ho(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:r={}}=e||{};return fo(this.state.doc,{blockSeparator:t,textSerializers:{...Vs(this.schema),...r}})}get isEmpty(){return function(e){var t;const r=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),n=e.toJSON();return JSON.stringify(r)===JSON.stringify(n)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}}function Oo(e){return new Ls({find:e.find,handler:({state:t,range:r,match:n})=>{const i=As(e.getAttributes,void 0,n);if(!1===i||null===i)return null;const{tr:s}=t,o=n[n.length-1],a=n[0];if(o){const n=a.search(/\S/),l=r.from+a.indexOf(o),u=l+o.length;if(go(r.from,r.to,t.doc).filter((t=>t.mark.type.excluded.find((r=>r===e.type&&r!==t.mark.type)))).filter((e=>e.to>l)).length)return null;u<r.to&&s.delete(u,r.to),l>r.from&&s.delete(r.from+n,l);const c=r.from+n+o.length;s.addMark(r.from+n,c,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}function _o(e){return new Ls({find:e.find,handler:({state:t,range:r,match:n})=>{const i=As(e.getAttributes,void 0,n)||{},{tr:s}=t,o=r.from;let a=r.to;const l=e.type.create(i);if(n[1]){let e=o+n[0].lastIndexOf(n[1]);e>a?e=a:a=e+n[1].length;const t=n[0][n[0].length-1];s.insertText(t,o+n[0].length-1),s.replaceWith(e,a,l)}else n[0]&&s.insert(o-1,e.type.create(i)).delete(s.mapping.map(o),s.mapping.map(a));s.scrollIntoView()}})}function Lo(e){return new Ls({find:e.find,handler:({state:t,range:r,match:n})=>{const i=t.doc.resolve(r.from),s=As(e.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;t.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,s)}})}function Ro(e){return new Ls({find:e.find,handler:({state:t,range:r,match:n})=>{let i=e.replace,s=r.from;const o=r.to;if(n[1]){const e=n[0].lastIndexOf(n[1]);i+=n[0].slice(e+n[1].length),s+=e;const t=s-o;t>0&&(i=n[0].slice(e-t,e)+i,s=o)}t.tr.insertText(i,s,o)}})}function Io(e){return new Ls({find:e.find,handler:({state:t,range:r,match:n,chain:i})=>{const s=As(e.getAttributes,void 0,n)||{},o=t.tr.delete(r.from,r.to),a=o.doc.resolve(r.from).blockRange(),l=a&&De(a,e.type,s);if(!l)return null;if(o.wrap(a,l),e.keepMarks&&e.editor){const{selection:r,storedMarks:n}=t,{splittableMarks:i}=e.editor.extensionManager,s=n||r.$to.parentOffset&&r.$from.marks();if(s){const e=s.filter((e=>i.includes(e.type.name)));o.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,s).run()}const u=o.doc.resolve(r.from-1).nodeBefore;u&&u.type===e.type&&ke(o.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(n,u))&&o.join(r.from-1)}})}class Fo{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=As(vs(this,"addOptions",{name:this.name}))),this.storage=As(vs(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Fo(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Fo(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=As(vs(t,"addOptions",{name:t.name})),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,n=e.state.selection.$from;if(n.pos===n.end()){const i=n.marks();if(!!!i.find((e=>(null==e?void 0:e.type.name)===t.name)))return!1;const s=i.find((e=>(null==e?void 0:e.type.name)===t.name));return s&&r.removeStoredMark(s),r.insertText(" ",n.pos),e.view.dispatch(r),!0}return!1}}class Po{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=As(vs(this,"addOptions",{name:this.name}))),this.storage=As(vs(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Po(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Po(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=As(vs(t,"addOptions",{name:t.name})),t.storage=As(vs(t,"addStorage",{name:t.name,options:t.options})),t}}function Bo(e){return new Ps({find:e.find,handler:({state:t,range:r,match:n,pasteEvent:i})=>{const s=As(e.getAttributes,void 0,n,i);if(!1===s||null===s)return null;const{tr:o}=t,a=n[n.length-1],l=n[0];let u=r.to;if(a){const n=l.search(/\S/),i=r.from+l.indexOf(a),c=i+a.length;if(go(r.from,r.to,t.doc).filter((t=>t.mark.type.excluded.find((r=>r===e.type&&r!==t.mark.type)))).filter((e=>e.to>i)).length)return null;c<r.to&&o.delete(c,r.to),i>r.from&&o.delete(r.from+n,i),u=r.from+n+a.length,o.addMark(r.from+n,u,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}const Uo=/^\s*>\s$/,$o=Po.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Io({find:Uo,type:this.type})]}}),jo=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,zo=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,qo=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Ho=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Vo=Fo.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Oo({find:jo,type:this.type}),Oo({find:qo,type:this.type})]},addPasteRules(){return[Bo({find:zo,type:this.type}),Bo({find:Ho,type:this.type})]}}),Go=Po.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",Es(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Wo=Fo.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const r=uo(e,this.type);return!!Object.entries(r).some((([,e])=>!!e))||t.unsetMark(this.name)}}}}),Ko=/^\s*([-+*])\s$/,Yo=Po.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Go.name,this.editor.getAttributes(Wo.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Io({find:Ko,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Io({find:Ko,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Wo.name),editor:this.editor})),[e]}}),Jo=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Zo=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Xo=Fo.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Oo({find:Jo,type:this.type})]},addPasteRules(){return[Bo({find:Zo,type:this.type})]}}),Qo=/^```([a-z]+)?[\s\n]$/,ea=/^~~~([a-z]+)?[\s\n]$/,ta=Po.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options,n=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter((e=>e.startsWith(r))).map((e=>e.replace(r,"")))[0];return n||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",Es(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!r&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const s=n.parentOffset===n.parent.nodeSize-2,o=n.parent.textContent.endsWith("\n\n");return!(!s||!o)&&e.chain().command((({tr:e})=>(e.delete(n.pos-2,n.pos),!0))).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:i,empty:s}=r;if(!s||i.parent.type!==this.type)return!1;if(!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();if(void 0===o)return!1;return!n.nodeAt(o)&&e.commands.exitCode()}}},addInputRules(){return[Lo({find:Qo,type:this.type,getAttributes:e=>({language:e[1]})}),Lo({find:ea,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new ft({key:new gt("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,s=null==i?void 0:i.mode;if(!r||!s)return!1;const{tr:o}=e.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(Xe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(r.replace(/\r\n?/g,"\n")),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),ra=Po.create({name:"doc",topNode:!0,content:"block+"});function na(e={}){return new ft({view:t=>new ia(t,e)})}class ia{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(r=t.width)&&void 0!==r?r:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map((t=>{let r=e=>{this[t](e)};return e.dom.addEventListener(t,r),{name:t,handler:r}}))}destroy(){this.handlers.forEach((({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t)))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),r=!t.parent.inlineContent;if(r){let r=t.nodeBefore,n=t.nodeAfter;if(r||n){let t=this.editorView.nodeDOM(this.cursorPos-(r?r.nodeSize:0));if(t){let i=t.getBoundingClientRect(),s=r?i.bottom:i.top;r&&n&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:i.left,right:i.right,top:s-this.width/2,bottom:s+this.width/2}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos);e={left:t.left-this.width/2,right:t.left+this.width/2,top:t.top,bottom:t.bottom}}let n,i,s=this.editorView.dom.offsetParent;if(this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),!s||s==document.body&&"static"==getComputedStyle(s).position)n=-pageXOffset,i=-pageYOffset;else{let e=s.getBoundingClientRect();n=e.left-s.scrollLeft,i=e.top-s.scrollTop}this.element.style.left=e.left-n+"px",this.element.style.top=e.top-i+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.setCursor(null)),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),n=r&&r.type.spec.disableDropCursor,i="function"==typeof n?n(this.editorView,t,e):n;if(t&&!i){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=_e(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const sa=qs.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[na(this.options)]}});class oa extends Ke{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return oa.valid(r)?new oa(r):Ke.near(r)}content(){return c.empty}eq(e){return e instanceof oa&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new oa(e.resolve(t.pos))}getBookmark(){return new aa(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let r=e.index(t),n=e.node(t);if(0!=r)for(let e=n.child(r-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let r=e.indexAfter(t),n=e.node(t);if(r!=n.childCount)for(let e=n.child(r);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e))return!1;let r=t.type.spec.allowGapCursor;if(null!=r)return r;let n=t.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&oa.valid(e))return e;let n=e.pos,i=null;for(let r=e.depth;;r--){let s=e.node(r);if(t>0?e.indexAfter(r)<s.childCount:e.index(r)>0){i=s.child(t>0?e.indexAfter(r):e.index(r)-1);break}if(0==r)return null;n+=t;let o=e.doc.resolve(n);if(oa.valid(o))return o}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!et.isSelectable(i)){e=e.doc.resolve(n+i.nodeSize*t),r=!1;continue e}break}i=s,n+=t;let o=e.doc.resolve(n);if(oa.valid(o))return o}return null}}}oa.prototype.visible=!1,oa.findFrom=oa.findGapCursorFrom,Ke.jsonID("gapcursor",oa);class aa{constructor(e){this.pos=e}map(e){return new aa(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return oa.valid(t)?new oa(t):Ke.near(t)}}const la=Bi({ArrowLeft:ua("horiz",-1),ArrowRight:ua("horiz",1),ArrowUp:ua("vert",-1),ArrowDown:ua("vert",1)});function ua(e,t){const r="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,n,i){let s=e.selection,o=t>0?s.$to:s.$from,a=s.empty;if(s instanceof Xe){if(!i.endOfTextblock(r)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=oa.findGapCursorFrom(o,t,a);return!!l&&(n&&n(e.tr.setSelection(new oa(l))),!0)}}function ca(e,t,r){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!oa.valid(n))return!1;let i=e.posAtCoords({left:r.clientX,top:r.clientY});return!(i&&i.inside>-1&&et.isSelectable(e.state.doc.nodeAt(i.inside)))&&(e.dispatch(e.state.tr.setSelection(new oa(n))),!0)}function da(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof oa))return!1;let{$from:r}=e.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let s=i.empty;for(let e=n.length-1;e>=0;e--)s=i.from(n[e].createAndFill(null,s));let o=e.state.tr.replace(r.pos,r.pos,new c(s,0,0));return o.setSelection(Xe.near(o.doc.resolve(r.pos+1))),e.dispatch(o),!1}function ha(e){if(!(e.selection instanceof oa))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",ei.create(e.doc,[Zn.widget(e.selection.head,t,{key:"gapcursor"})])}const fa=qs.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ft({props:{decorations:ha,createSelectionBetween:(e,t,r)=>t.pos==r.pos&&oa.valid(r)?new oa(r):null,handleClick:ca,handleKeyDown:la,handleDOMEvents:{beforeinput:da}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=As(vs(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),pa=Po.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",Es(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:r,editor:n})=>e.first([()=>e.exitCode(),()=>e.command((()=>{const{selection:e,storedMarks:i}=r;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=n.extensionManager,a=i||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command((({tr:e,dispatch:t})=>{if(t&&a&&s){const t=a.filter((e=>o.includes(e.type.name)));e.ensureMarks(t)}return!0})).run()}))])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ma=Po.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((e=>({tag:`h${e}`,attrs:{level:e}})))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Es(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce(((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})})),{})},addInputRules(){return this.options.levels.map((e=>Lo({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}})))}});var ga=200,ya=function(){};ya.prototype.append=function(e){return e.length?(e=ya.from(e),!this.length&&e||e.length<ga&&this.leafAppend(e)||this.length<ga&&e.leafPrepend(this)||this.appendInner(e)):this},ya.prototype.prepend=function(e){return e.length?ya.from(e).append(this):this},ya.prototype.appendInner=function(e){return new ba(this,e)},ya.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?ya.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},ya.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},ya.prototype.forEach=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)},ya.prototype.map=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=this.length);var n=[];return this.forEach((function(t,r){return n.push(e(t,r))}),t,r),n},ya.from=function(e){return e instanceof ya?e:e&&e.length?new va(e):ya.empty};var va=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,r){return 0==e&&r==this.length?this:new t(this.values.slice(e,r))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,r,n){for(var i=t;i<r;i++)if(!1===e(this.values[i],n+i))return!1},t.prototype.forEachInvertedInner=function(e,t,r,n){for(var i=t-1;i>=r;i--)if(!1===e(this.values[i],n+i))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=ga)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=ga)return new t(e.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t}(ya);ya.empty=new va([]);var ba=function(e){function t(t,r){e.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,r,n){var i=this.left.length;return!(t<i&&!1===this.left.forEachInner(e,t,Math.min(r,i),n))&&(!(r>i&&!1===this.right.forEachInner(e,Math.max(t-i,0),Math.min(this.length,r)-i,n+i))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,r,n){var i=this.left.length;return!(t>i&&!1===this.right.forEachInvertedInner(e,t-i,Math.max(r,i)-i,n+i))&&(!(r<i&&!1===this.left.forEachInvertedInner(e,Math.min(t,i),r,n))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var r=this.left.length;return t<=r?this.left.slice(e,t):e>=r?this.right.slice(e-r,t-r):this.left.slice(e,r).append(this.right.slice(0,t-r))},t.prototype.leafAppend=function(e){var r=this.right.leafAppend(e);if(r)return new t(this.left,r)},t.prototype.leafPrepend=function(e){var r=this.left.leafPrepend(e);if(r)return new t(r,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(ya);const xa=ya;class wa{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let r,n,i=this.items.length;for(;;i--){if(this.items.get(i-1).selection){--i;break}}t&&(r=this.remapping(i,this.items.length),n=r.maps.length);let s,o,a=e.tr,l=[],u=[];return this.items.forEach(((e,t)=>{if(!e.step)return r||(r=this.remapping(i,t+1),n=r.maps.length),n--,void u.push(e);if(r){u.push(new Ea(e.map));let t,i=e.step.map(r.slice(n));i&&a.maybeStep(i).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new Ea(t,void 0,void 0,l.length+u.length))),n--,t&&r.appendMap(t,n)}else a.maybeStep(e.step);return e.selection?(s=r?e.selection.map(r.slice(n)):e.selection,o=new wa(this.items.slice(0,i).append(u.reverse().concat(l)),this.eventCount-1),!1):void 0}),this.items.length,0),{remaining:o,transform:a,selection:s}}addTransform(e,t,r,n){let i=[],s=this.eventCount,o=this.items,a=!n&&o.length?o.get(o.length-1):null;for(let r=0;r<e.steps.length;r++){let l,u=e.steps[r].invert(e.docs[r]),c=new Ea(e.mapping.maps[r],u,t);(l=a&&a.merge(c))&&(c=l,r?i.pop():o=o.slice(0,o.length-1)),i.push(c),t&&(s++,t=void 0),n||(a=c)}let l=s-r.depth;return l>Ta&&(o=function(e,t){let r;return e.forEach(((e,n)=>{if(e.selection&&0==t--)return r=n,!1})),e.slice(r)}(o,l),s-=l),new wa(o.append(i),s)}remapping(e,t){let r=new he;return this.items.forEach(((t,n)=>{let i=null!=t.mirrorOffset&&n-t.mirrorOffset>=e?r.maps.length-t.mirrorOffset:void 0;r.appendMap(t.map,i)}),e,t),r}addMaps(e){return 0==this.eventCount?this:new wa(this.items.append(e.map((e=>new Ea(e)))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],n=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach((e=>{e.selection&&o--}),n);let a=t;this.items.forEach((t=>{let n=i.getMirror(--a);if(null==n)return;s=Math.min(s,n);let l=i.maps[n];if(t.step){let s=e.steps[n].invert(e.docs[n]),u=t.selection&&t.selection.map(i.slice(a+1,n));u&&o++,r.push(new Ea(l,s,u))}else r.push(new Ea(l))}),n);let l=[];for(let e=t;e<s;e++)l.push(new Ea(i.maps[e]));let u=this.items.slice(0,n).append(l).append(r),c=new wa(u,o);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-r.length)),c}emptyItemCount(){let e=0;return this.items.forEach((t=>{t.step||e++})),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,n=[],i=0;return this.items.forEach(((s,o)=>{if(o>=e)n.push(s),s.selection&&i++;else if(s.step){let e=s.step.map(t.slice(r)),o=e&&e.getMap();if(r--,o&&t.appendMap(o,r),e){let a=s.selection&&s.selection.map(t.slice(r));a&&i++;let l,u=new Ea(o.invert(),e,a),c=n.length-1;(l=n.length&&n[c].merge(u))?n[c]=l:n.push(u)}}else s.map&&r--}),this.items.length,0),new wa(xa.from(n.reverse()),i)}}wa.empty=new wa(xa.empty,0);class Ea{constructor(e,t,r,n){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=n}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Ea(t.getMap().invert(),t,this.selection)}}}class Sa{constructor(e,t,r,n,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=n,this.prevComposition=i}}const Ta=20;function Aa(e){let t=[];return e.forEach(((e,r,n,i)=>t.push(n,i))),t}function Da(e,t){if(!e)return null;let r=[];for(let n=0;n<e.length;n+=2){let i=t.map(e[n],1),s=t.map(e[n+1],-1);i<=s&&r.push(i,s)}return r}function Na(e,t,r,n){let i=Ma(t),s=Oa.get(t).spec.config,o=(n?e.undone:e.done).popEvent(t,i);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(n?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),s,i),u=new Sa(n?l:o.remaining,n?o.remaining:l,null,0,-1);r(o.transform.setSelection(a).setMeta(Oa,{redo:n,historyState:u}).scrollIntoView())}let Ca=!1,ka=null;function Ma(e){let t=e.plugins;if(ka!=t){Ca=!1,ka=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){Ca=!0;break}}return Ca}const Oa=new gt("history"),_a=new gt("closeHistory");function La(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new ft({key:Oa,state:{init:()=>new Sa(wa.empty,wa.empty,null,0,-1),apply:(t,r,n)=>function(e,t,r,n){let i,s=r.getMeta(Oa);if(s)return s.historyState;r.getMeta(_a)&&(e=new Sa(e.done,e.undone,null,0,-1));let o=r.getMeta("appendedTransaction");if(0==r.steps.length)return e;if(o&&o.getMeta(Oa))return o.getMeta(Oa).redo?new Sa(e.done.addTransform(r,void 0,n,Ma(t)),e.undone,Aa(r.mapping.maps[r.steps.length-1]),e.prevTime,e.prevComposition):new Sa(e.done,e.undone.addTransform(r,void 0,n,Ma(t)),null,e.prevTime,e.prevComposition);if(!1===r.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(i=r.getMeta("rebased"))?new Sa(e.done.rebased(r,i),e.undone.rebased(r,i),Da(e.prevRanges,r.mapping),e.prevTime,e.prevComposition):new Sa(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),Da(e.prevRanges,r.mapping),e.prevTime,e.prevComposition);{let i=r.getMeta("composition"),s=0==e.prevTime||!o&&e.prevComposition!=i&&(e.prevTime<(r.time||0)-n.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let r=!1;return e.mapping.maps[0].forEach(((e,n)=>{for(let i=0;i<t.length;i+=2)e<=t[i+1]&&n>=t[i]&&(r=!0)})),r}(r,e.prevRanges)),a=o?Da(e.prevRanges,r.mapping):Aa(r.mapping.maps[r.steps.length-1]);return new Sa(e.done.addTransform(r,s?t.selection.getBookmark():void 0,n,Ma(t)),wa.empty,a,r.time,null==i?e.prevComposition:i)}}(r,n,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,n="historyUndo"==r?Ra:"historyRedo"==r?Ia:null;return!!n&&(t.preventDefault(),n(e.state,e.dispatch))}}}})}const Ra=(e,t)=>{let r=Oa.getState(e);return!(!r||0==r.done.eventCount)&&(t&&Na(r,e,t,!1),!0)},Ia=(e,t)=>{let r=Oa.getState(e);return!(!r||0==r.undone.eventCount)&&(t&&Na(r,e,t,!0),!0)};const Fa=qs.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>Ra(e,t),redo:()=>({state:e,dispatch:t})=>Ia(e,t)}),addProseMirrorPlugins(){return[La(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Pa=Po.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",Es(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{$to:r}=t.selection,n=e();return 0===r.parentOffset?n.insertContentAt(Math.max(r.pos-2,0),{type:this.name}):n.insertContent({type:this.name}),n.command((({tr:e,dispatch:t})=>{var r;if(t){const{$to:t}=e.selection,n=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(Xe.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(et.create(e.doc,t.pos)):e.setSelection(Xe.create(e.doc,t.pos));else{const i=null===(r=t.parent.type.contentMatch.defaultType)||void 0===r?void 0:r.create();i&&(e.insert(n,i),e.setSelection(Xe.create(e.doc,n+1)))}e.scrollIntoView()}return!0})).run()}}},addInputRules(){return[_o({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Ba=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Ua=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,$a=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,ja=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,za=Fo.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Oo({find:Ba,type:this.type}),Oo({find:$a,type:this.type})]},addPasteRules(){return[Bo({find:Ua,type:this.type}),Bo({find:ja,type:this.type})]}}),qa=Po.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",Es(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ha=Po.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",Es(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Va=Fo.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const r=uo(e,this.type);return!!Object.entries(r).some((([,e])=>!!e))||t.unsetMark(this.name)}}}}),Ga=/^(\d+)\.\s$/,Wa=Po.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return 1===t?["ol",Es(this.options.HTMLAttributes,r),0]:["ol",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ha.name,this.editor.getAttributes(Va.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Io({find:Ga,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Io({find:Ga,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Va.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),Ka=Po.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Ya=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Ja=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Za=Fo.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){const e={};return io()?e["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():e["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),e},addInputRules(){return[Oo({find:Ya,type:this.type})]},addPasteRules(){return[Bo({find:Ja,type:this.type})]}}),Xa=Po.create({name:"text",group:"inline"}),Qa=qs.create({name:"starterKit",addExtensions(){var e,t,r,n,i,s,o,a,l,u,c,d,h,f,p,m,g,y;const v=[];return!1!==this.options.blockquote&&v.push($o.configure(null===(e=this.options)||void 0===e?void 0:e.blockquote)),!1!==this.options.bold&&v.push(Vo.configure(null===(t=this.options)||void 0===t?void 0:t.bold)),!1!==this.options.bulletList&&v.push(Yo.configure(null===(r=this.options)||void 0===r?void 0:r.bulletList)),!1!==this.options.code&&v.push(Xo.configure(null===(n=this.options)||void 0===n?void 0:n.code)),!1!==this.options.codeBlock&&v.push(ta.configure(null===(i=this.options)||void 0===i?void 0:i.codeBlock)),!1!==this.options.document&&v.push(ra.configure(null===(s=this.options)||void 0===s?void 0:s.document)),!1!==this.options.dropcursor&&v.push(sa.configure(null===(o=this.options)||void 0===o?void 0:o.dropcursor)),!1!==this.options.gapcursor&&v.push(fa.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&v.push(pa.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&v.push(ma.configure(null===(u=this.options)||void 0===u?void 0:u.heading)),!1!==this.options.history&&v.push(Fa.configure(null===(c=this.options)||void 0===c?void 0:c.history)),!1!==this.options.horizontalRule&&v.push(Pa.configure(null===(d=this.options)||void 0===d?void 0:d.horizontalRule)),!1!==this.options.italic&&v.push(za.configure(null===(h=this.options)||void 0===h?void 0:h.italic)),!1!==this.options.listItem&&v.push(qa.configure(null===(f=this.options)||void 0===f?void 0:f.listItem)),!1!==this.options.orderedList&&v.push(Wa.configure(null===(p=this.options)||void 0===p?void 0:p.orderedList)),!1!==this.options.paragraph&&v.push(Ka.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&v.push(Za.configure(null===(g=this.options)||void 0===g?void 0:g.strike)),!1!==this.options.text&&v.push(Xa.configure(null===(y=this.options)||void 0===y?void 0:y.text)),v}}),el=qs.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new ft({key:new gt("placeholder"),props:{decorations:({doc:e,selection:t})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,i=[];if(!r)return null;const s=e.type.createAndFill(),o=(null==s?void 0:s.sameMarkup(e))&&null===s.content.findDiffStart(e.content);return e.descendants(((e,t)=>{const r=n>=t&&n<=t+e.nodeSize,s=!e.isLeaf&&!e.childCount;if((r||!this.options.showOnlyCurrent)&&s){const n=[this.options.emptyNodeClass];o&&n.push(this.options.emptyEditorClass);const s=Zn.node(t,t+e.nodeSize,{class:n.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:r}):this.options.placeholder});i.push(s)}return this.options.includeChildren})),ei.create(e,i)}}})]}}),tl="aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",rl="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5تصالات6رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",nl=(e,t)=>{for(const r in t)e[r]=t[r];return e},il="numeric",sl="ascii",ol="alpha",al="asciinumeric",ll="alphanumeric",ul="domain",cl="emoji",dl="scheme",hl="slashscheme",fl="whitespace";function pl(e,t){return e in t||(t[e]=[]),t[e]}function ml(e,t,r){t[il]&&(t[al]=!0,t[ll]=!0),t[sl]&&(t[al]=!0,t[ol]=!0),t[al]&&(t[ll]=!0),t[ol]&&(t[ll]=!0),t[ll]&&(t[ul]=!0),t[cl]&&(t[ul]=!0);for(const n in t){const t=pl(n,r);t.indexOf(e)<0&&t.push(e)}}function gl(e){void 0===e&&(e=null),this.j={},this.jr=[],this.jd=null,this.t=e}gl.groups={},gl.prototype={accepts(){return!!this.t},go(e){const t=this,r=t.j[e];if(r)return r;for(let r=0;r<t.jr.length;r++){const n=t.jr[r][0],i=t.jr[r][1];if(i&&n.test(e))return i}return t.jd},has(e,t){return void 0===t&&(t=!1),t?e in this.j:!!this.go(e)},ta(e,t,r,n){for(let i=0;i<e.length;i++)this.tt(e[i],t,r,n)},tr(e,t,r,n){let i;return n=n||gl.groups,t&&t.j?i=t:(i=new gl(t),r&&n&&ml(t,r,n)),this.jr.push([e,i]),i},ts(e,t,r,n){let i=this;const s=e.length;if(!s)return i;for(let t=0;t<s-1;t++)i=i.tt(e[t]);return i.tt(e[s-1],t,r,n)},tt(e,t,r,n){n=n||gl.groups;const i=this;if(t&&t.j)return i.j[e]=t,t;const s=t;let o,a=i.go(e);if(a?(o=new gl,nl(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new gl,s){if(n)if(o.t&&"string"==typeof o.t){const e=nl(function(e,t){const r={};for(const n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}(o.t,n),r);ml(s,e,n)}else r&&ml(s,r,n);o.t=s}return i.j[e]=o,o}};const yl=(e,t,r,n,i)=>e.ta(t,r,n,i),vl=(e,t,r,n,i)=>e.tr(t,r,n,i),bl=(e,t,r,n,i)=>e.ts(t,r,n,i),xl=(e,t,r,n,i)=>e.tt(t,r,n,i),wl="WORD",El="UWORD",Sl="LOCALHOST",Tl="TLD",Al="UTLD",Dl="SCHEME",Nl="SLASH_SCHEME",Cl="NUM",kl="WS",Ml="NL",Ol="OPENBRACE",_l="OPENBRACKET",Ll="OPENANGLEBRACKET",Rl="OPENPAREN",Il="CLOSEBRACE",Fl="CLOSEBRACKET",Pl="CLOSEANGLEBRACKET",Bl="CLOSEPAREN",Ul="AMPERSAND",$l="APOSTROPHE",jl="ASTERISK",zl="AT",ql="BACKSLASH",Hl="BACKTICK",Vl="CARET",Gl="COLON",Wl="COMMA",Kl="DOLLAR",Yl="DOT",Jl="EQUALS",Zl="EXCLAMATION",Xl="HYPHEN",Ql="PERCENT",eu="PIPE",tu="PLUS",ru="POUND",nu="QUERY",iu="QUOTE",su="SEMI",ou="SLASH",au="TILDE",lu="UNDERSCORE",uu="EMOJI",cu="SYM";var du=Object.freeze({__proto__:null,WORD:wl,UWORD:El,LOCALHOST:Sl,TLD:Tl,UTLD:Al,SCHEME:Dl,SLASH_SCHEME:Nl,NUM:Cl,WS:kl,NL:Ml,OPENBRACE:Ol,OPENBRACKET:_l,OPENANGLEBRACKET:Ll,OPENPAREN:Rl,CLOSEBRACE:Il,CLOSEBRACKET:Fl,CLOSEANGLEBRACKET:Pl,CLOSEPAREN:Bl,AMPERSAND:Ul,APOSTROPHE:$l,ASTERISK:jl,AT:zl,BACKSLASH:ql,BACKTICK:Hl,CARET:Vl,COLON:Gl,COMMA:Wl,DOLLAR:Kl,DOT:Yl,EQUALS:Jl,EXCLAMATION:Zl,HYPHEN:Xl,PERCENT:Ql,PIPE:eu,PLUS:tu,POUND:ru,QUERY:nu,QUOTE:iu,SEMI:su,SLASH:ou,TILDE:au,UNDERSCORE:lu,EMOJI:uu,SYM:cu});const hu=/[a-z]/,fu=/\p{L}/u,pu=/\p{Emoji}/u,mu=/\d/,gu=/\s/;const yu="\n",vu="️",bu="‍";let xu=null,wu=null;function Eu(e,t,r,n,i){let s;const o=t.length;for(let r=0;r<o-1;r++){const o=t[r];e.j[o]?s=e.j[o]:(s=new gl(n),s.jr=i.slice(),e.j[o]=s),e=s}return s=new gl(r),s.jr=i.slice(),e.j[t[o-1]]=s,s}function Su(e){const t=[],r=[];let n=0;for(;n<e.length;){let i=0;for(;"0123456789".indexOf(e[n+i])>=0;)i++;if(i>0){t.push(r.join(""));for(let t=parseInt(e.substring(n,n+i),10);t>0;t--)r.pop();n+=i}else r.push(e[n]),n++}return t}const Tu={defaultProtocol:"http",events:null,format:Du,formatHref:Du,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Au(e,t){void 0===t&&(t=null);let r=nl({},Tu);e&&(r=nl(r,e instanceof Au?e.o:e));const n=r.ignoreTags,i=[];for(let e=0;e<n.length;e++)i.push(n[e].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=i}function Du(e){return e}Au.prototype={o:Tu,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,r){const n=null!=t;let i=this.o[e];return i?("object"==typeof i?(i=r.t in i?i[r.t]:Tu[e],"function"==typeof i&&n&&(i=i(t,r))):"function"==typeof i&&n&&(i=i(t,r.t,r)),i):i},getObj(e,t,r){let n=this.o[e];return"function"==typeof n&&null!=t&&(n=n(t,r.t,r)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function Nu(e,t){this.t="token",this.v=e,this.tk=t}function Cu(e,t){class r extends Nu{constructor(t,r){super(t,r),this.t=e}}for(const e in t)r.prototype[e]=t[e];return r.t=e,r}Nu.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),r=e.get("truncate",t,this),n=e.get("format",t,this);return r&&n.length>r?n.substring(0,r)+"…":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e){return void 0===e&&(e=Tu.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,r=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",r,this),i=e.get("tagName",r,t),s=this.toFormattedString(e),o={},a=e.get("className",r,t),l=e.get("target",r,t),u=e.get("rel",r,t),c=e.getObj("attributes",r,t),d=e.getObj("events",r,t);return o.href=n,a&&(o.class=a),l&&(o.target=l),u&&(o.rel=u),c&&nl(o,c),{tagName:i,attributes:o,content:s,eventListeners:d}}};const ku=Cu("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Mu=Cu("text"),Ou=Cu("nl"),_u=Cu("url",{isLink:!0,toHref(e){return void 0===e&&(e=Tu.defaultProtocol),this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==Sl&&e[1].t===Gl}});const Lu=e=>new gl(e);function Ru(e,t,r){const n=r[0].s,i=r[r.length-1].e;return new e(t.slice(n,i),r)}const Iu="undefined"!=typeof console&&console&&console.warn||(()=>{}),Fu="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Pu={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Bu(e,t){if(void 0===t&&(t=!1),Pu.initialized&&Iu(`linkifyjs: already initialized - will not register custom scheme "${e}" ${Fu}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Pu.customSchemes.push([e,t])}function Uu(){Pu.scanner=function(e){void 0===e&&(e=[]);const t={};gl.groups=t;const r=new gl;null==xu&&(xu=Su(tl)),null==wu&&(wu=Su(rl)),xl(r,"'",$l),xl(r,"{",Ol),xl(r,"[",_l),xl(r,"<",Ll),xl(r,"(",Rl),xl(r,"}",Il),xl(r,"]",Fl),xl(r,">",Pl),xl(r,")",Bl),xl(r,"&",Ul),xl(r,"*",jl),xl(r,"@",zl),xl(r,"`",Hl),xl(r,"^",Vl),xl(r,":",Gl),xl(r,",",Wl),xl(r,"$",Kl),xl(r,".",Yl),xl(r,"=",Jl),xl(r,"!",Zl),xl(r,"-",Xl),xl(r,"%",Ql),xl(r,"|",eu),xl(r,"+",tu),xl(r,"#",ru),xl(r,"?",nu),xl(r,'"',iu),xl(r,"/",ou),xl(r,";",su),xl(r,"~",au),xl(r,"_",lu),xl(r,"\\",ql);const n=vl(r,mu,Cl,{[il]:!0});vl(n,mu,n);const i=vl(r,hu,wl,{[sl]:!0});vl(i,hu,i);const s=vl(r,fu,El,{[ol]:!0});vl(s,hu),vl(s,fu,s);const o=vl(r,gu,kl,{[fl]:!0});xl(r,yu,Ml,{[fl]:!0}),xl(o,yu),vl(o,gu,o);const a=vl(r,pu,uu,{[cl]:!0});vl(a,pu,a),xl(a,vu,a);const l=xl(a,bu);vl(l,pu,a);const u=[[hu,i]],c=[[hu,null],[fu,s]];for(let e=0;e<xu.length;e++)Eu(r,xu[e],Tl,wl,u);for(let e=0;e<wu.length;e++)Eu(r,wu[e],Al,El,c);ml(Tl,{tld:!0,ascii:!0},t),ml(Al,{utld:!0,alpha:!0},t),Eu(r,"file",Dl,wl,u),Eu(r,"mailto",Dl,wl,u),Eu(r,"http",Nl,wl,u),Eu(r,"https",Nl,wl,u),Eu(r,"ftp",Nl,wl,u),Eu(r,"ftps",Nl,wl,u),ml(Dl,{scheme:!0,ascii:!0},t),ml(Nl,{slashscheme:!0,ascii:!0},t),e=e.sort(((e,t)=>e[0]>t[0]?1:-1));for(let t=0;t<e.length;t++){const n=e[t][0],i=e[t][1]?{[dl]:!0}:{[hl]:!0};n.indexOf("-")>=0?i[ul]=!0:hu.test(n)?mu.test(n)?i[al]=!0:i[sl]=!0:i[il]=!0,bl(r,n,n,i)}return bl(r,"localhost",Sl,{ascii:!0}),r.jd=new gl(cu),{start:r,tokens:nl({groups:t},du)}}(Pu.customSchemes);for(let e=0;e<Pu.tokenQueue.length;e++)Pu.tokenQueue[e][1]({scanner:Pu.scanner});Pu.parser=function(e){let{groups:t}=e;const r=t.domain.concat([Ul,jl,zl,ql,Hl,Vl,Kl,Jl,Xl,Cl,Ql,eu,tu,ru,ou,cu,au,lu]),n=[$l,Pl,Il,Fl,Bl,Gl,Wl,Yl,Zl,Ll,Ol,_l,Rl,nu,iu,su],i=[Ul,$l,jl,ql,Hl,Vl,Il,Kl,Jl,Xl,Ol,Ql,eu,tu,ru,nu,ou,cu,au,lu],s=Lu(),o=xl(s,au);yl(o,i,o),yl(o,t.domain,o);const a=Lu(),l=Lu(),u=Lu();yl(s,t.domain,a),yl(s,t.scheme,l),yl(s,t.slashscheme,u),yl(a,i,o),yl(a,t.domain,a);const c=xl(a,zl);xl(o,zl,c),xl(l,zl,c),xl(u,zl,c);const d=xl(o,Yl);yl(d,i,o),yl(d,t.domain,o);const h=Lu();yl(c,t.domain,h),yl(h,t.domain,h);const f=xl(h,Yl);yl(f,t.domain,h);const p=Lu(ku);yl(f,t.tld,p),yl(f,t.utld,p),xl(c,Sl,p);const m=xl(h,Xl);yl(m,t.domain,h),yl(p,t.domain,h),xl(p,Yl,f),xl(p,Xl,m);const g=xl(p,Gl);yl(g,t.numeric,ku);const y=xl(a,Xl),v=xl(a,Yl);yl(y,t.domain,a),yl(v,i,o),yl(v,t.domain,a);const b=Lu(_u);yl(v,t.tld,b),yl(v,t.utld,b),yl(b,t.domain,a),yl(b,i,o),xl(b,Yl,v),xl(b,Xl,y),xl(b,zl,c);const x=xl(b,Gl),w=Lu(_u);yl(x,t.numeric,w);const E=Lu(_u),S=Lu();yl(E,r,E),yl(E,n,S),yl(S,r,E),yl(S,n,S),xl(b,ou,E),xl(w,ou,E);const T=xl(l,Gl),A=xl(u,Gl),D=xl(A,ou),N=xl(D,ou);yl(l,t.domain,a),xl(l,Yl,v),xl(l,Xl,y),yl(u,t.domain,a),xl(u,Yl,v),xl(u,Xl,y),yl(T,t.domain,E),xl(T,ou,E),yl(N,t.domain,E),yl(N,r,E),xl(N,ou,E);const C=xl(E,Ol),k=xl(E,_l),M=xl(E,Ll),O=xl(E,Rl);xl(S,Ol,C),xl(S,_l,k),xl(S,Ll,M),xl(S,Rl,O),xl(C,Il,E),xl(k,Fl,E),xl(M,Pl,E),xl(O,Bl,E),xl(C,Il,E);const _=Lu(_u),L=Lu(_u),R=Lu(_u),I=Lu(_u);yl(C,r,_),yl(k,r,L),yl(M,r,R),yl(O,r,I);const F=Lu(),P=Lu(),B=Lu(),U=Lu();return yl(C,n),yl(k,n),yl(M,n),yl(O,n),yl(_,r,_),yl(L,r,L),yl(R,r,R),yl(I,r,I),yl(_,n,_),yl(L,n,L),yl(R,n,R),yl(I,n,I),yl(F,r,F),yl(P,r,L),yl(B,r,R),yl(U,r,I),yl(F,n,F),yl(P,n,P),yl(B,n,B),yl(U,n,U),xl(L,Fl,E),xl(R,Pl,E),xl(I,Bl,E),xl(_,Il,E),xl(P,Fl,E),xl(B,Pl,E),xl(U,Bl,E),xl(F,Bl,E),xl(s,Sl,b),xl(s,Ml,Ou),{start:s,tokens:du}}(Pu.scanner.tokens);for(let e=0;e<Pu.pluginQueue.length;e++)Pu.pluginQueue[e][1]({scanner:Pu.scanner,parser:Pu.parser});Pu.initialized=!0}function $u(e){return Pu.initialized||Uu(),function(e,t,r){let n=r.length,i=0,s=[],o=[];for(;i<n;){let a=e,l=null,u=null,c=0,d=null,h=-1;for(;i<n&&!(l=a.go(r[i].t));)o.push(r[i++]);for(;i<n&&(u=l||a.go(r[i].t));)l=null,a=u,a.accepts()?(h=0,d=a):h>=0&&h++,i++,c++;if(h<0)i-=c,i<n&&(o.push(r[i]),i++);else{o.length>0&&(s.push(Ru(Mu,t,o)),o=[]),i-=h,c-=h;const e=d.t,n=r.slice(i-c,i);s.push(Ru(e,t,n))}}return o.length>0&&s.push(Ru(Mu,t,o)),s}(Pu.parser.start,e,function(e,t){const r=function(e){const t=[],r=e.length;let n=0;for(;n<r;){let i,s=e.charCodeAt(n),o=s<55296||s>56319||n+1===r||(i=e.charCodeAt(n+1))<56320||i>57343?e[n]:e.slice(n,n+2);t.push(o),n+=o.length}return t}(t.replace(/[A-Z]/g,(e=>e.toLowerCase()))),n=r.length,i=[];let s=0,o=0;for(;o<n;){let a=e,l=null,u=0,c=null,d=-1,h=-1;for(;o<n&&(l=a.go(r[o]));)a=l,a.accepts()?(d=0,h=0,c=a):d>=0&&(d+=r[o].length,h++),u+=r[o].length,s+=r[o].length,o++;s-=d,o-=h,u-=d,i.push({t:c.t,v:t.slice(s-u,s),s:s-u,e:s})}return i}(Pu.scanner.start,e))}function ju(e,t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),t&&"object"==typeof t){if(r)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);r=t,t=null}const n=new Au(r),i=$u(e),s=[];for(let e=0;e<i.length;e++){const r=i[e];!r.isLink||t&&r.t!==t||!n.check(r)||s.push(r.toFormattedObject(n))}return s}function zu(e){return new ft({key:new gt("autolink"),appendTransaction:(t,r,n)=>{const i=t.some((e=>e.docChanged))&&!r.doc.eq(n.doc),s=t.some((e=>e.getMeta("preventAutolink")));if(!i||s)return;const{tr:o}=n,a=function(e,t){const r=new Ge(e);return t.forEach((e=>{e.steps.forEach((e=>{r.step(e)}))})),r}(r.doc,[...t]),l=function(e){const{mapping:t,steps:r}=e,n=[];return t.maps.forEach(((e,i)=>{const s=[];if(e.ranges.length)e.forEach(((e,t)=>{s.push({from:e,to:t})}));else{const{from:e,to:t}=r[i];if(void 0===e||void 0===t)return;s.push({from:e,to:t})}s.forEach((({from:e,to:r})=>{const s=t.slice(i).map(e,-1),o=t.slice(i).map(r),a=t.invert().map(s,-1),l=t.invert().map(o);n.push({oldRange:{from:a,to:l},newRange:{from:s,to:o}})}))})),mo(n)}(a);return l.forEach((({newRange:t})=>{const r=function(e,t,r){const n=[];return e.nodesBetween(t.from,t.to,((e,t)=>{r(e)&&n.push({node:e,pos:t})})),n}(n.doc,t,(e=>e.isTextblock));let i,s;if(r.length>1?(i=r[0],s=n.doc.textBetween(i.pos,i.pos+i.node.nodeSize,void 0," ")):r.length&&n.doc.textBetween(t.from,t.to," "," ").endsWith(" ")&&(i=r[0],s=n.doc.textBetween(i.pos,t.to,void 0," ")),i&&s){const t=s.split(" ").filter((e=>""!==e));if(t.length<=0)return!1;const r=t[t.length-1],a=i.pos+s.lastIndexOf(r);if(!r)return!1;ju(r).filter((e=>e.isLink)).map((e=>({...e,from:a+e.start+1,to:a+e.end+1}))).filter((e=>!n.schema.marks.code||!n.doc.rangeHasMark(e.from,e.to,n.schema.marks.code))).filter((t=>!e.validate||e.validate(t.value))).forEach((t=>{go(t.from,t.to,n.doc).some((t=>t.mark.type===e.type))||o.addMark(t.from,t.to,e.type.create({href:t.href}))}))}})),o.steps.length?o:void 0}})}const qu=Fo.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach((e=>{"string"!=typeof e?Bu(e.scheme,e.optionalSlashes):Bu(e)}))},onDestroy(){gl.groups={},Pu.scanner=null,Pu.parser=null,Pu.tokenQueue=[],Pu.pluginQueue=[],Pu.customSchemes=[],Pu.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:'a[href]:not([href *= "javascript:" i])'}],renderHTML({HTMLAttributes:e}){return["a",Es(this.options.HTMLAttributes,e),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Bo({find:e=>ju(e).filter((e=>!this.options.validate||this.options.validate(e.value))).filter((e=>e.isLink)).map((e=>({text:e.value,index:e.start,data:e}))),type:this.type,getAttributes:(e,t)=>{var r,n;const i=null===(r=null==t?void 0:t.clipboardData)||void 0===r?void 0:r.getData("text/html"),s=null==i?void 0:i.match(/href="([^"]*)"/);return s?{href:s[1]}:{href:null===(n=e.data)||void 0===n?void 0:n.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(zu({type:this.type,validate:this.options.validate})),this.options.openOnClick&&e.push(function(e){return new ft({key:new gt("handleClickLink"),props:{handleClick:(t,r,n)=>{var i,s;if(0!==n.button)return!1;if("A"!==n.target.nodeName)return!1;const o=po(t.state,e.type.name),a=n.target,l=null!==(i=null==a?void 0:a.href)&&void 0!==i?i:o.href,u=null!==(s=null==a?void 0:a.target)&&void 0!==s?s:o.target;return!(!a||!l||(t.editable&&window.open(l,u),0))}}})}({type:this.type})),this.options.linkOnPaste&&e.push(function(e){return new ft({key:new gt("handlePasteLink"),props:{handlePaste:(t,r,n)=>{var i;const{state:s}=t,{selection:o}=s,{empty:a}=o;if(a)return!1;let l="";n.content.forEach((e=>{l+=e.textContent}));const u=ju(l).find((e=>e.isLink&&e.value===l));if(!l||!u)return!1;const c=null===(i=r.clipboardData)||void 0===i?void 0:i.getData("text/html"),d=null==c?void 0:c.match(/href="([^"]*)"/),h=d?d[1]:u.href;return e.editor.commands.setMark(e.type,{href:h}),!0}}})}({editor:this.editor,type:this.type})),e}});const Hu=new gt("suggestion");function Vu({pluginKey:e=Hu,editor:t,char:r="@",allowSpaces:n=!1,allowedPrefixes:i=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:a="suggestion",command:l=(()=>null),items:u=(()=>[]),render:c=(()=>({})),allow:d=(()=>!0)}){let h;const f=null==c?void 0:c(),p=new ft({key:e,view(){return{update:async(e,r)=>{var n,i,s,o,a,c,d;const p=null===(n=this.key)||void 0===n?void 0:n.getState(r),m=null===(i=this.key)||void 0===i?void 0:i.getState(e.state),g=p.active&&m.active&&p.range.from!==m.range.from,y=!p.active&&m.active,v=p.active&&!m.active,b=y||g,x=!y&&!v&&p.query!==m.query&&!g,w=v||g;if(!b&&!x&&!w)return;const E=w&&!b?p:m,S=e.dom.querySelector(`[data-decoration-id="${E.decorationId}"]`);h={editor:t,range:E.range,query:E.query,text:E.text,items:[],command:e=>{l({editor:t,range:E.range,props:e})},decorationNode:S,clientRect:S?()=>{var r;const{decorationId:n}=null===(r=this.key)||void 0===r?void 0:r.getState(t.state),i=e.dom.querySelector(`[data-decoration-id="${n}"]`);return(null==i?void 0:i.getBoundingClientRect())||null}:null},b&&(null===(s=null==f?void 0:f.onBeforeStart)||void 0===s||s.call(f,h)),x&&(null===(o=null==f?void 0:f.onBeforeUpdate)||void 0===o||o.call(f,h)),(x||b)&&(h.items=await u({editor:t,query:E.query})),w&&(null===(a=null==f?void 0:f.onExit)||void 0===a||a.call(f,h)),x&&(null===(c=null==f?void 0:f.onUpdate)||void 0===c||c.call(f,h)),b&&(null===(d=null==f?void 0:f.onStart)||void 0===d||d.call(f,h))},destroy:()=>{var e;h&&(null===(e=null==f?void 0:f.onExit)||void 0===e||e.call(f,h))}}},state:{init:()=>({active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}),apply(e,o,a,l){const{isEditable:u}=t,{composing:c}=t.view,{selection:h}=e,{empty:f,from:p}=h,m={...o};if(m.composing=c,u&&(f||t.view.composing)){!(p<o.range.from||p>o.range.to)||c||o.composing||(m.active=!1);const e=function(e){var t;const{char:r,allowSpaces:n,allowedPrefixes:i,startOfLine:s,$position:o}=e,a=r.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),l=new RegExp(`\\s${a}$`),u=s?"^":"",c=n?new RegExp(`${u}${a}.*?(?=\\s${a}|$)`,"gm"):new RegExp(`${u}(?:^)?${a}[^\\s${a}]*`,"gm"),d=(null===(t=o.nodeBefore)||void 0===t?void 0:t.isText)&&o.nodeBefore.text;if(!d)return null;const h=o.pos-d.length,f=Array.from(d.matchAll(c)).pop();if(!f||void 0===f.input||void 0===f.index)return null;const p=f.input.slice(Math.max(0,f.index-1),f.index),m=new RegExp(`^[${null==i?void 0:i.join("")}\0]?$`).test(p);if(null!==i&&!m)return null;const g=h+f.index;let y=g+f[0].length;return n&&l.test(d.slice(y-1,y+1))&&(f[0]+=" ",y+=1),g<o.pos&&y>=o.pos?{range:{from:g,to:y},query:f[0].slice(r.length),text:f[0]}:null}({char:r,allowSpaces:n,allowedPrefixes:i,startOfLine:s,$position:h.$from}),a=`id_${Math.floor(4294967295*Math.random())}`;e&&d({editor:t,state:l,range:e.range})?(m.active=!0,m.decorationId=o.decorationId?o.decorationId:a,m.range=e.range,m.query=e.query,m.text=e.text):m.active=!1}else m.active=!1;return m.active||(m.decorationId=null,m.range={from:0,to:0},m.query=null,m.text=null),m}},props:{handleKeyDown(e,t){var r;const{active:n,range:i}=p.getState(e.state);return n&&(null===(r=null==f?void 0:f.onKeyDown)||void 0===r?void 0:r.call(f,{view:e,event:t,range:i}))||!1},decorations(e){const{active:t,range:r,decorationId:n}=p.getState(e);return t?ei.create(e.doc,[Zn.inline(r.from,r.to,{nodeName:o,class:a,"data-decoration-id":n})]):null}}});return p}function Gu(e){return Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gu(e)}function Wu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ku(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wu(Object(r),!0).forEach((function(t){Yu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Yu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Gu(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Gu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Gu(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ju=qs.create({name:"commands",addOptions:function(){return{suggestion:{char:"/",command:function(e){var t=e.editor,r=e.range;e.props.command({editor:t,range:r})}}}},addProseMirrorPlugins:function(){return[Vu(Ku({editor:this.editor},this.options.suggestion))]}});function Zu(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Xu(e){return e instanceof Zu(e).Element||e instanceof Element}function Qu(e){return e instanceof Zu(e).HTMLElement||e instanceof HTMLElement}function ec(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Zu(e).ShadowRoot||e instanceof ShadowRoot)}var tc=Math.max,rc=Math.min,nc=Math.round;function ic(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function sc(){return!/^((?!chrome|android).)*safari/i.test(ic())}function oc(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),i=1,s=1;t&&Qu(e)&&(i=e.offsetWidth>0&&nc(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&nc(n.height)/e.offsetHeight||1);var o=(Xu(e)?Zu(e):window).visualViewport,a=!sc()&&r,l=(n.left+(a&&o?o.offsetLeft:0))/i,u=(n.top+(a&&o?o.offsetTop:0))/s,c=n.width/i,d=n.height/s;return{width:c,height:d,top:u,right:l+c,bottom:u+d,left:l,x:l,y:u}}function ac(e){var t=Zu(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function lc(e){return e?(e.nodeName||"").toLowerCase():null}function uc(e){return((Xu(e)?e.ownerDocument:e.document)||window.document).documentElement}function cc(e){return oc(uc(e)).left+ac(e).scrollLeft}function dc(e){return Zu(e).getComputedStyle(e)}function hc(e){var t=dc(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function fc(e,t,r){void 0===r&&(r=!1);var n,i,s=Qu(t),o=Qu(t)&&function(e){var t=e.getBoundingClientRect(),r=nc(t.width)/e.offsetWidth||1,n=nc(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),a=uc(t),l=oc(e,o,r),u={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!r)&&(("body"!==lc(t)||hc(a))&&(u=(n=t)!==Zu(n)&&Qu(n)?{scrollLeft:(i=n).scrollLeft,scrollTop:i.scrollTop}:ac(n)),Qu(t)?((c=oc(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):a&&(c.x=cc(a))),{x:l.left+u.scrollLeft-c.x,y:l.top+u.scrollTop-c.y,width:l.width,height:l.height}}function pc(e){var t=oc(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function mc(e){return"html"===lc(e)?e:e.assignedSlot||e.parentNode||(ec(e)?e.host:null)||uc(e)}function gc(e){return["html","body","#document"].indexOf(lc(e))>=0?e.ownerDocument.body:Qu(e)&&hc(e)?e:gc(mc(e))}function yc(e,t){var r;void 0===t&&(t=[]);var n=gc(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),s=Zu(n),o=i?[s].concat(s.visualViewport||[],hc(n)?n:[]):n,a=t.concat(o);return i?a:a.concat(yc(mc(o)))}function vc(e){return["table","td","th"].indexOf(lc(e))>=0}function bc(e){return Qu(e)&&"fixed"!==dc(e).position?e.offsetParent:null}function xc(e){for(var t=Zu(e),r=bc(e);r&&vc(r)&&"static"===dc(r).position;)r=bc(r);return r&&("html"===lc(r)||"body"===lc(r)&&"static"===dc(r).position)?t:r||function(e){var t=/firefox/i.test(ic());if(/Trident/i.test(ic())&&Qu(e)&&"fixed"===dc(e).position)return null;var r=mc(e);for(ec(r)&&(r=r.host);Qu(r)&&["html","body"].indexOf(lc(r))<0;){var n=dc(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var wc="top",Ec="bottom",Sc="right",Tc="left",Ac="auto",Dc=[wc,Ec,Sc,Tc],Nc="start",Cc="end",kc="clippingParents",Mc="viewport",Oc="popper",_c="reference",Lc=Dc.reduce((function(e,t){return e.concat([t+"-"+Nc,t+"-"+Cc])}),[]),Rc=[].concat(Dc,[Ac]).reduce((function(e,t){return e.concat([t,t+"-"+Nc,t+"-"+Cc])}),[]),Ic=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Fc(e){var t=new Map,r=new Set,n=[];function i(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&i(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||i(e)})),n}var Pc={placement:"bottom",modifiers:[],strategy:"absolute"};function Bc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Uc(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,i=t.defaultOptions,s=void 0===i?Pc:i;return function(e,t,r){void 0===r&&(r=s);var i,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pc,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],u=!1,c={state:a,setOptions:function(r){var i="function"==typeof r?r(a.options):r;d(),a.options=Object.assign({},s,a.options,i),a.scrollParents={reference:Xu(e)?yc(e):e.contextElement?yc(e.contextElement):[],popper:yc(t)};var o=function(e){var t=Fc(e);return Ic.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}(function(e){var t=e.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(n,a.options.modifiers)));return a.orderedModifiers=o.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,i=e.effect;if("function"==typeof i){var s=i({state:a,name:t,instance:c,options:n}),o=function(){};l.push(s||o)}})),c.update()},forceUpdate:function(){if(!u){var e=a.elements,t=e.reference,r=e.popper;if(Bc(t,r)){a.rects={reference:fc(t,xc(r),"fixed"===a.options.strategy),popper:pc(r)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var i=a.orderedModifiers[n],s=i.fn,o=i.options,l=void 0===o?{}:o,d=i.name;"function"==typeof s&&(a=s({state:a,options:l,name:d,instance:c})||a)}else a.reset=!1,n=-1}}},update:(i=function(){return new Promise((function(e){c.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(i())}))}))),o}),destroy:function(){d(),u=!0}};if(!Bc(e,t))return c;function d(){l.forEach((function(e){return e()})),l=[]}return c.setOptions(r).then((function(e){!u&&r.onFirstUpdate&&r.onFirstUpdate(e)})),c}}var $c={passive:!0};const jc={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,s=void 0===i||i,o=n.resize,a=void 0===o||o,l=Zu(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&u.forEach((function(e){e.addEventListener("scroll",r.update,$c)})),a&&l.addEventListener("resize",r.update,$c),function(){s&&u.forEach((function(e){e.removeEventListener("scroll",r.update,$c)})),a&&l.removeEventListener("resize",r.update,$c)}},data:{}};function zc(e){return e.split("-")[0]}function qc(e){return e.split("-")[1]}function Hc(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Vc(e){var t,r=e.reference,n=e.element,i=e.placement,s=i?zc(i):null,o=i?qc(i):null,a=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(s){case wc:t={x:a,y:r.y-n.height};break;case Ec:t={x:a,y:r.y+r.height};break;case Sc:t={x:r.x+r.width,y:l};break;case Tc:t={x:r.x-n.width,y:l};break;default:t={x:r.x,y:r.y}}var u=s?Hc(s):null;if(null!=u){var c="y"===u?"height":"width";switch(o){case Nc:t[u]=t[u]-(r[c]/2-n[c]/2);break;case Cc:t[u]=t[u]+(r[c]/2-n[c]/2)}}return t}var Gc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Wc(e){var t,r=e.popper,n=e.popperRect,i=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,h=o.x,f=void 0===h?0:h,p=o.y,m=void 0===p?0:p,g="function"==typeof c?c({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var y=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),b=Tc,x=wc,w=window;if(u){var E=xc(r),S="clientHeight",T="clientWidth";if(E===Zu(r)&&"static"!==dc(E=uc(r)).position&&"absolute"===a&&(S="scrollHeight",T="scrollWidth"),i===wc||(i===Tc||i===Sc)&&s===Cc)x=Ec,m-=(d&&E===w&&w.visualViewport?w.visualViewport.height:E[S])-n.height,m*=l?1:-1;if(i===Tc||(i===wc||i===Ec)&&s===Cc)b=Sc,f-=(d&&E===w&&w.visualViewport?w.visualViewport.width:E[T])-n.width,f*=l?1:-1}var A,D=Object.assign({position:a},u&&Gc),N=!0===c?function(e,t){var r=e.x,n=e.y,i=t.devicePixelRatio||1;return{x:nc(r*i)/i||0,y:nc(n*i)/i||0}}({x:f,y:m},Zu(r)):{x:f,y:m};return f=N.x,m=N.y,l?Object.assign({},D,((A={})[x]=v?"0":"",A[b]=y?"0":"",A.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",A)):Object.assign({},D,((t={})[x]=v?m+"px":"",t[b]=y?f+"px":"",t.transform="",t))}const Kc={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=void 0===n||n,s=r.adaptive,o=void 0===s||s,a=r.roundOffsets,l=void 0===a||a,u={placement:zc(t.placement),variation:qc(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Wc(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Wc(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};const Yc={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},i=t.elements[e];Qu(i)&&lc(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],i=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});Qu(n)&&lc(n)&&(Object.assign(n.style,s),Object.keys(i).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};const Jc={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.offset,s=void 0===i?[0,0]:i,o=Rc.reduce((function(e,r){return e[r]=function(e,t,r){var n=zc(e),i=[Tc,wc].indexOf(n)>=0?-1:1,s="function"==typeof r?r(Object.assign({},t,{placement:e})):r,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[Tc,Sc].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(r,t.rects,s),e}),{}),a=o[t.placement],l=a.x,u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=o}};var Zc={left:"right",right:"left",bottom:"top",top:"bottom"};function Xc(e){return e.replace(/left|right|bottom|top/g,(function(e){return Zc[e]}))}var Qc={start:"end",end:"start"};function ed(e){return e.replace(/start|end/g,(function(e){return Qc[e]}))}function td(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&ec(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function rd(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function nd(e,t,r){return t===Mc?rd(function(e,t){var r=Zu(e),n=uc(e),i=r.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var u=sc();(u||!u&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+cc(e),y:l}}(e,r)):Xu(t)?function(e,t){var r=oc(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):rd(function(e){var t,r=uc(e),n=ac(e),i=null==(t=e.ownerDocument)?void 0:t.body,s=tc(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=tc(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-n.scrollLeft+cc(e),l=-n.scrollTop;return"rtl"===dc(i||r).direction&&(a+=tc(r.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(uc(e)))}function id(e,t,r,n){var i="clippingParents"===t?function(e){var t=yc(mc(e)),r=["absolute","fixed"].indexOf(dc(e).position)>=0&&Qu(e)?xc(e):e;return Xu(r)?t.filter((function(e){return Xu(e)&&td(e,r)&&"body"!==lc(e)})):[]}(e):[].concat(t),s=[].concat(i,[r]),o=s[0],a=s.reduce((function(t,r){var i=nd(e,r,n);return t.top=tc(i.top,t.top),t.right=rc(i.right,t.right),t.bottom=rc(i.bottom,t.bottom),t.left=tc(i.left,t.left),t}),nd(e,o,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function sd(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function od(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function ad(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=void 0===n?e.placement:n,s=r.strategy,o=void 0===s?e.strategy:s,a=r.boundary,l=void 0===a?kc:a,u=r.rootBoundary,c=void 0===u?Mc:u,d=r.elementContext,h=void 0===d?Oc:d,f=r.altBoundary,p=void 0!==f&&f,m=r.padding,g=void 0===m?0:m,y=sd("number"!=typeof g?g:od(g,Dc)),v=h===Oc?_c:Oc,b=e.rects.popper,x=e.elements[p?v:h],w=id(Xu(x)?x:x.contextElement||uc(e.elements.popper),l,c,o),E=oc(e.elements.reference),S=Vc({reference:E,element:b,strategy:"absolute",placement:i}),T=rd(Object.assign({},b,S)),A=h===Oc?T:E,D={top:w.top-A.top+y.top,bottom:A.bottom-w.bottom+y.bottom,left:w.left-A.left+y.left,right:A.right-w.right+y.right},N=e.modifiersData.offset;if(h===Oc&&N){var C=N[i];Object.keys(D).forEach((function(e){var t=[Sc,Ec].indexOf(e)>=0?1:-1,r=[wc,Ec].indexOf(e)>=0?"y":"x";D[e]+=C[r]*t}))}return D}const ld={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,s=void 0===i||i,o=r.altAxis,a=void 0===o||o,l=r.fallbackPlacements,u=r.padding,c=r.boundary,d=r.rootBoundary,h=r.altBoundary,f=r.flipVariations,p=void 0===f||f,m=r.allowedAutoPlacements,g=t.options.placement,y=zc(g),v=l||(y===g||!p?[Xc(g)]:function(e){if(zc(e)===Ac)return[];var t=Xc(e);return[ed(e),t,ed(t)]}(g)),b=[g].concat(v).reduce((function(e,r){return e.concat(zc(r)===Ac?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=r.boundary,s=r.rootBoundary,o=r.padding,a=r.flipVariations,l=r.allowedAutoPlacements,u=void 0===l?Rc:l,c=qc(n),d=c?a?Lc:Lc.filter((function(e){return qc(e)===c})):Dc,h=d.filter((function(e){return u.indexOf(e)>=0}));0===h.length&&(h=d);var f=h.reduce((function(t,r){return t[r]=ad(e,{placement:r,boundary:i,rootBoundary:s,padding:o})[zc(r)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:r,boundary:c,rootBoundary:d,padding:u,flipVariations:p,allowedAutoPlacements:m}):r)}),[]),x=t.rects.reference,w=t.rects.popper,E=new Map,S=!0,T=b[0],A=0;A<b.length;A++){var D=b[A],N=zc(D),C=qc(D)===Nc,k=[wc,Ec].indexOf(N)>=0,M=k?"width":"height",O=ad(t,{placement:D,boundary:c,rootBoundary:d,altBoundary:h,padding:u}),_=k?C?Sc:Tc:C?Ec:wc;x[M]>w[M]&&(_=Xc(_));var L=Xc(_),R=[];if(s&&R.push(O[N]<=0),a&&R.push(O[_]<=0,O[L]<=0),R.every((function(e){return e}))){T=D,S=!1;break}E.set(D,R)}if(S)for(var I=function(e){var t=b.find((function(t){var r=E.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return T=t,"break"},F=p?3:1;F>0;F--){if("break"===I(F))break}t.placement!==T&&(t.modifiersData[n]._skip=!0,t.placement=T,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ud(e,t,r){return tc(e,rc(t,r))}const cd={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,s=void 0===i||i,o=r.altAxis,a=void 0!==o&&o,l=r.boundary,u=r.rootBoundary,c=r.altBoundary,d=r.padding,h=r.tether,f=void 0===h||h,p=r.tetherOffset,m=void 0===p?0:p,g=ad(t,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),y=zc(t.placement),v=qc(t.placement),b=!v,x=Hc(y),w="x"===x?"y":"x",E=t.modifiersData.popperOffsets,S=t.rects.reference,T=t.rects.popper,A="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,D="number"==typeof A?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),N=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,C={x:0,y:0};if(E){if(s){var k,M="y"===x?wc:Tc,O="y"===x?Ec:Sc,_="y"===x?"height":"width",L=E[x],R=L+g[M],I=L-g[O],F=f?-T[_]/2:0,P=v===Nc?S[_]:T[_],B=v===Nc?-T[_]:-S[_],U=t.elements.arrow,$=f&&U?pc(U):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=j[M],q=j[O],H=ud(0,S[_],$[_]),V=b?S[_]/2-F-H-z-D.mainAxis:P-H-z-D.mainAxis,G=b?-S[_]/2+F+H+q+D.mainAxis:B+H+q+D.mainAxis,W=t.elements.arrow&&xc(t.elements.arrow),K=W?"y"===x?W.clientTop||0:W.clientLeft||0:0,Y=null!=(k=null==N?void 0:N[x])?k:0,J=L+G-Y,Z=ud(f?rc(R,L+V-Y-K):R,L,f?tc(I,J):I);E[x]=Z,C[x]=Z-L}if(a){var X,Q="x"===x?wc:Tc,ee="x"===x?Ec:Sc,te=E[w],re="y"===w?"height":"width",ne=te+g[Q],ie=te-g[ee],se=-1!==[wc,Tc].indexOf(y),oe=null!=(X=null==N?void 0:N[w])?X:0,ae=se?ne:te-S[re]-T[re]-oe+D.altAxis,le=se?te+S[re]+T[re]-oe-D.altAxis:ie,ue=f&&se?function(e,t,r){var n=ud(e,t,r);return n>r?r:n}(ae,te,le):ud(f?ae:ne,te,f?le:ie);E[w]=ue,C[w]=ue-te}t.modifiersData[n]=C}},requiresIfExists:["offset"]};const dd={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,i=e.options,s=r.elements.arrow,o=r.modifiersData.popperOffsets,a=zc(r.placement),l=Hc(a),u=[Tc,Sc].indexOf(a)>=0?"height":"width";if(s&&o){var c=function(e,t){return sd("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:od(e,Dc))}(i.padding,r),d=pc(s),h="y"===l?wc:Tc,f="y"===l?Ec:Sc,p=r.rects.reference[u]+r.rects.reference[l]-o[l]-r.rects.popper[u],m=o[l]-r.rects.reference[l],g=xc(s),y=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=p/2-m/2,b=c[h],x=y-d[u]-c[f],w=y/2-d[u]/2+v,E=ud(b,w,x),S=l;r.modifiersData[n]=((t={})[S]=E,t.centerOffset=E-w,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&td(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function hd(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function fd(e){return[wc,Sc,Ec,Tc].some((function(t){return e[t]>=0}))}var pd=Uc({defaultModifiers:[jc,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=Vc({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Kc,Yc,Jc,ld,cd,dd,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,o=ad(t,{elementContext:"reference"}),a=ad(t,{altBoundary:!0}),l=hd(o,n),u=hd(a,i,s),c=fd(l),d=fd(u);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}}]}),md="tippy-content",gd="tippy-backdrop",yd="tippy-arrow",vd="tippy-svg-arrow",bd={passive:!0,capture:!0},xd=function(){return document.body};function wd(e,t,r){if(Array.isArray(e)){var n=e[t];return null==n?Array.isArray(r)?r[t]:r:n}return e}function Ed(e,t){var r={}.toString.call(e);return 0===r.indexOf("[object")&&r.indexOf(t+"]")>-1}function Sd(e,t){return"function"==typeof e?e.apply(void 0,t):e}function Td(e,t){return 0===t?e:function(n){clearTimeout(r),r=setTimeout((function(){e(n)}),t)};var r}function Ad(e){return[].concat(e)}function Dd(e,t){-1===e.indexOf(t)&&e.push(t)}function Nd(e){return e.split("-")[0]}function Cd(e){return[].slice.call(e)}function kd(e){return Object.keys(e).reduce((function(t,r){return void 0!==e[r]&&(t[r]=e[r]),t}),{})}function Md(){return document.createElement("div")}function Od(e){return["Element","Fragment"].some((function(t){return Ed(e,t)}))}function _d(e){return Ed(e,"MouseEvent")}function Ld(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function Rd(e){return Od(e)?[e]:function(e){return Ed(e,"NodeList")}(e)?Cd(e):Array.isArray(e)?e:Cd(document.querySelectorAll(e))}function Id(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function Fd(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function Pd(e){var t,r=Ad(e)[0];return null!=r&&null!=(t=r.ownerDocument)&&t.body?r.ownerDocument:document}function Bd(e,t,r){var n=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[n](t,r)}))}function Ud(e,t){for(var r=t;r;){var n;if(e.contains(r))return!0;r=null==r.getRootNode||null==(n=r.getRootNode())?void 0:n.host}return!1}var $d={isTouch:!1},jd=0;function zd(){$d.isTouch||($d.isTouch=!0,window.performance&&document.addEventListener("mousemove",qd))}function qd(){var e=performance.now();e-jd<20&&($d.isTouch=!1,document.removeEventListener("mousemove",qd)),jd=e}function Hd(){var e=document.activeElement;if(Ld(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var Vd=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;var Gd={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Wd=Object.assign({appendTo:xd,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Gd,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Kd=Object.keys(Wd);function Yd(e){var t=(e.plugins||[]).reduce((function(t,r){var n,i=r.name,s=r.defaultValue;i&&(t[i]=void 0!==e[i]?e[i]:null!=(n=Wd[i])?n:s);return t}),{});return Object.assign({},e,t)}function Jd(e,t){var r=Object.assign({},t,{content:Sd(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(Yd(Object.assign({},Wd,{plugins:t}))):Kd).reduce((function(t,r){var n=(e.getAttribute("data-tippy-"+r)||"").trim();if(!n)return t;if("content"===r)t[r]=n;else try{t[r]=JSON.parse(n)}catch(e){t[r]=n}return t}),{})}(e,t.plugins));return r.aria=Object.assign({},Wd.aria,r.aria),r.aria={expanded:"auto"===r.aria.expanded?t.interactive:r.aria.expanded,content:"auto"===r.aria.content?t.interactive?null:"describedby":r.aria.content},r}var Zd=function(){return"innerHTML"};function Xd(e,t){e[Zd()]=t}function Qd(e){var t=Md();return!0===e?t.className=yd:(t.className=vd,Od(e)?t.appendChild(e):Xd(t,e)),t}function eh(e,t){Od(t.content)?(Xd(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?Xd(e,t.content):e.textContent=t.content)}function th(e){var t=e.firstElementChild,r=Cd(t.children);return{box:t,content:r.find((function(e){return e.classList.contains(md)})),arrow:r.find((function(e){return e.classList.contains(yd)||e.classList.contains(vd)})),backdrop:r.find((function(e){return e.classList.contains(gd)}))}}function rh(e){var t=Md(),r=Md();r.className="tippy-box",r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Md();function i(r,n){var i=th(t),s=i.box,o=i.content,a=i.arrow;n.theme?s.setAttribute("data-theme",n.theme):s.removeAttribute("data-theme"),"string"==typeof n.animation?s.setAttribute("data-animation",n.animation):s.removeAttribute("data-animation"),n.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"==typeof n.maxWidth?n.maxWidth+"px":n.maxWidth,n.role?s.setAttribute("role",n.role):s.removeAttribute("role"),r.content===n.content&&r.allowHTML===n.allowHTML||eh(o,e.props),n.arrow?a?r.arrow!==n.arrow&&(s.removeChild(a),s.appendChild(Qd(n.arrow))):s.appendChild(Qd(n.arrow)):a&&s.removeChild(a)}return n.className=md,n.setAttribute("data-state","hidden"),eh(n,e.props),t.appendChild(r),r.appendChild(n),i(e.props,e.props),{popper:t,onUpdate:i}}rh.$$tippy=!0;var nh=1,ih=[],sh=[];function oh(e,t){var r,n,i,s,o,a,l,u,c=Jd(e,Object.assign({},Wd,Yd(kd(t)))),d=!1,h=!1,f=!1,p=!1,m=[],g=Td(W,c.interactiveDebounce),y=nh++,v=(u=c.plugins).filter((function(e,t){return u.indexOf(e)===t})),b={id:y,reference:e,popper:Md(),popperInstance:null,props:c,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(n),cancelAnimationFrame(i)},setProps:function(t){0;if(b.state.isDestroyed)return;L("onBeforeUpdate",[b,t]),V();var r=b.props,n=Jd(e,Object.assign({},r,kd(t),{ignoreAttributes:!0}));b.props=n,H(),r.interactiveDebounce!==n.interactiveDebounce&&(F(),g=Td(W,n.interactiveDebounce));r.triggerTarget&&!n.triggerTarget?Ad(r.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):n.triggerTarget&&e.removeAttribute("aria-expanded");I(),_(),E&&E(r,n);b.popperInstance&&(Z(),Q().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));L("onAfterUpdate",[b,t])},setContent:function(e){b.setProps({content:e})},show:function(){0;var e=b.state.isVisible,t=b.state.isDestroyed,r=!b.state.isEnabled,n=$d.isTouch&&!b.props.touch,i=wd(b.props.duration,0,Wd.duration);if(e||t||r||n)return;if(C().hasAttribute("disabled"))return;if(L("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,N()&&(w.style.visibility="visible");_(),$(),b.state.isMounted||(w.style.transition="none");if(N()){var s=M();Id([s.box,s.content],0)}a=function(){var e;if(b.state.isVisible&&!p){if(p=!0,w.offsetHeight,w.style.transition=b.props.moveTransition,N()&&b.props.animation){var t=M(),r=t.box,n=t.content;Id([r,n],i),Fd([r,n],"visible")}R(),I(),Dd(sh,b),null==(e=b.popperInstance)||e.forceUpdate(),L("onMount",[b]),b.props.animation&&N()&&function(e,t){z(e,t)}(i,(function(){b.state.isShown=!0,L("onShown",[b])}))}},function(){var e,t=b.props.appendTo,r=C();e=b.props.interactive&&t===xd||"parent"===t?r.parentNode:Sd(t,[r]);e.contains(w)||e.appendChild(w);b.state.isMounted=!0,Z(),!1}()},hide:function(){0;var e=!b.state.isVisible,t=b.state.isDestroyed,r=!b.state.isEnabled,n=wd(b.props.duration,1,Wd.duration);if(e||t||r)return;if(L("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,p=!1,d=!1,N()&&(w.style.visibility="hidden");if(F(),j(),_(!0),N()){var i=M(),s=i.box,o=i.content;b.props.animation&&(Id([s,o],n),Fd([s,o],"hidden"))}R(),I(),b.props.animation?N()&&function(e,t){z(e,(function(){!b.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&t()}))}(n,b.unmount):b.unmount()},hideWithInteractivity:function(e){0;k().addEventListener("mousemove",g),Dd(ih,g),g(e)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){0;b.state.isVisible&&b.hide();if(!b.state.isMounted)return;X(),Q().forEach((function(e){e._tippy.unmount()})),w.parentNode&&w.parentNode.removeChild(w);sh=sh.filter((function(e){return e!==b})),b.state.isMounted=!1,L("onHidden",[b])},destroy:function(){0;if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),V(),delete e._tippy,b.state.isDestroyed=!0,L("onDestroy",[b])}};if(!c.render)return b;var x=c.render(b),w=x.popper,E=x.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+b.id,b.popper=w,e._tippy=b,w._tippy=b;var S=v.map((function(e){return e.fn(b)})),T=e.hasAttribute("aria-expanded");return H(),I(),_(),L("onCreate",[b]),c.showOnCreate&&ee(),w.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),w.addEventListener("mouseleave",(function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&k().addEventListener("mousemove",g)})),b;function A(){var e=b.props.touch;return Array.isArray(e)?e:[e,0]}function D(){return"hold"===A()[0]}function N(){var e;return!(null==(e=b.props.render)||!e.$$tippy)}function C(){return l||e}function k(){var e=C().parentNode;return e?Pd(e):document}function M(){return th(w)}function O(e){return b.state.isMounted&&!b.state.isVisible||$d.isTouch||s&&"focus"===s.type?0:wd(b.props.delay,e?0:1,Wd.delay)}function _(e){void 0===e&&(e=!1),w.style.pointerEvents=b.props.interactive&&!e?"":"none",w.style.zIndex=""+b.props.zIndex}function L(e,t,r){var n;(void 0===r&&(r=!0),S.forEach((function(r){r[e]&&r[e].apply(r,t)})),r)&&(n=b.props)[e].apply(n,t)}function R(){var t=b.props.aria;if(t.content){var r="aria-"+t.content,n=w.id;Ad(b.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(r);if(b.state.isVisible)e.setAttribute(r,t?t+" "+n:n);else{var i=t&&t.replace(n,"").trim();i?e.setAttribute(r,i):e.removeAttribute(r)}}))}}function I(){!T&&b.props.aria.expanded&&Ad(b.props.triggerTarget||e).forEach((function(e){b.props.interactive?e.setAttribute("aria-expanded",b.state.isVisible&&e===C()?"true":"false"):e.removeAttribute("aria-expanded")}))}function F(){k().removeEventListener("mousemove",g),ih=ih.filter((function(e){return e!==g}))}function P(t){if(!$d.isTouch||!f&&"mousedown"!==t.type){var r=t.composedPath&&t.composedPath()[0]||t.target;if(!b.props.interactive||!Ud(w,r)){if(Ad(b.props.triggerTarget||e).some((function(e){return Ud(e,r)}))){if($d.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else L("onClickOutside",[b,t]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),h=!0,setTimeout((function(){h=!1})),b.state.isMounted||j())}}}function B(){f=!0}function U(){f=!1}function $(){var e=k();e.addEventListener("mousedown",P,!0),e.addEventListener("touchend",P,bd),e.addEventListener("touchstart",U,bd),e.addEventListener("touchmove",B,bd)}function j(){var e=k();e.removeEventListener("mousedown",P,!0),e.removeEventListener("touchend",P,bd),e.removeEventListener("touchstart",U,bd),e.removeEventListener("touchmove",B,bd)}function z(e,t){var r=M().box;function n(e){e.target===r&&(Bd(r,"remove",n),t())}if(0===e)return t();Bd(r,"remove",o),Bd(r,"add",n),o=n}function q(t,r,n){void 0===n&&(n=!1),Ad(b.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,r,n),m.push({node:e,eventType:t,handler:r,options:n})}))}function H(){var e;D()&&(q("touchstart",G,{passive:!0}),q("touchend",K,{passive:!0})),(e=b.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(q(e,G),e){case"mouseenter":q("mouseleave",K);break;case"focus":q(Vd?"focusout":"blur",Y);break;case"focusin":q("focusout",Y)}}))}function V(){m.forEach((function(e){var t=e.node,r=e.eventType,n=e.handler,i=e.options;t.removeEventListener(r,n,i)})),m=[]}function G(e){var t,r=!1;if(b.state.isEnabled&&!J(e)&&!h){var n="focus"===(null==(t=s)?void 0:t.type);s=e,l=e.currentTarget,I(),!b.state.isVisible&&_d(e)&&ih.forEach((function(t){return t(e)})),"click"===e.type&&(b.props.trigger.indexOf("mouseenter")<0||d)&&!1!==b.props.hideOnClick&&b.state.isVisible?r=!0:ee(e),"click"===e.type&&(d=!r),r&&!n&&te(e)}}function W(e){var t=e.target,r=C().contains(t)||w.contains(t);if("mousemove"!==e.type||!r){var n=Q().concat(w).map((function(e){var t,r=null==(t=e._tippy.popperInstance)?void 0:t.state;return r?{popperRect:e.getBoundingClientRect(),popperState:r,props:c}:null})).filter(Boolean);(function(e,t){var r=t.clientX,n=t.clientY;return e.every((function(e){var t=e.popperRect,i=e.popperState,s=e.props.interactiveBorder,o=Nd(i.placement),a=i.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,u="top"===o?a.bottom.y:0,c="right"===o?a.left.x:0,d="left"===o?a.right.x:0,h=t.top-n+l>s,f=n-t.bottom-u>s,p=t.left-r+c>s,m=r-t.right-d>s;return h||f||p||m}))})(n,e)&&(F(),te(e))}}function K(e){J(e)||b.props.trigger.indexOf("click")>=0&&d||(b.props.interactive?b.hideWithInteractivity(e):te(e))}function Y(e){b.props.trigger.indexOf("focusin")<0&&e.target!==C()||b.props.interactive&&e.relatedTarget&&w.contains(e.relatedTarget)||te(e)}function J(e){return!!$d.isTouch&&D()!==e.type.indexOf("touch")>=0}function Z(){X();var t=b.props,r=t.popperOptions,n=t.placement,i=t.offset,s=t.getReferenceClientRect,o=t.moveTransition,l=N()?th(w).arrow:null,u=s?{getBoundingClientRect:s,contextElement:s.contextElement||C()}:e,c={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(N()){var r=M().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?r.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?r.setAttribute("data-"+e,""):r.removeAttribute("data-"+e)})),t.attributes.popper={}}}},d=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!o}},c];N()&&l&&d.push({name:"arrow",options:{element:l,padding:3}}),d.push.apply(d,(null==r?void 0:r.modifiers)||[]),b.popperInstance=pd(u,w,Object.assign({},r,{placement:n,onFirstUpdate:a,modifiers:d}))}function X(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Q(){return Cd(w.querySelectorAll("[data-tippy-root]"))}function ee(e){b.clearDelayTimeouts(),e&&L("onTrigger",[b,e]),$();var t=O(!0),n=A(),i=n[0],s=n[1];$d.isTouch&&"hold"===i&&s&&(t=s),t?r=setTimeout((function(){b.show()}),t):b.show()}function te(e){if(b.clearDelayTimeouts(),L("onUntrigger",[b,e]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&d)){var t=O(!1);t?n=setTimeout((function(){b.state.isVisible&&b.hide()}),t):i=requestAnimationFrame((function(){b.hide()}))}}else j()}}function ah(e,t){void 0===t&&(t={});var r=Wd.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",zd,bd),window.addEventListener("blur",Hd);var n=Object.assign({},t,{plugins:r}),i=Rd(e).reduce((function(e,t){var r=t&&oh(t,n);return r&&e.push(r),e}),[]);return Od(e)?i[0]:i}ah.defaultProps=Wd,ah.setDefaultProps=function(e){Object.keys(e).forEach((function(t){Wd[t]=e[t]}))},ah.currentInput=$d;Object.assign({},Yc,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});ah.setDefaultProps({render:rh});const lh=ah;var uh=[{name:"h2",title:"Heading 2",inline:!0,basic:!1,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setNode("heading",{level:2}).run();n.toggleHeading({level:2}).run()}},{name:"h3",title:"Heading 3",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setNode("heading",{level:3}).run();n.toggleHeading({level:3}).run()}},{name:"h4",title:"Heading 4",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setNode("heading",{level:4}).run();n.toggleHeading({level:4}).run()}},{name:"bold",title:"Bold",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setMark("bold").run();n.toggleMark("bold").run()}},{name:"italic",title:"Italic",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setMark("italic").run();n.toggleItalic().run()}},{name:"strike",title:"Strikethrough",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setMark("strikethrough").run();n.toggleStrike().run()}},{name:"blockquote",title:"Blockquote",inline:!1,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setBlockquote("blockquote").run();n.toggleBlockquote().run()}},{name:"hr",title:"Horizontal Rule",inline:!1,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).setHorizontalRule("hr").run();n.setHorizontalRule("hr").run()}},{name:"ul",title:"Unordered List",inline:!1,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).toggleBulletList().run();n.toggleBulletList().run()}},{name:"ol",title:"Ordered List",inline:!1,command:function(e){var t=e.editor,r=e.range,n=t.chain().focus();if(r)return n.deleteRange(r).toggleOrderedList().run();n.toggleOrderedList().run()}},{name:"img",title:"Image",inline:!1,command:function(e){var t=e.editor,r=e.range,n=window.prompt("Enter the image URL");if(null!==n)return t.chain().focus().deleteRange(r).setImage({src:n,alt:"TODO"}).run()}},{name:"link",title:"Link",inline:!0,command:function(e){var t=e.editor,r=e.range,n=t.getAttributes("link").href,i=window.prompt("Enter your link URL",n);if(null!==i){var s=t.chain().focus();r&&s.deleteRange(r),""!==i?s.extendMarkRange("link").setLink({href:i}).run():s.extendMarkRange("link").unsetLink().run()}}},{name:"html",title:"HTML",inline:!1,basic:!1,command:function(e){var t=e.editor,r=e.range,n=window.prompt("Enter your HTML");null!==n&&(r&&t.chain().focus().deleteRange(r).run(),t.commands.insertContent(n))}}];function ch(e){return ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(e)}function dh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dh(Object(r),!0).forEach((function(t){fh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function fh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==ch(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ch(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ch(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ph(e){return function(e){if(Array.isArray(e))return mh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return mh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}class gh{constructor({editor:e,element:t,view:r,tippyOptions:n={},updateDelay:i=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:e,state:t,from:r,to:n})=>{const{doc:i,selection:s}=t,{empty:o}=s,a=!i.textBetween(r,n).length&&Xs(t.selection),l=this.element.contains(document.activeElement);return!(!e.hasFocus()&&!l||o||a||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout((()=>this.update(this.editor.view)))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.handleDebouncedUpdate=(e,t)=>{const r=!(null==t?void 0:t.selection.eq(e.state.selection)),n=!(null==t?void 0:t.doc.eq(e.state.doc));(r||n)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout((()=>{this.updateHandler(e,r,n,t)}),this.updateDelay))},this.updateHandler=(e,t,r,n)=>{var i,s,o;const{state:a,composing:l}=e,{selection:u}=a;if(l||!t&&!r)return;this.createTooltip();const{ranges:c}=u,d=Math.min(...c.map((e=>e.$from.pos))),h=Math.max(...c.map((e=>e.$to.pos)));(null===(i=this.shouldShow)||void 0===i?void 0:i.call(this,{editor:this.editor,view:e,state:a,oldState:n,from:d,to:h}))?(null===(s=this.tippy)||void 0===s||s.setProps({getReferenceClientRect:(null===(o=this.tippyOptions)||void 0===o?void 0:o.getReferenceClientRect)||(()=>{if(a.selection instanceof et){let t=e.nodeDOM(d);const r=t.dataset.nodeViewWrapper?t:t.querySelector("[data-node-view-wrapper]");if(r&&(t=r.firstChild),t)return t.getBoundingClientRect()}return function(e,t,r){const n=e.state.doc.content.size,i=Qs(t,0,n),s=Qs(r,0,n),o=e.coordsAtPos(i),a=e.coordsAtPos(s,-1),l=Math.min(o.top,a.top),u=Math.max(o.bottom,a.bottom),c=Math.min(o.left,a.left),d=Math.max(o.right,a.right),h={top:l,bottom:u,left:c,right:d,width:d-c,height:u-l,x:c,y:l};return{...h,toJSON:()=>h}}(e,d,h)})}),this.show()):this.hide()},this.editor=e,this.element=t,this.view=r,this.updateDelay=i,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=n,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;!this.tippy&&t&&(this.tippy=lh(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:r}=e,n=r.selection.$from.pos!==r.selection.$to.pos;if(this.updateDelay>0&&n)return void this.handleDebouncedUpdate(e,t);const i=!(null==t?void 0:t.selection.eq(e.state.selection)),s=!(null==t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,i,s,t)}show(){var e;null===(e=this.tippy)||void 0===e||e.show()}hide(){var e;null===(e=this.tippy)||void 0===e||e.hide()}destroy(){var e,t;(null===(e=this.tippy)||void 0===e?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const yh=e=>new ft({key:"string"==typeof e.pluginKey?new gt(e.pluginKey):e.pluginKey,view:t=>new gh({view:t,...e})}),vh=qs.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[yh({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});var bh=[{name:"Select Language",code:""},{name:"HTML",code:"html"},{name:"Edge",code:"edge"},{name:"CSS",code:"css"},{name:"JavaScript",code:"js"},{name:"ABAP",code:"abap"},{name:"Augmented Backus-Naur form",code:"abnf"},{name:"ActionScript",code:"actionscript"},{name:"Ada",code:"ada"},{name:"AL",code:"al"},{name:"ANTLR4",code:"antlr4"},{name:"Apache Configuration",code:"apacheconf"},{name:"APL",code:"apl"},{name:"AppleScript",code:"applescript"},{name:"AQL",code:"aql"},{name:"Arduino",code:"arduino"},{name:"ARFF",code:"arff"},{name:"AsciiDoc",code:"asciidoc"},{name:"6502 Assembly",code:"asm6502"},{name:"ASP.NET (C#)",code:"aspnet"},{name:"AutoHotkey",code:"autohotkey"},{name:"AutoIt",code:"autoit"},{name:"Bash",code:"bash"},{name:"BASIC",code:"basic"},{name:"Batch",code:"batch"},{name:"BBcode",code:"bbcode"},{name:"Bison",code:"bison"},{name:"Backus–Naur form",code:"bnf"},{name:"Brainfuck",code:"brainfuck"},{name:"BrightScript",code:"brightscript"},{name:"Bro",code:"bro"},{name:"C",code:"c"},{name:"Concurnas",code:"concurnas"},{name:"C#",code:"csharp"},{name:"C++",code:"cpp"},{name:"CIL",code:"cil"},{name:"CoffeeScript",code:"coffeescript"},{name:"CMake",code:"cmake"},{name:"Clojure",code:"clojure"},{name:"Crystal",code:"crystal"},{name:"Content-Security-Policy",code:"csp"},{name:"CSS Extras",code:"css-extras"},{name:"D",code:"d"},{name:"Dart",code:"dart"},{name:"DAX",code:"dax"},{name:"Diff",code:"diff"},{name:"DNS zone file",code:"dns-zone-file"},{name:"Docker",code:"docker"},{name:"Extended Backus–Naur form",code:"ebnf"},{name:"Eiffel",code:"eiffel"},{name:"EJS",code:"ejs"},{name:"Elixir",code:"elixir"},{name:"Elm",code:"elm"},{name:"Embedded Lua templating",code:"etlua"},{name:"ERB",code:"erb"},{name:"Erlang",code:"erlang"},{name:"Excel Formula",code:"xlsx"},{name:"F#",code:"fsharp"},{name:"Factor",code:"factor"},{name:"Firestore security rules",code:"firestore-security-rules"},{name:"Flow",code:"flow"},{name:"Fortran",code:"fortran"},{name:"FreeMarker Template Language",code:"ftl"},{name:"G-code",code:"gcode"},{name:"GDScript",code:"gdscript"},{name:"GEDCOM",code:"gedcom"},{name:"Gherkin",code:"gherkin"},{name:"Git",code:"git"},{name:"GLSL",code:"glsl"},{name:"GameMaker Language",code:"gml"},{name:"Go",code:"go"},{name:"GraphQL",code:"graphql"},{name:"Groovy",code:"groovy"},{name:"Haml",code:"haml"},{name:"Handlebars",code:"handlebars"},{name:"Haskell",code:"haskell"},{name:"Haxe",code:"haxe"},{name:"HCL",code:"hcl"},{name:"HLSL",code:"hlsl"},{name:"HTTP",code:"http"},{name:"HTTP Public-Key-Pins",code:"hpkp"},{name:"HTTP Strict-Transport-Security",code:"hsts"},{name:"IchigoJam",code:"ichigojam"},{name:"Icon",code:"icon"},{name:"Structured Text (IEC 61131-3)",code:"iecst"},{name:"Inform 7",code:"inform7"},{name:"Ini",code:"ini"},{name:"Io",code:"io"},{name:"J",code:"j"},{name:"Java",code:"java"},{name:"JavaDoc",code:"javadoc"},{name:"JavaDoc-like",code:"javadoclike"},{name:"Java stack trace",code:"javastacktrace"},{name:"Jinja2",code:"jinja2"},{name:"Jolie",code:"jolie"},{name:"JQ",code:"jq"},{name:"JSDoc",code:"jsdoc"},{name:"JS Extras",code:"js-extras"},{name:"JS Templates",code:"js-templates"},{name:"JSON",code:"json"},{name:"JSONP",code:"jsonp"},{name:"JSON5",code:"json5"},{name:"Julia",code:"julia"},{name:"Keyman",code:"keyman"},{name:"Kotlin",code:"kotlin"},{name:"LaTeX",code:"latex"},{name:"Latte",code:"latte"},{name:"Less",code:"less"},{name:"LilyPond",code:"lilypond"},{name:"Liquid",code:"liquid"},{name:"Lisp",code:"lisp"},{name:"LiveScript",code:"livescript"},{name:"LLVM IR",code:"llvm"},{name:"LOLCODE",code:"lolcode"},{name:"Lua",code:"lua"},{name:"Makefile",code:"makefile"},{name:"Markdown",code:"markdown"},{name:"Markup templating",code:"markup-templating"},{name:"MATLAB",code:"matlab"},{name:"MEL",code:"mel"},{name:"Mizar",code:"mizar"},{name:"Monkey",code:"monkey"},{name:"MoonScript",code:"moonscript"},{name:"N1QL",code:"n1ql"},{name:"N4JS",code:"n4js"},{name:"Nand To Tetris HDL",code:"nand2tetris-hdl"},{name:"NASM",code:"nasm"},{name:"NEON",code:"neon"},{name:"nginx",code:"nginx"},{name:"Nim",code:"nim"},{name:"Nix",code:"nix"},{name:"NSIS",code:"nsis"},{name:"Objective-C",code:"objectivec"},{name:"OCaml",code:"ocaml"},{name:"OpenCL",code:"opencl"},{name:"Oz",code:"oz"},{name:"PARI/GP",code:"parigp"},{name:"Parser",code:"parser"},{name:"Pascal",code:"pascal"},{name:"Pascaligo",code:"pascaligo"},{name:"PC-Axis",code:"pcaxis"},{name:"PeopleCode",code:"peoplecode"},{name:"Perl",code:"perl"},{name:"PHP",code:"php"},{name:"PHPDoc",code:"phpdoc"},{name:"PHP Extras",code:"php-extras"},{name:"PL/SQL",code:"plsql"},{name:"PowerQuery",code:"powerquery"},{name:"PowerShell",code:"powershell"},{name:"Processing",code:"processing"},{name:"Prolog",code:"prolog"},{name:".properties",code:"properties"},{name:"Protocol Buffers",code:"protobuf"},{name:"Pug",code:"pug"},{name:"Puppet",code:"puppet"},{name:"Pure",code:"pure"},{name:"PureBasic",code:"purebasic"},{name:"Python",code:"python"},{name:"Q (kdb+ database)",code:"q"},{name:"QML",code:"qml"},{name:"Qore",code:"qore"},{name:"R",code:"r"},{name:"Racket",code:"racket"},{name:"React JSX",code:"jsx"},{name:"React TSX",code:"tsx"},{name:"Ren'py",code:"renpy"},{name:"Reason",code:"reason"},{name:"Regex",code:"regex"},{name:"reST (reStructuredText)",code:"rest"},{name:"Rip",code:"rip"},{name:"Roboconf",code:"roboconf"},{name:"Robot Framework",code:"robotframework"},{name:"Ruby",code:"ruby"},{name:"Rust",code:"rust"},{name:"SAS",code:"sas"},{name:"Sass (Sass)",code:"sass"},{name:"Sass (Scss)",code:"scss"},{name:"Scala",code:"scala"},{name:"Scheme",code:"scheme"},{name:"Shell session",code:"shell-session"},{name:"Smalltalk",code:"smalltalk"},{name:"Smarty",code:"smarty"},{name:"Solidity (Ethereum)",code:"solidity"},{name:"Solution file",code:"solution-file"},{name:"Soy (Closure Template)",code:"soy"},{name:"SPARQL",code:"sparql"},{name:"Splunk SPL",code:"splunk-spl"},{name:"SQF: Status Quo Function (Arma 3)",code:"sqf"},{name:"SQL",code:"sql"},{name:"Stylus",code:"stylus"},{name:"Swift",code:"swift"},{name:"TAP",code:"tap"},{name:"Tcl",code:"tcl"},{name:"Textile",code:"textile"},{name:"TOML",code:"toml"},{name:"Template Toolkit 2",code:"tt2"},{name:"Turtle",code:"turtle"},{name:"Twig",code:"twig"},{name:"TypeScript",code:"typescript"},{name:"T4 Text Templates (C#)",code:"t4-cs"},{name:"T4 Text Templates (VB)",code:"t4-vb"},{name:"T4 templating",code:"t4-templating"},{name:"UnrealScript",code:"unrealscript"},{name:"Vala",code:"vala"},{name:"VB.Net",code:"vbnet"},{name:"Velocity",code:"velocity"},{name:"Verilog",code:"verilog"},{name:"VHDL",code:"vhdl"},{name:"vim",code:"vim"},{name:"Visual Basic",code:"visual-basic"},{name:"WarpScript",code:"warpscript"},{name:"WebAssembly",code:"wasm"},{name:"Wiki markup",code:"wiki"},{name:"Xeora",code:"xeora"},{name:"XML doc (.net)",code:"xml-doc"},{name:"Xojo (REALbasic)",code:"xojo"},{name:"XQuery",code:"xquery"},{name:"YAML",code:"yaml"},{name:"Zig",code:"zig"}];const xh=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,wh=Po.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",Es(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[_o({find:xh,type:this.type,getAttributes:e=>{const[,,t,r,n]=e;return{src:r,alt:t,title:n}}})]}}),Eh=qs.create({name:"typography",addInputRules(){const e=[];var t;return!1!==this.options.emDash&&e.push(Ro({find:/--$/,replace:null!=(t=this.options.emDash)?t:"—"})),!1!==this.options.ellipsis&&e.push((e=>Ro({find:/\.\.\.$/,replace:null!=e?e:"…"}))(this.options.ellipsis)),!1!==this.options.openDoubleQuote&&e.push((e=>Ro({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:null!=e?e:"“"}))(this.options.openDoubleQuote)),!1!==this.options.closeDoubleQuote&&e.push((e=>Ro({find:/"$/,replace:null!=e?e:"”"}))(this.options.closeDoubleQuote)),!1!==this.options.openSingleQuote&&e.push((e=>Ro({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:null!=e?e:"‘"}))(this.options.openSingleQuote)),!1!==this.options.closeSingleQuote&&e.push((e=>Ro({find:/'$/,replace:null!=e?e:"’"}))(this.options.closeSingleQuote)),!1!==this.options.leftArrow&&e.push((e=>Ro({find:/<-$/,replace:null!=e?e:"←"}))(this.options.leftArrow)),!1!==this.options.rightArrow&&e.push((e=>Ro({find:/->$/,replace:null!=e?e:"→"}))(this.options.rightArrow)),!1!==this.options.copyright&&e.push((e=>Ro({find:/\(c\)$/,replace:null!=e?e:"©"}))(this.options.copyright)),!1!==this.options.trademark&&e.push((e=>Ro({find:/\(tm\)$/,replace:null!=e?e:"™"}))(this.options.trademark)),!1!==this.options.servicemark&&e.push((e=>Ro({find:/\(sm\)$/,replace:null!=e?e:"℠"}))(this.options.servicemark)),!1!==this.options.registeredTrademark&&e.push((e=>Ro({find:/\(r\)$/,replace:null!=e?e:"®"}))(this.options.registeredTrademark)),!1!==this.options.oneHalf&&e.push((e=>Ro({find:/(?:^|\s)(1\/2)$/,replace:null!=e?e:"½"}))(this.options.oneHalf)),!1!==this.options.plusMinus&&e.push((e=>Ro({find:/\+\/-$/,replace:null!=e?e:"±"}))(this.options.plusMinus)),!1!==this.options.notEqual&&e.push((e=>Ro({find:/!=$/,replace:null!=e?e:"≠"}))(this.options.notEqual)),!1!==this.options.laquo&&e.push((e=>Ro({find:/<<$/,replace:null!=e?e:"«"}))(this.options.laquo)),!1!==this.options.raquo&&e.push((e=>Ro({find:/>>$/,replace:null!=e?e:"»"}))(this.options.raquo)),!1!==this.options.multiplication&&e.push((e=>Ro({find:/\d+\s?([*x])\s?\d+$/,replace:null!=e?e:"×"}))(this.options.multiplication)),!1!==this.options.superscriptTwo&&e.push((e=>Ro({find:/\^2$/,replace:null!=e?e:"²"}))(this.options.superscriptTwo)),!1!==this.options.superscriptThree&&e.push((e=>Ro({find:/\^3$/,replace:null!=e?e:"³"}))(this.options.superscriptThree)),!1!==this.options.oneQuarter&&e.push((e=>Ro({find:/(?:^|\s)(1\/4)$/,replace:null!=e?e:"¼"}))(this.options.oneQuarter)),!1!==this.options.threeQuarters&&e.push((e=>Ro({find:/(?:^|\s)(3\/4)$/,replace:null!=e?e:"¾"}))(this.options.threeQuarters)),e}});function Sh(e){return function(e){if(Array.isArray(e))return Th(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Th(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Th(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Th(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}window.setupEditor=function(e){var t;return{isInitialized:!1,isFocused:!1,content:e,updatedAt:Date.now(),language:"ts",languages:Sh(bh),isActive:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.isActive(e,r)},chain:function(){return t.chain()},command:function(e){return uh.find((function(t){return t.name===e})).command({editor:t})},init:function(e){var r,n,i,s=this;e&&(t=new Mo({element:e,extensions:[Qa,vh.configure({element:document.querySelector(".bubble-menu")}),el.configure({placeholder:"Type / to see available commands"}),qu.configure({autolink:!0,linkOnPaste:!0,HTMLAttributes:{target:"_blank",rel:"nofollow noopener noreferrer"}}),$o.configure({}),sa.configure({}),pa.configure({}),wh.configure({}),Eh.configure({openDoubleQuote:!1,closeDoubleQuote:!1,openSingleQuote:!1,closeSingleQuote:!1}),ta.configure({languageClassPrefix:"language-",HTMLAttributes:{class:"code-block"}}).extend({addNodeView:function(){return function(e){var t=document.createElement("div");t.classList.add("code-block","relative"),t.dataset.nodeViewWrapper="";var r=document.createElement("pre"),n=document.createElement("code");n.style="white-space: pre-wrap;",r.append(n),t.append(r);var i=document.createElement("select");return i.classList.add("absolute","top-1","right-1","rounded","text-xs","text-gray-200","bg-gray-900","border-gray-800","px-2","py-1"),i.contentEditable=!1,i.addEventListener("change",(function(t){var r=e.editor.view,n=t.target.value;r.dispatch(r.state.tr.setNodeMarkup(e.getPos(),void 0,{language:n}))})),bh.map((function(t){var r=document.createElement("option");r.value=t.code,r.textContent=t.name,r.selected=t.code===e.node.attrs.language,i.append(r)})),t.append(i),{dom:t,contentDOM:r}}}}),Ju.configure({suggestion:(r={isBasic:!0},n=r.isBasic,i=void 0===n||n,{items:function(e){var t=e.query;return ph(uh).filter((function(e){var r=e.title.toLowerCase().startsWith(t.toLowerCase()),n=e.name.toLowerCase().startsWith(t.toLowerCase());return(!i||!1!==e.basic)&&(r||n)}))},render:function(){var e,t,r,n=document.getElementById("context"),i=function(e,t){var r=new CustomEvent("mounted",{detail:{name:e,data:t}});n.dispatchEvent(r)},s=function(e,t,r){var i=new CustomEvent("call",{detail:{namespace:e,name:t,args:r}});n.dispatchEvent(i)};return{onStart:function(o){r={selectedIndex:0,items:(e=o).items,onClick:function(t){var r=this.items[t];r&&e.command(r)},onKeyDown:function(e){var t=e.event;return"ArrowUp"===t.key?(s("tiptapCommand","upHandler"),!0):"ArrowDown"===t.key?(s("tiptapCommand","downHandler"),!0):"Enter"===t.key&&(s("tiptapCommand","enterHandler"),!0)},upHandler:function(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler:function(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler:function(){this.onClick(this.selectedIndex)}},t=lh("body",{allowHTML:!0,getReferenceClientRect:e.clientRect,appendTo:function(){return n},content:'\n          <div class="items flex flex-col bg-slate-100 border border-slate-200 shadow-xl rounded-lg p-2">\n            <template x-for="(item, index) in state.tiptapCommand.items" :key="index">\n              <button class="item w-full pl-3 pr-12 rounded-lg text-left" :class="{ \'bg-brand-400\': state.tiptapCommand.selectedIndex === index }" @click="state.tiptapCommand.onClick(index)" class="block py-1">\n                <div class="title" class="text-left" x-text="item.title"></div>\n              </button>\n            </template>\n            <div x-show="!state.tiptapCommand.items.length" class="text-slate-600">\n              No results found\n            </div>\n          </div>\n        ',showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}),i("tiptapCommand",r)},onUpdate:function(n){e=n,r.selectedIndex=0,r.items=n.items,i("tiptapCommand",hh(hh({},r),n)),t[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown:function(e){return"Escape"===e.event.key?(t[0].hide(),!0):r.onKeyDown(e)},onExit:function(){t[0].destroy()}}}})})],content:this.content,onUpdate:function(e){var t=e.editor;s.content=t.getHTML()},onFocus:function(){s.isFocused=!0},onBlur:function(){s.isFocused=!1},onSelectionUpdate:function(){s.updatedAt=Date.now()}}),this.isInitialized=!0)}}}},76124:(e,t,r)=>{"use strict";if(r(87931),r(95654),r(67182),r.g._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");r.g._babelPolyfill=!0;function n(e,t,r){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:r})}n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(e){[][e]&&n(Array,e,Function.call.bind([][e]))}))},67182:(e,t,r)=>{r(54530),e.exports=r(48080).RegExp.escape},50666:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},98479:(e,t,r)=>{var n=r(42380);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=n(e))throw TypeError(t);return+e}},17296:(e,t,r)=>{var n=r(64410)("unscopables"),i=Array.prototype;null==i[n]&&r(74461)(i,n,{}),e.exports=function(e){i[n][e]=!0}},10990:(e,t,r)=>{"use strict";var n=r(25454)(!0);e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},30269:e=>{e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},85075:(e,t,r)=>{var n=r(49708);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},43697:(e,t,r)=>{"use strict";var n=r(16040),i=r(39519),s=r(15263);e.exports=[].copyWithin||function(e,t){var r=n(this),o=s(r.length),a=i(e,o),l=i(t,o),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?o:i(u,o))-l,o-a),d=1;for(l<a&&a<l+c&&(d=-1,l+=c-1,a+=c-1);c-- >0;)l in r?r[a]=r[l]:delete r[a],a+=d,l+=d;return r}},35572:(e,t,r)=>{"use strict";var n=r(16040),i=r(39519),s=r(15263);e.exports=function(e){for(var t=n(this),r=s(t.length),o=arguments.length,a=i(o>1?arguments[1]:void 0,r),l=o>2?arguments[2]:void 0,u=void 0===l?r:i(l,r);u>a;)t[a++]=e;return t}},59315:(e,t,r)=>{var n=r(74036);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},64513:(e,t,r)=>{var n=r(76282),i=r(15263),s=r(39519);e.exports=function(e){return function(t,r,o){var a,l=n(t),u=i(l.length),c=s(o,u);if(e&&r!=r){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}}},13635:(e,t,r)=>{var n=r(21550),i=r(75945),s=r(16040),o=r(15263),a=r(42143);e.exports=function(e,t){var r=1==e,l=2==e,u=3==e,c=4==e,d=6==e,h=5==e||d,f=t||a;return function(t,a,p){for(var m,g,y=s(t),v=i(y),b=n(a,p,3),x=o(v.length),w=0,E=r?f(t,x):l?f(t,0):void 0;x>w;w++)if((h||w in v)&&(g=b(m=v[w],w,y),e))if(r)E[w]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:E.push(m)}else if(c)return!1;return d?-1:u||c?c:E}}},56574:(e,t,r)=>{var n=r(50666),i=r(16040),s=r(75945),o=r(15263);e.exports=function(e,t,r,a,l){n(t);var u=i(e),c=s(u),d=o(u.length),h=l?d-1:0,f=l?-1:1;if(r<2)for(;;){if(h in c){a=c[h],h+=f;break}if(h+=f,l?h<0:d<=h)throw TypeError("Reduce of empty array with no initial value")}for(;l?h>=0:d>h;h+=f)h in c&&(a=t(a,c[h],h,u));return a}},80920:(e,t,r)=>{var n=r(49708),i=r(63623),s=r(64410)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?Array:t}},42143:(e,t,r)=>{var n=r(80920);e.exports=function(e,t){return new(n(e))(t)}},47240:(e,t,r)=>{"use strict";var n=r(50666),i=r(49708),s=r(31671),o=[].slice,a={};e.exports=Function.bind||function(e){var t=n(this),r=o.call(arguments,1),l=function(){var n=r.concat(o.call(arguments));return this instanceof l?function(e,t,r){if(!(t in a)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";a[t]=Function("F,a","return new F("+n.join(",")+")")}return a[t](e,r)}(t,n.length,n):s(t,n,e)};return i(t.prototype)&&(l.prototype=t.prototype),l}},96347:(e,t,r)=>{var n=r(42380),i=r(64410)("toStringTag"),s="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:s?n(t):"Object"==(o=n(t))&&"function"==typeof t.callee?"Arguments":o}},42380:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},37647:(e,t,r)=>{"use strict";var n=r(24213).f,i=r(6088),s=r(33227),o=r(21550),a=r(30269),l=r(74036),u=r(15706),c=r(34257),d=r(72373),h=r(83144),f=r(18648).fastKey,p=r(51554),m=h?"_s":"size",g=function(e,t){var r,n=f(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var c=e((function(e,n){a(e,c,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,null!=n&&l(n,r,e[u],e)}));return s(c.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var r=p(this,t),n=g(r,e);if(n){var i=n.n,s=n.p;delete r._i[n.i],n.r=!0,s&&(s.n=i),i&&(i.p=s),r._f==n&&(r._f=i),r._l==n&&(r._l=s),r[m]--}return!!n},forEach:function(e){p(this,t);for(var r,n=o(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(p(this,t),e)}}),h&&n(c.prototype,"size",{get:function(){return p(this,t)[m]}}),c},def:function(e,t,r){var n,i,s=g(e,t);return s?s.v=r:(e._l=s={i:i=f(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=s),n&&(n.n=s),e[m]++,"F"!==i&&(e._i[i]=s)),e},getEntry:g,setStrong:function(e,t,r){u(e,t,(function(e,r){this._t=p(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?c(0,"keys"==t?r.k:"values"==t?r.v:[r.k,r.v]):(e._t=void 0,c(1))}),r?"entries":"values",!r,!0),d(t)}}},72935:(e,t,r)=>{var n=r(96347),i=r(59315);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},78348:(e,t,r)=>{"use strict";var n=r(33227),i=r(18648).getWeak,s=r(85075),o=r(49708),a=r(30269),l=r(74036),u=r(13635),c=r(83050),d=r(51554),h=u(5),f=u(6),p=0,m=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},y=function(e,t){return h(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var r=y(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,s){var u=e((function(e,n){a(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=n&&l(n,r,e[s],e)}));return n(u.prototype,{delete:function(e){if(!o(e))return!1;var r=i(e);return!0===r?m(d(this,t)).delete(e):r&&c(r,this._i)&&delete r[this._i]},has:function(e){if(!o(e))return!1;var r=i(e);return!0===r?m(d(this,t)).has(e):r&&c(r,this._i)}}),u},def:function(e,t,r){var n=i(s(t),!0);return!0===n?m(e).set(t,r):n[e._i]=r,e},ufstore:m}},8107:(e,t,r)=>{"use strict";var n=r(24405),i=r(61693),s=r(69593),o=r(33227),a=r(18648),l=r(74036),u=r(30269),c=r(49708),d=r(10496),h=r(3229),f=r(25572),p=r(77856);e.exports=function(e,t,r,m,g,y){var v=n[e],b=v,x=g?"set":"add",w=b&&b.prototype,E={},S=function(e){var t=w[e];s(w,e,"delete"==e||"has"==e?function(e){return!(y&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof b&&(y||w.forEach&&!d((function(){(new b).entries().next()})))){var T=new b,A=T[x](y?{}:-0,1)!=T,D=d((function(){T.has(1)})),N=h((function(e){new b(e)})),C=!y&&d((function(){for(var e=new b,t=5;t--;)e[x](t,t);return!e.has(-0)}));N||((b=t((function(t,r){u(t,b,e);var n=p(new v,t,b);return null!=r&&l(r,g,n[x],n),n}))).prototype=w,w.constructor=b),(D||C)&&(S("delete"),S("has"),g&&S("get")),(C||A)&&S(x),y&&w.clear&&delete w.clear}else b=m.getConstructor(t,e,g,x),o(b.prototype,r),a.NEED=!0;return f(b,e),E[e]=b,i(i.G+i.W+i.F*(b!=v),E),y||m.setStrong(b,e,g),b}},48080:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},72559:(e,t,r)=>{"use strict";var n=r(24213),i=r(33388);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},21550:(e,t,r)=>{var n=r(50666);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},59496:(e,t,r)=>{"use strict";var n=r(10496),i=Date.prototype.getTime,s=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=n((function(){return"0385-07-25T07:06:39.999Z"!=s.call(new Date(-50000000000001))}))||!n((function(){s.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(r>99?r:"0"+o(r))+"Z"}:s},72967:(e,t,r)=>{"use strict";var n=r(85075),i=r(23825),s="number";e.exports=function(e){if("string"!==e&&e!==s&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),e!=s)}},91083:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},83144:(e,t,r)=>{e.exports=!r(10496)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},47339:(e,t,r)=>{var n=r(49708),i=r(24405).document,s=n(i)&&n(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},95985:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},86522:(e,t,r)=>{var n=r(31126),i=r(68910),s=r(2806);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var o,a=r(e),l=s.f,u=0;a.length>u;)l.call(e,o=a[u++])&&t.push(o);return t}},61693:(e,t,r)=>{var n=r(24405),i=r(48080),s=r(74461),o=r(69593),a=r(21550),l="prototype",u=function(e,t,r){var c,d,h,f,p=e&u.F,m=e&u.G,g=e&u.S,y=e&u.P,v=e&u.B,b=m?n:g?n[t]||(n[t]={}):(n[t]||{})[l],x=m?i:i[t]||(i[t]={}),w=x[l]||(x[l]={});for(c in m&&(r=t),r)h=((d=!p&&b&&void 0!==b[c])?b:r)[c],f=v&&d?a(h,n):y&&"function"==typeof h?a(Function.call,h):h,b&&o(b,c,h,e&u.U),x[c]!=h&&s(x,c,f),y&&w[c]!=h&&(w[c]=h)};n.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},90528:(e,t,r)=>{var n=r(64410)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},10496:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},87925:(e,t,r)=>{"use strict";r(47515);var n=r(69593),i=r(74461),s=r(10496),o=r(91083),a=r(64410),l=r(72562),u=a("species"),c=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var h=a(e),f=!s((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=f?!s((function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[u]=function(){return r}),r[h](""),!t})):void 0;if(!f||!p||"replace"===e&&!c||"split"===e&&!d){var m=/./[h],g=r(o,h,""[e],(function(e,t,r,n,i){return t.exec===l?f&&!i?{done:!0,value:m.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}})),y=g[0],v=g[1];n(String.prototype,e,y),i(RegExp.prototype,h,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},95660:(e,t,r)=>{"use strict";var n=r(85075);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},84225:(e,t,r)=>{"use strict";var n=r(63623),i=r(49708),s=r(15263),o=r(21550),a=r(64410)("isConcatSpreadable");e.exports=function e(t,r,l,u,c,d,h,f){for(var p,m,g=c,y=0,v=!!h&&o(h,f,3);y<u;){if(y in l){if(p=v?v(l[y],y,r):l[y],m=!1,i(p)&&(m=void 0!==(m=p[a])?!!m:n(p)),m&&d>0)g=e(t,r,p,s(p.length),g,d-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=p}g++}y++}return g}},74036:(e,t,r)=>{var n=r(21550),i=r(98226),s=r(92193),o=r(85075),a=r(15263),l=r(77521),u={},c={},d=e.exports=function(e,t,r,d,h){var f,p,m,g,y=h?function(){return e}:l(e),v=n(r,d,t?2:1),b=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(s(y)){for(f=a(e.length);f>b;b++)if((g=t?v(o(p=e[b])[0],p[1]):v(e[b]))===u||g===c)return g}else for(m=y.call(e);!(p=m.next()).done;)if((g=i(m,v,p.value,t))===u||g===c)return g};d.BREAK=u,d.RETURN=c},19769:(e,t,r)=>{e.exports=r(47104)("native-function-to-string",Function.toString)},24405:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},83050:e=>{var t={}.hasOwnProperty;e.exports=function(e,r){return t.call(e,r)}},74461:(e,t,r)=>{var n=r(24213),i=r(33388);e.exports=r(83144)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},17727:(e,t,r)=>{var n=r(24405).document;e.exports=n&&n.documentElement},80748:(e,t,r)=>{e.exports=!r(83144)&&!r(10496)((function(){return 7!=Object.defineProperty(r(47339)("div"),"a",{get:function(){return 7}}).a}))},77856:(e,t,r)=>{var n=r(49708),i=r(41794).set;e.exports=function(e,t,r){var s,o=t.constructor;return o!==r&&"function"==typeof o&&(s=o.prototype)!==r.prototype&&n(s)&&i&&i(e,s),e}},31671:e=>{e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},75945:(e,t,r)=>{var n=r(42380);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},92193:(e,t,r)=>{var n=r(47985),i=r(64410)("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||s[i]===e)}},63623:(e,t,r)=>{var n=r(42380);e.exports=Array.isArray||function(e){return"Array"==n(e)}},48645:(e,t,r)=>{var n=r(49708),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},49708:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},70939:(e,t,r)=>{var n=r(49708),i=r(42380),s=r(64410)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},98226:(e,t,r)=>{var n=r(85075);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var s=e.return;throw void 0!==s&&n(s.call(e)),t}}},39614:(e,t,r)=>{"use strict";var n=r(6088),i=r(33388),s=r(25572),o={};r(74461)(o,r(64410)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(o,{next:i(1,r)}),s(e,t+" Iterator")}},15706:(e,t,r)=>{"use strict";var n=r(14925),i=r(61693),s=r(69593),o=r(74461),a=r(47985),l=r(39614),u=r(25572),c=r(88539),d=r(64410)("iterator"),h=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};e.exports=function(e,t,r,g,y,v,b){l(r,t,g);var x,w,E,S=function(e){if(!h&&e in N)return N[e];switch(e){case f:case p:return function(){return new r(this,e)}}return function(){return new r(this,e)}},T=t+" Iterator",A=y==p,D=!1,N=e.prototype,C=N[d]||N["@@iterator"]||y&&N[y],k=C||S(y),M=y?A?S("entries"):k:void 0,O="Array"==t&&N.entries||C;if(O&&(E=c(O.call(new e)))!==Object.prototype&&E.next&&(u(E,T,!0),n||"function"==typeof E[d]||o(E,d,m)),A&&C&&C.name!==p&&(D=!0,k=function(){return C.call(this)}),n&&!b||!h&&!D&&N[d]||o(N,d,k),a[t]=k,a[T]=m,y)if(x={values:A?k:S(p),keys:v?k:S(f),entries:M},b)for(w in x)w in N||s(N,w,x[w]);else i(i.P+i.F*(h||D),t,x);return x}},3229:(e,t,r)=>{var n=r(64410)("iterator"),i=!1;try{var s=[7][n]();s.return=function(){i=!0},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var s=[7],o=s[n]();o.next=function(){return{done:r=!0}},s[n]=function(){return o},e(s)}catch(e){}return r}},34257:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},47985:e=>{e.exports={}},14925:e=>{e.exports=!1},98651:e=>{var t=Math.expm1;e.exports=!t||t(10)>22025.465794806718||t(10)<22025.465794806718||-2e-17!=t(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:t},88961:(e,t,r)=>{var n=r(19439),i=Math.pow,s=i(2,-52),o=i(2,-23),a=i(2,127)*(2-o),l=i(2,-126);e.exports=Math.fround||function(e){var t,r,i=Math.abs(e),u=n(e);return i<l?u*(i/l/o+1/s-1/s)*l*o:(r=(t=(1+o/s)*i)-(t-i))>a||r!=r?u*(1/0):u*r}},18738:e=>{e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},64917:e=>{e.exports=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n}},19439:e=>{e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},18648:(e,t,r)=>{var n=r(7767)("meta"),i=r(49708),s=r(83050),o=r(24213).f,a=0,l=Object.isExtensible||function(){return!0},u=!r(10496)((function(){return l(Object.preventExtensions({}))})),c=function(e){o(e,n,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,n)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[n].i},getWeak:function(e,t){if(!s(e,n)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[n].w},onFreeze:function(e){return u&&d.NEED&&l(e)&&!s(e,n)&&c(e),e}}},70380:(e,t,r)=>{var n=r(29164),i=r(61693),s=r(47104)("metadata"),o=s.store||(s.store=new(r(86189))),a=function(e,t,r){var i=o.get(e);if(!i){if(!r)return;o.set(e,i=new n)}var s=i.get(t);if(!s){if(!r)return;i.set(t,s=new n)}return s};e.exports={store:o,map:a,has:function(e,t,r){var n=a(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=a(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){a(r,n,!0).set(e,t)},keys:function(e,t){var r=a(e,t,!1),n=[];return r&&r.forEach((function(e,t){n.push(t)})),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){i(i.S,"Reflect",e)}}},32583:(e,t,r)=>{var n=r(24405),i=r(21597).set,s=n.MutationObserver||n.WebKitMutationObserver,o=n.process,a=n.Promise,l="process"==r(42380)(o);e.exports=function(){var e,t,r,u=function(){var n,i;for(l&&(n=o.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(l)r=function(){o.nextTick(u)};else if(!s||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);r=function(){c.then(u)}}else r=function(){i.call(n,u)};else{var d=!0,h=document.createTextNode("");new s(u).observe(h,{characterData:!0}),r=function(){h.data=d=!d}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},12219:(e,t,r)=>{"use strict";var n=r(50666);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},92075:(e,t,r)=>{"use strict";var n=r(83144),i=r(31126),s=r(68910),o=r(2806),a=r(16040),l=r(75945),u=Object.assign;e.exports=!u||r(10496)((function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n}))?function(e,t){for(var r=a(e),u=arguments.length,c=1,d=s.f,h=o.f;u>c;)for(var f,p=l(arguments[c++]),m=d?i(p).concat(d(p)):i(p),g=m.length,y=0;g>y;)f=m[y++],n&&!h.call(p,f)||(r[f]=p[f]);return r}:u},6088:(e,t,r)=>{var n=r(85075),i=r(62390),s=r(95985),o=r(81145)("IE_PROTO"),a=function(){},l="prototype",u=function(){var e,t=r(47339)("iframe"),n=s.length;for(t.style.display="none",r(17727).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u[l][s[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(a[l]=n(e),r=new a,a[l]=null,r[o]=e):r=u(),void 0===t?r:i(r,t)}},24213:(e,t,r)=>{var n=r(85075),i=r(80748),s=r(23825),o=Object.defineProperty;t.f=r(83144)?Object.defineProperty:function(e,t,r){if(n(e),t=s(t,!0),n(r),i)try{return o(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},62390:(e,t,r)=>{var n=r(24213),i=r(85075),s=r(31126);e.exports=r(83144)?Object.defineProperties:function(e,t){i(e);for(var r,o=s(t),a=o.length,l=0;a>l;)n.f(e,r=o[l++],t[r]);return e}},42296:(e,t,r)=>{"use strict";e.exports=r(14925)||!r(10496)((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete r(24405)[e]}))},99015:(e,t,r)=>{var n=r(2806),i=r(33388),s=r(76282),o=r(23825),a=r(83050),l=r(80748),u=Object.getOwnPropertyDescriptor;t.f=r(83144)?u:function(e,t){if(e=s(e),t=o(t,!0),l)try{return u(e,t)}catch(e){}if(a(e,t))return i(!n.f.call(e,t),e[t])}},73233:(e,t,r)=>{var n=r(76282),i=r(77173).f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==s.call(e)?function(e){try{return i(e)}catch(e){return o.slice()}}(e):i(n(e))}},77173:(e,t,r)=>{var n=r(23872),i=r(95985).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},68910:(e,t)=>{t.f=Object.getOwnPropertySymbols},88539:(e,t,r)=>{var n=r(83050),i=r(16040),s=r(81145)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},23872:(e,t,r)=>{var n=r(83050),i=r(76282),s=r(64513)(!1),o=r(81145)("IE_PROTO");e.exports=function(e,t){var r,a=i(e),l=0,u=[];for(r in a)r!=o&&n(a,r)&&u.push(r);for(;t.length>l;)n(a,r=t[l++])&&(~s(u,r)||u.push(r));return u}},31126:(e,t,r)=>{var n=r(23872),i=r(95985);e.exports=Object.keys||function(e){return n(e,i)}},2806:(e,t)=>{t.f={}.propertyIsEnumerable},79870:(e,t,r)=>{var n=r(61693),i=r(48080),s=r(10496);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],o={};o[e]=t(r),n(n.S+n.F*s((function(){r(1)})),"Object",o)}},72133:(e,t,r)=>{var n=r(83144),i=r(31126),s=r(76282),o=r(2806).f;e.exports=function(e){return function(t){for(var r,a=s(t),l=i(a),u=l.length,c=0,d=[];u>c;)r=l[c++],n&&!o.call(a,r)||d.push(e?[r,a[r]]:a[r]);return d}}},2275:(e,t,r)=>{var n=r(77173),i=r(68910),s=r(85075),o=r(24405).Reflect;e.exports=o&&o.ownKeys||function(e){var t=n.f(s(e)),r=i.f;return r?t.concat(r(e)):t}},95995:(e,t,r)=>{var n=r(24405).parseFloat,i=r(25480).trim;e.exports=1/n(r(71176)+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},27252:(e,t,r)=>{var n=r(24405).parseInt,i=r(25480).trim,s=r(71176),o=/^[-+]?0[xX]/;e.exports=8!==n(s+"08")||22!==n(s+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(o.test(r)?16:10))}:n},24552:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},99894:(e,t,r)=>{var n=r(85075),i=r(49708),s=r(12219);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=s.f(e);return(0,r.resolve)(t),r.promise}},33388:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},33227:(e,t,r)=>{var n=r(69593);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},69593:(e,t,r)=>{var n=r(24405),i=r(74461),s=r(83050),o=r(7767)("src"),a=r(19769),l="toString",u=(""+a).split(l);r(48080).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,r,a){var l="function"==typeof r;l&&(s(r,"name")||i(r,"name",t)),e[t]!==r&&(l&&(s(r,o)||i(r,o,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:a?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[o]||a.call(this)}))},26798:(e,t,r)=>{"use strict";var n=r(96347),i=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var s=r.call(e,t);if("object"!=typeof s)throw new TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},72562:(e,t,r)=>{"use strict";var n,i,s=r(95660),o=RegExp.prototype.exec,a=String.prototype.replace,l=o,u="lastIndex",c=(n=/a/,i=/b*/g,o.call(n,"a"),o.call(i,"a"),0!==n[u]||0!==i[u]),d=void 0!==/()??/.exec("")[1];(c||d)&&(l=function(e){var t,r,n,i,l=this;return d&&(r=new RegExp("^"+l.source+"$(?!\\s)",s.call(l))),c&&(t=l[u]),n=o.call(l,e),c&&n&&(l[u]=l.global?n.index+n[0].length:t),d&&n&&n.length>1&&a.call(n[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)})),n}),e.exports=l},22950:e=>{e.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},41366:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},50578:(e,t,r)=>{"use strict";var n=r(61693),i=r(50666),s=r(21550),o=r(74036);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,a,l=arguments[1];return i(this),(t=void 0!==l)&&i(l),null==e?new this:(r=[],t?(n=0,a=s(l,arguments[2],2),o(e,!1,(function(e){r.push(a(e,n++))}))):o(e,!1,r.push,r),new this(r))}})}},20147:(e,t,r)=>{"use strict";var n=r(61693);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},41794:(e,t,r)=>{var n=r(49708),i=r(85075),s=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(21550)(Function.call,r(99015).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return s(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:s}},72373:(e,t,r)=>{"use strict";var n=r(24405),i=r(24213),s=r(83144),o=r(64410)("species");e.exports=function(e){var t=n[e];s&&t&&!t[o]&&i.f(t,o,{configurable:!0,get:function(){return this}})}},25572:(e,t,r)=>{var n=r(24213).f,i=r(83050),s=r(64410)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,s)&&n(e,s,{configurable:!0,value:t})}},81145:(e,t,r)=>{var n=r(47104)("keys"),i=r(7767);e.exports=function(e){return n[e]||(n[e]=i(e))}},47104:(e,t,r)=>{var n=r(48080),i=r(24405),s="__core-js_shared__",o=i[s]||(i[s]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(14925)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},33611:(e,t,r)=>{var n=r(85075),i=r(50666),s=r(64410)("species");e.exports=function(e,t){var r,o=n(e).constructor;return void 0===o||null==(r=n(o)[s])?t:i(r)}},69718:(e,t,r)=>{"use strict";var n=r(10496);e.exports=function(e,t){return!!e&&n((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},25454:(e,t,r)=>{var n=r(94058),i=r(91083);e.exports=function(e){return function(t,r){var s,o,a=String(i(t)),l=n(r),u=a.length;return l<0||l>=u?e?"":void 0:(s=a.charCodeAt(l))<55296||s>56319||l+1===u||(o=a.charCodeAt(l+1))<56320||o>57343?e?a.charAt(l):s:e?a.slice(l,l+2):o-56320+(s-55296<<10)+65536}}},31452:(e,t,r)=>{var n=r(70939),i=r(91083);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},47742:(e,t,r)=>{var n=r(61693),i=r(10496),s=r(91083),o=/"/g,a=function(e,t,r,n){var i=String(s(e)),a="<"+t;return""!==r&&(a+=" "+r+'="'+String(n).replace(o,"&quot;")+'"'),a+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(a),n(n.P+n.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",r)}},26687:(e,t,r)=>{var n=r(15263),i=r(23874),s=r(91083);e.exports=function(e,t,r,o){var a=String(s(e)),l=a.length,u=void 0===r?" ":String(r),c=n(t);if(c<=l||""==u)return a;var d=c-l,h=i.call(u,Math.ceil(d/u.length));return h.length>d&&(h=h.slice(0,d)),o?h+a:a+h}},23874:(e,t,r)=>{"use strict";var n=r(94058),i=r(91083);e.exports=function(e){var t=String(i(this)),r="",s=n(e);if(s<0||s==1/0)throw RangeError("Count can't be negative");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},25480:(e,t,r)=>{var n=r(61693),i=r(91083),s=r(10496),o=r(71176),a="["+o+"]",l=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),c=function(e,t,r){var i={},a=s((function(){return!!o[e]()||"​"!="​"[e]()})),l=i[e]=a?t(d):o[e];r&&(i[r]=l),n(n.P+n.F*a,"String",i)},d=c.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=c},71176:e=>{e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},21597:(e,t,r)=>{var n,i,s,o=r(21550),a=r(31671),l=r(17727),u=r(47339),c=r(24405),d=c.process,h=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,m=c.Dispatch,g=0,y={},v="onreadystatechange",b=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},x=function(e){b.call(e.data)};h&&f||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++g]=function(){a("function"==typeof e?e:Function(e),t)},n(g),g},f=function(e){delete y[e]},"process"==r(42380)(d)?n=function(e){d.nextTick(o(b,e,1))}:m&&m.now?n=function(e){m.now(o(b,e,1))}:p?(s=(i=new p).port2,i.port1.onmessage=x,n=o(s.postMessage,s,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(e){c.postMessage(e+"","*")},c.addEventListener("message",x,!1)):n=v in u("script")?function(e){l.appendChild(u("script"))[v]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(o(b,e,1),0)}),e.exports={set:h,clear:f}},39519:(e,t,r)=>{var n=r(94058),i=Math.max,s=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):s(e,t)}},84423:(e,t,r)=>{var n=r(94058),i=r(15263);e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},94058:e=>{var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},76282:(e,t,r)=>{var n=r(75945),i=r(91083);e.exports=function(e){return n(i(e))}},15263:(e,t,r)=>{var n=r(94058),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},16040:(e,t,r)=>{var n=r(91083);e.exports=function(e){return Object(n(e))}},23825:(e,t,r)=>{var n=r(49708);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},33412:(e,t,r)=>{"use strict";if(r(83144)){var n=r(14925),i=r(24405),s=r(10496),o=r(61693),a=r(76331),l=r(7050),u=r(21550),c=r(30269),d=r(33388),h=r(74461),f=r(33227),p=r(94058),m=r(15263),g=r(84423),y=r(39519),v=r(23825),b=r(83050),x=r(96347),w=r(49708),E=r(16040),S=r(92193),T=r(6088),A=r(88539),D=r(77173).f,N=r(77521),C=r(7767),k=r(64410),M=r(13635),O=r(64513),_=r(33611),L=r(66172),R=r(47985),I=r(3229),F=r(72373),P=r(35572),B=r(43697),U=r(24213),$=r(99015),j=U.f,z=$.f,q=i.RangeError,H=i.TypeError,V=i.Uint8Array,G="ArrayBuffer",W="Shared"+G,K="BYTES_PER_ELEMENT",Y="prototype",J=Array[Y],Z=l.ArrayBuffer,X=l.DataView,Q=M(0),ee=M(2),te=M(3),re=M(4),ne=M(5),ie=M(6),se=O(!0),oe=O(!1),ae=L.values,le=L.keys,ue=L.entries,ce=J.lastIndexOf,de=J.reduce,he=J.reduceRight,fe=J.join,pe=J.sort,me=J.slice,ge=J.toString,ye=J.toLocaleString,ve=k("iterator"),be=k("toStringTag"),xe=C("typed_constructor"),we=C("def_constructor"),Ee=a.CONSTR,Se=a.TYPED,Te=a.VIEW,Ae="Wrong length!",De=M(1,(function(e,t){return Oe(_(e,e[we]),t)})),Ne=s((function(){return 1===new V(new Uint16Array([1]).buffer)[0]})),Ce=!!V&&!!V[Y].set&&s((function(){new V(1).set({})})),ke=function(e,t){var r=p(e);if(r<0||r%t)throw q("Wrong offset!");return r},Me=function(e){if(w(e)&&Se in e)return e;throw H(e+" is not a typed array!")},Oe=function(e,t){if(!w(e)||!(xe in e))throw H("It is not a typed array constructor!");return new e(t)},_e=function(e,t){return Le(_(e,e[we]),t)},Le=function(e,t){for(var r=0,n=t.length,i=Oe(e,n);n>r;)i[r]=t[r++];return i},Re=function(e,t,r){j(e,t,{get:function(){return this._d[r]}})},Ie=function(e){var t,r,n,i,s,o,a=E(e),l=arguments.length,c=l>1?arguments[1]:void 0,d=void 0!==c,h=N(a);if(null!=h&&!S(h)){for(o=h.call(a),n=[],t=0;!(s=o.next()).done;t++)n.push(s.value);a=n}for(d&&l>2&&(c=u(c,arguments[2],2)),t=0,r=m(a.length),i=Oe(this,r);r>t;t++)i[t]=d?c(a[t],t):a[t];return i},Fe=function(){for(var e=0,t=arguments.length,r=Oe(this,t);t>e;)r[e]=arguments[e++];return r},Pe=!!V&&s((function(){ye.call(new V(1))})),Be=function(){return ye.apply(Pe?me.call(Me(this)):Me(this),arguments)},Ue={copyWithin:function(e,t){return B.call(Me(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return re(Me(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return P.apply(Me(this),arguments)},filter:function(e){return _e(this,ee(Me(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ne(Me(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ie(Me(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Q(Me(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return oe(Me(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return se(Me(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return fe.apply(Me(this),arguments)},lastIndexOf:function(e){return ce.apply(Me(this),arguments)},map:function(e){return De(Me(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return de.apply(Me(this),arguments)},reduceRight:function(e){return he.apply(Me(this),arguments)},reverse:function(){for(var e,t=this,r=Me(t).length,n=Math.floor(r/2),i=0;i<n;)e=t[i],t[i++]=t[--r],t[r]=e;return t},some:function(e){return te(Me(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return pe.call(Me(this),e)},subarray:function(e,t){var r=Me(this),n=r.length,i=y(e,n);return new(_(r,r[we]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,m((void 0===t?n:y(t,n))-i))}},$e=function(e,t){return _e(this,me.call(Me(this),e,t))},je=function(e){Me(this);var t=ke(arguments[1],1),r=this.length,n=E(e),i=m(n.length),s=0;if(i+t>r)throw q(Ae);for(;s<i;)this[t+s]=n[s++]},ze={entries:function(){return ue.call(Me(this))},keys:function(){return le.call(Me(this))},values:function(){return ae.call(Me(this))}},qe=function(e,t){return w(e)&&e[Se]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},He=function(e,t){return qe(e,t=v(t,!0))?d(2,e[t]):z(e,t)},Ve=function(e,t,r){return!(qe(e,t=v(t,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?j(e,t,r):(e[t]=r.value,e)};Ee||($.f=He,U.f=Ve),o(o.S+o.F*!Ee,"Object",{getOwnPropertyDescriptor:He,defineProperty:Ve}),s((function(){ge.call({})}))&&(ge=ye=function(){return fe.call(this)});var Ge=f({},Ue);f(Ge,ze),h(Ge,ve,ze.values),f(Ge,{slice:$e,set:je,constructor:function(){},toString:ge,toLocaleString:Be}),Re(Ge,"buffer","b"),Re(Ge,"byteOffset","o"),Re(Ge,"byteLength","l"),Re(Ge,"length","e"),j(Ge,be,{get:function(){return this[Se]}}),e.exports=function(e,t,r,l){var u=e+((l=!!l)?"Clamped":"")+"Array",d="get"+e,f="set"+e,p=i[u],y=p||{},v=p&&A(p),b=!p||!a.ABV,E={},S=p&&p[Y],N=function(e,r){j(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[d](r*t+n.o,Ne)}(this,r)},set:function(e){return function(e,r,n){var i=e._d;l&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[f](r*t+i.o,n,Ne)}(this,r,e)},enumerable:!0})};b?(p=r((function(e,r,n,i){c(e,p,u,"_d");var s,o,a,l,d=0,f=0;if(w(r)){if(!(r instanceof Z||(l=x(r))==G||l==W))return Se in r?Le(p,r):Ie.call(p,r);s=r,f=ke(n,t);var y=r.byteLength;if(void 0===i){if(y%t)throw q(Ae);if((o=y-f)<0)throw q(Ae)}else if((o=m(i)*t)+f>y)throw q(Ae);a=o/t}else a=g(r),s=new Z(o=a*t);for(h(e,"_d",{b:s,o:f,l:o,e:a,v:new X(s)});d<a;)N(e,d++)})),S=p[Y]=T(Ge),h(S,"constructor",p)):s((function(){p(1)}))&&s((function(){new p(-1)}))&&I((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=r((function(e,r,n,i){var s;return c(e,p,u),w(r)?r instanceof Z||(s=x(r))==G||s==W?void 0!==i?new y(r,ke(n,t),i):void 0!==n?new y(r,ke(n,t)):new y(r):Se in r?Le(p,r):Ie.call(p,r):new y(g(r))})),Q(v!==Function.prototype?D(y).concat(D(v)):D(y),(function(e){e in p||h(p,e,y[e])})),p[Y]=S,n||(S.constructor=p));var C=S[ve],k=!!C&&("values"==C.name||null==C.name),M=ze.values;h(p,xe,!0),h(S,Se,u),h(S,Te,!0),h(S,we,p),(l?new p(1)[be]==u:be in S)||j(S,be,{get:function(){return u}}),E[u]=p,o(o.G+o.W+o.F*(p!=y),E),o(o.S,u,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*s((function(){y.of.call(p,1)})),u,{from:Ie,of:Fe}),K in S||h(S,K,t),o(o.P,u,Ue),F(u),o(o.P+o.F*Ce,u,{set:je}),o(o.P+o.F*!k,u,ze),n||S.toString==ge||(S.toString=ge),o(o.P+o.F*s((function(){new p(1).slice()})),u,{slice:$e}),o(o.P+o.F*(s((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!s((function(){S.toLocaleString.call([1,2])}))),u,{toLocaleString:Be}),R[u]=k?C:M,n||k||h(S,ve,M)}}else e.exports=function(){}},7050:(e,t,r)=>{"use strict";var n=r(24405),i=r(83144),s=r(14925),o=r(76331),a=r(74461),l=r(33227),u=r(10496),c=r(30269),d=r(94058),h=r(15263),f=r(84423),p=r(77173).f,m=r(24213).f,g=r(35572),y=r(25572),v="ArrayBuffer",b="DataView",x="prototype",w="Wrong index!",E=n[v],S=n[b],T=n.Math,A=n.RangeError,D=n.Infinity,N=E,C=T.abs,k=T.pow,M=T.floor,O=T.log,_=T.LN2,L="buffer",R="byteLength",I="byteOffset",F=i?"_b":L,P=i?"_l":R,B=i?"_o":I;function U(e,t,r){var n,i,s,o=new Array(r),a=8*r-t-1,l=(1<<a)-1,u=l>>1,c=23===t?k(2,-24)-k(2,-77):0,d=0,h=e<0||0===e&&1/e<0?1:0;for((e=C(e))!=e||e===D?(i=e!=e?1:0,n=l):(n=M(O(e)/_),e*(s=k(2,-n))<1&&(n--,s*=2),(e+=n+u>=1?c/s:c*k(2,1-u))*s>=2&&(n++,s/=2),n+u>=l?(i=0,n=l):n+u>=1?(i=(e*s-1)*k(2,t),n+=u):(i=e*k(2,u-1)*k(2,t),n=0));t>=8;o[d++]=255&i,i/=256,t-=8);for(n=n<<t|i,a+=t;a>0;o[d++]=255&n,n/=256,a-=8);return o[--d]|=128*h,o}function $(e,t,r){var n,i=8*r-t-1,s=(1<<i)-1,o=s>>1,a=i-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;a>0;c=256*c+e[l],l--,a-=8);for(n=c&(1<<-a)-1,c>>=-a,a+=t;a>0;n=256*n+e[l],l--,a-=8);if(0===c)c=1-o;else{if(c===s)return n?NaN:u?-D:D;n+=k(2,t),c-=o}return(u?-1:1)*n*k(2,c-t)}function j(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function z(e){return[255&e]}function q(e){return[255&e,e>>8&255]}function H(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function V(e){return U(e,52,8)}function G(e){return U(e,23,4)}function W(e,t,r){m(e[x],t,{get:function(){return this[r]}})}function K(e,t,r,n){var i=f(+r);if(i+t>e[P])throw A(w);var s=e[F]._b,o=i+e[B],a=s.slice(o,o+t);return n?a:a.reverse()}function Y(e,t,r,n,i,s){var o=f(+r);if(o+t>e[P])throw A(w);for(var a=e[F]._b,l=o+e[B],u=n(+i),c=0;c<t;c++)a[l+c]=u[s?c:t-c-1]}if(o.ABV){if(!u((function(){E(1)}))||!u((function(){new E(-1)}))||u((function(){return new E,new E(1.5),new E(NaN),E.name!=v}))){for(var J,Z=(E=function(e){return c(this,E),new N(f(e))})[x]=N[x],X=p(N),Q=0;X.length>Q;)(J=X[Q++])in E||a(E,J,N[J]);s||(Z.constructor=E)}var ee=new S(new E(2)),te=S[x].setInt8;ee.setInt8(0,2147483648),ee.setInt8(1,2147483649),!ee.getInt8(0)&&ee.getInt8(1)||l(S[x],{setInt8:function(e,t){te.call(this,e,t<<24>>24)},setUint8:function(e,t){te.call(this,e,t<<24>>24)}},!0)}else E=function(e){c(this,E,v);var t=f(e);this._b=g.call(new Array(t),0),this[P]=t},S=function(e,t,r){c(this,S,b),c(e,E,b);var n=e[P],i=d(t);if(i<0||i>n)throw A("Wrong offset!");if(i+(r=void 0===r?n-i:h(r))>n)throw A("Wrong length!");this[F]=e,this[B]=i,this[P]=r},i&&(W(E,R,"_l"),W(S,L,"_b"),W(S,R,"_l"),W(S,I,"_o")),l(S[x],{getInt8:function(e){return K(this,1,e)[0]<<24>>24},getUint8:function(e){return K(this,1,e)[0]},getInt16:function(e){var t=K(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=K(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return j(K(this,4,e,arguments[1]))},getUint32:function(e){return j(K(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return $(K(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return $(K(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,z,t)},setUint8:function(e,t){Y(this,1,e,z,t)},setInt16:function(e,t){Y(this,2,e,q,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,q,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,H,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,H,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,G,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,V,t,arguments[2])}});y(E,v),y(S,b),a(S[x],o.VIEW,!0),t[v]=E,t[b]=S},76331:(e,t,r)=>{for(var n,i=r(24405),s=r(74461),o=r(7767),a=o("typed_array"),l=o("view"),u=!(!i.ArrayBuffer||!i.DataView),c=u,d=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(n=i[h[d++]])?(s(n.prototype,a,!0),s(n.prototype,l,!0)):c=!1;e.exports={ABV:u,CONSTR:c,TYPED:a,VIEW:l}},7767:e=>{var t=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+r).toString(36))}},97860:(e,t,r)=>{var n=r(24405).navigator;e.exports=n&&n.userAgent||""},51554:(e,t,r)=>{var n=r(49708);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},94519:(e,t,r)=>{var n=r(24405),i=r(48080),s=r(14925),o=r(63438),a=r(24213).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=s?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:o.f(e)})}},63438:(e,t,r)=>{t.f=r(64410)},64410:(e,t,r)=>{var n=r(47104)("wks"),i=r(7767),s=r(24405).Symbol,o="function"==typeof s;(e.exports=function(e){return n[e]||(n[e]=o&&s[e]||(o?s:i)("Symbol."+e))}).store=n},77521:(e,t,r)=>{var n=r(96347),i=r(64410)("iterator"),s=r(47985);e.exports=r(48080).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||s[n(e)]}},54530:(e,t,r)=>{var n=r(61693),i=r(22950)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(e){return i(e)}})},79440:(e,t,r)=>{var n=r(61693);n(n.P,"Array",{copyWithin:r(43697)}),r(17296)("copyWithin")},26075:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(4);n(n.P+n.F*!r(69718)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},15588:(e,t,r)=>{var n=r(61693);n(n.P,"Array",{fill:r(35572)}),r(17296)("fill")},18931:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(2);n(n.P+n.F*!r(69718)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},45294:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(6),s="findIndex",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),n(n.P+n.F*o,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(17296)(s)},66233:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(5),s="find",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(17296)(s)},19946:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(0),s=r(69718)([].forEach,!0);n(n.P+n.F*!s,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},79731:(e,t,r)=>{"use strict";var n=r(21550),i=r(61693),s=r(16040),o=r(98226),a=r(92193),l=r(15263),u=r(72559),c=r(77521);i(i.S+i.F*!r(3229)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,d,h=s(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,y=0,v=c(h);if(g&&(m=n(m,p>2?arguments[2]:void 0,2)),null==v||f==Array&&a(v))for(r=new f(t=l(h.length));t>y;y++)u(r,y,g?m(h[y],y):h[y]);else for(d=v.call(h),r=new f;!(i=d.next()).done;y++)u(r,y,g?o(d,m,[i.value,y],!0):i.value);return r.length=y,r}})},29209:(e,t,r)=>{"use strict";var n=r(61693),i=r(64513)(!1),s=[].indexOf,o=!!s&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!r(69718)(s)),"Array",{indexOf:function(e){return o?s.apply(this,arguments)||0:i(this,e,arguments[1])}})},82550:(e,t,r)=>{var n=r(61693);n(n.S,"Array",{isArray:r(63623)})},66172:(e,t,r)=>{"use strict";var n=r(17296),i=r(34257),s=r(47985),o=r(76282);e.exports=r(15706)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),s.Arguments=s.Array,n("keys"),n("values"),n("entries")},65956:(e,t,r)=>{"use strict";var n=r(61693),i=r(76282),s=[].join;n(n.P+n.F*(r(75945)!=Object||!r(69718)(s)),"Array",{join:function(e){return s.call(i(this),void 0===e?",":e)}})},72733:(e,t,r)=>{"use strict";var n=r(61693),i=r(76282),s=r(94058),o=r(15263),a=[].lastIndexOf,l=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!r(69718)(a)),"Array",{lastIndexOf:function(e){if(l)return a.apply(this,arguments)||0;var t=i(this),r=o(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,s(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},92369:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(1);n(n.P+n.F*!r(69718)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},40745:(e,t,r)=>{"use strict";var n=r(61693),i=r(72559);n(n.S+n.F*r(10496)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)i(r,e,arguments[e++]);return r.length=t,r}})},53565:(e,t,r)=>{"use strict";var n=r(61693),i=r(56574);n(n.P+n.F*!r(69718)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},9662:(e,t,r)=>{"use strict";var n=r(61693),i=r(56574);n(n.P+n.F*!r(69718)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},56149:(e,t,r)=>{"use strict";var n=r(61693),i=r(17727),s=r(42380),o=r(39519),a=r(15263),l=[].slice;n(n.P+n.F*r(10496)((function(){i&&l.call(i)})),"Array",{slice:function(e,t){var r=a(this.length),n=s(this);if(t=void 0===t?r:t,"Array"==n)return l.call(this,e,t);for(var i=o(e,r),u=o(t,r),c=a(u-i),d=new Array(c),h=0;h<c;h++)d[h]="String"==n?this.charAt(i+h):this[i+h];return d}})},24135:(e,t,r)=>{"use strict";var n=r(61693),i=r(13635)(3);n(n.P+n.F*!r(69718)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},32106:(e,t,r)=>{"use strict";var n=r(61693),i=r(50666),s=r(16040),o=r(10496),a=[].sort,l=[1,2,3];n(n.P+n.F*(o((function(){l.sort(void 0)}))||!o((function(){l.sort(null)}))||!r(69718)(a)),"Array",{sort:function(e){return void 0===e?a.call(s(this)):a.call(s(this),i(e))}})},95324:(e,t,r)=>{r(72373)("Array")},22330:(e,t,r)=>{var n=r(61693);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},22943:(e,t,r)=>{var n=r(61693),i=r(59496);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},56665:(e,t,r)=>{"use strict";var n=r(61693),i=r(16040),s=r(23825);n(n.P+n.F*r(10496)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),r=s(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},61002:(e,t,r)=>{var n=r(64410)("toPrimitive"),i=Date.prototype;n in i||r(74461)(i,n,r(72967))},8616:(e,t,r)=>{var n=Date.prototype,i="Invalid Date",s="toString",o=n[s],a=n.getTime;new Date(NaN)+""!=i&&r(69593)(n,s,(function(){var e=a.call(this);return e==e?o.call(this):i}))},67442:(e,t,r)=>{var n=r(61693);n(n.P,"Function",{bind:r(47240)})},27998:(e,t,r)=>{"use strict";var n=r(49708),i=r(88539),s=r(64410)("hasInstance"),o=Function.prototype;s in o||r(24213).f(o,s,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},6278:(e,t,r)=>{var n=r(24213).f,i=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in i||r(83144)&&n(i,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(e){return""}}})},29164:(e,t,r)=>{"use strict";var n=r(37647),i=r(51554),s="Map";e.exports=r(8107)(s,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,s),e);return t&&t.v},set:function(e,t){return n.def(i(this,s),0===e?0:e,t)}},n,!0)},96367:(e,t,r)=>{var n=r(61693),i=r(18738),s=Math.sqrt,o=Math.acosh;n(n.S+n.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+s(e-1)*s(e+1))}})},87345:(e,t,r)=>{var n=r(61693),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},79471:(e,t,r)=>{var n=r(61693),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},55890:(e,t,r)=>{var n=r(61693),i=r(19439);n(n.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},88299:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},89286:(e,t,r)=>{var n=r(61693),i=Math.exp;n(n.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},8240:(e,t,r)=>{var n=r(61693),i=r(98651);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},41050:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{fround:r(88961)})},88246:(e,t,r)=>{var n=r(61693),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var r,n,s=0,o=0,a=arguments.length,l=0;o<a;)l<(r=i(arguments[o++]))?(s=s*(n=l/r)*n+1,l=r):s+=r>0?(n=r/l)*n:r;return l===1/0?1/0:l*Math.sqrt(s)}})},19349:(e,t,r)=>{var n=r(61693),i=Math.imul;n(n.S+n.F*r(10496)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var r=65535,n=+e,i=+t,s=r&n,o=r&i;return 0|s*o+((r&n>>>16)*o+s*(r&i>>>16)<<16>>>0)}})},95159:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},83158:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{log1p:r(18738)})},17521:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},92565:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{sign:r(19439)})},48337:(e,t,r)=>{var n=r(61693),i=r(98651),s=Math.exp;n(n.S+n.F*r(10496)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(s(e-1)-s(-e-1))*(Math.E/2)}})},18582:(e,t,r)=>{var n=r(61693),i=r(98651),s=Math.exp;n(n.S,"Math",{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(s(e)+s(-e))}})},62310:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},15434:(e,t,r)=>{"use strict";var n=r(24405),i=r(83050),s=r(42380),o=r(77856),a=r(23825),l=r(10496),u=r(77173).f,c=r(99015).f,d=r(24213).f,h=r(25480).trim,f="Number",p=n[f],m=p,g=p.prototype,y=s(r(6088)(g))==f,v="trim"in String.prototype,b=function(e){var t=a(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,s=(t=v?t.trim():h(t,3)).charCodeAt(0);if(43===s||45===s){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===s){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var o,l=t.slice(2),u=0,c=l.length;u<c;u++)if((o=l.charCodeAt(u))<48||o>i)return NaN;return parseInt(l,n)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof p&&(y?l((function(){g.valueOf.call(r)})):s(r)!=f)?o(new m(b(t)),r,p):b(t)};for(var x,w=r(83144)?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;w.length>E;E++)i(m,x=w[E])&&!i(p,x)&&d(p,x,c(m,x));p.prototype=g,g.constructor=p,r(69593)(n,f,p)}},84412:(e,t,r)=>{var n=r(61693);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},17993:(e,t,r)=>{var n=r(61693),i=r(24405).isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},41755:(e,t,r)=>{var n=r(61693);n(n.S,"Number",{isInteger:r(48645)})},85390:(e,t,r)=>{var n=r(61693);n(n.S,"Number",{isNaN:function(e){return e!=e}})},40352:(e,t,r)=>{var n=r(61693),i=r(48645),s=Math.abs;n(n.S,"Number",{isSafeInteger:function(e){return i(e)&&s(e)<=9007199254740991}})},40526:(e,t,r)=>{var n=r(61693);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},60708:(e,t,r)=>{var n=r(61693);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},22360:(e,t,r)=>{var n=r(61693),i=r(95995);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},25114:(e,t,r)=>{var n=r(61693),i=r(27252);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},77967:(e,t,r)=>{"use strict";var n=r(61693),i=r(94058),s=r(98479),o=r(23874),a=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",d="0",h=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*u[r],u[r]=n%1e7,n=l(n/1e7)},f=function(e){for(var t=6,r=0;--t>=0;)r+=u[t],u[t]=l(r/e),r=r%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var r=String(u[e]);t=""===t?r:t+o.call(d,7-r.length)+r}return t},m=function(e,t,r){return 0===t?r:t%2==1?m(e,t-1,r*e):m(e*e,t/2,r)};n(n.P+n.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(10496)((function(){a.call({})}))),"Number",{toFixed:function(e){var t,r,n,a,l=s(this,c),u=i(e),g="",y=d;if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(l*m(2,69,1))-69,r=t<0?l*m(2,-t,1):l/m(2,t,1),r*=4503599627370496,(t=52-t)>0){for(h(0,r),n=u;n>=7;)h(1e7,0),n-=7;for(h(m(10,n,1),0),n=t-1;n>=23;)f(1<<23),n-=23;f(1<<n),h(1,1),f(2),y=p()}else h(0,r),h(1<<-t,0),y=p()+o.call(d,u);return y=u>0?g+((a=y.length)<=u?"0."+o.call(d,u-a)+y:y.slice(0,a-u)+"."+y.slice(a-u)):g+y}})},3552:(e,t,r)=>{"use strict";var n=r(61693),i=r(10496),s=r(98479),o=1..toPrecision;n(n.P+n.F*(i((function(){return"1"!==o.call(1,void 0)}))||!i((function(){o.call({})}))),"Number",{toPrecision:function(e){var t=s(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},32680:(e,t,r)=>{var n=r(61693);n(n.S+n.F,"Object",{assign:r(92075)})},67031:(e,t,r)=>{var n=r(61693);n(n.S,"Object",{create:r(6088)})},13073:(e,t,r)=>{var n=r(61693);n(n.S+n.F*!r(83144),"Object",{defineProperties:r(62390)})},48892:(e,t,r)=>{var n=r(61693);n(n.S+n.F*!r(83144),"Object",{defineProperty:r(24213).f})},84925:(e,t,r)=>{var n=r(49708),i=r(18648).onFreeze;r(79870)("freeze",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},80476:(e,t,r)=>{var n=r(76282),i=r(99015).f;r(79870)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},18899:(e,t,r)=>{r(79870)("getOwnPropertyNames",(function(){return r(73233).f}))},27771:(e,t,r)=>{var n=r(16040),i=r(88539);r(79870)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},52395:(e,t,r)=>{var n=r(49708);r(79870)("isExtensible",(function(e){return function(t){return!!n(t)&&(!e||e(t))}}))},71263:(e,t,r)=>{var n=r(49708);r(79870)("isFrozen",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},72875:(e,t,r)=>{var n=r(49708);r(79870)("isSealed",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},84177:(e,t,r)=>{var n=r(61693);n(n.S,"Object",{is:r(41366)})},950:(e,t,r)=>{var n=r(16040),i=r(31126);r(79870)("keys",(function(){return function(e){return i(n(e))}}))},84058:(e,t,r)=>{var n=r(49708),i=r(18648).onFreeze;r(79870)("preventExtensions",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},80585:(e,t,r)=>{var n=r(49708),i=r(18648).onFreeze;r(79870)("seal",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},26548:(e,t,r)=>{var n=r(61693);n(n.S,"Object",{setPrototypeOf:r(41794).set})},6268:(e,t,r)=>{"use strict";var n=r(96347),i={};i[r(64410)("toStringTag")]="z",i+""!="[object z]"&&r(69593)(Object.prototype,"toString",(function(){return"[object "+n(this)+"]"}),!0)},84212:(e,t,r)=>{var n=r(61693),i=r(95995);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},15291:(e,t,r)=>{var n=r(61693),i=r(27252);n(n.G+n.F*(parseInt!=i),{parseInt:i})},92229:(e,t,r)=>{"use strict";var n,i,s,o,a=r(14925),l=r(24405),u=r(21550),c=r(96347),d=r(61693),h=r(49708),f=r(50666),p=r(30269),m=r(74036),g=r(33611),y=r(21597).set,v=r(32583)(),b=r(12219),x=r(24552),w=r(97860),E=r(99894),S="Promise",T=l.TypeError,A=l.process,D=A&&A.versions,N=D&&D.v8||"",C=l[S],k="process"==c(A),M=function(){},O=i=b.f,_=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(64410)("species")]=function(e){e(M,M)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(M)instanceof t&&0!==N.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),L=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},R=function(e,t){if(!e._n){e._n=!0;var r=e._c;v((function(){for(var n=e._v,i=1==e._s,s=0,o=function(t){var r,s,o,a=i?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{a?(i||(2==e._h&&P(e),e._h=1),!0===a?r=n:(c&&c.enter(),r=a(n),c&&(c.exit(),o=!0)),r===t.promise?u(T("Promise-chain cycle")):(s=L(r))?s.call(r,l,u):l(r)):u(n)}catch(e){c&&!o&&c.exit(),u(e)}};r.length>s;)o(r[s++]);e._c=[],e._n=!1,t&&!e._h&&I(e)}))}},I=function(e){y.call(l,(function(){var t,r,n,i=e._v,s=F(e);if(s&&(t=x((function(){k?A.emit("unhandledRejection",i,e):(r=l.onunhandledrejection)?r({promise:e,reason:i}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=k||F(e)?2:1),e._a=void 0,s&&t.e)throw t.v}))},F=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){y.call(l,(function(){var t;k?A.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),R(t,!0))},U=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=L(e))?v((function(){var n={_w:r,_d:!1};try{t.call(e,u(U,n,1),u(B,n,1))}catch(e){B.call(n,e)}})):(r._v=e,r._s=1,R(r,!1))}catch(e){B.call({_w:r,_d:!1},e)}}};_||(C=function(e){p(this,C,S,"_h"),f(e),n.call(this);try{e(u(U,this,1),u(B,this,1))}catch(e){B.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(33227)(C.prototype,{then:function(e,t){var r=O(g(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=k?A.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),s=function(){var e=new n;this.promise=e,this.resolve=u(U,e,1),this.reject=u(B,e,1)},b.f=O=function(e){return e===C||e===o?new s(e):i(e)}),d(d.G+d.W+d.F*!_,{Promise:C}),r(25572)(C,S),r(72373)(S),o=r(48080)[S],d(d.S+d.F*!_,S,{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!_),S,{resolve:function(e){return E(a&&this===o?C:this,e)}}),d(d.S+d.F*!(_&&r(3229)((function(e){C.all(e).catch(M)}))),S,{all:function(e){var t=this,r=O(t),n=r.resolve,i=r.reject,s=x((function(){var r=[],s=0,o=1;m(e,!1,(function(e){var a=s++,l=!1;r.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,r[a]=e,--o||n(r))}),i)})),--o||n(r)}));return s.e&&i(s.v),r.promise},race:function(e){var t=this,r=O(t),n=r.reject,i=x((function(){m(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},39757:(e,t,r)=>{var n=r(61693),i=r(50666),s=r(85075),o=(r(24405).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!r(10496)((function(){o((function(){}))})),"Reflect",{apply:function(e,t,r){var n=i(e),l=s(r);return o?o(n,t,l):a.call(n,t,l)}})},28545:(e,t,r)=>{var n=r(61693),i=r(6088),s=r(50666),o=r(85075),a=r(49708),l=r(10496),u=r(47240),c=(r(24405).Reflect||{}).construct,d=l((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),h=!l((function(){c((function(){}))}));n(n.S+n.F*(d||h),"Reflect",{construct:function(e,t){s(e),o(t);var r=arguments.length<3?e:s(arguments[2]);if(h&&!d)return c(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var l=r.prototype,f=i(a(l)?l:Object.prototype),p=Function.apply.call(e,f,t);return a(p)?p:f}})},13451:(e,t,r)=>{var n=r(24213),i=r(61693),s=r(85075),o=r(23825);i(i.S+i.F*r(10496)((function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,r){s(e),t=o(t,!0),s(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},93735:(e,t,r)=>{var n=r(61693),i=r(99015).f,s=r(85075);n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(s(e),t);return!(r&&!r.configurable)&&delete e[t]}})},16012:(e,t,r)=>{"use strict";var n=r(61693),i=r(85075),s=function(e){this._t=i(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r(39614)(s,"Object",(function(){var e,t=this,r=t._k;do{if(t._i>=r.length)return{value:void 0,done:!0}}while(!((e=r[t._i++])in t._t));return{value:e,done:!1}})),n(n.S,"Reflect",{enumerate:function(e){return new s(e)}})},13806:(e,t,r)=>{var n=r(99015),i=r(61693),s=r(85075);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(s(e),t)}})},29063:(e,t,r)=>{var n=r(61693),i=r(88539),s=r(85075);n(n.S,"Reflect",{getPrototypeOf:function(e){return i(s(e))}})},39849:(e,t,r)=>{var n=r(99015),i=r(88539),s=r(83050),o=r(61693),a=r(49708),l=r(85075);o(o.S,"Reflect",{get:function e(t,r){var o,u,c=arguments.length<3?t:arguments[2];return l(t)===c?t[r]:(o=n.f(t,r))?s(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:a(u=i(t))?e(u,r,c):void 0}})},71111:(e,t,r)=>{var n=r(61693);n(n.S,"Reflect",{has:function(e,t){return t in e}})},42413:(e,t,r)=>{var n=r(61693),i=r(85075),s=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(e){return i(e),!s||s(e)}})},17098:(e,t,r)=>{var n=r(61693);n(n.S,"Reflect",{ownKeys:r(2275)})},2294:(e,t,r)=>{var n=r(61693),i=r(85075),s=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(e){i(e);try{return s&&s(e),!0}catch(e){return!1}}})},36938:(e,t,r)=>{var n=r(61693),i=r(41794);i&&n(n.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},29920:(e,t,r)=>{var n=r(24213),i=r(99015),s=r(88539),o=r(83050),a=r(61693),l=r(33388),u=r(85075),c=r(49708);a(a.S,"Reflect",{set:function e(t,r,a){var d,h,f=arguments.length<4?t:arguments[3],p=i.f(u(t),r);if(!p){if(c(h=s(t)))return e(h,r,a,f);p=l(0)}if(o(p,"value")){if(!1===p.writable||!c(f))return!1;if(d=i.f(f,r)){if(d.get||d.set||!1===d.writable)return!1;d.value=a,n.f(f,r,d)}else n.f(f,r,l(0,a));return!0}return void 0!==p.set&&(p.set.call(f,a),!0)}})},41544:(e,t,r)=>{var n=r(24405),i=r(77856),s=r(24213).f,o=r(77173).f,a=r(70939),l=r(95660),u=n.RegExp,c=u,d=u.prototype,h=/a/g,f=/a/g,p=new u(h)!==h;if(r(83144)&&(!p||r(10496)((function(){return f[r(64410)("match")]=!1,u(h)!=h||u(f)==f||"/a/i"!=u(h,"i")})))){u=function(e,t){var r=this instanceof u,n=a(e),s=void 0===t;return!r&&n&&e.constructor===u&&s?e:i(p?new c(n&&!s?e.source:e,t):c((n=e instanceof u)?e.source:e,n&&s?l.call(e):t),r?this:d,u)};for(var m=function(e){e in u||s(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},g=o(c),y=0;g.length>y;)m(g[y++]);d.constructor=u,u.prototype=d,r(69593)(n,"RegExp",u)}r(72373)("RegExp")},47515:(e,t,r)=>{"use strict";var n=r(72562);r(61693)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},15155:(e,t,r)=>{r(83144)&&"g"!=/./g.flags&&r(24213).f(RegExp.prototype,"flags",{configurable:!0,get:r(95660)})},94675:(e,t,r)=>{"use strict";var n=r(85075),i=r(15263),s=r(10990),o=r(26798);r(87925)("match",1,(function(e,t,r,a){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=a(r,e,this);if(t.done)return t.value;var l=n(e),u=String(this);if(!l.global)return o(l,u);var c=l.unicode;l.lastIndex=0;for(var d,h=[],f=0;null!==(d=o(l,u));){var p=String(d[0]);h[f]=p,""===p&&(l.lastIndex=s(u,i(l.lastIndex),c)),f++}return 0===f?null:h}]}))},21983:(e,t,r)=>{"use strict";var n=r(85075),i=r(16040),s=r(15263),o=r(94058),a=r(10990),l=r(26798),u=Math.max,c=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;r(87925)("replace",2,(function(e,t,r,p){return[function(n,i){var s=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,s,i):r.call(String(s),n,i)},function(e,t){var i=p(r,e,this,t);if(i.done)return i.value;var d=n(e),h=String(this),f="function"==typeof t;f||(t=String(t));var g=d.global;if(g){var y=d.unicode;d.lastIndex=0}for(var v=[];;){var b=l(d,h);if(null===b)break;if(v.push(b),!g)break;""===String(b[0])&&(d.lastIndex=a(h,s(d.lastIndex),y))}for(var x,w="",E=0,S=0;S<v.length;S++){b=v[S];for(var T=String(b[0]),A=u(c(o(b.index),h.length),0),D=[],N=1;N<b.length;N++)D.push(void 0===(x=b[N])?x:String(x));var C=b.groups;if(f){var k=[T].concat(D,A,h);void 0!==C&&k.push(C);var M=String(t.apply(void 0,k))}else M=m(T,h,A,D,C,t);A>=E&&(w+=h.slice(E,A)+M,E=A+T.length)}return w+h.slice(E)}];function m(e,t,n,s,o,a){var l=n+e.length,u=s.length,c=f;return void 0!==o&&(o=i(o),c=h),r.call(a,c,(function(r,i){var a;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(l);case"<":a=o[i.slice(1,-1)];break;default:var c=+i;if(0===c)return r;if(c>u){var h=d(c/10);return 0===h?r:h<=u?void 0===s[h-1]?i.charAt(1):s[h-1]+i.charAt(1):r}a=s[c-1]}return void 0===a?"":a}))}}))},96285:(e,t,r)=>{"use strict";var n=r(85075),i=r(41366),s=r(26798);r(87925)("search",1,(function(e,t,r,o){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=o(r,e,this);if(t.done)return t.value;var a=n(e),l=String(this),u=a.lastIndex;i(u,0)||(a.lastIndex=0);var c=s(a,l);return i(a.lastIndex,u)||(a.lastIndex=u),null===c?-1:c.index}]}))},92467:(e,t,r)=>{"use strict";var n=r(70939),i=r(85075),s=r(33611),o=r(10990),a=r(15263),l=r(26798),u=r(72562),c=r(10496),d=Math.min,h=[].push,f="split",p="length",m="lastIndex",g=4294967295,y=!c((function(){RegExp(g,"y")}));r(87925)("split",2,(function(e,t,r,c){var v;return v="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[p]||2!="ab"[f](/(?:ab)*/)[p]||4!="."[f](/(.?)(.?)/)[p]||"."[f](/()()/)[p]>1||""[f](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!n(e))return r.call(i,e,t);for(var s,o,a,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?g:t>>>0,y=new RegExp(e.source,c+"g");(s=u.call(y,i))&&!((o=y[m])>d&&(l.push(i.slice(d,s.index)),s[p]>1&&s.index<i[p]&&h.apply(l,s.slice(1)),a=s[0][p],d=o,l[p]>=f));)y[m]===s.index&&y[m]++;return d===i[p]?!a&&y.test("")||l.push(""):l.push(i.slice(d)),l[p]>f?l.slice(0,f):l}:"0"[f](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var i=e(this),s=null==r?void 0:r[t];return void 0!==s?s.call(r,i,n):v.call(String(i),r,n)},function(e,t){var n=c(v,e,this,t,v!==r);if(n.done)return n.value;var u=i(e),h=String(this),f=s(u,RegExp),p=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(y?"y":"g"),b=new f(y?u:"^(?:"+u.source+")",m),x=void 0===t?g:t>>>0;if(0===x)return[];if(0===h.length)return null===l(b,h)?[h]:[];for(var w=0,E=0,S=[];E<h.length;){b.lastIndex=y?E:0;var T,A=l(b,y?h:h.slice(E));if(null===A||(T=d(a(b.lastIndex+(y?0:E)),h.length))===w)E=o(h,E,p);else{if(S.push(h.slice(w,E)),S.length===x)return S;for(var D=1;D<=A.length-1;D++)if(S.push(A[D]),S.length===x)return S;E=w=T}}return S.push(h.slice(w)),S}]}))},80223:(e,t,r)=>{"use strict";r(15155);var n=r(85075),i=r(95660),s=r(83144),o="toString",a=/./[o],l=function(e){r(69593)(RegExp.prototype,o,e,!0)};r(10496)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?l((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!s&&e instanceof RegExp?i.call(e):void 0)})):a.name!=o&&l((function(){return a.call(this)}))},59594:(e,t,r)=>{"use strict";var n=r(37647),i=r(51554);e.exports=r(8107)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},13583:(e,t,r)=>{"use strict";r(47742)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},24234:(e,t,r)=>{"use strict";r(47742)("big",(function(e){return function(){return e(this,"big","","")}}))},76853:(e,t,r)=>{"use strict";r(47742)("blink",(function(e){return function(){return e(this,"blink","","")}}))},95165:(e,t,r)=>{"use strict";r(47742)("bold",(function(e){return function(){return e(this,"b","","")}}))},90730:(e,t,r)=>{"use strict";var n=r(61693),i=r(25454)(!1);n(n.P,"String",{codePointAt:function(e){return i(this,e)}})},83948:(e,t,r)=>{"use strict";var n=r(61693),i=r(15263),s=r(31452),o="endsWith",a=""[o];n(n.P+n.F*r(90528)(o),"String",{endsWith:function(e){var t=s(this,e,o),r=arguments.length>1?arguments[1]:void 0,n=i(t.length),l=void 0===r?n:Math.min(i(r),n),u=String(e);return a?a.call(t,u,l):t.slice(l-u.length,l)===u}})},44050:(e,t,r)=>{"use strict";r(47742)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},7868:(e,t,r)=>{"use strict";r(47742)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},41191:(e,t,r)=>{"use strict";r(47742)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},33684:(e,t,r)=>{var n=r(61693),i=r(39519),s=String.fromCharCode,o=String.fromCodePoint;n(n.S+n.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?s(t):s(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},24487:(e,t,r)=>{"use strict";var n=r(61693),i=r(31452),s="includes";n(n.P+n.F*r(90528)(s),"String",{includes:function(e){return!!~i(this,e,s).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},65220:(e,t,r)=>{"use strict";r(47742)("italics",(function(e){return function(){return e(this,"i","","")}}))},11872:(e,t,r)=>{"use strict";var n=r(25454)(!0);r(15706)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},81644:(e,t,r)=>{"use strict";r(47742)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},96373:(e,t,r)=>{var n=r(61693),i=r(76282),s=r(15263);n(n.S,"String",{raw:function(e){for(var t=i(e.raw),r=s(t.length),n=arguments.length,o=[],a=0;r>a;)o.push(String(t[a++])),a<n&&o.push(String(arguments[a]));return o.join("")}})},92778:(e,t,r)=>{var n=r(61693);n(n.P,"String",{repeat:r(23874)})},34609:(e,t,r)=>{"use strict";r(47742)("small",(function(e){return function(){return e(this,"small","","")}}))},51390:(e,t,r)=>{"use strict";var n=r(61693),i=r(15263),s=r(31452),o="startsWith",a=""[o];n(n.P+n.F*r(90528)(o),"String",{startsWith:function(e){var t=s(this,e,o),r=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},91627:(e,t,r)=>{"use strict";r(47742)("strike",(function(e){return function(){return e(this,"strike","","")}}))},8942:(e,t,r)=>{"use strict";r(47742)("sub",(function(e){return function(){return e(this,"sub","","")}}))},98325:(e,t,r)=>{"use strict";r(47742)("sup",(function(e){return function(){return e(this,"sup","","")}}))},82067:(e,t,r)=>{"use strict";r(25480)("trim",(function(e){return function(){return e(this,3)}}))},70107:(e,t,r)=>{"use strict";var n=r(24405),i=r(83050),s=r(83144),o=r(61693),a=r(69593),l=r(18648).KEY,u=r(10496),c=r(47104),d=r(25572),h=r(7767),f=r(64410),p=r(63438),m=r(94519),g=r(86522),y=r(63623),v=r(85075),b=r(49708),x=r(16040),w=r(76282),E=r(23825),S=r(33388),T=r(6088),A=r(73233),D=r(99015),N=r(68910),C=r(24213),k=r(31126),M=D.f,O=C.f,_=A.f,L=n.Symbol,R=n.JSON,I=R&&R.stringify,F="prototype",P=f("_hidden"),B=f("toPrimitive"),U={}.propertyIsEnumerable,$=c("symbol-registry"),j=c("symbols"),z=c("op-symbols"),q=Object[F],H="function"==typeof L&&!!N.f,V=n.QObject,G=!V||!V[F]||!V[F].findChild,W=s&&u((function(){return 7!=T(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=M(q,t);n&&delete q[t],O(e,t,r),n&&e!==q&&O(q,t,n)}:O,K=function(e){var t=j[e]=T(L[F]);return t._k=e,t},Y=H&&"symbol"==typeof L.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof L},J=function(e,t,r){return e===q&&J(z,t,r),v(e),t=E(t,!0),v(r),i(j,t)?(r.enumerable?(i(e,P)&&e[P][t]&&(e[P][t]=!1),r=T(r,{enumerable:S(0,!1)})):(i(e,P)||O(e,P,S(1,{})),e[P][t]=!0),W(e,t,r)):O(e,t,r)},Z=function(e,t){v(e);for(var r,n=g(t=w(t)),i=0,s=n.length;s>i;)J(e,r=n[i++],t[r]);return e},X=function(e){var t=U.call(this,e=E(e,!0));return!(this===q&&i(j,e)&&!i(z,e))&&(!(t||!i(this,e)||!i(j,e)||i(this,P)&&this[P][e])||t)},Q=function(e,t){if(e=w(e),t=E(t,!0),e!==q||!i(j,t)||i(z,t)){var r=M(e,t);return!r||!i(j,t)||i(e,P)&&e[P][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=_(w(e)),n=[],s=0;r.length>s;)i(j,t=r[s++])||t==P||t==l||n.push(t);return n},te=function(e){for(var t,r=e===q,n=_(r?z:w(e)),s=[],o=0;n.length>o;)!i(j,t=n[o++])||r&&!i(q,t)||s.push(j[t]);return s};H||(a((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===q&&t.call(z,r),i(this,P)&&i(this[P],e)&&(this[P][e]=!1),W(this,e,S(1,r))};return s&&G&&W(q,e,{configurable:!0,set:t}),K(e)})[F],"toString",(function(){return this._k})),D.f=Q,C.f=J,r(77173).f=A.f=ee,r(2806).f=X,N.f=te,s&&!r(14925)&&a(q,"propertyIsEnumerable",X,!0),p.f=function(e){return K(f(e))}),o(o.G+o.W+o.F*!H,{Symbol:L});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)f(re[ne++]);for(var ie=k(f.store),se=0;ie.length>se;)m(ie[se++]);o(o.S+o.F*!H,"Symbol",{for:function(e){return i($,e+="")?$[e]:$[e]=L(e)},keyFor:function(e){if(!Y(e))throw TypeError(e+" is not a symbol!");for(var t in $)if($[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!H,"Object",{create:function(e,t){return void 0===t?T(e):Z(T(e),t)},defineProperty:J,defineProperties:Z,getOwnPropertyDescriptor:Q,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var oe=u((function(){N.f(1)}));o(o.S+o.F*oe,"Object",{getOwnPropertySymbols:function(e){return N.f(x(e))}}),R&&o(o.S+o.F*(!H||u((function(){var e=L();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!Y(e))return y(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Y(t))return t}),n[1]=t,I.apply(R,n)}}),L[F][B]||r(74461)(L[F],B,L[F].valueOf),d(L,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},27955:(e,t,r)=>{"use strict";var n=r(61693),i=r(76331),s=r(7050),o=r(85075),a=r(39519),l=r(15263),u=r(49708),c=r(24405).ArrayBuffer,d=r(33611),h=s.ArrayBuffer,f=s.DataView,p=i.ABV&&c.isView,m=h.prototype.slice,g=i.VIEW,y="ArrayBuffer";n(n.G+n.W+n.F*(c!==h),{ArrayBuffer:h}),n(n.S+n.F*!i.CONSTR,y,{isView:function(e){return p&&p(e)||u(e)&&g in e}}),n(n.P+n.U+n.F*r(10496)((function(){return!new h(2).slice(1,void 0).byteLength})),y,{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(o(this),e);for(var r=o(this).byteLength,n=a(e,r),i=a(void 0===t?r:t,r),s=new(d(this,h))(l(i-n)),u=new f(this),c=new f(s),p=0;n<i;)c.setUint8(p++,u.getUint8(n++));return s}}),r(72373)(y)},24879:(e,t,r)=>{var n=r(61693);n(n.G+n.W+n.F*!r(76331).ABV,{DataView:r(7050).DataView})},47117:(e,t,r)=>{r(33412)("Float32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},41370:(e,t,r)=>{r(33412)("Float64",8,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},20157:(e,t,r)=>{r(33412)("Int16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},42634:(e,t,r)=>{r(33412)("Int32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},75275:(e,t,r)=>{r(33412)("Int8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},62099:(e,t,r)=>{r(33412)("Uint16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},53463:(e,t,r)=>{r(33412)("Uint32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},23411:(e,t,r)=>{r(33412)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},79163:(e,t,r)=>{r(33412)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},86189:(e,t,r)=>{"use strict";var n,i=r(24405),s=r(13635)(0),o=r(69593),a=r(18648),l=r(92075),u=r(78348),c=r(49708),d=r(51554),h=r(51554),f=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",m=a.getWeak,g=Object.isExtensible,y=u.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(e){if(c(e)){var t=m(e);return!0===t?y(d(this,p)).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(d(this,p),e,t)}},x=e.exports=r(8107)(p,v,b,u,!0,!0);h&&f&&(l((n=u.getConstructor(v,p)).prototype,b),a.NEED=!0,s(["delete","has","get","set"],(function(e){var t=x.prototype,r=t[e];o(t,e,(function(t,i){if(c(t)&&!g(t)){this._f||(this._f=new n);var s=this._f[e](t,i);return"set"==e?this:s}return r.call(this,t,i)}))})))},16937:(e,t,r)=>{"use strict";var n=r(78348),i=r(51554),s="WeakSet";r(8107)(s,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,s),e,!0)}},n,!1,!0)},83570:(e,t,r)=>{"use strict";var n=r(61693),i=r(84225),s=r(16040),o=r(15263),a=r(50666),l=r(42143);n(n.P,"Array",{flatMap:function(e){var t,r,n=s(this);return a(e),t=o(n.length),r=l(n,0),i(r,n,n,t,0,1,e,arguments[1]),r}}),r(17296)("flatMap")},81625:(e,t,r)=>{"use strict";var n=r(61693),i=r(84225),s=r(16040),o=r(15263),a=r(94058),l=r(42143);n(n.P,"Array",{flatten:function(){var e=arguments[0],t=s(this),r=o(t.length),n=l(t,0);return i(n,t,t,r,0,void 0===e?1:a(e)),n}}),r(17296)("flatten")},58347:(e,t,r)=>{"use strict";var n=r(61693),i=r(64513)(!0);n(n.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(17296)("includes")},38553:(e,t,r)=>{var n=r(61693),i=r(32583)(),s=r(24405).process,o="process"==r(42380)(s);n(n.G,{asap:function(e){var t=o&&s.domain;i(t?t.bind(e):e)}})},90826:(e,t,r)=>{var n=r(61693),i=r(42380);n(n.S,"Error",{isError:function(e){return"Error"===i(e)}})},23499:(e,t,r)=>{var n=r(61693);n(n.G,{global:r(24405)})},45865:(e,t,r)=>{r(50578)("Map")},68920:(e,t,r)=>{r(20147)("Map")},95745:(e,t,r)=>{var n=r(61693);n(n.P+n.R,"Map",{toJSON:r(72935)("Map")})},13588:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}})},4607:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},63874:(e,t,r)=>{var n=r(61693),i=180/Math.PI;n(n.S,"Math",{degrees:function(e){return e*i}})},95657:(e,t,r)=>{var n=r(61693),i=r(64917),s=r(88961);n(n.S,"Math",{fscale:function(e,t,r,n,o){return s(i(e,t,r,n,o))}})},89252:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,s=r>>>0;return(t>>>0)+(n>>>0)+((i&s|(i|s)&~(i+s>>>0))>>>31)|0}})},83548:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{imulh:function(e,t){var r=65535,n=+e,i=+t,s=n&r,o=i&r,a=n>>16,l=i>>16,u=(a*o>>>0)+(s*o>>>16);return a*l+(u>>16)+((s*l>>>0)+(u&r)>>16)}})},89295:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,s=r>>>0;return(t>>>0)-(n>>>0)-((~i&s|~(i^s)&i-s>>>0)>>>31)|0}})},6577:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},95914:(e,t,r)=>{var n=r(61693),i=Math.PI/180;n(n.S,"Math",{radians:function(e){return e*i}})},24100:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{scale:r(64917)})},90598:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},47151:(e,t,r)=>{var n=r(61693);n(n.S,"Math",{umulh:function(e,t){var r=65535,n=+e,i=+t,s=n&r,o=i&r,a=n>>>16,l=i>>>16,u=(a*o>>>0)+(s*o>>>16);return a*l+(u>>>16)+((s*l>>>0)+(u&r)>>>16)}})},14255:(e,t,r)=>{"use strict";var n=r(61693),i=r(16040),s=r(50666),o=r(24213);r(83144)&&n(n.P+r(42296),"Object",{__defineGetter__:function(e,t){o.f(i(this),e,{get:s(t),enumerable:!0,configurable:!0})}})},71346:(e,t,r)=>{"use strict";var n=r(61693),i=r(16040),s=r(50666),o=r(24213);r(83144)&&n(n.P+r(42296),"Object",{__defineSetter__:function(e,t){o.f(i(this),e,{set:s(t),enumerable:!0,configurable:!0})}})},33788:(e,t,r)=>{var n=r(61693),i=r(72133)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},9872:(e,t,r)=>{var n=r(61693),i=r(2275),s=r(76282),o=r(99015),a=r(72559);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=s(e),l=o.f,u=i(n),c={},d=0;u.length>d;)void 0!==(r=l(n,t=u[d++]))&&a(c,t,r);return c}})},8987:(e,t,r)=>{"use strict";var n=r(61693),i=r(16040),s=r(23825),o=r(88539),a=r(99015).f;r(83144)&&n(n.P+r(42296),"Object",{__lookupGetter__:function(e){var t,r=i(this),n=s(e,!0);do{if(t=a(r,n))return t.get}while(r=o(r))}})},6605:(e,t,r)=>{"use strict";var n=r(61693),i=r(16040),s=r(23825),o=r(88539),a=r(99015).f;r(83144)&&n(n.P+r(42296),"Object",{__lookupSetter__:function(e){var t,r=i(this),n=s(e,!0);do{if(t=a(r,n))return t.set}while(r=o(r))}})},92094:(e,t,r)=>{var n=r(61693),i=r(72133)(!1);n(n.S,"Object",{values:function(e){return i(e)}})},41071:(e,t,r)=>{"use strict";var n=r(61693),i=r(24405),s=r(48080),o=r(32583)(),a=r(64410)("observable"),l=r(50666),u=r(85075),c=r(30269),d=r(33227),h=r(74461),f=r(74036),p=f.RETURN,m=function(e){return null==e?void 0:l(e)},g=function(e){var t=e._c;t&&(e._c=void 0,t())},y=function(e){return void 0===e._o},v=function(e){y(e)||(e._o=void 0,g(e))},b=function(e,t){u(e),this._c=void 0,this._o=e,e=new x(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:l(r),this._c=r)}catch(t){return void e.error(t)}y(this)&&g(this)};b.prototype=d({},{unsubscribe:function(){v(this)}});var x=function(e){this._s=e};x.prototype=d({},{next:function(e){var t=this._s;if(!y(t)){var r=t._o;try{var n=m(r.next);if(n)return n.call(r,e)}catch(e){try{v(t)}finally{throw e}}}},error:function(e){var t=this._s;if(y(t))throw e;var r=t._o;t._o=void 0;try{var n=m(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{g(t)}finally{throw e}}return g(t),e},complete:function(e){var t=this._s;if(!y(t)){var r=t._o;t._o=void 0;try{var n=m(r.complete);e=n?n.call(r,e):void 0}catch(e){try{g(t)}finally{throw e}}return g(t),e}}});var w=function(e){c(this,w,"Observable","_f")._f=l(e)};d(w.prototype,{subscribe:function(e){return new b(e,this._f)},forEach:function(e){var t=this;return new(s.Promise||i.Promise)((function(r,n){l(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})}))}}),d(w,{from:function(e){var t="function"==typeof this?this:w,r=m(u(e)[a]);if(r){var n=u(r.call(e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}return new t((function(t){var r=!1;return o((function(){if(!r){try{if(f(e,!1,(function(e){if(t.next(e),r)return p}))===p)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}})),function(){r=!0}}))},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:w)((function(e){var t=!1;return o((function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}})),function(){t=!0}}))}}),h(w.prototype,a,(function(){return this})),n(n.G,{Observable:w}),r(72373)("Observable")},57752:(e,t,r)=>{"use strict";var n=r(61693),i=r(48080),s=r(24405),o=r(33611),a=r(99894);n(n.P+n.R,"Promise",{finally:function(e){var t=o(this,i.Promise||s.Promise),r="function"==typeof e;return this.then(r?function(r){return a(t,e()).then((function(){return r}))}:e,r?function(r){return a(t,e()).then((function(){throw r}))}:e)}})},24243:(e,t,r)=>{"use strict";var n=r(61693),i=r(12219),s=r(24552);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=s(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},17551:(e,t,r)=>{var n=r(70380),i=r(85075),s=n.key,o=n.set;n.exp({defineMetadata:function(e,t,r,n){o(e,t,i(r),s(n))}})},76157:(e,t,r)=>{var n=r(70380),i=r(85075),s=n.key,o=n.map,a=n.store;n.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:s(arguments[2]),n=o(i(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var l=a.get(t);return l.delete(r),!!l.size||a.delete(t)}})},73806:(e,t,r)=>{var n=r(59594),i=r(59315),s=r(70380),o=r(85075),a=r(88539),l=s.keys,u=s.key,c=function(e,t){var r=l(e,t),s=a(e);if(null===s)return r;var o=c(s,t);return o.length?r.length?i(new n(r.concat(o))):o:r};s.exp({getMetadataKeys:function(e){return c(o(e),arguments.length<2?void 0:u(arguments[1]))}})},10929:(e,t,r)=>{var n=r(70380),i=r(85075),s=r(88539),o=n.has,a=n.get,l=n.key,u=function(e,t,r){if(o(e,t,r))return a(e,t,r);var n=s(t);return null!==n?u(e,n,r):void 0};n.exp({getMetadata:function(e,t){return u(e,i(t),arguments.length<3?void 0:l(arguments[2]))}})},70314:(e,t,r)=>{var n=r(70380),i=r(85075),s=n.keys,o=n.key;n.exp({getOwnMetadataKeys:function(e){return s(i(e),arguments.length<2?void 0:o(arguments[1]))}})},63440:(e,t,r)=>{var n=r(70380),i=r(85075),s=n.get,o=n.key;n.exp({getOwnMetadata:function(e,t){return s(e,i(t),arguments.length<3?void 0:o(arguments[2]))}})},39352:(e,t,r)=>{var n=r(70380),i=r(85075),s=r(88539),o=n.has,a=n.key,l=function(e,t,r){if(o(e,t,r))return!0;var n=s(t);return null!==n&&l(e,n,r)};n.exp({hasMetadata:function(e,t){return l(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},18285:(e,t,r)=>{var n=r(70380),i=r(85075),s=n.has,o=n.key;n.exp({hasOwnMetadata:function(e,t){return s(e,i(t),arguments.length<3?void 0:o(arguments[2]))}})},42541:(e,t,r)=>{var n=r(70380),i=r(85075),s=r(50666),o=n.key,a=n.set;n.exp({metadata:function(e,t){return function(r,n){a(e,t,(void 0!==n?i:s)(r),o(n))}}})},58906:(e,t,r)=>{r(50578)("Set")},85127:(e,t,r)=>{r(20147)("Set")},87225:(e,t,r)=>{var n=r(61693);n(n.P+n.R,"Set",{toJSON:r(72935)("Set")})},55747:(e,t,r)=>{"use strict";var n=r(61693),i=r(25454)(!0),s=r(10496)((function(){return"𠮷"!=="𠮷".at(0)}));n(n.P+n.F*s,"String",{at:function(e){return i(this,e)}})},45707:(e,t,r)=>{"use strict";var n=r(61693),i=r(91083),s=r(15263),o=r(70939),a=r(95660),l=RegExp.prototype,u=function(e,t){this._r=e,this._s=t};r(39614)(u,"RegExp String",(function(){var e=this._r.exec(this._s);return{value:e,done:null===e}})),n(n.P,"String",{matchAll:function(e){if(i(this),!o(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in l?String(e.flags):a.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=s(e.lastIndex),new u(n,t)}})},91409:(e,t,r)=>{"use strict";var n=r(61693),i=r(26687),s=r(97860),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(s);n(n.P+n.F*o,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},90304:(e,t,r)=>{"use strict";var n=r(61693),i=r(26687),s=r(97860),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(s);n(n.P+n.F*o,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},27066:(e,t,r)=>{"use strict";r(25480)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},33255:(e,t,r)=>{"use strict";r(25480)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},94757:(e,t,r)=>{r(94519)("asyncIterator")},97414:(e,t,r)=>{r(94519)("observable")},51178:(e,t,r)=>{var n=r(61693);n(n.S,"System",{global:r(24405)})},66006:(e,t,r)=>{r(50578)("WeakMap")},59676:(e,t,r)=>{r(20147)("WeakMap")},1743:(e,t,r)=>{r(50578)("WeakSet")},69026:(e,t,r)=>{r(20147)("WeakSet")},89635:(e,t,r)=>{for(var n=r(66172),i=r(31126),s=r(69593),o=r(24405),a=r(74461),l=r(47985),u=r(64410),c=u("iterator"),d=u("toStringTag"),h=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(f),m=0;m<p.length;m++){var g,y=p[m],v=f[y],b=o[y],x=b&&b.prototype;if(x&&(x[c]||a(x,c,h),x[d]||a(x,d,y),l[y]=h,v))for(g in n)x[g]||s(x,g,n[g],!0)}},37761:(e,t,r)=>{var n=r(61693),i=r(21597);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},39736:(e,t,r)=>{var n=r(24405),i=r(61693),s=r(97860),o=[].slice,a=/MSIE .\./.test(s),l=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&o.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*a,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},87931:(e,t,r)=>{r(70107),r(67031),r(48892),r(13073),r(80476),r(27771),r(950),r(18899),r(84925),r(80585),r(84058),r(71263),r(72875),r(52395),r(32680),r(84177),r(26548),r(6268),r(67442),r(6278),r(27998),r(15291),r(84212),r(15434),r(77967),r(3552),r(84412),r(17993),r(41755),r(85390),r(40352),r(40526),r(60708),r(22360),r(25114),r(96367),r(87345),r(79471),r(55890),r(88299),r(89286),r(8240),r(41050),r(88246),r(19349),r(95159),r(83158),r(17521),r(92565),r(48337),r(18582),r(62310),r(33684),r(96373),r(82067),r(11872),r(90730),r(83948),r(24487),r(92778),r(51390),r(13583),r(24234),r(76853),r(95165),r(44050),r(7868),r(41191),r(65220),r(81644),r(34609),r(91627),r(8942),r(98325),r(22330),r(56665),r(22943),r(8616),r(61002),r(82550),r(79731),r(40745),r(65956),r(56149),r(32106),r(19946),r(92369),r(18931),r(24135),r(26075),r(9662),r(53565),r(29209),r(72733),r(79440),r(15588),r(66233),r(45294),r(95324),r(66172),r(41544),r(47515),r(80223),r(15155),r(94675),r(21983),r(96285),r(92467),r(92229),r(29164),r(59594),r(86189),r(16937),r(27955),r(24879),r(75275),r(23411),r(79163),r(20157),r(62099),r(42634),r(53463),r(47117),r(41370),r(39757),r(28545),r(13451),r(93735),r(16012),r(39849),r(13806),r(29063),r(71111),r(42413),r(17098),r(2294),r(29920),r(36938),r(58347),r(83570),r(81625),r(55747),r(90304),r(91409),r(27066),r(33255),r(45707),r(94757),r(97414),r(9872),r(92094),r(33788),r(14255),r(71346),r(8987),r(6605),r(95745),r(87225),r(68920),r(85127),r(59676),r(69026),r(45865),r(58906),r(66006),r(1743),r(23499),r(51178),r(90826),r(13588),r(4607),r(63874),r(95657),r(89252),r(89295),r(83548),r(6577),r(95914),r(24100),r(47151),r(90598),r(57752),r(24243),r(17551),r(76157),r(10929),r(73806),r(63440),r(70314),r(39352),r(18285),r(42541),r(38553),r(41071),r(39736),r(37761),r(89635),e.exports=r(48080)},95654:function(e,t,r){!function(t){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag",u=t.regeneratorRuntime;if(u)e.exports=u;else{(u=t.regeneratorRuntime=e.exports).wrap=b;var c="suspendedStart",d="suspendedYield",h="executing",f="completed",p={},m={};m[o]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(M([])));y&&y!==n&&i.call(y,o)&&(m=y);var v=S.prototype=w.prototype=Object.create(m);E.prototype=v.constructor=S,S.constructor=E,S[l]=E.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(v),e},u.awrap=function(e){return{__await:e}},T(A.prototype),A.prototype[a]=function(){return this},u.AsyncIterator=A,u.async=function(e,t,r,n){var i=new A(b(e,t,r,n));return u.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},T(v),v[l]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},u.values=M,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:M(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),p}}}function b(e,t,r,n){var i=t&&t.prototype instanceof w?t:w,s=Object.create(i.prototype),o=new k(n||[]);return s._invoke=function(e,t,r){var n=c;return function(i,s){if(n===h)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw s;return O()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=D(o,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===c)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var l=x(e,t,r);if("normal"===l.type){if(n=r.done?f:d,l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=f,r.method="throw",r.arg=l.arg)}}}(e,r,o),s}function x(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function w(){}function E(){}function S(){}function T(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function A(e){function r(t,n,s,o){var a=x(e[t],e,n);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):Promise.resolve(u).then((function(e){l.value=e,s(l)}),o)}o(a.arg)}var n;"object"==typeof t.process&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise((function(n,i){r(e,t,n,i)}))}return n=n?n.then(i,i):i()}}function D(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,D(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=x(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,p):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function M(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return s.next=s}}return{next:O}}function O(){return{value:r,done:!0}}}("object"==typeof r.g?r.g:"object"==typeof window?window:"object"==typeof self?self:this)},61977:function(e,t){var r;!function(n){"use strict";var i=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},s=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},o=function(){throw SyntaxError("Invalid Param")};function a(e,t){var r=Math.abs(e),n=Math.abs(t);return 0===e?Math.log(n):0===t?Math.log(r):r<3e3&&n<3e3?.5*Math.log(e*e+t*t):(e/=2,t/=2,.5*Math.log(e*e+t*t)+Math.LN2)}function l(e,t){if(!(this instanceof l))return new l(e,t);var r=function(e,t){var r={re:0,im:0};if(null==e)r.re=r.im=0;else if(void 0!==t)r.re=e,r.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)r.re=e.re,r.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return l.INFINITY;r.re=e.abs*Math.cos(e.arg),r.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return l.INFINITY;r.re=e.r*Math.cos(e.phi),r.im=e.r*Math.sin(e.phi)}else 2===e.length?(r.re=e[0],r.im=e[1]):o();break;case"string":r.im=r.re=0;var n=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,s=0;null===n&&o();for(var a=0;a<n.length;a++){var u=n[a];" "===u||"\t"===u||"\n"===u||("+"===u?i++:"-"===u?s++:"i"===u||"I"===u?(i+s===0&&o()," "===n[a+1]||isNaN(n[a+1])?r.im+=parseFloat((s%2?"-":"")+"1"):(r.im+=parseFloat((s%2?"-":"")+n[a+1]),a++),i=s=0):((i+s===0||isNaN(u))&&o(),"i"===n[a+1]||"I"===n[a+1]?(r.im+=parseFloat((s%2?"-":"")+u),a++):r.re+=parseFloat((s%2?"-":"")+u),i=s=0))}i+s>0&&o();break;case"number":r.im=0,r.re=e;break;default:o()}return isNaN(r.re)||isNaN(r.im),r}(e,t);this.re=r.re,this.im=r.im}l.prototype={re:0,im:0,sign:function(){var e=this.abs();return new l(this.re/e,this.im/e)},add:function(e,t){var r=new l(e,t);return this.isInfinite()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:new l(this.re+r.re,this.im+r.im)},sub:function(e,t){var r=new l(e,t);return this.isInfinite()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:new l(this.re-r.re,this.im-r.im)},mul:function(e,t){var r=new l(e,t);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:0===r.im&&0===this.im?new l(this.re*r.re,0):new l(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(e,t){var r=new l(e,t);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return l.NAN;if(this.isInfinite()||r.isZero())return l.INFINITY;if(this.isZero()||r.isInfinite())return l.ZERO;e=this.re,t=this.im;var n,i,s=r.re,o=r.im;return 0===o?new l(e/s,t/s):Math.abs(s)<Math.abs(o)?new l((e*(i=s/o)+t)/(n=s*i+o),(t*i-e)/n):new l((e+t*(i=o/s))/(n=o*i+s),(t-e*i)/n)},pow:function(e,t){var r=new l(e,t);if(e=this.re,t=this.im,r.isZero())return l.ONE;if(0===r.im){if(0===t&&e>0)return new l(Math.pow(e,r.re),0);if(0===e)switch((r.re%4+4)%4){case 0:return new l(Math.pow(t,r.re),0);case 1:return new l(0,Math.pow(t,r.re));case 2:return new l(-Math.pow(t,r.re),0);case 3:return new l(0,-Math.pow(t,r.re))}}if(0===e&&0===t&&r.re>0&&r.im>=0)return l.ZERO;var n=Math.atan2(t,e),i=a(e,t);return e=Math.exp(r.re*i-r.im*n),t=r.im*i+r.re*n,new l(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e,t,r=this.re,n=this.im,i=this.abs();if(r>=0){if(0===n)return new l(Math.sqrt(r),0);e=.5*Math.sqrt(2*(i+r))}else e=Math.abs(n)/Math.sqrt(2*(i-r));return t=r<=0?.5*Math.sqrt(2*(i-r)):Math.abs(n)/Math.sqrt(2*(i+r)),new l(e,n<0?-t:t)},exp:function(){var e=Math.exp(this.re);return this.im,new l(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new l(Math.expm1(e)*Math.cos(t)+function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var r=e*e;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new l(a(e,t),Math.atan2(t,e))},abs:function(){return e=this.re,t=this.im,r=Math.abs(e),n=Math.abs(t),r<3e3&&n<3e3?Math.sqrt(r*r+n*n):(r<n?(r=n,n=e/t):n=t/e,r*Math.sqrt(1+n*n));var e,t,r,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new l(Math.sin(e)*i(t),Math.cos(e)*s(t))},cos:function(){var e=this.re,t=this.im;return new l(Math.cos(e)*i(t),-Math.sin(e)*s(t))},tan:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)+i(t);return new l(Math.sin(e)/r,s(t)/r)},cot:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)-i(t);return new l(-Math.sin(e)/r,s(t)/r)},sec:function(){var e=this.re,t=this.im,r=.5*i(2*t)+.5*Math.cos(2*e);return new l(Math.cos(e)*i(t)/r,Math.sin(e)*s(t)/r)},csc:function(){var e=this.re,t=this.im,r=.5*i(2*t)-.5*Math.cos(2*e);return new l(Math.sin(e)*i(t)/r,-Math.cos(e)*s(t)/r)},asin:function(){var e=this.re,t=this.im,r=new l(t*t-e*e+1,-2*e*t).sqrt(),n=new l(r.re-t,r.im+e).log();return new l(n.im,-n.re)},acos:function(){var e=this.re,t=this.im,r=new l(t*t-e*e+1,-2*e*t).sqrt(),n=new l(r.re-t,r.im+e).log();return new l(Math.PI/2-n.im,n.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new l(0,1/0);if(-1===t)return new l(0,-1/0)}var r=e*e+(1-t)*(1-t),n=new l((1-t*t-e*e)/r,-2*e/r).log();return new l(-.5*n.im,.5*n.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new l(Math.atan2(1,e),0);var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).atan():new l(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(0,1/0);var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).acos():new l(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(Math.PI/2,1/0);var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).asin():new l(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new l(s(e)*Math.cos(t),i(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new l(i(e)*Math.cos(t),s(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,r=i(e)+Math.cos(t);return new l(s(e)/r,Math.sin(t)/r)},coth:function(){var e=2*this.re,t=2*this.im,r=i(e)-Math.cos(t);return new l(s(e)/r,-Math.sin(t)/r)},csch:function(){var e=this.re,t=this.im,r=Math.cos(2*t)-i(2*e);return new l(-2*s(e)*Math.cos(t)/r,2*i(e)*Math.sin(t)/r)},sech:function(){var e=this.re,t=this.im,r=Math.cos(2*t)+i(2*e);return new l(2*i(e)*Math.cos(t)/r,-2*s(e)*Math.sin(t)/r)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else{t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,r=e>1&&0===t,n=1-e,i=1+e,s=n*n+t*t,o=0!==s?new l((i*n-t*t)/s,(t*n+i*t)/s):new l(-1!==e?e/0:0,0!==t?t/0:0),u=o.re;return o.re=a(o.re,o.im)/2,o.im=Math.atan2(o.im,u)/2,r&&(o.im=-o.im),o},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new l(0,Math.PI/2);var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).atanh():new l(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new l(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).asinh():new l(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return l.INFINITY;var r=e*e+t*t;return 0!==r?new l(e/r,-t/r).acosh():new l(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return l.INFINITY;if(this.isInfinite())return l.ZERO;var e=this.re,t=this.im,r=e*e+t*t;return new l(e/r,-t/r)},conjugate:function(){return new l(this.re,-this.im)},neg:function(){return new l(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new l(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new l(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new l(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var r=new l(e,t);return Math.abs(r.re-this.re)<=l.EPSILON&&Math.abs(r.im-this.im)<=l.EPSILON},clone:function(){return new l(this.re,this.im)},toString:function(){var e=this.re,t=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<l.EPSILON&&(e=0),Math.abs(t)<l.EPSILON&&(t=0),0===t?r+e:(0!==e?(r+=e,r+=" ",t<0?(t=-t,r+="-"):r+="+",r+=" "):t<0&&(t=-t,r+="-"),1!==t&&(r+=t),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},l.ZERO=new l(0,0),l.ONE=new l(1,0),l.I=new l(0,1),l.PI=new l(Math.PI,0),l.E=new l(Math.E,0),l.INFINITY=new l(1/0,1/0),l.NAN=new l(NaN,NaN),l.EPSILON=1e-15,void 0===(r=function(){return l}.apply(t,[]))||(e.exports=r)}()},77928:e=>{"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},n={"–":"\\--","—":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},i=function(e,r){return t({},e,r)};e.exports=function(e){for(var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s.preserveFormatting,a=void 0!==o&&o,l=s.escapeMapFn,u=void 0===l?i:l,c=String(e),d="",h=u(t({},r),a?t({},n):{}),f=Object.keys(h),p=function(){var e=!1;f.forEach((function(t,r){e||c.length>=t.length&&c.slice(0,t.length)===t&&(d+=h[f[r]],c=c.slice(t.length,c.length),e=!0)})),e||(d+=c.slice(0,1),c=c.slice(1,c.length))};c;)p();return d}},85628:function(e,t){var r;!function(n){"use strict";var i={s:1,n:0,d:1};function s(e,t){if(isNaN(e=parseInt(e,10)))throw c.InvalidParameter;return e*t}function o(e,t){if(0===t)throw c.DivisionByZero;var r=Object.create(c.prototype);r.s=e<0?-1:1;var n=u(e=e<0?-e:e,t);return r.n=e/n,r.d=t/n,r}function a(e){for(var t={},r=e,n=2,i=4;i<=r;){for(;r%n==0;)r/=n,t[n]=(t[n]||0)+1;i+=1+2*n++}return r!==e?r>1&&(t[r]=(t[r]||0)+1):t[e]=(t[e]||0)+1,t}var l=function(e,t){var r,n=0,o=1,a=1,l=0,u=0,d=0,h=1,f=1,p=0,m=1,g=1,y=1,v=1e7;if(null==e);else if(void 0!==t){if(a=(n=e)*(o=t),n%1!=0||o%1!=0)throw c.NonIntegerParameter}else switch(typeof e){case"object":if("d"in e&&"n"in e)n=e.n,o=e.d,"s"in e&&(n*=e.s);else{if(!(0 in e))throw c.InvalidParameter;n=e[0],1 in e&&(o=e[1])}a=n*o;break;case"number":if(e<0&&(a=e,e=-e),e%1==0)n=e;else if(e>0){for(e>=1&&(e/=f=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)));m<=v&&y<=v;){if(e===(r=(p+g)/(m+y))){m+y<=v?(n=p+g,o=m+y):y>m?(n=g,o=y):(n=p,o=m);break}e>r?(p+=g,m+=y):(g+=p,y+=m),m>v?(n=g,o=y):(n=p,o=m)}n*=f}else(isNaN(e)||isNaN(t))&&(o=n=NaN);break;case"string":if(null===(m=e.match(/\d+|./g)))throw c.InvalidParameter;if("-"===m[p]?(a=-1,p++):"+"===m[p]&&p++,m.length===p+1?u=s(m[p++],a):"."===m[p+1]||"."===m[p]?("."!==m[p]&&(l=s(m[p++],a)),(++p+1===m.length||"("===m[p+1]&&")"===m[p+3]||"'"===m[p+1]&&"'"===m[p+3])&&(u=s(m[p],a),h=Math.pow(10,m[p].length),p++),("("===m[p]&&")"===m[p+2]||"'"===m[p]&&"'"===m[p+2])&&(d=s(m[p+1],a),f=Math.pow(10,m[p+1].length)-1,p+=3)):"/"===m[p+1]||":"===m[p+1]?(u=s(m[p],a),h=s(m[p+2],1),p+=3):"/"===m[p+3]&&" "===m[p+1]&&(l=s(m[p],a),u=s(m[p+2],a),h=s(m[p+4],1),p+=5),m.length<=p){a=n=d+(o=h*f)*l+f*u;break}default:throw c.InvalidParameter}if(0===o)throw c.DivisionByZero;i.s=a<0?-1:1,i.n=Math.abs(n),i.d=Math.abs(o)};function u(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function c(e,t){if(l(e,t),!(this instanceof c))return o(i.s*i.n,i.d);e=u(i.d,i.n),this.s=i.s,this.n=i.n/e,this.d=i.d/e}c.DivisionByZero=new Error("Division by Zero"),c.InvalidParameter=new Error("Invalid argument"),c.NonIntegerParameter=new Error("Parameters must be integer"),c.prototype={s:1,n:0,d:1,abs:function(){return o(this.n,this.d)},neg:function(){return o(-this.s*this.n,this.d)},add:function(e,t){return l(e,t),o(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(e,t){return l(e,t),o(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(e,t){return l(e,t),o(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(e,t){return l(e,t),o(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return o(this.s*this.n,this.d)},mod:function(e,t){if(isNaN(this.n)||isNaN(this.d))return new c(NaN);if(void 0===e)return o(this.s*this.n%this.d,1);if(l(e,t),0===i.n&&0===this.d)throw c.DivisionByZero;return o(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d)},gcd:function(e,t){return l(e,t),o(u(i.n,this.n)*u(i.d,this.d),i.d*this.d)},lcm:function(e,t){return l(e,t),0===i.n&&0===this.n?o(0,1):o(i.n*this.n,u(i.n,this.n)*u(i.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):o(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):o(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):o(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return o(this.s*this.d,this.n)},pow:function(e,t){if(l(e,t),1===i.d)return i.s<0?o(Math.pow(this.s*this.d,i.n),Math.pow(this.n,i.n)):o(Math.pow(this.s*this.n,i.n),Math.pow(this.d,i.n));if(this.s<0)return null;var r=a(this.n),n=a(this.d),s=1,u=1;for(var c in r)if("1"!==c){if("0"===c){s=0;break}if(r[c]*=i.n,r[c]%i.d!=0)return null;r[c]/=i.d,s*=Math.pow(c,r[c])}for(var c in n)if("1"!==c){if(n[c]*=i.n,n[c]%i.d!=0)return null;n[c]/=i.d,u*=Math.pow(c,n[c])}return i.s<0?o(u,s):o(s,u)},equals:function(e,t){return l(e,t),this.s*this.n*i.d==i.s*i.n*this.d},compare:function(e,t){l(e,t);var r=this.s*this.n*i.d-i.s*i.n*this.d;return(0<r)-(r<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;e=e||.001;for(var t=this.abs(),r=t.toContinued(),n=1;n<r.length;n++){for(var i=o(r[n-1],1),s=n-2;s>=0;s--)i=i.inverse().add(r[s]);if(i.sub(t).abs().valueOf()<e)return i.mul(this.s)}return this},divisible:function(e,t){return l(e,t),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,r="",n=this.n,i=this.d;return this.s<0&&(r+="-"),1===i?r+=n:(e&&(t=Math.floor(n/i))>0&&(r+=t,r+=" ",n%=i),r+=n,r+="/",r+=i),r},toLatex:function(e){var t,r="",n=this.n,i=this.d;return this.s<0&&(r+="-"),1===i?r+=n:(e&&(t=Math.floor(n/i))>0&&(r+=t,n%=i),r+="\\frac{",r+=n,r+="}{",r+=i,r+="}"),r},toContinued:function(){var e,t=this.n,r=this.d,n=[];if(isNaN(t)||isNaN(r))return n;do{n.push(Math.floor(t/r)),e=t%r,t=r,r=e}while(1!==t);return n},toString:function(e){var t=this.n,r=this.d;if(isNaN(t)||isNaN(r))return"NaN";e=e||15;var n=function(e,t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var r=10%t,n=1;1!==r;n++)if(r=10*r%t,n>2e3)return 0;return n}(0,r),i=function(e,t,r){for(var n=1,i=function(e,t,r){for(var n=1;t>0;e=e*e%r,t>>=1)1&t&&(n=n*e%r);return n}(10,r,t),s=0;s<300;s++){if(n===i)return s;n=10*n%t,i=10*i%t}return 0}(0,r,n),s=this.s<0?"-":"";if(s+=t/r|0,t%=r,(t*=10)&&(s+="."),n){for(var o=i;o--;)s+=t/r|0,t%=r,t*=10;s+="(";for(o=n;o--;)s+=t/r|0,t%=r,t*=10;s+=")"}else for(o=e;t&&o--;)s+=t/r|0,t%=r,t*=10;return s}},void 0===(r=function(){return c}.apply(t,[]))||(e.exports=r)}()},63228:e=>{e.exports=function e(t,r){"use strict";var n,i,s=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,a=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,u=/^0/,c=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},d=c(t).replace(o,"")||"",h=c(r).replace(o,"")||"",f=d.replace(s,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=h.replace(s,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(d.match(l),16)||1!==f.length&&d.match(a)&&Date.parse(d),g=parseInt(h.match(l),16)||m&&h.match(a)&&Date.parse(h)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var y=0,v=Math.max(f.length,p.length);y<v;y++){if(n=!(f[y]||"").match(u)&&parseFloat(f[y])||f[y]||0,i=!(p[y]||"").match(u)&&parseFloat(p[y])||p[y]||0,isNaN(n)!==isNaN(i))return isNaN(n)?1:-1;if(typeof n!=typeof i&&(n+="",i+=""),n<i)return-1;if(n>i)return 1}return 0}},21443:function(e,t,r){"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={addCSS:!0,thumbWidth:15,watch:!0},a=function(e){return null!=e?e.constructor:null},l=function(e,t){return!!(e&&t&&e instanceof t)},u=function(e){return null==e},c=function(e){return a(e)===Object},d=function(e){return a(e)===String},h=function(e){return Array.isArray(e)},f=function(e){return l(e,NodeList)},p={nullOrUndefined:u,object:c,number:function(e){return a(e)===Number&&!Number.isNaN(e)},string:d,boolean:function(e){return a(e)===Boolean},function:function(e){return a(e)===Function},array:h,nodeList:f,element:function(e){return l(e,Element)},event:function(e){return l(e,Event)},empty:function(e){return u(e)||(d(e)||h(e)||f(e))&&!e.length||c(e)&&!Object.keys(e).length}};function m(e,t){if(1>t){var r=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(r))}return Math.round(e/t)*t}var g=function(){function e(t,r){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),p.element(t)?this.element=t:p.string(t)&&(this.element=document.querySelector(t)),p.element(this.element)&&p.empty(this.element.rangeTouch)&&(this.config=s({},o,{},r),this.init())}return function(e,r,n){r&&t(e.prototype,r),n&&t(e,n)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,r=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[r](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!p.event(t))return null;var r,n=t.target,i=t.changedTouches[0],s=parseFloat(n.getAttribute("min"))||0,o=parseFloat(n.getAttribute("max"))||100,a=parseFloat(n.getAttribute("step"))||1,l=n.getBoundingClientRect(),u=100/l.width*(this.config.thumbWidth/2)/100;return 0>(r=100/l.width*(i.clientX-l.left))?r=0:100<r&&(r=100),50>r?r-=(100-2*r)*u:50<r&&(r+=2*(r-50)*u),s+m(r/100*(o-s),a)}},{key:"set",value:function(t){e.enabled&&p.event(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var r=new Event(t,{bubbles:!0});e.dispatchEvent(r)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=null;if(p.empty(t)||p.string(t)?n=Array.from(document.querySelectorAll(p.string(t)?t:'input[type="range"]')):p.element(t)?n=[t]:p.nodeList(t)?n=Array.from(t):p.array(t)&&(n=t.filter(p.element)),p.empty(n))return null;var i=s({},o,{},r);if(p.string(t)&&i.watch){var a=new MutationObserver((function(r){Array.from(r).forEach((function(r){Array.from(r.addedNodes).forEach((function(r){p.element(r)&&function(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}(r,t)&&new e(r,i)}))}))}));a.observe(document.body,{childList:!0,subtree:!0})}return n.map((function(t){return new e(t,r)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();const y=e=>null!=e?e.constructor:null,v=(e,t)=>Boolean(e&&t&&e instanceof t),b=e=>null==e,x=e=>y(e)===Object,w=e=>y(e)===String,E=e=>"function"==typeof e,S=e=>Array.isArray(e),T=e=>v(e,NodeList),A=e=>b(e)||(w(e)||S(e)||T(e))&&!e.length||x(e)&&!Object.keys(e).length;var D={nullOrUndefined:b,object:x,number:e=>y(e)===Number&&!Number.isNaN(e),string:w,boolean:e=>y(e)===Boolean,function:E,array:S,weakMap:e=>v(e,WeakMap),nodeList:T,element:e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,textNode:e=>y(e)===Text,event:e=>v(e,Event),keyboardEvent:e=>v(e,KeyboardEvent),cue:e=>v(e,window.TextTrackCue)||v(e,window.VTTCue),track:e=>v(e,TextTrack)||!b(e)&&w(e.kind),promise:e=>v(e,Promise)&&E(e.then),url:e=>{if(v(e,window.URL))return!0;if(!w(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!A(new URL(t).hostname)}catch(e){return!1}},empty:A};const N=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},r=Object.keys(t).find((t=>void 0!==e.style[t]));return!!D.string(r)&&t[r]})();function C(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}var k={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function M(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function O(e={},...t){if(!t.length)return e;const r=t.shift();return D.object(r)?(Object.keys(r).forEach((t=>{D.object(r[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),O(e[t],r[t])):Object.assign(e,{[t]:r[t]})})),O(e,...t)):e}function _(e,t){const r=e.length?e:[e];Array.from(r).reverse().forEach(((e,r)=>{const n=r>0?t.cloneNode(!0):t,i=e.parentNode,s=e.nextSibling;n.appendChild(e),s?i.insertBefore(n,s):i.appendChild(n)}))}function L(e,t){D.element(e)&&!D.empty(t)&&Object.entries(t).filter((([,e])=>!D.nullOrUndefined(e))).forEach((([t,r])=>e.setAttribute(t,r)))}function R(e,t,r){const n=document.createElement(e);return D.object(t)&&L(n,t),D.string(r)&&(n.innerText=r),n}function I(e,t,r,n){D.element(t)&&t.appendChild(R(e,r,n))}function F(e){D.nodeList(e)||D.array(e)?Array.from(e).forEach(F):D.element(e)&&D.element(e.parentNode)&&e.parentNode.removeChild(e)}function P(e){if(!D.element(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function B(e,t){return D.element(t)&&D.element(t.parentNode)&&D.element(e)?(t.parentNode.replaceChild(e,t),e):null}function U(e,t){if(!D.string(e)||D.empty(e))return{};const r={},n=O({},t);return e.split(",").forEach((e=>{const t=e.trim(),i=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),[o]=s,a=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":D.string(n.class)?r.class=`${n.class} ${i}`:r.class=i;break;case"#":r.id=t.replace("#","");break;case"[":r[o]=a}})),O(n,r)}function $(e,t){if(!D.element(e))return;let r=t;D.boolean(r)||(r=!e.hidden),e.hidden=r}function j(e,t,r){if(D.nodeList(e))return Array.from(e).map((e=>j(e,t,r)));if(D.element(e)){let n="toggle";return void 0!==r&&(n=r?"add":"remove"),e.classList[n](t),e.classList.contains(t)}return!1}function z(e,t){return D.element(e)&&e.classList.contains(t)}function q(e,t){const{prototype:r}=Element;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function H(e){return this.elements.container.querySelectorAll(e)}function V(e){return this.elements.container.querySelector(e)}function G(e=null,t=!1){D.element(e)&&e.focus({preventScroll:!0,focusVisible:t})}const W={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},K={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t){const r=K[e]||"html5"!==t;return{api:r,ui:r&&K.rangeInput}},pip:!(k.isIPhone||!D.function(R("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||R("video").disablePictureInPicture)),airplay:D.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(D.empty(e))return!1;const[t]=e.split("/");let r=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(W).includes(r)&&(r+=`; codecs="${W[e]}"`);try{return Boolean(r&&this.media.canPlayType(r).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==N,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Y=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function J(e,t,r,n=!1,i=!0,s=!1){if(!e||!("addEventListener"in e)||D.empty(t)||!D.function(r))return;const o=t.split(" ");let a=s;Y&&(a={passive:i,capture:s}),o.forEach((t=>{this&&this.eventListeners&&n&&this.eventListeners.push({element:e,type:t,callback:r,options:a}),e[n?"addEventListener":"removeEventListener"](t,r,a)}))}function Z(e,t="",r,n=!0,i=!1){J.call(this,e,t,r,!0,n,i)}function X(e,t="",r,n=!0,i=!1){J.call(this,e,t,r,!1,n,i)}function Q(e,t="",r,n=!0,i=!1){const s=(...o)=>{X(e,t,s,n,i),r.apply(this,o)};J.call(this,e,t,s,!0,n,i)}function ee(e,t="",r=!1,n={}){if(!D.element(e)||D.empty(t))return;const i=new CustomEvent(t,{bubbles:r,detail:{...n,plyr:this}});e.dispatchEvent(i)}function te(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:r,callback:n,options:i}=e;t.removeEventListener(r,n,i)})),this.eventListeners=[])}function re(){return new Promise((e=>this.ready?setTimeout(e,0):Z.call(this,this.elements.container,"ready",e))).then((()=>{}))}function ne(e){D.promise(e)&&e.then(null,(()=>{}))}function ie(e){return D.array(e)?e.filter(((t,r)=>e.indexOf(t)===r)):e}function se(e,t){return D.array(e)&&e.length?e.reduce(((e,r)=>Math.abs(r-t)<Math.abs(e-t)?r:e)):null}function oe(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const ae=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,r])=>({...e,[t/r]:[t,r]})),{});function le(e){return!!(D.array(e)||D.string(e)&&e.includes(":"))&&(D.array(e)?e:e.split(":")).map(Number).every(D.number)}function ue(e){if(!D.array(e)||!e.every(D.number))return null;const[t,r]=e,n=(e,t)=>0===t?e:n(t,e%t),i=n(t,r);return[t/i,r/i]}function ce(e){const t=e=>le(e)?e.split(":").map(Number):null;let r=t(e);if(null===r&&(r=t(this.config.ratio)),null===r&&!D.empty(this.embed)&&D.array(this.embed.ratio)&&({ratio:r}=this.embed),null===r&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;r=[e,t]}return ue(r)}function de(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,r=ce.call(this,e);if(!D.array(r))return{};const[n,i]=ue(r),s=100/n*i;if(oe(`aspect-ratio: ${n}/${i}`)?t.style.aspectRatio=`${n}/${i}`:t.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),r=(e-s)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${r}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:r}}function he(e,t,r=.05){const n=e/t,i=se(Object.keys(ae),n);return Math.abs(i-n)<=r?ae[i]:[e,t]}const fe={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!D.empty(t)||K.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:fe.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,D.empty(this.config.ratio)||de.call(e),Object.defineProperty(e.media,"quality",{get(){const t=fe.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&D.function(e.config.quality.onChange))e.config.quality.onChange(t);else{const r=fe.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!r)return;const{currentTime:n,paused:i,preload:s,readyState:o,playbackRate:a}=e.media;e.media.src=r.getAttribute("src"),("none"!==s||o)&&(e.once("loadedmetadata",(()=>{e.speed=a,e.currentTime=n,i||ne(e.play())})),e.media.load())}ee.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(F(fe.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function pe(e,...t){return D.empty(e)?e:e.toString().replace(/{(\d+)}/g,((e,r)=>t[r].toString()))}const me=(e="",t="",r="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),r.toString()),ge=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function ye(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=me(t,"-"," "),t=me(t,"_"," "),t=ge(t),me(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}function ve(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const be={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},xe={get(e="",t={}){if(D.empty(e)||D.empty(t))return"";let r=M(t.i18n,e);if(D.empty(r))return Object.keys(be).includes(e)?be[e]:"";const n={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(n).forEach((([e,t])=>{r=me(r,e,t)})),r}};class we{constructor(t){e(this,"get",(e=>{if(!we.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(D.empty(t))return null;const r=JSON.parse(t);return D.string(e)&&e.length?r[e]:r})),e(this,"set",(e=>{if(!we.supported||!this.enabled)return;if(!D.object(e))return;let t=this.get();D.empty(t)&&(t={}),O(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Ee(e,t="text"){return new Promise(((r,n)=>{try{const n=new XMLHttpRequest;if(!("withCredentials"in n))return;n.addEventListener("load",(()=>{if("text"===t)try{r(JSON.parse(n.responseText))}catch(e){r(n.responseText)}else r(n.response)})),n.addEventListener("error",(()=>{throw new Error(n.status)})),n.open("GET",e,!0),n.responseType=t,n.send()}catch(e){n(e)}}))}function Se(e,t){if(!D.string(e))return;const r="cache",n=D.string(t);let i=!1;const s=()=>null!==document.getElementById(t),o=(e,t)=>{e.innerHTML=t,n&&s()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!s()){const s=we.supported,a=document.createElement("div");if(a.setAttribute("hidden",""),n&&a.setAttribute("id",t),s){const e=window.localStorage.getItem(`${r}-${t}`);if(i=null!==e,i){const t=JSON.parse(e);o(a,t.content)}}Ee(e).then((e=>{if(!D.empty(e)){if(s)try{window.localStorage.setItem(`${r}-${t}`,JSON.stringify({content:e}))}catch(e){}o(a,e)}})).catch((()=>{}))}}const Te=e=>Math.trunc(e/60/60%60,10),Ae=e=>Math.trunc(e/60%60,10),De=e=>Math.trunc(e%60,10);function Ne(e=0,t=!1,r=!1){if(!D.number(e))return Ne(void 0,t,r);const n=e=>`0${e}`.slice(-2);let i=Te(e);const s=Ae(e),o=De(e);return i=t||i>0?`${i}:`:"",`${r&&e>0?"-":""}${i}${n(s)}:${n(o)}`}const Ce={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,r=e.host!==t||k.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:r}},findElements(){try{return this.elements.controls=V.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:H.call(this,this.config.selectors.buttons.play),pause:V.call(this,this.config.selectors.buttons.pause),restart:V.call(this,this.config.selectors.buttons.restart),rewind:V.call(this,this.config.selectors.buttons.rewind),fastForward:V.call(this,this.config.selectors.buttons.fastForward),mute:V.call(this,this.config.selectors.buttons.mute),pip:V.call(this,this.config.selectors.buttons.pip),airplay:V.call(this,this.config.selectors.buttons.airplay),settings:V.call(this,this.config.selectors.buttons.settings),captions:V.call(this,this.config.selectors.buttons.captions),fullscreen:V.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=V.call(this,this.config.selectors.progress),this.elements.inputs={seek:V.call(this,this.config.selectors.inputs.seek),volume:V.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:V.call(this,this.config.selectors.display.buffer),currentTime:V.call(this,this.config.selectors.display.currentTime),duration:V.call(this,this.config.selectors.display.duration)},D.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const r="http://www.w3.org/2000/svg",n=Ce.getIconUrl.call(this),i=`${n.cors?"":n.url}#${this.config.iconPrefix}`,s=document.createElementNS(r,"svg");L(s,O(t,{"aria-hidden":"true",focusable:"false"}));const o=document.createElementNS(r,"use"),a=`${i}-${e}`;return"href"in o&&o.setAttributeNS("http://www.w3.org/1999/xlink","href",a),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),s.appendChild(o),s},createLabel(e,t={}){const r=xe.get(e,this.config);return R("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},r)},createBadge(e){if(D.empty(e))return null;const t=R("span",{class:this.config.classNames.menu.value});return t.appendChild(R("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const r=O({},t);let n=ye(e);const i={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(r).includes(e)&&(i[e]=r[e],delete r[e])})),"button"!==i.element||Object.keys(r).includes("type")||(r.type="button"),Object.keys(r).includes("class")?r.class.split(" ").some((e=>e===this.config.classNames.control))||O(r,{class:`${r.class} ${this.config.classNames.control}`}):r.class=this.config.classNames.control,e){case"play":i.toggle=!0,i.label="play",i.labelPressed="pause",i.icon="play",i.iconPressed="pause";break;case"mute":i.toggle=!0,i.label="mute",i.labelPressed="unmute",i.icon="volume",i.iconPressed="muted";break;case"captions":i.toggle=!0,i.label="enableCaptions",i.labelPressed="disableCaptions",i.icon="captions-off",i.iconPressed="captions-on";break;case"fullscreen":i.toggle=!0,i.label="enterFullscreen",i.labelPressed="exitFullscreen",i.icon="enter-fullscreen",i.iconPressed="exit-fullscreen";break;case"play-large":r.class+=` ${this.config.classNames.control}--overlaid`,n="play",i.label="play",i.icon="play";break;default:D.empty(i.label)&&(i.label=n),D.empty(i.icon)&&(i.icon=e)}const s=R(i.element);return i.toggle?(s.appendChild(Ce.createIcon.call(this,i.iconPressed,{class:"icon--pressed"})),s.appendChild(Ce.createIcon.call(this,i.icon,{class:"icon--not-pressed"})),s.appendChild(Ce.createLabel.call(this,i.labelPressed,{class:"label--pressed"})),s.appendChild(Ce.createLabel.call(this,i.label,{class:"label--not-pressed"}))):(s.appendChild(Ce.createIcon.call(this,i.icon)),s.appendChild(Ce.createLabel.call(this,i.label))),O(r,U(this.config.selectors.buttons[n],r)),L(s,r),"play"===n?(D.array(this.elements.buttons[n])||(this.elements.buttons[n]=[]),this.elements.buttons[n].push(s)):this.elements.buttons[n]=s,s},createRange(e,t){const r=R("input",O(U(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":xe.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=r,Ce.updateRangeFill.call(this,r),g.setup(r),r},createProgress(e,t){const r=R("progress",O(U(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){r.appendChild(R("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],n=t?xe.get(t,this.config):"";r.innerText=`% ${n.toLowerCase()}`}return this.elements.display[e]=r,r},createTime(e,t){const r=U(this.config.selectors.display[e],t),n=R("div",O(r,{class:`${r.class?r.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":xe.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=n,n},bindMenuItemShortcuts(e,t){Z.call(this,e,"keydown keyup",(r=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(r.key))return;if(r.preventDefault(),r.stopPropagation(),"keydown"===r.type)return;const n=q(e,'[role="menuitemradio"]');if(!n&&[" ","ArrowRight"].includes(r.key))Ce.showMenuPanel.call(this,t,!0);else{let t;" "!==r.key&&("ArrowDown"===r.key||n&&"ArrowRight"===r.key?(t=e.nextElementSibling,D.element(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,D.element(t)||(t=e.parentNode.lastElementChild)),G.call(this,t,!0))}}),!1),Z.call(this,e,"keyup",(e=>{"Return"===e.key&&Ce.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:r,title:n,badge:i=null,checked:s=!1}){const o=U(this.config.selectors.inputs[r]),a=R("button",O(o,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${o.class?o.class:""}`.trim(),"aria-checked":s,value:e})),l=R("span");l.innerHTML=n,D.element(i)&&l.appendChild(i),a.appendChild(l),Object.defineProperty(a,"checked",{enumerable:!0,get:()=>"true"===a.getAttribute("aria-checked"),set(e){e&&Array.from(a.parentNode.children).filter((e=>q(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),a.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(a,"click keyup",(t=>{if(!D.keyboardEvent(t)||" "===t.key){switch(t.preventDefault(),t.stopPropagation(),a.checked=!0,r){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}Ce.showMenuPanel.call(this,"home",D.keyboardEvent(t))}}),r,!1),Ce.bindMenuItemShortcuts.call(this,a,r),t.appendChild(a)},formatTime(e=0,t=!1){return D.number(e)?Ne(e,Te(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,r=!1){D.element(e)&&D.number(t)&&(e.innerText=Ce.formatTime(t,r))},updateVolume(){this.supported.ui&&(D.element(this.elements.inputs.volume)&&Ce.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),D.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){D.element(e)&&(e.value=t,Ce.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!D.event(e))return;let t=0;const r=(e,t)=>{const r=D.number(t)?t:0,n=D.element(e)?e:this.elements.display.buffer;if(D.element(n)){n.value=r;const e=n.getElementsByTagName("span")[0];D.element(e)&&(e.childNodes[0].nodeValue=r)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":n=this.currentTime,i=this.duration,t=0===n||0===i||Number.isNaN(n)||Number.isNaN(i)?0:(n/i*100).toFixed(2),"timeupdate"===e.type&&Ce.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":r(this.elements.display.buffer,100*this.buffered)}var n,i},updateRangeFill(e){const t=D.event(e)?e.target:e;if(D.element(t)&&"range"===t.getAttribute("type")){if(q(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=Ce.formatTime(this.currentTime),r=Ce.formatTime(this.duration),n=xe.get("seekLabel",this.config);t.setAttribute("aria-valuetext",n.replace("{currentTime}",e).replace("{duration}",r))}else if(q(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);(k.isWebKit||k.isIPadOS)&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,r;if(!this.config.tooltips.seek||!D.element(this.elements.inputs.seek)||!D.element(this.elements.display.seekTooltip)||0===this.duration)return;const n=this.elements.display.seekTooltip,i=`${this.config.classNames.tooltip}--visible`,s=e=>j(n,i,e);if(this.touch)return void s(!1);let o=0;const a=this.elements.progress.getBoundingClientRect();if(D.event(e))o=100/a.width*(e.pageX-a.left);else{if(!z(n,i))return;o=parseFloat(n.style.left,10)}o<0?o=0:o>100&&(o=100);const l=this.duration/100*o;n.innerText=Ce.formatTime(l);const u=null===(t=this.config.markers)||void 0===t||null===(r=t.points)||void 0===r?void 0:r.find((({time:e})=>e===Math.round(l)));u&&n.insertAdjacentHTML("afterbegin",`${u.label}<br>`),n.style.left=`${o}%`,D.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&s("mouseenter"===e.type)},timeUpdate(e){const t=!D.element(this.elements.display.duration)&&this.config.invertTime;Ce.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Ce.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return $(this.elements.display.currentTime,!0),void $(this.elements.progress,!0);D.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=D.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Ce.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Ce.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ce.setMarkers.call(this),Ce.updateSeekTooltip.call(this)},toggleMenuButton(e,t){$(this.elements.settings.buttons[e],!t)},updateSetting(e,t,r){const n=this.elements.settings.panels[e];let i=null,s=t;if("captions"===e)i=this.currentTrack;else{if(i=D.empty(r)?this[e]:r,D.empty(i)&&(i=this.config[e].default),!D.empty(this.options[e])&&!this.options[e].includes(i))return void this.debug.warn(`Unsupported value of '${i}' for ${e}`);if(!this.config[e].options.includes(i))return void this.debug.warn(`Disabled value of '${i}' for ${e}`)}if(D.element(s)||(s=n&&n.querySelector('[role="menu"]')),!D.element(s))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=Ce.getLabel.call(this,e,i);const o=s&&s.querySelector(`[value="${i}"]`);D.element(o)&&(o.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?xe.get("normal",this.config):`${t}&times;`;case"quality":if(D.number(t)){const e=xe.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return ge(t);case"captions":return Oe.getLabel.call(this);default:return null}},setQualityMenu(e){if(!D.element(this.elements.settings.panels.quality))return;const t="quality",r=this.elements.settings.panels.quality.querySelector('[role="menu"]');D.array(e)&&(this.options.quality=ie(e).filter((e=>this.config.quality.options.includes(e))));const n=!D.empty(this.options.quality)&&this.options.quality.length>1;if(Ce.toggleMenuButton.call(this,t,n),P(r),Ce.checkMenu.call(this),!n)return;const i=e=>{const t=xe.get(`qualityBadge.${e}`,this.config);return t.length?Ce.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const r=this.config.quality.options;return r.indexOf(e)>r.indexOf(t)?1:-1})).forEach((e=>{Ce.createMenuItem.call(this,{value:e,list:r,type:t,title:Ce.getLabel.call(this,"quality",e),badge:i(e)})})),Ce.updateSetting.call(this,t,r)},setCaptionsMenu(){if(!D.element(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),r=Oe.getTracks.call(this),n=Boolean(r.length);if(Ce.toggleMenuButton.call(this,e,n),P(t),Ce.checkMenu.call(this),!n)return;const i=r.map(((e,r)=>({value:r,checked:this.captions.toggled&&this.currentTrack===r,title:Oe.getLabel.call(this,e),badge:e.language&&Ce.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));i.unshift({value:-1,checked:!this.captions.toggled,title:xe.get("disabled",this.config),list:t,type:"language"}),i.forEach(Ce.createMenuItem.bind(this)),Ce.updateSetting.call(this,e,t)},setSpeedMenu(){if(!D.element(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const r=!D.empty(this.options.speed)&&this.options.speed.length>1;Ce.toggleMenuButton.call(this,e,r),P(t),Ce.checkMenu.call(this),r&&(this.options.speed.forEach((r=>{Ce.createMenuItem.call(this,{value:r,list:t,type:e,title:Ce.getLabel.call(this,"speed",r)})})),Ce.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!D.empty(e)&&Object.values(e).some((e=>!e.hidden));$(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let r=e;D.element(r)||(r=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const n=r.querySelector('[role^="menuitem"]');G.call(this,n,t)},toggleMenu(e){const{popup:t}=this.elements.settings,r=this.elements.buttons.settings;if(!D.element(t)||!D.element(r))return;const{hidden:n}=t;let i=n;if(D.boolean(e))i=e;else if(D.keyboardEvent(e)&&"Escape"===e.key)i=!1;else if(D.event(e)){const n=D.function(e.composedPath)?e.composedPath()[0]:e.target,s=t.contains(n);if(s||!s&&e.target!==r&&i)return}r.setAttribute("aria-expanded",i),$(t,!i),j(this.elements.container,this.config.classNames.menu.open,i),i&&D.keyboardEvent(e)?Ce.focusFirstMenuItem.call(this,null,!0):i||n||G.call(this,r,D.keyboardEvent(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const r=t.scrollWidth,n=t.scrollHeight;return F(t),{width:r,height:n}},showMenuPanel(e="",t=!1){const r=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!D.element(r))return;const n=r.parentNode,i=Array.from(n.children).find((e=>!e.hidden));if(K.transitions&&!K.reducedMotion){n.style.width=`${i.scrollWidth}px`,n.style.height=`${i.scrollHeight}px`;const e=Ce.getMenuSize.call(this,r),t=e=>{e.target===n&&["width","height"].includes(e.propertyName)&&(n.style.width="",n.style.height="",X.call(this,n,N,t))};Z.call(this,n,N,t),n.style.width=`${e.width}px`,n.style.height=`${e.height}px`}$(i,!0),$(r,!1),Ce.focusFirstMenuItem.call(this,r,t)},setDownloadUrl(){const e=this.elements.buttons.download;D.element(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:r,createProgress:n,createRange:i,createTime:s,setQualityMenu:o,setSpeedMenu:a,showMenuPanel:l}=Ce;this.elements.controls=null,D.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(r.call(this,"play-large"));const u=R("div",U(this.config.selectors.controls.wrapper));this.elements.controls=u;const c={class:"plyr__controls__item"};return ie(D.array(this.config.controls)?this.config.controls:[]).forEach((o=>{if("restart"===o&&u.appendChild(r.call(this,"restart",c)),"rewind"===o&&u.appendChild(r.call(this,"rewind",c)),"play"===o&&u.appendChild(r.call(this,"play",c)),"fast-forward"===o&&u.appendChild(r.call(this,"fast-forward",c)),"progress"===o){const t=R("div",{class:`${c.class} plyr__progress__container`}),r=R("div",U(this.config.selectors.progress));if(r.appendChild(i.call(this,"seek",{id:`plyr-seek-${e.id}`})),r.appendChild(n.call(this,"buffer")),this.config.tooltips.seek){const e=R("span",{class:this.config.classNames.tooltip},"00:00");r.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=r,t.appendChild(this.elements.progress),u.appendChild(t)}if("current-time"===o&&u.appendChild(s.call(this,"currentTime",c)),"duration"===o&&u.appendChild(s.call(this,"duration",c)),"mute"===o||"volume"===o){let{volume:t}=this.elements;if(D.element(t)&&u.contains(t)||(t=R("div",O({},c,{class:`${c.class} plyr__volume`.trim()})),this.elements.volume=t,u.appendChild(t)),"mute"===o&&t.appendChild(r.call(this,"mute")),"volume"===o&&!k.isIos&&!k.isIPadOS){const r={max:1,step:.05,value:this.config.volume};t.appendChild(i.call(this,"volume",O(r,{id:`plyr-volume-${e.id}`})))}}if("captions"===o&&u.appendChild(r.call(this,"captions",c)),"settings"===o&&!D.empty(this.config.settings)){const n=R("div",O({},c,{class:`${c.class} plyr__menu`.trim(),hidden:""}));n.appendChild(r.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const i=R("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),s=R("div"),o=R("div",{id:`plyr-settings-${e.id}-home`}),a=R("div",{role:"menu"});o.appendChild(a),s.appendChild(o),this.elements.settings.panels.home=o,this.config.settings.forEach((r=>{const n=R("button",O(U(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,n,r),Z.call(this,n,"click",(()=>{l.call(this,r,!1)}));const i=R("span",null,xe.get(r,this.config)),o=R("span",{class:this.config.classNames.menu.value});o.innerHTML=e[r],i.appendChild(o),n.appendChild(i),a.appendChild(n);const u=R("div",{id:`plyr-settings-${e.id}-${r}`,hidden:""}),c=R("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});c.appendChild(R("span",{"aria-hidden":!0},xe.get(r,this.config))),c.appendChild(R("span",{class:this.config.classNames.hidden},xe.get("menuBack",this.config))),Z.call(this,u,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),Z.call(this,c,"click",(()=>{l.call(this,"home",!1)})),u.appendChild(c),u.appendChild(R("div",{role:"menu"})),s.appendChild(u),this.elements.settings.buttons[r]=n,this.elements.settings.panels[r]=u})),i.appendChild(s),n.appendChild(i),u.appendChild(n),this.elements.settings.popup=i,this.elements.settings.menu=n}if("pip"===o&&K.pip&&u.appendChild(r.call(this,"pip",c)),"airplay"===o&&K.airplay&&u.appendChild(r.call(this,"airplay",c)),"download"===o){const e=O({},c,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!D.url(t)&&this.isEmbed&&O(e,{icon:`logo-${this.provider}`,label:this.provider}),u.appendChild(r.call(this,"download",e))}"fullscreen"===o&&u.appendChild(r.call(this,"fullscreen",c))})),this.isHTML5&&o.call(this,fe.getQualityOptions.call(this)),a.call(this),u},inject(){if(this.config.loadSprite){const e=Ce.getIconUrl.call(this);e.cors&&Se(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let r,n=!0;if(D.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),D.element(this.config.controls)||D.string(this.config.controls)?e=this.config.controls:(e=Ce.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Oe.getLabel.call(this)}),n=!1),n&&D.string(this.config.controls)&&(e=(e=>{let r=e;return Object.entries(t).forEach((([e,t])=>{r=me(r,`{${e}}`,t)})),r})(e)),D.string(this.config.selectors.controls.container)&&(r=document.querySelector(this.config.selectors.controls.container)),D.element(r)||(r=this.elements.container),r[D.element(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),D.element(this.elements.controls)||Ce.findElements.call(this),!D.empty(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>z(e,t),set(r=!1){j(e,t,r),e.setAttribute("aria-pressed",r?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{D.array(t)||D.nodeList(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(k.isEdge&&C(r),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,r=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,n=H.call(this,r);Array.from(n).forEach((e=>{j(e,this.config.classNames.hidden,!1),j(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const r=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==r||!r.length)return;const n=document.createDocumentFragment(),i=document.createDocumentFragment();let s=null;const o=`${this.config.classNames.tooltip}--visible`,a=e=>j(s,o,e);r.forEach((e=>{const t=R("span",{class:this.config.classNames.marker},""),r=e.time/this.duration*100+"%";s&&(t.addEventListener("mouseenter",(()=>{e.label||(s.style.left=r,s.innerHTML=e.label,a(!0))})),t.addEventListener("mouseleave",(()=>{a(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=r,i.appendChild(t)})),n.appendChild(i),this.config.tooltips.seek||(s=R("span",{class:this.config.classNames.tooltip},""),n.appendChild(s)),this.elements.markers={points:i,tip:s},this.elements.progress.appendChild(n)}};function ke(e,t=!0){let r=e;if(t){const e=document.createElement("a");e.href=r,r=e.href}try{return new URL(r)}catch(e){return null}}function Me(e){const t=new URLSearchParams;return D.object(e)&&Object.entries(e).forEach((([e,r])=>{t.set(e,r)})),t}const Oe={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!K.textTracks)return void(D.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ce.setCaptionsMenu.call(this));var e,t;if(D.element(this.elements.captions)||(this.elements.captions=R("div",U(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper,D.element(e)&&D.element(t)&&t.parentNode.insertBefore(e,t.nextSibling)),k.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),r=ke(t);null!==r&&r.hostname!==window.location.href.hostname&&["http:","https:"].includes(r.protocol)&&Ee(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{F(e)}))}))}const r=ie((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===n&&([n]=r);let i=this.storage.get("captions");if(D.boolean(i)||({active:i}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:i,language:n,languages:r}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";Z.call(this,this.media.textTracks,e,Oe.update.bind(this))}setTimeout(Oe.update.bind(this),0)},update(){const e=Oe.getTracks.call(this,!0),{active:t,language:r,meta:n,currentTrackNode:i}=this.captions,s=Boolean(e.find((e=>e.language===r)));this.isHTML5&&this.isVideo&&e.filter((e=>!n.get(e))).forEach((e=>{this.debug.log("Track added",e),n.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),Z.call(this,e,"cuechange",(()=>Oe.updateCues.call(this)))})),(s&&this.language!==r||!e.includes(i))&&(Oe.setLanguage.call(this,r),Oe.toggle.call(this,t&&s)),this.elements&&j(this.elements.container,this.config.classNames.captions.enabled,!D.empty(e)),D.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ce.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:r}=this.captions,n=this.config.classNames.captions.active,i=D.nullOrUndefined(e)?!r:e;if(i!==r){if(t||(this.captions.active=i,this.storage.set({captions:i})),!this.language&&i&&!t){const e=Oe.getTracks.call(this),t=Oe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void Oe.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=i),j(this.elements.container,n,i),this.captions.toggled=i,Ce.updateSetting.call(this,"captions"),ee.call(this,this.media,i?"captionsenabled":"captionsdisabled")}setTimeout((()=>{i&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const r=Oe.getTracks.call(this);if(-1!==e)if(D.number(e))if(e in r){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const n=r[e],{language:i}=n||{};this.captions.currentTrackNode=n,Ce.updateSetting.call(this,"captions"),t||(this.captions.language=i,this.storage.set({language:i})),this.isVimeo&&this.embed.enableTextTrack(i),ee.call(this,this.media,"languagechange")}Oe.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&Oe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else Oe.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!D.string(e))return void this.debug.warn("Invalid language argument",e);const r=e.toLowerCase();this.captions.language=r;const n=Oe.getTracks.call(this),i=Oe.findTrack.call(this,[r]);Oe.set.call(this,n.indexOf(i),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const r=Oe.getTracks.call(this),n=e=>Number((this.captions.meta.get(e)||{}).default),i=Array.from(r).sort(((e,t)=>n(t)-n(e)));let s;return e.every((e=>(s=i.find((t=>t.language===e)),!s))),s||(t?i[0]:void 0)},getCurrentTrack(){return Oe.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!D.track(t)&&K.textTracks&&this.captions.toggled&&(t=Oe.getCurrentTrack.call(this)),D.track(t)?D.empty(t.label)?D.empty(t.language)?xe.get("enabled",this.config):e.language.toUpperCase():t.label:xe.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!D.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!D.nullOrUndefined(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=Oe.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(ve)}const r=t.map((e=>e.trim())).join("\n");if(r!==this.elements.captions.innerHTML){P(this.elements.captions);const e=R("span",U(this.config.selectors.caption));e.innerHTML=r,this.elements.captions.appendChild(e),ee.call(this,this.media,"cuechange")}}},_e={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Le="picture-in-picture",Re="inline",Ie={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Fe="audio",Pe="video",Be=()=>{};class Ue{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Be}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Be}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Be}}class $e{constructor(t){e(this,"onChange",(()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;D.element(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;ee.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),e(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",j(this.target,this.player.config.classNames.fullscreen.fallback,e),k.isIos){let t=document.head.querySelector('meta[name="viewport"]');const r="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const n=D.string(t.content)&&t.content.includes(r);e?(this.cleanupViewport=!n,n||(t.content+=`,${r}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==r)).join(","))}this.onChange()})),e(this,"trapFocus",(e=>{if(k.isIos||k.isIPadOS||!this.active||"Tab"!==e.key)return;const t=document.activeElement,r=H.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[n]=r,i=r[r.length-1];t!==i||e.shiftKey?t===n&&e.shiftKey&&(i.focus(),e.preventDefault()):(n.focus(),e.preventDefault())})),e(this,"update",(()=>{if(this.supported){let e;e=this.forceFallback?"Fallback (forced)":$e.nativeSupported?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");j(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)})),e(this,"enter",(()=>{this.supported&&(k.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!$e.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?D.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),e(this,"exit",(()=>{if(this.supported)if(k.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),ne(this.player.play());else if(!$e.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!D.empty(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),e(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=t,this.prefix=$e.prefix,this.property=$e.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&function(e,t){const{prototype:r}=Element;return(r.closest||function(){let e=this;do{if(q.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,t.config.fullscreen.container),Z.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),Z.call(this.player,this.player.elements.container,"dblclick",(e=>{D.element(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),Z.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return $e.nativeSupported&&!this.forceFallback}static get prefix(){if(D.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!D.function(document[`${t}ExitFullscreen`])&&!D.function(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,$e.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||$e.nativeSupported||!k.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!$e.nativeSupported||this.forceFallback)return z(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return k.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function je(e,t=1){return new Promise(((r,n)=>{const i=new Image,s=()=>{delete i.onload,delete i.onerror,(i.naturalWidth>=t?r:n)(i)};Object.assign(i,{onload:s,onerror:s,src:e})}))}const ze={addStyleHook(){j(this.elements.container,this.config.selectors.container.replace(".",""),!0),j(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void ze.toggleNativeControls.call(this,!0);D.element(this.elements.controls)||(Ce.inject.call(this),this.listeners.controls()),ze.toggleNativeControls.call(this),this.isHTML5&&Oe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ce.updateVolume.call(this),Ce.timeUpdate.call(this),Ce.durationUpdate.call(this),ze.checkPlaying.call(this),j(this.elements.container,this.config.classNames.pip.supported,K.pip&&this.isHTML5&&this.isVideo),j(this.elements.container,this.config.classNames.airplay.supported,K.airplay&&this.isHTML5),j(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{ee.call(this,this.media,"ready")}),0),ze.setTitle.call(this),this.poster&&ze.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&Ce.durationUpdate.call(this),this.config.mediaMetadata&&Ce.setMediaMetadata.call(this)},setTitle(){let e=xe.get("play",this.config);if(D.string(this.config.title)&&!D.empty(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=V.call(this,"iframe");if(!D.element(e))return;const t=D.empty(this.config.title)?"video":this.config.title,r=xe.get("frameTitle",this.config);e.setAttribute("title",r.replace("{title}",t))}},togglePoster(e){j(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),re.call(this).then((()=>je(e))).catch((t=>{throw e===this.poster&&ze.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),ze.togglePoster.call(this,!0),e))))},checkPlaying(e){j(this.elements.container,this.config.classNames.playing,this.playing),j(this.elements.container,this.config.classNames.paused,this.paused),j(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",xe.get(this.playing?"pause":"play",this.config))})),D.event(e)&&"timeupdate"===e.type||ze.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{j(this.elements.container,this.config.classNames.loading,this.loading),ze.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const r=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||r))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!D.empty(e)&&D.string(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),D.empty(this.media.style)&&this.media.removeAttribute("style")}};class qe{constructor(t){e(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,j(t.container,e.config.classNames.isTouch,!0)})),e(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&J.call(t,window,"keydown keyup",this.handleKey,e,!1),J.call(t,document.body,"click",this.toggleMenu,e),Q.call(t,document.body,"touchstart",this.firstTouch)})),e(this,"container",(()=>{const{player:e}=this,{config:t,elements:r,timers:n}=e;!t.keyboard.global&&t.keyboard.focused&&Z.call(e,r.container,"keydown keyup",this.handleKey,!1),Z.call(e,r.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:i}=r;i&&"enterfullscreen"===t.type&&(i.pressed=!1,i.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(ze.toggleControls.call(e,!0),s=e.touch?3e3:2e3),clearTimeout(n.controls),n.controls=setTimeout((()=>ze.toggleControls.call(e,!1)),s)}));const i=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=r.wrapper,{active:n}=e.fullscreen,[i,s]=ce.call(e),o=oe(`aspect-ratio: ${i} / ${s}`);if(!n)return void(o?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[a,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],u=a/l>i/s;o?(t.style.width=u?"auto":"100%",t.style.height=u?"100%":"auto"):(t.style.maxWidth=u?l/s*i+"px":null,t.style.margin=u?"0 auto":null)},s=()=>{clearTimeout(n.resized),n.resized=setTimeout(i,50)};Z.call(e,r.container,"enterfullscreen exitfullscreen",(t=>{const{target:n}=e.fullscreen;n===r.container&&(!e.isEmbed&&D.empty(e.config.ratio)||(i(),("enterfullscreen"===t.type?Z:X).call(e,window,"resize",s)))}))})),e(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(Z.call(e,e.media,"timeupdate seeking seeked",(t=>Ce.timeUpdate.call(e,t))),Z.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>Ce.durationUpdate.call(e,t))),Z.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),Z.call(e,e.media,"progress playing seeking seeked",(t=>Ce.updateProgress.call(e,t))),Z.call(e,e.media,"volumechange",(t=>Ce.updateVolume.call(e,t))),Z.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>ze.checkPlaying.call(e,t))),Z.call(e,e.media,"waiting canplay seeked playing",(t=>ze.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const r=V.call(e,`.${e.config.classNames.video}`);if(!D.element(r))return;Z.call(e,t.container,"click",(n=>{([t.container,r].includes(n.target)||r.contains(n.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(n,e.restart,"restart"),this.proxy(n,(()=>{ne(e.play())}),"play")):this.proxy(n,(()=>{ne(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&Z.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),Z.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),Z.call(e,e.media,"ratechange",(()=>{Ce.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),Z.call(e,e.media,"qualitychange",(t=>{Ce.updateSetting.call(e,"quality",null,t.detail.quality)})),Z.call(e,e.media,"ready qualitychange",(()=>{Ce.setDownloadUrl.call(e)}));const r=e.config.events.concat(["keyup","keydown"]).join(" ");Z.call(e,e.media,r,(r=>{let{detail:n={}}=r;"error"===r.type&&(n=e.media.error),ee.call(e,t.container,r.type,!0,n)}))})),e(this,"proxy",((e,t,r)=>{const{player:n}=this,i=n.config.listeners[r];let s=!0;D.function(i)&&(s=i.call(n,e)),!1!==s&&D.function(t)&&t.call(n,e)})),e(this,"bind",((e,t,r,n,i=!0)=>{const{player:s}=this,o=s.config.listeners[n],a=D.function(o);Z.call(s,e,t,(e=>this.proxy(e,r,n)),i&&!a)})),e(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,r=k.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{ne(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{ee.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),Ce.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{[" ","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),Ce.toggleMenu.call(e,t)):Ce.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&Ce.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const r=t.progress.getBoundingClientRect(),n=100/r.width*(e.pageX-r.left);e.currentTarget.setAttribute("seek-value",n)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const r=t.currentTarget,n="play-on-seeked";if(D.keyboardEvent(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const i=r.hasAttribute(n),s=["mouseup","touchend","keyup"].includes(t.type);i&&s?(r.removeAttribute(n),ne(e.play())):!s&&e.playing&&(r.setAttribute(n,""),e.pause())})),k.isIos){const t=H.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,r,(e=>C(e.target)))))}this.bind(t.inputs.seek,r,(t=>{const r=t.currentTarget;let n=r.getAttribute("seek-value");D.empty(n)&&(n=r.value),r.removeAttribute("seek-value"),e.currentTime=n/r.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>Ce.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.endScrubbing(t)})),k.isWebKit&&Array.from(H.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>Ce.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!D.element(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,Ce.timeUpdate.call(e))})),this.bind(t.inputs.volume,r,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(r=>{t.controls.hover=!e.touch&&"mouseenter"===r.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((r=>{this.bind(r,"mouseenter mouseleave",(r=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===r.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:r,timers:n}=e;j(t.controls,r.classNames.noTransition,!0),ze.toggleControls.call(e,!0),setTimeout((()=>{j(t.controls,r.classNames.noTransition,!1)}),0);const i=this.touch?3e3:4e3;clearTimeout(n.controls),n.controls=setTimeout((()=>ze.toggleControls.call(e,!1)),i)})),this.bind(t.inputs.volume,"wheel",(t=>{const r=t.webkitDirectionInvertedFromDevice,[n,i]=[t.deltaX,-t.deltaY].map((e=>r?-e:e)),s=Math.sign(Math.abs(n)>Math.abs(i)?n:i);e.increaseVolume(s/50);const{volume:o}=e.media;(1===s&&o<1||-1===s&&o>0)&&t.preventDefault()}),"volume",!1)})),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:r}=t,{key:n,type:i,altKey:s,ctrlKey:o,metaKey:a,shiftKey:l}=e,u="keydown"===i,c=u&&n===this.lastKey;var d;if(!(s||o||a||l)&&n)if(u){const i=document.activeElement;if(D.element(i)){const{editable:n}=t.config.selectors,{seek:s}=r.inputs;if(i!==s&&q(i,n))return;if(" "===e.key&&q(i,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(n)&&(e.preventDefault(),e.stopPropagation()),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c||(d=parseInt(n,10),t.currentTime=t.duration/10*d);break;case" ":case"k":c||ne(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":c||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":c||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===n&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}toggleMenu(e){Ce.toggleMenu.call(this.player,e)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self&&self;var He=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){e.exports=function(){var e=function(){},t={},r={},n={};function i(e,t){e=e.push?e:[e];var i,s,o,a=[],l=e.length,u=l;for(i=function(e,r){r.length&&a.push(e),--u||t(a)};l--;)s=e[l],(o=r[s])?i(s,o):(n[s]=n[s]||[]).push(i)}function s(e,t){if(e){var i=n[e];if(r[e]=t,i)for(;i.length;)i[0](e,t),i.splice(0,1)}}function o(t,r){t.call&&(t={success:t}),r.length?(t.error||e)(r):(t.success||e)(t)}function a(t,r,n,i){var s,o,l=document,u=n.async,c=(n.numRetries||0)+1,d=n.before||e,h=t.replace(/[\?|#].*$/,""),f=t.replace(/^(css|img)!/,"");i=i||0,/(^css!|\.css$)/.test(h)?((o=l.createElement("link")).rel="stylesheet",o.href=f,(s="hideFocus"in o)&&o.relList&&(s=0,o.rel="preload",o.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(o=l.createElement("img")).src=f:((o=l.createElement("script")).src=t,o.async=void 0===u||u),o.onload=o.onerror=o.onbeforeload=function(e){var l=e.type[0];if(s)try{o.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((i+=1)<c)return a(t,r,n,i)}else if("preload"==o.rel&&"style"==o.as)return o.rel="stylesheet";r(t,l,e.defaultPrevented)},!1!==d(t,o)&&l.head.appendChild(o)}function l(e,t,r){var n,i,s=(e=e.push?e:[e]).length,o=s,l=[];for(n=function(e,r,n){if("e"==r&&l.push(e),"b"==r){if(!n)return;l.push(e)}--s||t(l)},i=0;i<o;i++)a(e[i],n,r)}function u(e,r,n){var i,a;if(r&&r.trim&&(i=r),a=(i?n:r)||{},i){if(i in t)throw"LoadJS";t[i]=!0}function u(t,r){l(e,(function(e){o(a,e),t&&o({success:t,error:r},e),s(i,e)}),a)}if(a.returnPromise)return new Promise(u);u()}return u.ready=function(e,t){return i(e,(function(e){o(t,e)})),u},u.done=function(e){s(e,[])},u.reset=function(){t={},r={},n={}},u.isDefined=function(e){return e in t},u}()}));function Ve(e){return new Promise(((t,r)=>{He(e,{success:t,error:r})}))}function Ge(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ee.call(this,this.media,e?"play":"pause"))}const We={setup(){const e=this;j(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,de.call(e),D.object(window.Vimeo)?We.ready.call(e):Ve(e.config.urls.vimeo.sdk).then((()=>{We.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){const e=this,t=e.config.vimeo,{premium:r,referrerPolicy:n,...i}=t;let s=e.media.getAttribute("src"),o="";D.empty(s)?(s=e.media.getAttribute(e.config.attributes.embed.id),o=e.media.getAttribute(e.config.attributes.embed.hash)):o=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(s);const a=o?{h:o}:{};r&&Object.assign(i,{controls:!1,sidedock:!1});const l=Me({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:e.config.playsinline,...a,...i}),u=(c=s,D.empty(c)?null:D.number(Number(c))?c:c.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:c);var c;const d=R("iframe"),h=pe(e.config.urls.vimeo.iframe,u,l);if(d.setAttribute("src",h),d.setAttribute("allowfullscreen",""),d.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),D.empty(n)||d.setAttribute("referrerPolicy",n),r||!t.customControls)d.setAttribute("data-poster",e.poster),e.media=B(d,e.media);else{const t=R("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(d),e.media=B(t,e.media)}t.customControls||Ee(pe(e.config.urls.vimeo.api,h)).then((t=>{!D.empty(t)&&t.thumbnail_url&&ze.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(d,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(Ge.call(e,!0),e.embed.play()),e.media.pause=()=>(Ge.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:f}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>f,set(t){const{embed:r,media:n,paused:i,volume:s}=e,o=i&&!r.hasPlayed;n.seeking=!0,ee.call(e,n,"seeking"),Promise.resolve(o&&r.setVolume(0)).then((()=>r.setCurrentTime(t))).then((()=>o&&r.pause())).then((()=>o&&r.setVolume(s))).catch((()=>{}))}});let p=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>p,set(t){e.embed.setPlaybackRate(t).then((()=>{p=t,ee.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,ee.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const r=!!D.boolean(t)&&t;e.embed.setMuted(!!r||e.config.muted).then((()=>{g=r,ee.call(e,e.media,"volumechange")}))}});let y,{loop:v}=e.config;Object.defineProperty(e.media,"loop",{get:()=>v,set(t){const r=D.boolean(t)?t:e.config.loop.active;e.embed.setLoop(r).then((()=>{v=r}))}}),e.embed.getVideoUrl().then((t=>{y=t,Ce.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>y}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[r,n]=t;e.embed.ratio=he(r,n),de.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,ze.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{f=t,ee.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,ee.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,Oe.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const r=t.map((e=>function(e){const t=document.createDocumentFragment(),r=document.createElement("div");return t.appendChild(r),r.innerHTML=e,t.firstChild.innerText}(e.text)));Oe.updateCues.call(e,r)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{Ge.call(e,!t),t||ee.call(e,e.media,"playing")})),D.element(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{ee.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{ee.call(e,e.media,"playing")})),e.embed.on("play",(()=>{Ge.call(e,!0),ee.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{Ge.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,f=t.seconds,ee.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,ee.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&ee.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,ee.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,ee.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,ee.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,ee.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>ze.build.call(e)),0)}};function Ke(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ee.call(this,this.media,e?"play":"pause"))}function Ye(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const Je={setup(){if(j(this.elements.wrapper,this.config.classNames.embed,!0),D.object(window.YT)&&D.function(window.YT.Player))Je.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{D.function(e)&&e(),Je.ready.call(this)},Ve(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Ee(pe(this.config.urls.youtube.api,e)).then((e=>{if(D.object(e)){const{title:t,height:r,width:n}=e;this.config.title=t,ze.setTitle.call(this),this.embed.ratio=he(n,r)}de.call(this)})).catch((()=>{de.call(this)}))},ready(){const e=this,t=e.config.youtube,r=e.media&&e.media.getAttribute("id");if(!D.empty(r)&&r.startsWith("youtube-"))return;let n=e.media.getAttribute("src");D.empty(n)&&(n=e.media.getAttribute(this.config.attributes.embed.id));const i=(s=n,D.empty(s)?null:s.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:s);var s;const o=R("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=B(o,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${i}/${e}default.jpg`;je(t("maxres"),121).catch((()=>je(t("sd"),121))).catch((()=>je(t("hq")))).then((t=>ze.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:i,host:Ye(t),playerVars:O({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.playsinline&&!e.config.fullscreen.iosNative?1:0,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const r=t.data,n={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[r]||"An unknown error occurred";e.media.error={code:r,message:n},ee.call(e,e.media,"error")}},onPlaybackRateChange(t){const r=t.target;e.media.playbackRate=r.getPlaybackRate(),ee.call(e,e.media,"ratechange")},onReady(r){if(D.function(e.media.play))return;const n=r.target;Je.getTitle.call(e,i),e.media.play=()=>{Ke.call(e,!0),n.playVideo()},e.media.pause=()=>{Ke.call(e,!1),n.pauseVideo()},e.media.stop=()=>{n.stopVideo()},e.media.duration=n.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(n.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,ee.call(e,e.media,"seeking"),n.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>n.getPlaybackRate(),set(e){n.setPlaybackRate(e)}});let{volume:s}=e.config;Object.defineProperty(e.media,"volume",{get:()=>s,set(t){s=t,n.setVolume(100*s),ee.call(e,e.media,"volumechange")}});let{muted:o}=e.config;Object.defineProperty(e.media,"muted",{get:()=>o,set(t){const r=D.boolean(t)?t:o;o=r,n[r?"mute":"unMute"](),n.setVolume(100*s),ee.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>n.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const a=n.getAvailablePlaybackRates();e.options.speed=a.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),ee.call(e,e.media,"timeupdate"),ee.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=n.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&ee.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),ee.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>ze.build.call(e)),50)},onStateChange(r){const n=r.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(r.data)&&(e.media.seeking=!1,ee.call(e,e.media,"seeked")),r.data){case-1:ee.call(e,e.media,"timeupdate"),e.media.buffered=n.getVideoLoadedFraction(),ee.call(e,e.media,"progress");break;case 0:Ke.call(e,!1),e.media.loop?(n.stopVideo(),n.playVideo()):ee.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(Ke.call(e,!0),ee.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{ee.call(e,e.media,"timeupdate")}),50),e.media.duration!==n.getDuration()&&(e.media.duration=n.getDuration(),ee.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),Ke.call(e,!1);break;case 3:ee.call(e,e.media,"waiting")}ee.call(e,e.elements.container,"statechange",!1,{code:r.data})}}})}},Ze={setup(){this.media?(j(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),j(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&j(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=R("div",{class:this.config.classNames.video}),_(this.media,this.elements.wrapper),this.elements.poster=R("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?fe.setup.call(this):this.isYouTube?Je.setup.call(this):this.isVimeo&&We.setup.call(this)):this.debug.warn("No media element found!")}};class Xe{constructor(t){e(this,"load",(()=>{this.enabled&&(D.object(window.google)&&D.object(window.google.ima)?this.ready():Ve(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),e(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),e(this,"setupIMA",(()=>{this.elements.container=R("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),e(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),e(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=Ne(Math.max(this.manager.getRemainingTime(),0)),t=`${xe.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),e(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),e(this,"addCuePoints",(()=>{D.empty(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(D.element(t)){const r=100/this.player.duration*e,n=R("span",{class:this.player.config.classNames.cues});n.style.left=`${r.toString()}%`,t.appendChild(n)}}}))})),e(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,r=e.getAd(),n=e.getAdData();switch((e=>{ee.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),r.isLinear()||(r.width=t.offsetWidth,r.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:n.adError&&this.player.debug.warn(`Non-fatal ad error: ${n.adError.getMessage()}`)}})),e(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),e(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;D.empty(this.cuePoints)||this.cuePoints.forEach(((r,n)=>{t<r&&r<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(n,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),e(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),e(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,ne(this.player.media.play())})),e(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),e(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),e(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),e(this,"trigger",((e,...t)=>{const r=this.events[e];D.array(r)&&r.forEach((e=>{D.function(e)&&e.apply(this,t)}))})),e(this,"on",((e,t)=>(D.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),e(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),e(this,"clearSafetyTimer",(e=>{D.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!D.empty(e.publisherId)||D.url(e.tagUrl))}get tagUrl(){const{config:e}=this;return D.url(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${Me({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function Qe(e=0,t=0,r=255){return Math.min(Math.max(e,t),r)}const et=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const r={};e.split(/\r\n|\n|\r/).forEach((e=>{if(D.number(r.startTime)){if(!D.empty(e.trim())&&D.empty(r.text)){const t=e.trim().split("#xywh=");[r.text]=t,t[1]&&([r.x,r.y,r.w,r.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(r.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),r.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),r.text&&t.push(r)})),t},tt=(e,t)=>{const r={};return e>t.width/t.height?(r.width=t.width,r.height=1/e*t.width):(r.height=t.height,r.width=e*t.height),r};class rt{constructor(t){e(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)}))})),e(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(D.empty(t))throw new Error("Missing previewThumbnails.src config attribute");const r=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(D.function(t))t((e=>{this.thumbnails=e,r()}));else{const e=(D.string(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(r)}})))),e(this,"getThumbnail",(e=>new Promise((t=>{Ee(e).then((r=>{const n={frames:et(r),height:null,urlPrefix:""};n.frames[0].text.startsWith("/")||n.frames[0].text.startsWith("http://")||n.frames[0].text.startsWith("https://")||(n.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const i=new Image;i.onload=()=>{n.height=i.naturalHeight,n.width=i.naturalWidth,this.thumbnails.push(n),t()},i.src=n.urlPrefix+n.frames[0].text}))})))),e(this,"startMove",(e=>{if(this.loaded&&D.event(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,r;const n=this.player.elements.progress.getBoundingClientRect(),i=100/n.width*(e.pageX-n.left);this.seekTime=this.player.media.duration*(i/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=Ne(this.seekTime);const s=null===(t=this.player.config.markers)||void 0===t||null===(r=t.points)||void 0===r?void 0:r.find((({time:e})=>e===Math.round(this.seekTime)));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}})),e(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),e(this,"startScrubbing",(e=>{(D.nullOrUndefined(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),e(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):Q.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),e(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),e(this,"render",(()=>{this.elements.thumb.container=R("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=R("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=R("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=R("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),D.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=R("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),e(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),e(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let r=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,n)=>{this.loadedImages.includes(t.frames[e].text)&&(r=n)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(r)))})),e(this,"loadImage",((e=0)=>{const t=this.showingThumb,r=this.thumbnails[e],{urlPrefix:n}=r,i=r.frames[t],s=r.frames[t].text,o=n+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,i,e,t,s,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const r=new Image;r.src=o,r.dataset.index=t,r.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${o}`),r.onload=()=>this.showImage(r,i,e,t,s,!0),this.loadingImage=r,this.removeOldImages(r)}})),e(this,"showImage",((e,t,r,n,i,s=!0)=>{this.player.debug.log(`Showing thumb: ${i}. num: ${n}. qual: ${r}. newimg: ${s}`),this.setImageSizeAndOffset(e,t),s&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(i)||this.loadedImages.push(i)),this.preloadNearby(n,!0).then(this.preloadNearby(n,!1)).then(this.getHigherQuality(r,e,t,i))})),e(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const r=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),r)}}))})),e(this,"preloadNearby",((e,t=!0)=>new Promise((r=>{setTimeout((()=>{const n=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===n){let i;i=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let s=!1;i.forEach((e=>{const t=e.text;if(t!==n&&!this.loadedImages.includes(t)){s=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],n=e+t,i=new Image;i.src=n,i.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),r()}}})),s||r()}}),300)})))),e(this,"getHigherQuality",((e,t,r,n)=>{if(e<this.thumbnails.length-1){let i=t.naturalHeight;this.usingSprites&&(i=r.h),i<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===n&&(this.player.debug.log(`Showing higher quality thumb for: ${n}`),this.loadImage(e+1))}),300)}})),e(this,"toggleThumbContainer",((e=!1,t=!1)=>{const r=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(r,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),e(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),e(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:r}=this.elements.thumb,n=t.left-e.left+10,i=t.right-e.left-r.clientWidth-10,s=this.mousePosX-e.left-r.clientWidth/2,o=Qe(s,n,i);r.style.left=`${o}px`,r.style.setProperty("--preview-arrow-offset",s-o+"px")})),e(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=tt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),e(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const r=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*r+"px",e.style.width=e.naturalWidth*r+"px",e.style.left=`-${t.x*r}px`,e.style.top=`-${t.y*r}px`})),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=tt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const nt={insertElements(e,t){D.string(t)?I(e,this.media,{src:t}):D.array(t)&&t.forEach((t=>{I(e,this.media,t)}))},change(e){M(e,"sources.length")?(fe.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],F(this.media),this.media=null,D.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:r}=e,[{provider:n=Ie.html5,src:i}]=t,s="html5"===n?r:"div",o="html5"===n?{}:{src:i};Object.assign(this,{provider:n,type:r,supported:K.check(r,n,this.config.playsinline),media:R(s,o)}),this.elements.container.appendChild(this.media),D.boolean(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),D.empty(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),ze.addStyleHook.call(this),this.isHTML5&&nt.insertElements.call(this,"source",t),this.config.title=e.title,Ze.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&nt.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&ze.build.call(this),this.isHTML5&&this.media.load(),D.empty(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new rt(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class it{constructor(t,r){if(e(this,"play",(()=>D.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>ne(this.media.play()))),this.media.play()):null)),e(this,"pause",(()=>this.playing&&D.function(this.media.pause)?this.media.pause():null)),e(this,"togglePlay",(e=>(D.boolean(e)?e:!this.playing)?this.play():this.pause())),e(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):D.function(this.media.stop)&&this.media.stop()})),e(this,"restart",(()=>{this.currentTime=0})),e(this,"rewind",(e=>{this.currentTime-=D.number(e)?e:this.config.seekTime})),e(this,"forward",(e=>{this.currentTime+=D.number(e)?e:this.config.seekTime})),e(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(D.number(e)?e:0)})),e(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),e(this,"airplay",(()=>{K.airplay&&this.media.webkitShowPlaybackTargetPicker()})),e(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=z(this.elements.container,this.config.classNames.hideControls),r=void 0===e?void 0:!e,n=j(this.elements.container,this.config.classNames.hideControls,r);if(n&&D.array(this.config.controls)&&this.config.controls.includes("settings")&&!D.empty(this.config.settings)&&Ce.toggleMenu.call(this,!1),n!==t){const e=n?"controlshidden":"controlsshown";ee.call(this,this.media,e)}return!n}return!1})),e(this,"on",((e,t)=>{Z.call(this,this.elements.container,e,t)})),e(this,"once",((e,t)=>{Q.call(this,this.elements.container,e,t)})),e(this,"off",((e,t)=>{X(this.elements.container,e,t)})),e(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const r=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(F(this.elements.buttons.play),F(this.elements.captions),F(this.elements.controls),F(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),D.function(e)&&e()):(te.call(this),fe.cancelRequests.call(this),B(this.elements.original,this.elements.container),ee.call(this,this.elements.original,"destroyed",!0),D.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(ze.toggleNativeControls.call(this,!0),r()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&D.function(this.embed.destroy)&&this.embed.destroy(),r()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(r),setTimeout(r,200))})),e(this,"supports",(e=>K.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=K.touch,this.media=t,D.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||D.nodeList(this.media)||D.array(this.media))&&(this.media=this.media[0]),this.config=O({},_e,it.defaults,r||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Ue(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",K),D.nullOrUndefined(this.media)||!D.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!K.check().api)return void this.debug.error("Setup failed: no support");const n=this.media.cloneNode(!0);n.autoplay=!1,this.elements.original=n;const i=this.media.tagName.toLowerCase();let s=null,o=null;switch(i){case"div":if(s=this.media.querySelector("iframe"),D.element(s)){if(o=ke(s.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Ie.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Ie.vimeo:null}(o.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",o.search.length){const e=["1","true"];e.includes(o.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(o.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(o.searchParams.get("playsinline")),this.config.youtube.hl=o.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(D.empty(this.provider)||!Object.values(Ie).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Pe;break;case"video":case"audio":this.type=i,this.provider=Ie.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=K.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new qe(this),this.storage=new we(this),this.media.plyr=this,D.element(this.elements.container)||(this.elements.container=R("div"),_(this.media,this.elements.container)),ze.migrateStyles.call(this),ze.addStyleHook.call(this),Ze.setup.call(this),this.config.debug&&Z.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new $e(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&ze.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Xe(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>ne(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new rt(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Ie.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Ie.youtube}get isVimeo(){return this.provider===Ie.vimeo}get isVideo(){return this.type===Pe}get isAudio(){return this.type===Fe}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=D.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return D.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,r=D.number(t)&&t!==1/0?t:0;return e||r}set volume(e){let t=e;D.string(t)&&(t=Number(t)),D.number(t)||(t=this.storage.get("volume")),D.number(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!D.empty(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;D.boolean(t)||(t=this.storage.get("muted")),D.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;D.number(e)&&(t=e),D.number(t)||(t=this.storage.get("speed")),D.number(t)||(t=this.config.speed.selected);const{minimumSpeed:r,maximumSpeed:n}=this;t=Qe(t,r,n),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,r=this.options.quality;if(!r.length)return;let n=[!D.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(D.number),i=!0;if(!r.includes(n)){const e=se(r,n);this.debug.warn(`Unsupported quality option: ${n}, using ${e} instead`),n=e,i=!1}t.selected=n,this.media.quality=n,i&&this.storage.set({quality:n})}get quality(){return this.media.quality}set loop(e){const t=D.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){nt.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return D.url(e)?e:this.source}set download(e){D.url(e)&&(this.config.urls.download=e,Ce.setDownloadUrl.call(this))}set poster(e){this.isVideo?ze.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=ue(ce.call(this));return D.array(e)?e.join(":"):e}set ratio(e){this.isVideo?D.string(e)&&le(e)?(this.config.ratio=ue(e),de.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=D.boolean(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){Oe.toggle.call(this,e,!1)}set currentTrack(e){Oe.set.call(this,e,!1),Oe.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){Oe.setLanguage.call(this,e,!1)}get language(){return(Oe.getCurrentTrack.call(this)||{}).language}set pip(e){if(!K.pip)return;const t=D.boolean(e)?e:!this.pip;D.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?Le:Re),D.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return K.pip?D.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Le:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new rt(this))}static supported(e,t){return K.check(e,t)}static loadSprite(e,t){return Se(e,t)}static setup(e,t={}){let r=null;return D.string(e)?r=Array.from(document.querySelectorAll(e)):D.nodeList(e)?r=Array.from(e):D.array(e)&&(r=e.filter(D.element)),D.empty(r)?null:r.map((e=>new it(e,t)))}}var st;return it.defaults=(st=_e,JSON.parse(JSON.stringify(st))),it}())},36377:(e,t,r)=>{var n=r(84832),i=r(68652),s=r(90801),o=r(92030),a=r(3618),l=r(89049),u=r(51971);u.alea=n,u.xor128=i,u.xorwow=s,u.xorshift7=o,u.xor4096=a,u.tychei=l,e.exports=u},84832:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this,r=function(){var e=4022871197,t=function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=r(" "),t.s1=r(" "),t.s2=r(" "),t.s0-=r(e),t.s0<0&&(t.s0+=1),t.s1-=r(e),t.s1<0&&(t.s1+=1),t.s2-=r(e),t.s2<0&&(t.s2+=1),r=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var r=new o(e),n=t&&t.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.alea=l}(0,e=r.nmd(e),r.amdD)},89049:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this,r="";t.next=function(){var e=t.b,r=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^r,t.c=r=r-n|0,t.d=n<<16^r>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):r+=e;for(var n=0;n<r.length+20;n++)t.b^=0|r.charCodeAt(n),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var r=new o(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.tychei=l}(0,e=r.nmd(e),r.amdD)},68652:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var r=new o(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.xor128=l}(0,e=r.nmd(e),r.amdD)},3618:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this;t.next=function(){var e,r,n=t.w,i=t.X,s=t.i;return t.w=n=n+1640531527|0,r=i[s+34&127],e=i[s=s+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,r=i[s]=r^e,t.i=s,r+(n^n>>>16)|0},function(e,t){var r,n,i,s,o,a=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),i=0,s=-32;s<l;++s)t&&(n^=t.charCodeAt((s+32)%t.length)),0===s&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,s>=0&&(o=o+1640531527|0,i=0==(r=a[127&s]^=n+o)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,s=512;s>0;--s)n=a[i+34&127],r=a[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[i]=n^r;e.w=o,e.X=a,e.i=i}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var r=new o(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.X&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.xor4096=l}(0,e=r.nmd(e),r.amdD)},92030:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this;t.next=function(){var e,r,n=t.x,i=t.i;return e=n[i],r=(e^=e>>>7)^e<<24,r^=(e=n[i+1&7])^e>>>10,r^=(e=n[i+3&7])^e>>>3,r^=(e=n[i+4&7])^e<<7,e=n[i+7&7],r^=(e^=e<<13)^e<<9,n[i]=r,t.i=i+1&7,r},function(e,t){var r,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,r=0;r<t.length;++r)n[7&r]=n[7&r]<<15^t.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],e.x=n,e.i=0,r=256;r>0;--r)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var r=new o(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.x&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.xorshift7=l}(0,e=r.nmd(e),r.amdD)},90801:function(e,t,r){var n;!function(e,i,s){function o(e){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),n==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var r=new o(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,i))||(i.exports=n):this.xorwow=l}(0,e=r.nmd(e),r.amdD)},51971:function(e,t,r){var n;!function(i,s,o){var a,l=256,u=o.pow(l,6),c=o.pow(2,52),d=2*c,h=l-1;function f(e,t,r){var n=[],h=y(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(s)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),v(e)}catch(e){var t=i.navigator,r=t&&t.plugins;return[+new Date,i,r,i.screen,v(s)]}}():e,3),n),f=new p(n),b=function(){for(var e=f.g(6),t=u,r=0;e<c;)e=(e+r)*l,t*=l,r=f.g(1);for(;e>=d;)e/=2,t/=2,r>>>=1;return(e+r)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(v(f.S),s),(t.pass||r||function(e,t,r,n){return n&&(n.S&&m(n,f),e.state=function(){return m(f,{})}),r?(o.random=e,t):e})(b,h,"global"in t?t.global:this==o,t.state)}function p(e){var t,r=e.length,n=this,i=0,s=n.i=n.j=0,o=n.S=[];for(r||(e=[r++]);i<l;)o[i]=i++;for(i=0;i<l;i++)o[i]=o[s=h&s+e[i%r]+(t=o[i])],o[s]=t;(n.g=function(e){for(var t,r=0,i=n.i,s=n.j,o=n.S;e--;)t=o[i=h&i+1],r=r*l+o[h&(o[i]=o[s=h&s+t])+(o[s]=t)];return n.i=i,n.j=s,r})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var r,n=[],i=typeof e;if(t&&"object"==i)for(r in e)try{n.push(g(e[r],t-1))}catch(e){}return n.length?n:"string"==i?e:e+"\0"}function y(e,t){for(var r,n=e+"",i=0;i<n.length;)t[h&i]=h&(r^=19*t[h&i])+n.charCodeAt(i++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(y(o.random(),s),e.exports){e.exports=f;try{a=r(75042)}catch(e){}}else void 0===(n=function(){return f}.call(t,r,t,e))||(e.exports=n)}("undefined"!=typeof self?self:this,[],Math)},75042:()=>{},44814:function(e){e.exports=function(){"use strict";function e(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=t(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var i=0,s=function(){};return{s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function t(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(){return!0}function s(){return!1}function o(){}var a="Argument is not a typed-function.";function l(){function t(e){return"object"===n(e)&&null!==e&&e.constructor===Object}var r,u,c=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:t},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],d={name:"any",test:i,isAny:!0},h=0,f={createCount:0};function p(t){var n=r.get(t);if(n)return n;var i,s,o='Unknown type "'+t+'"',a=t.toLowerCase(),l=e(u);try{for(l.s();!(s=l.n()).done;)if((i=s.value).toLowerCase()===a){o+='. Did you mean "'+i+'" ?';break}}catch(e){l.e(e)}finally{l.f()}throw new TypeError(o)}function m(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",n=t?p(t).index:u.length,i=[],s=0;s<e.length;++s){if(!e[s]||"string"!=typeof e[s].name||"function"!=typeof e[s].test)throw new TypeError("Object with properties {name: string, test: function} expected");var o=e[s].name;if(r.has(o))throw new TypeError('Duplicate type name "'+o+'"');i.push(o),r.set(o,{name:o,test:e[s].test,isAny:e[s].isAny,index:n+s,conversionsTo:[]})}var a=u.slice(n);u=u.slice(0,n).concat(i).concat(a);for(var l=n+i.length;l<u.length;++l)r.get(u[l]).index=l}function g(){r=new Map,u=[],h=0,m([d],!1)}function y(){var t,n,i=e(u);try{for(i.s();!(n=i.n()).done;)t=n.value,r.get(t).conversionsTo=[]}catch(e){i.e(e)}finally{i.f()}h=0}function v(e){var t=u.filter((function(t){var n=r.get(t);return!n.isAny&&n.test(e)}));return t.length?t:["any"]}function b(e){return e&&"function"==typeof e&&"_typedFunctionData"in e}function x(t,r,n){if(!b(t))throw new TypeError(a);var i=n&&n.exact,s=N(Array.isArray(r)?r.join(","):r),o=S(s);if(!i||o in t.signatures){var l=t._typedFunctionData.signatureMap.get(o);if(l)return l}var u,c,d,h=s.length;if(i)for(c in u=[],t.signatures)u.push(t._typedFunctionData.signatureMap.get(c));else u=t._typedFunctionData.signatures;for(var f=0;f<h;++f){var p,m=s[f],g=[],y=void 0,v=e(u);try{for(v.s();!(p=v.n()).done;){var x=O((y=p.value).params,f);if(x&&(!m.restParam||x.restParam)){if(!x.hasAny&&"continue"===function(){var e=D(x);if(m.types.some((function(t){return!e.has(t.name)})))return"continue"}())continue;g.push(y)}}}catch(e){v.e(e)}finally{v.f()}if(0===(u=g).length)break}var w,E=e(u);try{for(E.s();!(w=E.n()).done;)if((d=w.value).params.length<=h)return d}catch(e){E.e(e)}finally{E.f()}throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+S(s,", ")+"))")}function w(e,t,r){return x(e,t,r).implementation}function E(e,t){var r=p(t);if(r.test(e))return e;var n=r.conversionsTo;if(0===n.length)throw new Error("There are no conversions to "+t+" defined.");for(var i=0;i<n.length;i++)if(p(n[i].from).test(e))return n[i].convert(e);throw new Error("Cannot convert "+e+" to "+t)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map((function(e){return e.name})).join(t)}function T(e){var t=0===e.indexOf("..."),r=(t?e.length>3?e.slice(3):"any":e).split("|").map((function(e){return p(e.trim())})),n=!1,i=t?"...":"";return{types:r.map((function(e){return n=e.isAny||n,i+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:t}}function A(e){var t=$(e.types.map((function(e){return e.name}))),r=e.hasAny,n=e.name,i=t.map((function(e){var t=p(e.from);return r=t.isAny||r,n+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}}));return{types:e.types.concat(i),name:n,hasAny:r,hasConversion:i.length>0,restParam:e.restParam}}function D(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach((function(t){return e.typeSet.add(t.name)}))),e.typeSet}function N(e){var t=[];if("string"!=typeof e)throw new TypeError("Signatures must be strings");var r=e.trim();if(""===r)return t;for(var n=r.split(","),i=0;i<n.length;++i){var s=T(n[i].trim());if(s.restParam&&i!==n.length-1)throw new SyntaxError('Unexpected rest parameter "'+n[i]+'": only allowed for the last parameter');if(0===s.types.length)return null;t.push(s)}return t}function C(e){var t=X(e);return!!t&&t.restParam}function k(e){if(e&&0!==e.types.length){if(1===e.types.length)return p(e.types[0].name).test;if(2===e.types.length){var t=p(e.types[0].name).test,r=p(e.types[1].name).test;return function(e){return t(e)||r(e)}}var n=e.types.map((function(e){return p(e.name).test}));return function(e){for(var t=0;t<n.length;t++)if(n[t](e))return!0;return!1}}return i}function M(e){var t,r,n;if(C(e)){var i=(t=Z(e).map(k)).length,s=k(X(e)),o=function(e){for(var t=i;t<e.length;t++)if(!s(e[t]))return!1;return!0};return function(e){for(var r=0;r<t.length;r++)if(!t[r](e[r]))return!1;return o(e)&&e.length>=i+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(r=k(e[0]),function(e){return r(e[0])&&1===e.length}):2===e.length?(r=k(e[0]),n=k(e[1]),function(e){return r(e[0])&&n(e[1])&&2===e.length}):(t=e.map(k),function(e){for(var r=0;r<t.length;r++)if(!t[r](e[r]))return!1;return e.length===t.length})}function O(e,t){return t<e.length?e[t]:C(e)?X(e):null}function _(e,t){var r=O(e,t);return r?D(r):new Set}function L(e){return null===e.conversion||void 0===e.conversion}function R(t,r){var n=new Set;return t.forEach((function(t){var i,s,o=e(_(t.params,r));try{for(o.s();!(s=o.n()).done;)i=s.value,n.add(i)}catch(e){o.e(e)}finally{o.f()}})),n.has("any")?["any"]:Array.from(n)}function I(e,t,r){var i,s,o,a=e||"unnamed",l=r,u=function(){var e=[];if(l.forEach((function(r){var n=k(O(r.params,o));(o<r.params.length||C(r.params))&&n(t[o])&&e.push(r)})),0===e.length){if((s=R(l,o)).length>0){var r=v(t[o]);return(i=new TypeError("Unexpected type of argument in function "+a+" (expected: "+s.join(" or ")+", actual: "+r.join(" | ")+", index: "+o+")")).data={category:"wrongType",fn:a,index:o,actual:r,expected:s},{v:i}}}else l=e};for(o=0;o<t.length;o++){var c=u();if("object"===n(c))return c.v}var d=l.map((function(e){return C(e.params)?1/0:e.params.length}));if(t.length<Math.min.apply(null,d))return s=R(l,o),(i=new TypeError("Too few arguments in function "+a+" (expected: "+s.join(" or ")+", index: "+t.length+")")).data={category:"tooFewArgs",fn:a,index:t.length,expected:s},i;var h=Math.max.apply(null,d);if(t.length>h)return(i=new TypeError("Too many arguments in function "+a+" (expected: "+h+", actual: "+t.length+")")).data={category:"tooManyArgs",fn:a,index:t.length,expectedLength:h},i;for(var f=[],p=0;p<t.length;++p)f.push(v(t[p]).join("|"));return(i=new TypeError('Arguments of type "'+f.join(", ")+'" do not match any of the defined signatures of function '+a+".")).data={category:"mismatch",actual:f},i}function F(e){for(var t=u.length+1,r=0;r<e.types.length;r++)L(e.types[r])&&(t=Math.min(t,e.types[r].typeIndex));return t}function P(e){for(var t=h+1,r=0;r<e.types.length;r++)L(e.types[r])||(t=Math.min(t,e.types[r].conversionIndex));return t}function B(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;var r=F(e)-F(t);if(r<0)return-1;if(r>0)return 1;var n=P(e)-P(t);return n<0?-1:n>0?1:0}function U(t,r){var n=t.params,i=r.params,s=X(n),o=X(i),a=C(n),l=C(i);if(a&&s.hasAny){if(!l||!o.hasAny)return 1}else if(l&&o.hasAny)return-1;var u,c,d=0,h=0,f=e(n);try{for(f.s();!(c=f.n()).done;)(u=c.value).hasAny&&++d,u.hasConversion&&++h}catch(e){f.e(e)}finally{f.f()}var p,m=0,g=0,y=e(i);try{for(y.s();!(p=y.n()).done;)(u=p.value).hasAny&&++m,u.hasConversion&&++g}catch(e){y.e(e)}finally{y.f()}if(d!==m)return d-m;if(a&&s.hasConversion){if(!l||!o.hasConversion)return 1}else if(l&&o.hasConversion)return-1;if(h!==g)return h-g;if(a){if(!l)return 1}else if(l)return-1;var v=(n.length-i.length)*(a?-1:1);if(0!==v)return v;for(var b,x=[],w=0,E=0;E<n.length;++E){var S=B(n[E],i[E]);x.push(S),w+=S}if(0!==w)return w;for(var T=0,A=x;T<A.length;T++)if(0!==(b=A[T]))return b;return 0}function $(t){if(0===t.length)return[];var r=t.map(p);t.length>1&&r.sort((function(e,t){return e.index-t.index}));var n=r[0].conversionsTo;if(1===t.length)return n;n=n.concat([]);for(var i=new Set(t),s=1;s<r.length;++s){var o,a=void 0,l=e(r[s].conversionsTo);try{for(l.s();!(o=l.n()).done;)a=o.value,i.has(a.from)||(n.push(a),i.add(a.from))}catch(e){l.e(e)}finally{l.f()}}return n}function j(e,t){var r=t;if(e.some((function(e){return e.hasConversion}))){var n=C(e),i=e.map(z);r=function(){for(var e=[],r=n?arguments.length-1:arguments.length,s=0;s<r;s++)e[s]=i[s](arguments[s]);return n&&(e[r]=arguments[r].map(i[r])),t.apply(this,e)}}var s=r;if(C(e)){var o=e.length-1;s=function(){return r.apply(this,Q(arguments,0,o).concat([Q(arguments,o)]))}}return s}function z(e){var t,r,n,i,s=[],o=[];switch(e.types.forEach((function(e){e.conversion&&(s.push(p(e.conversion.from).test),o.push(e.conversion.convert))})),o.length){case 0:return function(e){return e};case 1:return t=s[0],n=o[0],function(e){return t(e)?n(e):e};case 2:return t=s[0],r=s[1],n=o[0],i=o[1],function(e){return t(e)?n(e):r(e)?i(e):e};default:return function(e){for(var t=0;t<o.length;t++)if(s[t](e))return o[t](e);return e}}}function q(e){function t(e,r,n){if(r<e.length){var i=e[r],s=[];if(i.restParam){var o=i.types.filter(L);o.length<i.types.length&&s.push({types:o,name:"..."+o.map((function(e){return e.name})).join("|"),hasAny:o.some((function(e){return e.isAny})),hasConversion:!1,restParam:!0}),s.push(i)}else s=i.types.map((function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}}));return te(s,(function(i){return t(e,r+1,n.concat([i]))}))}return[n]}return t(e,0,[])}function H(t,r){for(var n=Math.max(t.length,r.length),i=0;i<n;i++){var s,o=_(t,i),a=!1,l=void 0,u=e(_(r,i));try{for(u.s();!(s=u.n()).done;)if(l=s.value,o.has(l)){a=!0;break}}catch(e){u.e(e)}finally{u.f()}if(!a)return!1}var c=t.length,d=r.length,h=C(t),f=C(r);return h?f?c===d:d>=c:f?c>=d:c===d}function V(e){return e.map((function(e){return oe(e)?ie(e.referToSelf.callback):se(e)?ne(e.referTo.references,e.referTo.callback):e}))}function G(t,r,n){var i,s,o=[],a=e(t);try{for(a.s();!(s=a.n()).done;){var l=n[i=s.value];if("number"!=typeof l)throw new TypeError('No definition for referenced signature "'+i+'"');if("function"!=typeof(l=r[l]))return!1;o.push(l)}}catch(e){a.e(e)}finally{a.f()}return o}function W(e,t,r){for(var n=V(e),i=new Array(n.length).fill(!1),s=!0;s;){s=!1;for(var o=!0,a=0;a<n.length;++a)if(!i[a]){var l=n[a];if(oe(l))n[a]=l.referToSelf.callback(r),n[a].referToSelf=l.referToSelf,i[a]=!0,o=!1;else if(se(l)){var u=G(l.referTo.references,n,t);u?(n[a]=l.referTo.callback.apply(this,u),n[a].referTo=l.referTo,i[a]=!0,o=!1):s=!0}}if(o&&s)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return n}function K(e){var t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach((function(r){var n=e[r];if(t.test(n.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}function Y(t,r){if(f.createCount++,0===Object.keys(r).length)throw new SyntaxError("No signatures provided");f.warnAgainstDeprecatedThis&&K(r);var n,i=[],a=[],l={},u=[],c=function(){if(!Object.prototype.hasOwnProperty.call(r,n))return"continue";var t=N(n);if(!t)return"continue";i.forEach((function(e){if(H(e,t))throw new TypeError('Conflicting signatures "'+S(e)+'" and "'+S(t)+'".')})),i.push(t);var s=a.length;a.push(r[n]);var o,c=void 0,d=e(q(t.map(A)));try{for(d.s();!(o=d.n()).done;){var h=S(c=o.value);u.push({params:c,name:h,fn:s}),c.every((function(e){return!e.hasConversion}))&&(l[h]=s)}}catch(e){d.e(e)}finally{d.f()}};for(n in r)c();u.sort(U);var d,h=W(a,l,pe);for(d in l)Object.prototype.hasOwnProperty.call(l,d)&&(l[d]=h[l[d]]);for(var p=[],m=new Map,g=0,y=u;g<y.length;g++)d=y[g],m.has(d.name)||(d.fn=h[d.fn],p.push(d),m.set(d.name,d));for(var v=p[0]&&p[0].params.length<=2&&!C(p[0].params),b=p[1]&&p[1].params.length<=2&&!C(p[1].params),x=p[2]&&p[2].params.length<=2&&!C(p[2].params),w=p[3]&&p[3].params.length<=2&&!C(p[3].params),E=p[4]&&p[4].params.length<=2&&!C(p[4].params),T=p[5]&&p[5].params.length<=2&&!C(p[5].params),D=v&&b&&x&&w&&E&&T,O=0;O<p.length;++O)p[O].test=M(p[O].params);for(var _=v?k(p[0].params[0]):s,L=b?k(p[1].params[0]):s,R=x?k(p[2].params[0]):s,I=w?k(p[3].params[0]):s,F=E?k(p[4].params[0]):s,P=T?k(p[5].params[0]):s,B=v?k(p[0].params[1]):s,$=b?k(p[1].params[1]):s,z=x?k(p[2].params[1]):s,V=w?k(p[3].params[1]):s,G=E?k(p[4].params[1]):s,Y=T?k(p[5].params[1]):s,J=0;J<p.length;++J)p[J].implementation=j(p[J].params,p[J].fn);var Z=v?p[0].implementation:o,X=b?p[1].implementation:o,Q=x?p[2].implementation:o,ee=w?p[3].implementation:o,te=E?p[4].implementation:o,re=T?p[5].implementation:o,ne=v?p[0].params.length:-1,ie=b?p[1].params.length:-1,se=x?p[2].params.length:-1,oe=w?p[3].params.length:-1,ae=E?p[4].params.length:-1,le=T?p[5].params.length:-1,ue=D?6:0,ce=p.length,de=p.map((function(e){return e.test})),he=p.map((function(e){return e.implementation})),fe=function(){for(var e=ue;e<ce;e++)if(de[e](arguments))return he[e].apply(this,arguments);return f.onMismatch(t,arguments,p)};function pe(e,t){return arguments.length===ne&&_(e)&&B(t)?Z.apply(this,arguments):arguments.length===ie&&L(e)&&$(t)?X.apply(this,arguments):arguments.length===se&&R(e)&&z(t)?Q.apply(this,arguments):arguments.length===oe&&I(e)&&V(t)?ee.apply(this,arguments):arguments.length===ae&&F(e)&&G(t)?te.apply(this,arguments):arguments.length===le&&P(e)&&Y(t)?re.apply(this,arguments):fe.apply(this,arguments)}try{Object.defineProperty(pe,"name",{value:t})}catch(e){}return pe.signatures=l,pe._typedFunctionData={signatures:p,signatureMap:m},pe}function J(e,t,r){throw I(e,t,r)}function Z(e){return Q(e,0,e.length-1)}function X(e){return e[e.length-1]}function Q(e,t,r){return Array.prototype.slice.call(e,t,r)}function ee(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]}function te(e,t){return Array.prototype.concat.apply([],e.map(t))}function re(){var e=Z(arguments).map((function(e){return S(N(e))})),t=X(arguments);if("function"!=typeof t)throw new TypeError("Callback function expected as last argument");return ne(e,t)}function ne(e,t){return{referTo:{references:e,callback:t}}}function ie(e){if("function"!=typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function se(e){return e&&"object"===n(e.referTo)&&Array.isArray(e.referTo.references)&&"function"==typeof e.referTo.callback}function oe(e){return e&&"object"===n(e.referToSelf)&&"function"==typeof e.referToSelf.callback}function ae(e,t){if(!e)return t;if(t&&t!==e){var r=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw r.data={actual:t,expected:e},r}return e}function le(e){var t;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(b(e[r])||"string"==typeof e[r].signature)&&(t=ae(t,e[r].name));return t}function ue(e,t){var r;for(r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(r in e&&t[r]!==e[r]){var n=new Error('Signature "'+r+'" is defined twice');throw n.data={signature:r,sourceFunction:t[r],destFunction:e[r]},n}e[r]=t[r]}}g(),m(c);var ce=f;function de(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return f=function(e){for(var r="string"==typeof e,n=r?e:"",i={},s=r?1:0;s<arguments.length;++s){var o=arguments[s],a={},l=void 0;if("function"==typeof o?(l=o.name,"string"==typeof o.signature?a[o.signature]=o:b(o)&&(a=o.signatures)):t(o)&&(a=o,r||(l=le(o))),0===Object.keys(a).length){var u=new TypeError("Argument to 'typed' at index "+s+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw u.data={index:s,argument:o},u}r||(n=ae(n,l)),ue(i,a)}return Y(n||"",i)},f.create=l,f.createCount=ce.createCount,f.onMismatch=J,f.throwMismatchError=J,f.createError=I,f.clear=g,f.clearConversions=y,f.addTypes=m,f._findType=p,f.referTo=re,f.referToSelf=ie,f.convert=E,f.findSignature=x,f.find=w,f.isTypedFunction=b,f.warnAgainstDeprecatedThis=!0,f.addType=function(e,t){var n="any";!1!==t&&r.has("Object")&&(n="Object"),f.addTypes([e],n)},f.addConversion=function(e){de(e);var t=p(e.to);if(!t.conversionsTo.every((function(t){return t.from!==e.from})))throw new Error('There is already a conversion from "'+e.from+'" to "'+t.name+'"');t.conversionsTo.push({from:e.from,convert:e.convert,index:h++})},f.addConversions=function(e){e.forEach(f.addConversion)},f.removeConversion=function(e){de(e);var t=p(e.to),r=ee(t.conversionsTo,(function(t){return t.from===e.from}));if(!r)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(r.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");var n=t.conversionsTo.indexOf(r);t.conversionsTo.splice(n,1)},f.resolve=function(e,t){if(!b(e))throw new TypeError(a);for(var r=e._typedFunctionData.signatures,n=0;n<r.length;++n)if(r[n].test(t))return r[n];return null},f}return l()}()}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";function e(e,t){return function(){return e.apply(t,arguments)}}const{toString:t}=Object.prototype,{getPrototypeOf:n}=Object,i=(s=Object.create(null),e=>{const r=t.call(e);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())});var s;const o=e=>(e=e.toLowerCase(),t=>i(t)===e),a=e=>t=>typeof t===e,{isArray:l}=Array,u=a("undefined");const c=o("ArrayBuffer");const d=a("string"),h=a("function"),f=a("number"),p=e=>null!==e&&"object"==typeof e,m=e=>{if("object"!==i(e))return!1;const t=n(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},g=o("Date"),y=o("File"),v=o("Blob"),b=o("FileList"),x=o("URLSearchParams");function w(e,t,{allOwnKeys:r=!1}={}){if(null==e)return;let n,i;if("object"!=typeof e&&(e=[e]),l(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let o;for(n=0;n<s;n++)o=i[n],t.call(null,e[o],o,e)}}function E(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,i=r.length;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,T=e=>!u(e)&&e!==S;const A=(D="undefined"!=typeof Uint8Array&&n(Uint8Array),e=>D&&e instanceof D);var D;const N=o("HTMLFormElement"),C=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),k=o("RegExp"),M=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};w(r,((r,i)=>{!1!==t(r,i,e)&&(n[i]=r)})),Object.defineProperties(e,n)},O="abcdefghijklmnopqrstuvwxyz",_="0123456789",L={DIGIT:_,ALPHA:O,ALPHA_DIGIT:O+O.toUpperCase()+_};const R=o("AsyncFunction"),I={isArray:l,isArrayBuffer:c,isBuffer:function(e){return null!==e&&!u(e)&&null!==e.constructor&&!u(e.constructor)&&h(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||h(e.append)&&("formdata"===(t=i(e))||"object"===t&&h(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&c(e.buffer),t},isString:d,isNumber:f,isBoolean:e=>!0===e||!1===e,isObject:p,isPlainObject:m,isUndefined:u,isDate:g,isFile:y,isBlob:v,isRegExp:k,isFunction:h,isStream:e=>p(e)&&h(e.pipe),isURLSearchParams:x,isTypedArray:A,isFileList:b,forEach:w,merge:function e(){const{caseless:t}=T(this)&&this||{},r={},n=(n,i)=>{const s=t&&E(r,i)||i;m(r[s])&&m(n)?r[s]=e(r[s],n):m(n)?r[s]=e({},n):l(n)?r[s]=n.slice():r[s]=n};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&w(arguments[e],n);return r},extend:(t,r,n,{allOwnKeys:i}={})=>(w(r,((r,i)=>{n&&h(r)?t[i]=e(r,n):t[i]=r}),{allOwnKeys:i}),t),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,i)=>{let s,o,a;const l={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)a=s[o],i&&!i(a,e,t)||l[a]||(t[a]=e[a],l[a]=!0);e=!1!==r&&n(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:i,kindOfTest:o,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(l(e))return e;let t=e.length;if(!f(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:N,hasOwnProperty:C,hasOwnProp:C,reduceDescriptors:M,freezeMethods:e=>{M(e,((t,r)=>{if(h(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];h(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach((e=>{r[e]=!0}))};return l(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:E,global:S,isContextDefined:T,ALPHABET:L,generateString:(e=16,t=L.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&h(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(p(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const i=l(e)?[]:{};return w(e,((e,t)=>{const s=r(e,n+1);!u(s)&&(i[t]=s)})),t[n]=void 0,i}}return e};return r(e,0)},isAsyncFn:R,isThenable:e=>e&&(p(e)||h(e))&&h(e.then)&&h(e.catch)};function F(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}I.inherits(F,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:I.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const P=F.prototype,B={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{B[e]={value:e}})),Object.defineProperties(F,B),Object.defineProperty(P,"isAxiosError",{value:!0}),F.from=(e,t,r,n,i,s)=>{const o=Object.create(P);return I.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),F.call(o,e.message,t,r,n,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const U=F;function $(e){return I.isPlainObject(e)||I.isArray(e)}function j(e){return I.endsWith(e,"[]")?e.slice(0,-2):e}function z(e,t,r){return e?e.concat(t).map((function(e,t){return e=j(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}const q=I.toFlatObject(I,{},null,(function(e){return/^is[A-Z]/.test(e)}));const H=function(e,t,r){if(!I.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=I.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!I.isUndefined(t[e])}))).metaTokens,i=r.visitor||u,s=r.dots,o=r.indexes,a=(r.Blob||"undefined"!=typeof Blob&&Blob)&&I.isSpecCompliantForm(t);if(!I.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(I.isDate(e))return e.toISOString();if(!a&&I.isBlob(e))throw new U("Blob is not supported. Use a Buffer instead.");return I.isArrayBuffer(e)||I.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function u(e,r,i){let a=e;if(e&&!i&&"object"==typeof e)if(I.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(I.isArray(e)&&function(e){return I.isArray(e)&&!e.some($)}(e)||(I.isFileList(e)||I.endsWith(r,"[]"))&&(a=I.toArray(e)))return r=j(r),a.forEach((function(e,n){!I.isUndefined(e)&&null!==e&&t.append(!0===o?z([r],n,s):null===o?r:r+"[]",l(e))})),!1;return!!$(e)||(t.append(z(i,r,s),l(e)),!1)}const c=[],d=Object.assign(q,{defaultVisitor:u,convertValue:l,isVisitable:$});if(!I.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!I.isUndefined(r)){if(-1!==c.indexOf(r))throw Error("Circular reference detected in "+n.join("."));c.push(r),I.forEach(r,(function(r,s){!0===(!(I.isUndefined(r)||null===r)&&i.call(t,r,I.isString(s)?s.trim():s,n,d))&&e(r,n?n.concat(s):[s])})),c.pop()}}(e),t};function V(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function G(e,t){this._pairs=[],e&&H(e,this,t)}const W=G.prototype;W.append=function(e,t){this._pairs.push([e,t])},W.toString=function(e){const t=e?function(t){return e.call(this,t,V)}:V;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const K=G;function Y(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function J(e,t,r){if(!t)return e;const n=r&&r.encode||Y,i=r&&r.serialize;let s;if(s=i?i(t,r):I.isURLSearchParams(t)?t.toString():new K(t,r).toString(n),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Z=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){I.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},X={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Q="undefined"!=typeof URLSearchParams?URLSearchParams:K,ee="undefined"!=typeof FormData?FormData:null,te="undefined"!=typeof Blob?Blob:null,re=(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),ne={isBrowser:!0,classes:{URLSearchParams:Q,FormData:ee,Blob:te},isStandardBrowserEnv:re,isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const ie=function(e){function t(e,r,n,i){let s=e[i++];const o=Number.isFinite(+s),a=i>=e.length;if(s=!s&&I.isArray(n)?n.length:s,a)return I.hasOwnProp(n,s)?n[s]=[n[s],r]:n[s]=r,!o;n[s]&&I.isObject(n[s])||(n[s]=[]);return t(e,r,n[s],i)&&I.isArray(n[s])&&(n[s]=function(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}(n[s])),!o}if(I.isFormData(e)&&I.isFunction(e.entries)){const r={};return I.forEachEntry(e,((e,n)=>{t(function(e){return I.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,r,0)})),r}return null},se={"Content-Type":void 0};const oe={transitional:X,adapter:["xhr","http"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=I.isObject(e);i&&I.isHTMLForm(e)&&(e=new FormData(e));if(I.isFormData(e))return n&&n?JSON.stringify(ie(e)):e;if(I.isArrayBuffer(e)||I.isBuffer(e)||I.isStream(e)||I.isFile(e)||I.isBlob(e))return e;if(I.isArrayBufferView(e))return e.buffer;if(I.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return H(e,new ne.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return ne.isNode&&I.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=I.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return H(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(e,t,r){if(I.isString(e))try{return(t||JSON.parse)(e),I.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||oe.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(e&&I.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw U.from(e,U.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ne.classes.FormData,Blob:ne.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};I.forEach(["delete","get","head"],(function(e){oe.headers[e]={}})),I.forEach(["post","put","patch"],(function(e){oe.headers[e]=I.merge(se)}));const ae=oe,le=I.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ue=Symbol("internals");function ce(e){return e&&String(e).trim().toLowerCase()}function de(e){return!1===e||null==e?e:I.isArray(e)?e.map(de):String(e)}function he(e,t,r,n,i){return I.isFunction(n)?n.call(this,t,r):(i&&(t=r),I.isString(t)?I.isString(n)?-1!==t.indexOf(n):I.isRegExp(n)?n.test(t):void 0:void 0)}class fe{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function i(e,t,r){const i=ce(t);if(!i)throw new Error("header name must be a non-empty string");const s=I.findKey(n,i);(!s||void 0===n[s]||!0===r||void 0===r&&!1!==n[s])&&(n[s||t]=de(e))}const s=(e,t)=>I.forEach(e,((e,r)=>i(e,r,t)));return I.isPlainObject(e)||e instanceof this.constructor?s(e,t):I.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?s((e=>{const t={};let r,n,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),r=e.substring(0,i).trim().toLowerCase(),n=e.substring(i+1).trim(),!r||t[r]&&le[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)})),t})(e),t):null!=e&&i(t,e,r),this}get(e,t){if(e=ce(e)){const r=I.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(I.isFunction(t))return t.call(this,e,r);if(I.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ce(e)){const r=I.findKey(this,e);return!(!r||void 0===this[r]||t&&!he(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function i(e){if(e=ce(e)){const i=I.findKey(r,e);!i||t&&!he(0,r[i],i,t)||(delete r[i],n=!0)}}return I.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const i=t[r];e&&!he(0,this[i],i,e,!0)||(delete this[i],n=!0)}return n}normalize(e){const t=this,r={};return I.forEach(this,((n,i)=>{const s=I.findKey(r,i);if(s)return t[s]=de(n),void delete t[i];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,r)=>t.toUpperCase()+r))}(i):String(i).trim();o!==i&&delete t[i],t[o]=de(n),r[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return I.forEach(this,((r,n)=>{null!=r&&!1!==r&&(t[n]=e&&I.isArray(r)?r.join(", "):r)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach((e=>r.set(e))),r}static accessor(e){const t=(this[ue]=this[ue]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=ce(e);t[n]||(!function(e,t){const r=I.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+r,{value:function(e,r,i){return this[n].call(this,t,e,r,i)},configurable:!0})}))}(r,e),t[n]=!0)}return I.isArray(e)?e.forEach(n):n(e),this}}fe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),I.freezeMethods(fe.prototype),I.freezeMethods(fe);const pe=fe;function me(e,t){const r=this||ae,n=t||r,i=pe.from(n.headers);let s=n.data;return I.forEach(e,(function(e){s=e.call(r,s,i.normalize(),t?t.status:void 0)})),i.normalize(),s}function ge(e){return!(!e||!e.__CANCEL__)}function ye(e,t,r){U.call(this,null==e?"canceled":e,U.ERR_CANCELED,t,r),this.name="CanceledError"}I.inherits(ye,U,{__CANCEL__:!0});const ve=ye;const be=ne.isStandardBrowserEnv?{write:function(e,t,r,n,i,s){const o=[];o.push(e+"="+encodeURIComponent(t)),I.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),I.isString(n)&&o.push("path="+n),I.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function xe(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const we=ne.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function n(r){let n=r;return e&&(t.setAttribute("href",n),n=t.href),t.setAttribute("href",n),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return r=n(window.location.href),function(e){const t=I.isString(e)?n(e):e;return t.protocol===r.protocol&&t.host===r.host}}():function(){return!0};const Ee=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i,s=0,o=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),u=n[o];i||(i=l),r[s]=a,n[s]=l;let c=o,d=0;for(;c!==s;)d+=r[c++],c%=e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),l-i<t)return;const h=u&&l-u;return h?Math.round(1e3*d/h):void 0}};function Se(e,t){let r=0;const n=Ee(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-r,l=n(a);r=s;const u={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&s<=o?(o-s)/l:void 0,event:i};u[t?"download":"upload"]=!0,e(u)}}const Te="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){let n=e.data;const i=pe.from(e.headers).normalize(),s=e.responseType;let o;function a(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}I.isFormData(n)&&(ne.isStandardBrowserEnv||ne.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));let l=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",r=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+r))}const u=xe(e.baseURL,e.url);function c(){if(!l)return;const n=pe.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new U("Request failed with status code "+r.status,[U.ERR_BAD_REQUEST,U.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}((function(e){t(e),a()}),(function(e){r(e),a()}),{data:s&&"text"!==s&&"json"!==s?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:n,config:e,request:l}),l=null}if(l.open(e.method.toUpperCase(),J(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=c:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(c)},l.onabort=function(){l&&(r(new U("Request aborted",U.ECONNABORTED,e,l)),l=null)},l.onerror=function(){r(new U("Network Error",U.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const n=e.transitional||X;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(new U(t,n.clarifyTimeoutError?U.ETIMEDOUT:U.ECONNABORTED,e,l)),l=null},ne.isStandardBrowserEnv){const t=(e.withCredentials||we(u))&&e.xsrfCookieName&&be.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===n&&i.setContentType(null),"setRequestHeader"in l&&I.forEach(i.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),I.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),s&&"json"!==s&&(l.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",Se(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Se(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=t=>{l&&(r(!t||t.type?new ve(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)));const d=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);d&&-1===ne.protocols.indexOf(d)?r(new U("Unsupported protocol "+d+":",U.ERR_BAD_REQUEST,e)):l.send(n||null)}))},Ae={http:null,xhr:Te};I.forEach(Ae,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const De=e=>{e=I.isArray(e)?e:[e];const{length:t}=e;let r,n;for(let i=0;i<t&&(r=e[i],!(n=I.isString(r)?Ae[r.toLowerCase()]:r));i++);if(!n){if(!1===n)throw new U(`Adapter ${r} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(I.hasOwnProp(Ae,r)?`Adapter '${r}' is not available in the build`:`Unknown adapter '${r}'`)}if(!I.isFunction(n))throw new TypeError("adapter is not a function");return n};function Ne(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ve(null,e)}function Ce(e){Ne(e),e.headers=pe.from(e.headers),e.data=me.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return De(e.adapter||ae.adapter)(e).then((function(t){return Ne(e),t.data=me.call(e,e.transformResponse,t),t.headers=pe.from(t.headers),t}),(function(t){return ge(t)||(Ne(e),t&&t.response&&(t.response.data=me.call(e,e.transformResponse,t.response),t.response.headers=pe.from(t.response.headers))),Promise.reject(t)}))}const ke=e=>e instanceof pe?e.toJSON():e;function Me(e,t){t=t||{};const r={};function n(e,t,r){return I.isPlainObject(e)&&I.isPlainObject(t)?I.merge.call({caseless:r},e,t):I.isPlainObject(t)?I.merge({},t):I.isArray(t)?t.slice():t}function i(e,t,r){return I.isUndefined(t)?I.isUndefined(e)?void 0:n(void 0,e,r):n(e,t,r)}function s(e,t){if(!I.isUndefined(t))return n(void 0,t)}function o(e,t){return I.isUndefined(t)?I.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function a(r,i,s){return s in t?n(r,i):s in e?n(void 0,r):void 0}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t)=>i(ke(e),ke(t),!0)};return I.forEach(Object.keys(Object.assign({},e,t)),(function(n){const s=l[n]||i,o=s(e[n],t[n],n);I.isUndefined(o)&&s!==a||(r[n]=o)})),r}const Oe="1.4.0",_e={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{_e[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));const Le={};_e.transitional=function(e,t,r){function n(e,t){return"[Axios v1.4.0] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,i,s)=>{if(!1===e)throw new U(n(i," has been removed"+(t?" in "+t:"")),U.ERR_DEPRECATED);return t&&!Le[i]&&(Le[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,s)}};const Re={assertOptions:function(e,t,r){if("object"!=typeof e)throw new U("options must be an object",U.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const t=e[s],r=void 0===t||o(t,s,e);if(!0!==r)throw new U("option "+s+" must be "+r,U.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new U("Unknown option "+s,U.ERR_BAD_OPTION)}},validators:_e},Ie=Re.validators;class Fe{constructor(e){this.defaults=e,this.interceptors={request:new Z,response:new Z}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Me(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:i}=t;let s;void 0!==r&&Re.assertOptions(r,{silentJSONParsing:Ie.transitional(Ie.boolean),forcedJSONParsing:Ie.transitional(Ie.boolean),clarifyTimeoutError:Ie.transitional(Ie.boolean)},!1),null!=n&&(I.isFunction(n)?t.paramsSerializer={serialize:n}:Re.assertOptions(n,{encode:Ie.function,serialize:Ie.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase(),s=i&&I.merge(i.common,i[t.method]),s&&I.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=pe.concat(s,i);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let u;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let c,d=0;if(!a){const e=[Ce.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),c=e.length,u=Promise.resolve(t);d<c;)u=u.then(e[d++],e[d++]);return u}c=o.length;let h=t;for(d=0;d<c;){const e=o[d++],t=o[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{u=Ce.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,c=l.length;d<c;)u=u.then(l[d++],l[d++]);return u}getUri(e){return J(xe((e=Me(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}I.forEach(["delete","get","head","options"],(function(e){Fe.prototype[e]=function(t,r){return this.request(Me(r||{},{method:e,url:t,data:(r||{}).data}))}})),I.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,i){return this.request(Me(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}Fe.prototype[e]=t(),Fe.prototype[e+"Form"]=t(!0)}));const Pe=Fe;class Be{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const r=this;this.promise.then((e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e,n,i){r.reason||(r.reason=new ve(e,n,i),t(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;const t=new Be((function(t){e=t}));return{token:t,cancel:e}}}const Ue=Be;const $e={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($e).forEach((([e,t])=>{$e[t]=e}));const je=$e;const ze=function t(r){const n=new Pe(r),i=e(Pe.prototype.request,n);return I.extend(i,Pe.prototype,n,{allOwnKeys:!0}),I.extend(i,n,null,{allOwnKeys:!0}),i.create=function(e){return t(Me(r,e))},i}(ae);ze.Axios=Pe,ze.CanceledError=ve,ze.CancelToken=Ue,ze.isCancel=ge,ze.VERSION=Oe,ze.toFormData=H,ze.AxiosError=U,ze.Cancel=ze.CanceledError,ze.all=function(e){return Promise.all(e)},ze.spread=function(e){return function(t){return e.apply(null,t)}},ze.isAxiosError=function(e){return I.isObject(e)&&!0===e.isAxiosError},ze.mergeConfig=Me,ze.AxiosHeaders=pe,ze.formToJSON=e=>ie(I.isHTMLForm(e)?new FormData(e):e),ze.HttpStatusCode=je,ze.default=ze;const qe=ze;class He extends Error{}class Ve extends He{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Ge extends He{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class We extends He{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Ke extends He{}class Ye extends He{constructor(e){super(`Invalid unit ${e}`)}}class Je extends He{}class Ze extends He{constructor(){super("Zone is an abstract class")}}const Xe="numeric",Qe="short",et="long",tt={year:Xe,month:Xe,day:Xe},rt={year:Xe,month:Qe,day:Xe},nt={year:Xe,month:Qe,day:Xe,weekday:Qe},it={year:Xe,month:et,day:Xe},st={year:Xe,month:et,day:Xe,weekday:et},ot={hour:Xe,minute:Xe},at={hour:Xe,minute:Xe,second:Xe},lt={hour:Xe,minute:Xe,second:Xe,timeZoneName:Qe},ut={hour:Xe,minute:Xe,second:Xe,timeZoneName:et},ct={hour:Xe,minute:Xe,hourCycle:"h23"},dt={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23"},ht={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23",timeZoneName:Qe},ft={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23",timeZoneName:et},pt={year:Xe,month:Xe,day:Xe,hour:Xe,minute:Xe},mt={year:Xe,month:Xe,day:Xe,hour:Xe,minute:Xe,second:Xe},gt={year:Xe,month:Qe,day:Xe,hour:Xe,minute:Xe},yt={year:Xe,month:Qe,day:Xe,hour:Xe,minute:Xe,second:Xe},vt={year:Xe,month:Qe,day:Xe,weekday:Qe,hour:Xe,minute:Xe},bt={year:Xe,month:et,day:Xe,hour:Xe,minute:Xe,timeZoneName:Qe},xt={year:Xe,month:et,day:Xe,hour:Xe,minute:Xe,second:Xe,timeZoneName:Qe},wt={year:Xe,month:et,day:Xe,weekday:et,hour:Xe,minute:Xe,timeZoneName:et},Et={year:Xe,month:et,day:Xe,weekday:et,hour:Xe,minute:Xe,second:Xe,timeZoneName:et};class St{get type(){throw new Ze}get name(){throw new Ze}get ianaName(){return this.name}get isUniversal(){throw new Ze}offsetName(e,t){throw new Ze}formatOffset(e,t){throw new Ze}offset(e){throw new Ze}equals(e){throw new Ze}get isValid(){throw new Ze}}let Tt=null;class At extends St{static get instance(){return null===Tt&&(Tt=new At),Tt}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return yr(e,t,r)}formatOffset(e,t){return wr(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return"system"===e.type}get isValid(){return!0}}let Dt={};const Nt={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Ct={};class kt extends St{static create(e){return Ct[e]||(Ct[e]=new kt(e)),Ct[e]}static resetCache(){Ct={},Dt={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}}constructor(e){super(),this.zoneName=e,this.valid=kt.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return yr(e,t,r,this.name)}formatOffset(e,t){return wr(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const r=(n=this.name,Dt[n]||(Dt[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Dt[n]);var n;let[i,s,o,a,l,u,c]=r.formatToParts?function(e,t){const r=e.formatToParts(t),n=[];for(let e=0;e<r.length;e++){const{type:t,value:i}=r[e],s=Nt[t];"era"===t?n[s]=i:Qt(s)||(n[s]=parseInt(i,10))}return n}(r,t):function(e,t){const r=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,i,s,o,a,l,u,c]=n;return[o,i,s,a,l,u,c]}(r,t);"BC"===a&&(i=1-Math.abs(i));let d=+t;const h=d%1e3;return d-=h>=0?h:1e3+h,(pr({year:i,month:s,day:o,hour:24===l?0:l,minute:u,second:c,millisecond:0})-d)/6e4}equals(e){return"iana"===e.type&&e.name===this.name}get isValid(){return this.valid}}let Mt={};let Ot={};function _t(e,t={}){const r=JSON.stringify([e,t]);let n=Ot[r];return n||(n=new Intl.DateTimeFormat(e,t),Ot[r]=n),n}let Lt={};let Rt={};let It=null;function Ft(e,t,r,n){const i=e.listingMode();return"error"===i?null:"en"===i?r(t):n(t)}class Pt{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:i,...s}=r;if(!t||Object.keys(s).length>0){const t={useGrouping:!1,...r};r.padTo>0&&(t.minimumIntegerDigits=r.padTo),this.inf=function(e,t={}){const r=JSON.stringify([e,t]);let n=Lt[r];return n||(n=new Intl.NumberFormat(e,t),Lt[r]=n),n}(e,t)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}return or(this.floor?Math.floor(e):cr(e,3),this.padTo)}}class Bt{constructor(e,t,r){let n;if(this.opts=r,this.originalZone=void 0,this.opts.timeZone)this.dt=e;else if("fixed"===e.zone.type){const t=e.offset/60*-1,r=t>=0?`Etc/GMT+${t}`:`Etc/GMT${t}`;0!==e.offset&&kt.create(r).valid?(n=r,this.dt=e):(n="UTC",this.dt=0===e.offset?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else"system"===e.zone.type?this.dt=e:"iana"===e.zone.type?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const i={...this.opts};i.timeZone=i.timeZone||n,this.dtf=_t(t,i)}format(){return this.originalZone?this.formatToParts().map((({value:e})=>e)).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map((e=>{if("timeZoneName"===e.type){const t=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...e,value:t}}return e})):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Ut{constructor(e,t,r){this.opts={style:"long",...r},!t&&rr()&&(this.rtf=function(e,t={}){const{base:r,...n}=t,i=JSON.stringify([e,n]);let s=Rt[i];return s||(s=new Intl.RelativeTimeFormat(e,t),Rt[i]=s),s}(e,r))}format(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,r="always",n=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===r&&s){const r="days"===e;switch(t){case 1:return r?"tomorrow":`next ${i[e][0]}`;case-1:return r?"yesterday":`last ${i[e][0]}`;case 0:return r?"today":`this ${i[e][0]}`}}const o=Object.is(t,-0)||t<0,a=Math.abs(t),l=1===a,u=i[e],c=n?l?u[1]:u[2]||u[1]:l?i[e][0]:e;return o?`${a} ${c} ago`:`in ${a} ${c}`}(t,e,this.opts.numeric,"long"!==this.opts.style)}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class $t{static fromOpts(e){return $t.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,r,n=!1){const i=e||Xt.defaultLocale,s=i||(n?"en-US":It||(It=(new Intl.DateTimeFormat).resolvedOptions().locale,It)),o=t||Xt.defaultNumberingSystem,a=r||Xt.defaultOutputCalendar;return new $t(s,o,a,i)}static resetCache(){It=null,Ot={},Lt={},Rt={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:r}={}){return $t.create(e,t,r)}constructor(e,t,r,n){const[i,s,o]=function(e){const t=e.indexOf("-x-");-1!==t&&(e=e.substring(0,t));const r=e.indexOf("-u-");if(-1===r)return[e];{let t,n;try{t=_t(e).resolvedOptions(),n=e}catch(i){const s=e.substring(0,r);t=_t(s).resolvedOptions(),n=s}const{numberingSystem:i,calendar:s}=t;return[n,i,s]}}(e);this.locale=i,this.numberingSystem=t||s||null,this.outputCalendar=r||o||null,this.intl=function(e,t,r){return r||t?(e.includes("-u-")||(e+="-u"),r&&(e+=`-ca-${r}`),t&&(e+=`-nu-${t}`),e):e}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){var e;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(e=this).numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"}clone(e){return e&&0!==Object.getOwnPropertyNames(e).length?$t.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1):this}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return Ft(this,e,Dr,(()=>{const r=t?{month:e,day:"numeric"}:{month:e},n=t?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=function(e){const t=[];for(let r=1;r<=12;r++){const n=qi.utc(2009,r,1);t.push(e(n))}return t}((e=>this.extract(e,r,"month")))),this.monthsCache[n][e]}))}weekdays(e,t=!1){return Ft(this,e,Mr,(()=>{const r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=t?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=function(e){const t=[];for(let r=1;r<=7;r++){const n=qi.utc(2016,11,13+r);t.push(e(n))}return t}((e=>this.extract(e,r,"weekday")))),this.weekdaysCache[n][e]}))}meridiems(){return Ft(this,void 0,(()=>Or),(()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[qi.utc(2016,11,13,9),qi.utc(2016,11,13,19)].map((t=>this.extract(t,e,"dayperiod")))}return this.meridiemCache}))}eras(e){return Ft(this,e,Ir,(()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[qi.utc(-40,1,1),qi.utc(2017,1,1)].map((e=>this.extract(e,t,"era")))),this.eraCache[e]}))}extract(e,t,r){const n=this.dtFormatter(e,t).formatToParts().find((e=>e.type.toLowerCase()===r));return n?n.value:null}numberFormatter(e={}){return new Pt(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new Bt(e,this.intl,t)}relFormatter(e={}){return new Ut(this.intl,this.isEnglish(),e)}listFormatter(e={}){return function(e,t={}){const r=JSON.stringify([e,t]);let n=Mt[r];return n||(n=new Intl.ListFormat(e,t),Mt[r]=n),n}(this.intl,e)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let jt=null;class zt extends St{static get utcInstance(){return null===jt&&(jt=new zt(0)),jt}static instance(e){return 0===e?zt.utcInstance:new zt(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new zt(vr(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${wr(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${wr(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return wr(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return"fixed"===e.type&&e.fixed===this.fixed}get isValid(){return!0}}class qt extends St{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ht(e,t){if(Qt(e)||null===e)return t;if(e instanceof St)return e;if(function(e){return"string"==typeof e}(e)){const r=e.toLowerCase();return"default"===r?t:"local"===r||"system"===r?At.instance:"utc"===r||"gmt"===r?zt.utcInstance:zt.parseSpecifier(r)||kt.create(e)}return er(e)?zt.instance(e):"object"==typeof e&&"offset"in e&&"function"==typeof e.offset?e:new qt(e)}let Vt,Gt=()=>Date.now(),Wt="system",Kt=null,Yt=null,Jt=null,Zt=60;class Xt{static get now(){return Gt}static set now(e){Gt=e}static set defaultZone(e){Wt=e}static get defaultZone(){return Ht(Wt,At.instance)}static get defaultLocale(){return Kt}static set defaultLocale(e){Kt=e}static get defaultNumberingSystem(){return Yt}static set defaultNumberingSystem(e){Yt=e}static get defaultOutputCalendar(){return Jt}static set defaultOutputCalendar(e){Jt=e}static get twoDigitCutoffYear(){return Zt}static set twoDigitCutoffYear(e){Zt=e%100}static get throwOnInvalid(){return Vt}static set throwOnInvalid(e){Vt=e}static resetCaches(){$t.resetCache(),kt.resetCache()}}function Qt(e){return void 0===e}function er(e){return"number"==typeof e}function tr(e){return"number"==typeof e&&e%1==0}function rr(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function nr(e,t,r){if(0!==e.length)return e.reduce(((e,n)=>{const i=[t(n),n];return e&&r(e[0],i[0])===e[0]?e:i}),null)[1]}function ir(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sr(e,t,r){return tr(e)&&e>=t&&e<=r}function or(e,t=2){let r;return r=e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0"),r}function ar(e){return Qt(e)||null===e||""===e?void 0:parseInt(e,10)}function lr(e){return Qt(e)||null===e||""===e?void 0:parseFloat(e)}function ur(e){if(!Qt(e)&&null!==e&&""!==e){const t=1e3*parseFloat("0."+e);return Math.floor(t)}}function cr(e,t,r=!1){const n=10**t;return(r?Math.trunc:Math.round)(e*n)/n}function dr(e){return e%4==0&&(e%100!=0||e%400==0)}function hr(e){return dr(e)?366:365}function fr(e,t){const r=function(e,t){return e-t*Math.floor(e/t)}(t-1,12)+1;return 2===r?dr(e+(t-r)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function pr(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function mr(e){const t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,r=e-1,n=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7;return 4===t||3===n?53:52}function gr(e){return e>99?e:e>Xt.twoDigitCutoffYear?1900+e:2e3+e}function yr(e,t,r,n=null){const i=new Date(e),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const o={timeZoneName:t,...s},a=new Intl.DateTimeFormat(r,o).formatToParts(i).find((e=>"timezonename"===e.type.toLowerCase()));return a?a.value:null}function vr(e,t){let r=parseInt(e,10);Number.isNaN(r)&&(r=0);const n=parseInt(t,10)||0;return 60*r+(r<0||Object.is(r,-0)?-n:n)}function br(e){const t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new Je(`Invalid unit value ${e}`);return t}function xr(e,t){const r={};for(const n in e)if(ir(e,n)){const i=e[n];if(null==i)continue;r[t(n)]=br(i)}return r}function wr(e,t){const r=Math.trunc(Math.abs(e/60)),n=Math.trunc(Math.abs(e%60)),i=e>=0?"+":"-";switch(t){case"short":return`${i}${or(r,2)}:${or(n,2)}`;case"narrow":return`${i}${r}${n>0?`:${n}`:""}`;case"techie":return`${i}${or(r,2)}${or(n,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function Er(e){return function(e,t){return t.reduce(((t,r)=>(t[r]=e[r],t)),{})}(e,["hour","minute","second","millisecond"])}const Sr=["January","February","March","April","May","June","July","August","September","October","November","December"],Tr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ar=["J","F","M","A","M","J","J","A","S","O","N","D"];function Dr(e){switch(e){case"narrow":return[...Ar];case"short":return[...Tr];case"long":return[...Sr];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Nr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Cr=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],kr=["M","T","W","T","F","S","S"];function Mr(e){switch(e){case"narrow":return[...kr];case"short":return[...Cr];case"long":return[...Nr];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Or=["AM","PM"],_r=["Before Christ","Anno Domini"],Lr=["BC","AD"],Rr=["B","A"];function Ir(e){switch(e){case"narrow":return[...Rr];case"short":return[...Lr];case"long":return[..._r];default:return null}}function Fr(e,t){let r="";for(const n of e)n.literal?r+=n.val:r+=t(n.val);return r}const Pr={D:tt,DD:rt,DDD:it,DDDD:st,t:ot,tt:at,ttt:lt,tttt:ut,T:ct,TT:dt,TTT:ht,TTTT:ft,f:pt,ff:gt,fff:bt,ffff:wt,F:mt,FF:yt,FFF:xt,FFFF:Et};class Br{static create(e,t={}){return new Br(e,t)}static parseFormat(e){let t=null,r="",n=!1;const i=[];for(let s=0;s<e.length;s++){const o=e.charAt(s);"'"===o?(r.length>0&&i.push({literal:n||/^\s+$/.test(r),val:r}),t=null,r="",n=!n):n||o===t?r+=o:(r.length>0&&i.push({literal:/^\s+$/.test(r),val:r}),r=o,t=o)}return r.length>0&&i.push({literal:n||/^\s+$/.test(r),val:r}),i}static macroTokenToFormatOpts(e){return Pr[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return or(e,t);const r={...this.opts};return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,t){const r="en"===this.loc.listingMode(),n=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,i=(t,r)=>this.loc.extract(e,t,r),s=t=>e.isOffsetFixed&&0===e.offset&&t.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,t.format):"",o=()=>r?function(e){return Or[e.hour<12?0:1]}(e):i({hour:"numeric",hourCycle:"h12"},"dayperiod"),a=(t,n)=>r?function(e,t){return Dr(t)[e.month-1]}(e,t):i(n?{month:t}:{month:t,day:"numeric"},"month"),l=(t,n)=>r?function(e,t){return Mr(t)[e.weekday-1]}(e,t):i(n?{weekday:t}:{weekday:t,month:"long",day:"numeric"},"weekday"),u=t=>{const r=Br.macroTokenToFormatOpts(t);return r?this.formatWithSystemDefault(e,r):t},c=t=>r?function(e,t){return Ir(t)[e.year<0?0:1]}(e,t):i({era:t},"era");return Fr(Br.parseFormat(t),(t=>{switch(t){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12==0?12:e.hour%12);case"hh":return this.num(e.hour%12==0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return s({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return s({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return n?i({day:"numeric"},"day"):this.num(e.day);case"dd":return n?i({day:"2-digit"},"day"):this.num(e.day,2);case"c":case"E":return this.num(e.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return n?i({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?i({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return n?i({month:"numeric"},"month"):this.num(e.month);case"MM":return n?i({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return n?i({year:"numeric"},"year"):this.num(e.year);case"yy":return n?i({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?i({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?i({year:"numeric"},"year"):this.num(e.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(t)}}))}formatDurationFromString(e,t){const r=e=>{switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=Br.parseFormat(t),i=n.reduce(((e,{literal:t,val:r})=>t?e:e.concat(r)),[]),s=e.shiftTo(...i.map(r).filter((e=>e)));return Fr(n,(e=>t=>{const n=r(t);return n?this.num(e.get(n),t.length):t})(s))}}class Ur{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const $r=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function jr(...e){const t=e.reduce(((e,t)=>e+t.source),"");return RegExp(`^${t}$`)}function zr(...e){return t=>e.reduce((([e,r,n],i)=>{const[s,o,a]=i(t,n);return[{...e,...s},o||r,a]}),[{},null,1]).slice(0,2)}function qr(e,...t){if(null==e)return[null,null];for(const[r,n]of t){const t=r.exec(e);if(t)return n(t)}return[null,null]}function Hr(...e){return(t,r)=>{const n={};let i;for(i=0;i<e.length;i++)n[e[i]]=ar(t[r+i]);return[n,null,r+i]}}const Vr=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Gr=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Wr=RegExp(`${Gr.source}${`(?:${Vr.source}?(?:\\[(${$r.source})\\])?)?`}`),Kr=RegExp(`(?:T${Wr.source})?`),Yr=Hr("weekYear","weekNumber","weekDay"),Jr=Hr("year","ordinal"),Zr=RegExp(`${Gr.source} ?(?:${Vr.source}|(${$r.source}))?`),Xr=RegExp(`(?: ${Zr.source})?`);function Qr(e,t,r){const n=e[t];return Qt(n)?r:ar(n)}function en(e,t){return[{hours:Qr(e,t,0),minutes:Qr(e,t+1,0),seconds:Qr(e,t+2,0),milliseconds:ur(e[t+3])},null,t+4]}function tn(e,t){const r=!e[t]&&!e[t+1],n=vr(e[t+1],e[t+2]);return[{},r?null:zt.instance(n),t+3]}function rn(e,t){return[{},e[t]?kt.create(e[t]):null,t+1]}const nn=RegExp(`^T?${Gr.source}$`),sn=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function on(e){const[t,r,n,i,s,o,a,l,u]=e,c="-"===t[0],d=l&&"-"===l[0],h=(e,t=!1)=>void 0!==e&&(t||e&&c)?-e:e;return[{years:h(lr(r)),months:h(lr(n)),weeks:h(lr(i)),days:h(lr(s)),hours:h(lr(o)),minutes:h(lr(a)),seconds:h(lr(l),"-0"===l),milliseconds:h(ur(u),d)}]}const an={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ln(e,t,r,n,i,s,o){const a={year:2===t.length?gr(ar(t)):ar(t),month:Tr.indexOf(r)+1,day:ar(n),hour:ar(i),minute:ar(s)};return o&&(a.second=ar(o)),e&&(a.weekday=e.length>3?Nr.indexOf(e)+1:Cr.indexOf(e)+1),a}const un=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function cn(e){const[,t,r,n,i,s,o,a,l,u,c,d]=e,h=ln(t,i,n,r,s,o,a);let f;return f=l?an[l]:u?0:vr(c,d),[h,new zt(f)]}const dn=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,hn=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,fn=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function pn(e){const[,t,r,n,i,s,o,a]=e;return[ln(t,i,n,r,s,o,a),zt.utcInstance]}function mn(e){const[,t,r,n,i,s,o,a]=e;return[ln(t,a,r,n,i,s,o),zt.utcInstance]}const gn=jr(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Kr),yn=jr(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Kr),vn=jr(/(\d{4})-?(\d{3})/,Kr),bn=jr(Wr),xn=zr((function(e,t){return[{year:Qr(e,t),month:Qr(e,t+1,1),day:Qr(e,t+2,1)},null,t+3]}),en,tn,rn),wn=zr(Yr,en,tn,rn),En=zr(Jr,en,tn,rn),Sn=zr(en,tn,rn);const Tn=zr(en);const An=jr(/(\d{4})-(\d\d)-(\d\d)/,Xr),Dn=jr(Zr),Nn=zr(en,tn,rn);const Cn={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},kn={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...Cn},Mn=365.2425,On=30.436875,_n={years:{quarters:4,months:12,weeks:52.1775,days:Mn,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:On,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...Cn},Ln=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Rn=Ln.slice(0).reverse();function In(e,t,r=!1){const n={values:r?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Bn(n)}function Fn(e){return Math.trunc(1e3*e)/1e3}function Pn(e,t,r,n,i){const s=e[i][r],o=t[r]/s,a=Math.floor(o);n[i]=Fn(n[i]+a),t[r]=Fn(t[r]-a*s)}class Bn{constructor(e){const t="longterm"===e.conversionAccuracy||!1;let r=t?_n:kn;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||$t.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,t){return Bn.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(null==e||"object"!=typeof e)throw new Je("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new Bn({values:xr(e,Bn.normalizeUnit),loc:$t.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(er(e))return Bn.fromMillis(e);if(Bn.isDuration(e))return e;if("object"==typeof e)return Bn.fromObject(e);throw new Je(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[r]=function(e){return qr(e,[sn,on])}(e);return r?Bn.fromObject(r,t):Bn.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[r]=function(e){return qr(e,[nn,Tn])}(e);return r?Bn.fromObject(r,t):Bn.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new Je("need to specify a reason the Duration is invalid");const r=e instanceof Ur?e:new Ur(e,t);if(Xt.throwOnInvalid)throw new We(r);return new Bn({invalid:r})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new Ye(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const r={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?Br.create(this.loc,r).formatDurationFromString(this,e):"Invalid Duration"}toHuman(e={}){const t=Ln.map((t=>{const r=this.values[t];return Qt(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:t.slice(0,-1)}).format(r)})).filter((e=>e));return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=cr(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1};return qi.fromMillis(t,{zone:"UTC"}).toISOTime(e)}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){let e=this.values.milliseconds??0;for(let t of Rn.slice(1))this.values?.[t]&&(e+=this.values[t]*this.matrix[t].milliseconds);return e}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Bn.fromDurationLike(e),r={};for(const e of Ln)(ir(t.values,e)||ir(this.values,e))&&(r[e]=t.get(e)+this.get(e));return In(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const t=Bn.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const r of Object.keys(this.values))t[r]=br(e(this.values[r],r));return In(this,{values:t},!0)}get(e){return this[Bn.normalizeUnit(e)]}set(e){if(!this.isValid)return this;return In(this,{values:{...this.values,...xr(e,Bn.normalizeUnit)}})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:r,matrix:n}={}){return In(this,{loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:n,conversionAccuracy:r})}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return this.valueOf()>=0?(function(e,t){Rn.reduce(((r,n)=>Qt(t[n])?r:(r&&Pn(e,t,r,t,n),n)),null)}(this.matrix,e),In(this,{values:e},!0)):this.negate().normalize().negate()}rescale(){if(!this.isValid)return this;return In(this,{values:function(e){const t={};for(const[r,n]of Object.entries(e))0!==n&&(t[r]=n);return t}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...e){if(!this.isValid)return this;if(0===e.length)return this;e=e.map((e=>Bn.normalizeUnit(e)));const t={},r={},n=this.toObject();let i;for(const s of Ln)if(e.indexOf(s)>=0){i=s;let e=0;for(const t in r)e+=this.matrix[t][s]*r[t],r[t]=0;er(n[s])&&(e+=n[s]);const o=Math.trunc(e);t[s]=o,r[s]=(1e3*e-1e3*o)/1e3;for(const e in n)Ln.indexOf(e)>Ln.indexOf(s)&&Pn(this.matrix,n,e,t,s)}else er(n[s])&&(r[s]=n[s]);for(const e in r)0!==r[e]&&(t[i]+=e===i?r[e]:r[e]/this.matrix[i][e]);return In(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=0===this.values[t]?0:-this.values[t];return In(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(const n of Ln)if(t=this.values[n],r=e.values[n],!(void 0===t||0===t?void 0===r||0===r:t===r))return!1;var t,r;return!0}}const Un="Invalid Interval";class $n{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new Je("need to specify a reason the Interval is invalid");const r=e instanceof Ur?e:new Ur(e,t);if(Xt.throwOnInvalid)throw new Ge(r);return new $n({invalid:r})}static fromDateTimes(e,t){const r=Hi(e),n=Hi(t),i=function(e,t){return e&&e.isValid?t&&t.isValid?t<e?$n.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null:$n.invalid("missing or invalid end"):$n.invalid("missing or invalid start")}(r,n);return null==i?new $n({start:r,end:n}):i}static after(e,t){const r=Bn.fromDurationLike(t),n=Hi(e);return $n.fromDateTimes(n,n.plus(r))}static before(e,t){const r=Bn.fromDurationLike(t),n=Hi(e);return $n.fromDateTimes(n.minus(r),n)}static fromISO(e,t){const[r,n]=(e||"").split("/",2);if(r&&n){let e,i,s,o;try{e=qi.fromISO(r,t),i=e.isValid}catch(n){i=!1}try{s=qi.fromISO(n,t),o=s.isValid}catch(n){o=!1}if(i&&o)return $n.fromDateTimes(e,s);if(i){const r=Bn.fromISO(n,t);if(r.isValid)return $n.after(e,r)}else if(o){const e=Bn.fromISO(r,t);if(e.isValid)return $n.before(s,e)}}return $n.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),r=this.end.startOf(e);return Math.floor(r.diff(t,e).get(e))+(r.valueOf()!==this.end.valueOf())}hasSame(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return!!this.isValid&&this.s>e}isBefore(e){return!!this.isValid&&this.e<=e}contains(e){return!!this.isValid&&(this.s<=e&&this.e>e)}set({start:e,end:t}={}){return this.isValid?$n.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Hi).filter((e=>this.contains(e))).sort(),r=[];let{s:n}=this,i=0;for(;n<this.e;){const e=t[i]||this.e,s=+e>+this.e?this.e:e;r.push($n.fromDateTimes(n,s)),n=s,i+=1}return r}splitBy(e){const t=Bn.fromDurationLike(e);if(!this.isValid||!t.isValid||0===t.as("milliseconds"))return[];let r,{s:n}=this,i=1;const s=[];for(;n<this.e;){const e=this.start.plus(t.mapUnits((e=>e*i)));r=+e>+this.e?this.e:e,s.push($n.fromDateTimes(n,r)),n=r,i+=1}return s}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return!!this.isValid&&+this.e==+e.s}abutsEnd(e){return!!this.isValid&&+e.e==+this.s}engulfs(e){return!!this.isValid&&(this.s<=e.s&&this.e>=e.e)}equals(e){return!(!this.isValid||!e.isValid)&&(this.s.equals(e.s)&&this.e.equals(e.e))}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return t>=r?null:$n.fromDateTimes(t,r)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return $n.fromDateTimes(t,r)}static merge(e){const[t,r]=e.sort(((e,t)=>e.s-t.s)).reduce((([e,t],r)=>t?t.overlaps(r)||t.abutsStart(r)?[e,t.union(r)]:[e.concat([t]),r]:[e,r]),[[],null]);return r&&t.push(r),t}static xor(e){let t=null,r=0;const n=[],i=e.map((e=>[{time:e.s,type:"s"},{time:e.e,type:"e"}])),s=Array.prototype.concat(...i).sort(((e,t)=>e.time-t.time));for(const e of s)r+="s"===e.type?1:-1,1===r?t=e.time:(t&&+t!=+e.time&&n.push($n.fromDateTimes(t,e.time)),t=null);return $n.merge(n)}difference(...e){return $n.xor([this].concat(e)).map((e=>this.intersection(e))).filter((e=>e&&!e.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Un}toLocaleString(e=tt,t={}){return this.isValid?Br.create(this.s.loc.clone(t),e).formatInterval(this):Un}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Un}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Un}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Un}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:Un}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Bn.invalid(this.invalidReason)}mapEndpoints(e){return $n.fromDateTimes(e(this.s),e(this.e))}}class jn{static hasDST(e=Xt.defaultZone){const t=qi.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return kt.isValidZone(e)}static normalizeZone(e){return Ht(e,Xt.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||$t.create(t,r,i)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||$t.create(t,r,i)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||$t.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||$t.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return $t.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return $t.create(t,null,"gregory").eras(e)}static features(){return{relative:rr()}}}function zn(e,t){const r=e=>e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=r(t)-r(e);return Math.floor(Bn.fromMillis(n).as("days"))}function qn(e,t,r,n){let[i,s,o,a]=function(e,t,r){const n=[["years",(e,t)=>t.year-e.year],["quarters",(e,t)=>t.quarter-e.quarter+4*(t.year-e.year)],["months",(e,t)=>t.month-e.month+12*(t.year-e.year)],["weeks",(e,t)=>{const r=zn(e,t);return(r-r%7)/7}],["days",zn]],i={},s=e;let o,a;for(const[l,u]of n)r.indexOf(l)>=0&&(o=l,i[l]=u(e,t),a=s.plus(i),a>t?(i[l]--,(e=s.plus(i))>t&&(a=e,i[l]--,e=s.plus(i))):e=a);return[e,i,a,o]}(e,t,r);const l=t-i,u=r.filter((e=>["hours","minutes","seconds","milliseconds"].indexOf(e)>=0));0===u.length&&(o<t&&(o=i.plus({[a]:1})),o!==i&&(s[a]=(s[a]||0)+l/(o-i)));const c=Bn.fromObject(s,n);return u.length>0?Bn.fromMillis(l,n).shiftTo(...u).plus(c):c}const Hn={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Vn={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Gn=Hn.hanidec.replace(/[\[|\]]/g,"").split("");function Wn({numberingSystem:e},t=""){return new RegExp(`${Hn[e||"latn"]}${t}`)}const Kn="missing Intl.DateTimeFormat.formatToParts support";function Yn(e,t=(e=>e)){return{regex:e,deser:([e])=>t(function(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);if(-1!==e[r].search(Hn.hanidec))t+=Gn.indexOf(e[r]);else for(const e in Vn){const[r,i]=Vn[e];n>=r&&n<=i&&(t+=n-r)}}return parseInt(t,10)}return t}(e))}}const Jn=`[ ${String.fromCharCode(160)}]`,Zn=new RegExp(Jn,"g");function Xn(e){return e.replace(/\./g,"\\.?").replace(Zn,Jn)}function Qn(e){return e.replace(/\./g,"").replace(Zn," ").toLowerCase()}function ei(e,t){return null===e?null:{regex:RegExp(e.map(Xn).join("|")),deser:([r])=>e.findIndex((e=>Qn(r)===Qn(e)))+t}}function ti(e,t){return{regex:e,deser:([,e,t])=>vr(e,t),groups:t}}function ri(e){return{regex:e,deser:([e])=>e}}const ni={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let ii=null;function si(e,t){return Array.prototype.concat(...e.map((e=>function(e,t){if(e.literal)return e;const r=ai(Br.macroTokenToFormatOpts(e.val),t);return null==r||r.includes(void 0)?e:r}(e,t))))}function oi(e,t,r){const n=si(Br.parseFormat(r),e),i=n.map((t=>function(e,t){const r=Wn(t),n=Wn(t,"{2}"),i=Wn(t,"{3}"),s=Wn(t,"{4}"),o=Wn(t,"{6}"),a=Wn(t,"{1,2}"),l=Wn(t,"{1,3}"),u=Wn(t,"{1,6}"),c=Wn(t,"{1,9}"),d=Wn(t,"{2,4}"),h=Wn(t,"{4,6}"),f=e=>{return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([e])=>e,literal:!0};var t},p=(p=>{if(e.literal)return f(p);switch(p.val){case"G":return ei(t.eras("short"),0);case"GG":return ei(t.eras("long"),0);case"y":return Yn(u);case"yy":case"kk":return Yn(d,gr);case"yyyy":case"kkkk":return Yn(s);case"yyyyy":return Yn(h);case"yyyyyy":return Yn(o);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Yn(a);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Yn(n);case"MMM":return ei(t.months("short",!0),1);case"MMMM":return ei(t.months("long",!0),1);case"LLL":return ei(t.months("short",!1),1);case"LLLL":return ei(t.months("long",!1),1);case"o":case"S":return Yn(l);case"ooo":case"SSS":return Yn(i);case"u":return ri(c);case"uu":return ri(a);case"uuu":case"E":case"c":return Yn(r);case"a":return ei(t.meridiems(),0);case"EEE":return ei(t.weekdays("short",!1),1);case"EEEE":return ei(t.weekdays("long",!1),1);case"ccc":return ei(t.weekdays("short",!0),1);case"cccc":return ei(t.weekdays("long",!0),1);case"Z":case"ZZ":return ti(new RegExp(`([+-]${a.source})(?::(${n.source}))?`),2);case"ZZZ":return ti(new RegExp(`([+-]${a.source})(${n.source})?`),2);case"z":return ri(/[a-z_+-/]{1,256}?/i);case" ":return ri(/[^\S\n\r]/);default:return f(p)}})(e)||{invalidReason:Kn};return p.token=e,p}(t,e))),s=i.find((e=>e.invalidReason));if(s)return{input:t,tokens:n,invalidReason:s.invalidReason};{const[e,r]=function(e){const t=e.map((e=>e.regex)).reduce(((e,t)=>`${e}(${t.source})`),"");return[`^${t}$`,e]}(i),s=RegExp(e,"i"),[o,a]=function(e,t,r){const n=e.match(t);if(n){const e={};let t=1;for(const i in r)if(ir(r,i)){const s=r[i],o=s.groups?s.groups+1:1;!s.literal&&s.token&&(e[s.token.val[0]]=s.deser(n.slice(t,t+o))),t+=o}return[n,e]}return[n,{}]}(t,s,r),[l,u,c]=a?function(e){let t,r=null;Qt(e.z)||(r=kt.create(e.z)),Qt(e.Z)||(r||(r=new zt(e.Z)),t=e.Z),Qt(e.q)||(e.M=3*(e.q-1)+1),Qt(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),Qt(e.u)||(e.S=ur(e.u));const n=Object.keys(e).reduce(((t,r)=>{const n=(e=>{switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(r);return n&&(t[n]=e[r]),t}),{});return[n,r,t]}(a):[null,null,void 0];if(ir(a,"a")&&ir(a,"H"))throw new Ke("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:n,regex:s,rawMatches:o,matches:a,result:l,zone:u,specificOffset:c}}}function ai(e,t){if(!e)return null;const r=Br.create(t,e).dtFormatter((ii||(ii=qi.fromMillis(1555555555555)),ii)),n=r.formatToParts(),i=r.resolvedOptions();return n.map((t=>function(e,t,r){const{type:n,value:i}=e;if("literal"===n){const e=/^\s+$/.test(i);return{literal:!e,val:e?" ":i}}const s=t[n];let o=n;"hour"===n&&(o=null!=t.hour12?t.hour12?"hour12":"hour24":null!=t.hourCycle?"h11"===t.hourCycle||"h12"===t.hourCycle?"hour12":"hour24":r.hour12?"hour12":"hour24");let a=ni[o];if("object"==typeof a&&(a=a[s]),a)return{literal:!1,val:a}}(t,e,i)))}const li=[0,31,59,90,120,151,181,212,243,273,304,334],ui=[0,31,60,91,121,152,182,213,244,274,305,335];function ci(e,t){return new Ur("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function di(e,t,r){const n=new Date(Date.UTC(e,t-1,r));e<100&&e>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const i=n.getUTCDay();return 0===i?7:i}function hi(e,t,r){return r+(dr(e)?ui:li)[t-1]}function fi(e,t){const r=dr(e)?ui:li,n=r.findIndex((e=>e<t));return{month:n+1,day:t-r[n]}}function pi(e){const{year:t,month:r,day:n}=e,i=hi(t,r,n),s=di(t,r,n);let o,a=Math.floor((i-s+10)/7);return a<1?(o=t-1,a=mr(o)):a>mr(t)?(o=t+1,a=1):o=t,{weekYear:o,weekNumber:a,weekday:s,...Er(e)}}function mi(e){const{weekYear:t,weekNumber:r,weekday:n}=e,i=di(t,1,4),s=hr(t);let o,a=7*r+n-i-3;a<1?(o=t-1,a+=hr(o)):a>s?(o=t+1,a-=hr(t)):o=t;const{month:l,day:u}=fi(o,a);return{year:o,month:l,day:u,...Er(e)}}function gi(e){const{year:t,month:r,day:n}=e;return{year:t,ordinal:hi(t,r,n),...Er(e)}}function yi(e){const{year:t,ordinal:r}=e,{month:n,day:i}=fi(t,r);return{year:t,month:n,day:i,...Er(e)}}function vi(e){const t=tr(e.year),r=sr(e.month,1,12),n=sr(e.day,1,fr(e.year,e.month));return t?r?!n&&ci("day",e.day):ci("month",e.month):ci("year",e.year)}function bi(e){const{hour:t,minute:r,second:n,millisecond:i}=e,s=sr(t,0,23)||24===t&&0===r&&0===n&&0===i,o=sr(r,0,59),a=sr(n,0,59),l=sr(i,0,999);return s?o?a?!l&&ci("millisecond",i):ci("second",n):ci("minute",r):ci("hour",t)}const xi="Invalid DateTime",wi=864e13;function Ei(e){return new Ur("unsupported zone",`the zone "${e.name}" is not supported`)}function Si(e){return null===e.weekData&&(e.weekData=pi(e.c)),e.weekData}function Ti(e,t){const r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new qi({...r,...t,old:r})}function Ai(e,t,r){let n=e-60*t*1e3;const i=r.offset(n);if(t===i)return[n,t];n-=60*(i-t)*1e3;const s=r.offset(n);return i===s?[n,i]:[e-60*Math.min(i,s)*1e3,Math.max(i,s)]}function Di(e,t){const r=new Date(e+=60*t*1e3);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function Ni(e,t,r){return Ai(pr(e),t,r)}function Ci(e,t){const r=e.o,n=e.c.year+Math.trunc(t.years),i=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),s={...e.c,year:n,month:i,day:Math.min(e.c.day,fr(n,i))+Math.trunc(t.days)+7*Math.trunc(t.weeks)},o=Bn.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=pr(s);let[l,u]=Ai(a,r,e.zone);return 0!==o&&(l+=o,u=e.zone.offset(l)),{ts:l,o:u}}function ki(e,t,r,n,i,s){const{setZone:o,zone:a}=r;if(e&&0!==Object.keys(e).length||t){const n=t||a,i=qi.fromObject(e,{...r,zone:n,specificOffset:s});return o?i:i.setZone(a)}return qi.invalid(new Ur("unparsable",`the input "${i}" can't be parsed as ${n}`))}function Mi(e,t,r=!0){return e.isValid?Br.create($t.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function Oi(e,t){const r=e.c.year>9999||e.c.year<0;let n="";return r&&e.c.year>=0&&(n+="+"),n+=or(e.c.year,r?6:4),t?(n+="-",n+=or(e.c.month),n+="-",n+=or(e.c.day)):(n+=or(e.c.month),n+=or(e.c.day)),n}function _i(e,t,r,n,i,s){let o=or(e.c.hour);return t?(o+=":",o+=or(e.c.minute),0===e.c.millisecond&&0===e.c.second&&r||(o+=":")):o+=or(e.c.minute),0===e.c.millisecond&&0===e.c.second&&r||(o+=or(e.c.second),0===e.c.millisecond&&n||(o+=".",o+=or(e.c.millisecond,3))),i&&(e.isOffsetFixed&&0===e.offset&&!s?o+="Z":e.o<0?(o+="-",o+=or(Math.trunc(-e.o/60)),o+=":",o+=or(Math.trunc(-e.o%60))):(o+="+",o+=or(Math.trunc(e.o/60)),o+=":",o+=or(Math.trunc(e.o%60)))),s&&(o+="["+e.zone.ianaName+"]"),o}const Li={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Ri={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ii={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Fi=["year","month","day","hour","minute","second","millisecond"],Pi=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Bi=["year","ordinal","hour","minute","second","millisecond"];function Ui(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new Ye(e);return t}function $i(e,t){const r=Ht(t.zone,Xt.defaultZone),n=$t.fromObject(t),i=Xt.now();let s,o;if(Qt(e.year))s=i;else{for(const t of Fi)Qt(e[t])&&(e[t]=Li[t]);const t=vi(e)||bi(e);if(t)return qi.invalid(t);const n=r.offset(i);[s,o]=Ni(e,n,r)}return new qi({ts:s,zone:r,loc:n,o})}function ji(e,t,r){const n=!!Qt(r.round)||r.round,i=(e,i)=>{e=cr(e,n||r.calendary?0:2,!0);return t.loc.clone(r).relFormatter(r).format(e,i)},s=n=>r.calendary?t.hasSame(e,n)?0:t.startOf(n).diff(e.startOf(n),n).get(n):t.diff(e,n).get(n);if(r.unit)return i(s(r.unit),r.unit);for(const e of r.units){const t=s(e);if(Math.abs(t)>=1)return i(t,e)}return i(e>t?-0:0,r.units[r.units.length-1])}function zi(e){let t,r={};return e.length>0&&"object"==typeof e[e.length-1]?(r=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[r,t]}class qi{constructor(e){const t=e.zone||Xt.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new Ur("invalid input"):null)||(t.isValid?null:Ei(t));this.ts=Qt(e.ts)?Xt.now():e.ts;let n=null,i=null;if(!r){if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,i]=[e.old.c,e.old.o];else{const e=t.offset(this.ts);n=Di(this.ts,e),r=Number.isNaN(n.year)?new Ur("invalid input"):null,n=r?null:n,i=r?null:e}}this._zone=t,this.loc=e.loc||$t.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}static now(){return new qi({})}static local(){const[e,t]=zi(arguments),[r,n,i,s,o,a,l]=t;return $i({year:r,month:n,day:i,hour:s,minute:o,second:a,millisecond:l},e)}static utc(){const[e,t]=zi(arguments),[r,n,i,s,o,a,l]=t;return e.zone=zt.utcInstance,$i({year:r,month:n,day:i,hour:s,minute:o,second:a,millisecond:l},e)}static fromJSDate(e,t={}){const r=function(e){return"[object Date]"===Object.prototype.toString.call(e)}(e)?e.valueOf():NaN;if(Number.isNaN(r))return qi.invalid("invalid input");const n=Ht(t.zone,Xt.defaultZone);return n.isValid?new qi({ts:r,zone:n,loc:$t.fromObject(t)}):qi.invalid(Ei(n))}static fromMillis(e,t={}){if(er(e))return e<-wi||e>wi?qi.invalid("Timestamp out of range"):new qi({ts:e,zone:Ht(t.zone,Xt.defaultZone),loc:$t.fromObject(t)});throw new Je(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(er(e))return new qi({ts:1e3*e,zone:Ht(t.zone,Xt.defaultZone),loc:$t.fromObject(t)});throw new Je("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const r=Ht(t.zone,Xt.defaultZone);if(!r.isValid)return qi.invalid(Ei(r));const n=Xt.now(),i=Qt(t.specificOffset)?r.offset(n):t.specificOffset,s=xr(e,Ui),o=!Qt(s.ordinal),a=!Qt(s.year),l=!Qt(s.month)||!Qt(s.day),u=a||l,c=s.weekYear||s.weekNumber,d=$t.fromObject(t);if((u||o)&&c)throw new Ke("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new Ke("Can't mix ordinal dates with month/day");const h=c||s.weekday&&!u;let f,p,m=Di(n,i);h?(f=Pi,p=Ri,m=pi(m)):o?(f=Bi,p=Ii,m=gi(m)):(f=Fi,p=Li);let g=!1;for(const e of f){Qt(s[e])?s[e]=g?p[e]:m[e]:g=!0}const y=h?function(e){const t=tr(e.weekYear),r=sr(e.weekNumber,1,mr(e.weekYear)),n=sr(e.weekday,1,7);return t?r?!n&&ci("weekday",e.weekday):ci("week",e.week):ci("weekYear",e.weekYear)}(s):o?function(e){const t=tr(e.year),r=sr(e.ordinal,1,hr(e.year));return t?!r&&ci("ordinal",e.ordinal):ci("year",e.year)}(s):vi(s),v=y||bi(s);if(v)return qi.invalid(v);const b=h?mi(s):o?yi(s):s,[x,w]=Ni(b,i,r),E=new qi({ts:x,zone:r,o:w,loc:d});return s.weekday&&u&&e.weekday!==E.weekday?qi.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${E.toISO()}`):E}static fromISO(e,t={}){const[r,n]=function(e){return qr(e,[gn,xn],[yn,wn],[vn,En],[bn,Sn])}(e);return ki(r,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[r,n]=function(e){return qr(function(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[un,cn])}(e);return ki(r,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[r,n]=function(e){return qr(e,[dn,pn],[hn,pn],[fn,mn])}(e);return ki(r,n,t,"HTTP",t)}static fromFormat(e,t,r={}){if(Qt(e)||Qt(t))throw new Je("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:i=null}=r,s=$t.fromOpts({locale:n,numberingSystem:i,defaultToEN:!0}),[o,a,l,u]=function(e,t,r){const{result:n,zone:i,specificOffset:s,invalidReason:o}=oi(e,t,r);return[n,i,s,o]}(s,e,t);return u?qi.invalid(u):ki(o,a,r,`format ${t}`,e,l)}static fromString(e,t,r={}){return qi.fromFormat(e,t,r)}static fromSQL(e,t={}){const[r,n]=function(e){return qr(e,[An,xn],[Dn,Nn])}(e);return ki(r,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new Je("need to specify a reason the DateTime is invalid");const r=e instanceof Ur?e:new Ur(e,t);if(Xt.throwOnInvalid)throw new Ve(r);return new qi({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const r=ai(e,$t.fromObject(t));return r?r.map((e=>e?e.val:null)).join(""):null}static expandFormat(e,t={}){return si(Br.parseFormat(e),$t.fromObject(t)).map((e=>e.val)).join("")}get(e){return this[e]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Si(this).weekYear:NaN}get weekNumber(){return this.isValid?Si(this).weekNumber:NaN}get weekday(){return this.isValid?Si(this).weekday:NaN}get ordinal(){return this.isValid?gi(this.c).ordinal:NaN}get monthShort(){return this.isValid?jn.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?jn.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?jn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?jn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,r=pr(this.c),n=this.zone.offset(r-e),i=this.zone.offset(r+e),s=this.zone.offset(r-n*t),o=this.zone.offset(r-i*t);if(s===o)return[this];const a=r-s*t,l=r-o*t,u=Di(a,s),c=Di(l,o);return u.hour===c.hour&&u.minute===c.minute&&u.second===c.second&&u.millisecond===c.millisecond?[Ti(this,{ts:a}),Ti(this,{ts:l})]:[this]}get isInLeapYear(){return dr(this.year)}get daysInMonth(){return fr(this.year,this.month)}get daysInYear(){return this.isValid?hr(this.year):NaN}get weeksInWeekYear(){return this.isValid?mr(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:r,calendar:n}=Br.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:r,outputCalendar:n}}toUTC(e=0,t={}){return this.setZone(zt.instance(e),t)}toLocal(){return this.setZone(Xt.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:r=!1}={}){if((e=Ht(e,Xt.defaultZone)).equals(this.zone))return this;if(e.isValid){let n=this.ts;if(t||r){const t=e.offset(this.ts),r=this.toObject();[n]=Ni(r,t,e)}return Ti(this,{ts:n,zone:e})}return qi.invalid(Ei(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:r}={}){return Ti(this,{loc:this.loc.clone({locale:e,numberingSystem:t,outputCalendar:r})})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=xr(e,Ui),r=!Qt(t.weekYear)||!Qt(t.weekNumber)||!Qt(t.weekday),n=!Qt(t.ordinal),i=!Qt(t.year),s=!Qt(t.month)||!Qt(t.day),o=i||s,a=t.weekYear||t.weekNumber;if((o||n)&&a)throw new Ke("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(s&&n)throw new Ke("Can't mix ordinal dates with month/day");let l;r?l=mi({...pi(this.c),...t}):Qt(t.ordinal)?(l={...this.toObject(),...t},Qt(t.day)&&(l.day=Math.min(fr(l.year,l.month),l.day))):l=yi({...gi(this.c),...t});const[u,c]=Ni(l,this.o,this.zone);return Ti(this,{ts:u,o:c})}plus(e){if(!this.isValid)return this;return Ti(this,Ci(this,Bn.fromDurationLike(e)))}minus(e){if(!this.isValid)return this;return Ti(this,Ci(this,Bn.fromDurationLike(e).negate()))}startOf(e){if(!this.isValid)return this;const t={},r=Bn.normalizeUnit(e);switch(r){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===r&&(t.weekday=1),"quarters"===r){const e=Math.ceil(this.month/3);t.month=3*(e-1)+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?Br.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):xi}toLocaleString(e=tt,t={}){return this.isValid?Br.create(this.loc.clone(t),e).formatDateTime(this):xi}toLocaleParts(e={}){return this.isValid?Br.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:i=!1}={}){if(!this.isValid)return null;const s="extended"===e;let o=Oi(this,s);return o+="T",o+=_i(this,s,t,r,n,i),o}toISODate({format:e="extended"}={}){return this.isValid?Oi(this,"extended"===e):null}toISOWeekDate(){return Mi(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:i=!1,format:s="extended"}={}){if(!this.isValid)return null;return(n?"T":"")+_i(this,"extended"===s,t,e,r,i)}toRFC2822(){return Mi(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Mi(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Oi(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(r&&(n+=" "),t?n+="z":e&&(n+="ZZ")),Mi(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():xi}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",r={}){if(!this.isValid||!e.isValid)return Bn.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...r},i=(a=t,Array.isArray(a)?a:[a]).map(Bn.normalizeUnit),s=e.valueOf()>this.valueOf(),o=qn(s?this:e,s?e:this,i,n);var a;return s?o.negate():o}diffNow(e="milliseconds",t={}){return this.diff(qi.now(),e,t)}until(e){return this.isValid?$n.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const r=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(t)<=r&&r<=n.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||qi.fromObject({},{zone:this.zone}),r=e.padding?this<t?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],i=e.unit;return Array.isArray(e.unit)&&(n=e.unit,i=void 0),ji(t,this.plus(r),{...e,numeric:"always",units:n,unit:i})}toRelativeCalendar(e={}){return this.isValid?ji(e.base||qi.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(qi.isDateTime))throw new Je("min requires all arguments be DateTimes");return nr(e,(e=>e.valueOf()),Math.min)}static max(...e){if(!e.every(qi.isDateTime))throw new Je("max requires all arguments be DateTimes");return nr(e,(e=>e.valueOf()),Math.max)}static fromFormatExplain(e,t,r={}){const{locale:n=null,numberingSystem:i=null}=r;return oi($t.fromOpts({locale:n,numberingSystem:i,defaultToEN:!0}),e,t)}static fromStringExplain(e,t,r={}){return qi.fromFormatExplain(e,t,r)}static get DATE_SHORT(){return tt}static get DATE_MED(){return rt}static get DATE_MED_WITH_WEEKDAY(){return nt}static get DATE_FULL(){return it}static get DATE_HUGE(){return st}static get TIME_SIMPLE(){return ot}static get TIME_WITH_SECONDS(){return at}static get TIME_WITH_SHORT_OFFSET(){return lt}static get TIME_WITH_LONG_OFFSET(){return ut}static get TIME_24_SIMPLE(){return ct}static get TIME_24_WITH_SECONDS(){return dt}static get TIME_24_WITH_SHORT_OFFSET(){return ht}static get TIME_24_WITH_LONG_OFFSET(){return ft}static get DATETIME_SHORT(){return pt}static get DATETIME_SHORT_WITH_SECONDS(){return mt}static get DATETIME_MED(){return gt}static get DATETIME_MED_WITH_SECONDS(){return yt}static get DATETIME_MED_WITH_WEEKDAY(){return vt}static get DATETIME_FULL(){return bt}static get DATETIME_FULL_WITH_SECONDS(){return xt}static get DATETIME_HUGE(){return wt}static get DATETIME_HUGE_WITH_SECONDS(){return Et}}function Hi(e){if(qi.isDateTime(e))return e;if(e&&e.valueOf&&er(e.valueOf()))return qi.fromJSDate(e);if(e&&"object"==typeof e)return qi.fromObject(e);throw new Je(`Unknown datetime argument: ${e}, of type ${typeof e}`)}function Vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Gi,Wi,Ki,Yi,Ji=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=Vi({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in i)i[o]&&(s+="; "+o,!0!==i[o]&&(s+="="+i[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+s}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",Vi({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Vi({},this.attributes,t))},withConverter:function(t){return e(Vi({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),Zi=(r(88939),!1),Xi=!1,Qi=[],es=-1;function ts(e){!function(e){Qi.includes(e)||Qi.push(e);Xi||Zi||(Zi=!0,queueMicrotask(ns))}(e)}function rs(e){let t=Qi.indexOf(e);-1!==t&&t>es&&Qi.splice(t,1)}function ns(){Zi=!1,Xi=!0;for(let e=0;e<Qi.length;e++)Qi[e](),es=e;Qi.length=0,es=-1,Xi=!1}var is=!0;function ss(e){Wi=e}var os=[],as=[],ls=[];function us(e,t){"function"==typeof t?(e._x_cleanups||(e._x_cleanups=[]),e._x_cleanups.push(t)):(t=e,as.push(t))}function cs(e,t){e._x_attributeCleanups&&Object.entries(e._x_attributeCleanups).forEach((([r,n])=>{(void 0===t||t.includes(r))&&(n.forEach((e=>e())),delete e._x_attributeCleanups[r])}))}var ds=new MutationObserver(xs),hs=!1;function fs(){ds.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),hs=!0}function ps(){(ms=ms.concat(ds.takeRecords())).length&&!gs&&(gs=!0,queueMicrotask((()=>{xs(ms),ms.length=0,gs=!1}))),ds.disconnect(),hs=!1}var ms=[],gs=!1;function ys(e){if(!hs)return e();ps();let t=e();return fs(),t}var vs=!1,bs=[];function xs(e){if(vs)return void(bs=bs.concat(e));let t=[],r=[],n=new Map,i=new Map;for(let s=0;s<e.length;s++)if(!e[s].target._x_ignoreMutationObserver&&("childList"===e[s].type&&(e[s].addedNodes.forEach((e=>1===e.nodeType&&t.push(e))),e[s].removedNodes.forEach((e=>1===e.nodeType&&r.push(e)))),"attributes"===e[s].type)){let t=e[s].target,r=e[s].attributeName,o=e[s].oldValue,a=()=>{n.has(t)||n.set(t,[]),n.get(t).push({name:r,value:t.getAttribute(r)})},l=()=>{i.has(t)||i.set(t,[]),i.get(t).push(r)};t.hasAttribute(r)&&null===o?a():t.hasAttribute(r)?(l(),a()):l()}i.forEach(((e,t)=>{cs(t,e)})),n.forEach(((e,t)=>{os.forEach((r=>r(t,e)))}));for(let e of r)if(!t.includes(e)&&(as.forEach((t=>t(e))),e._x_cleanups))for(;e._x_cleanups.length;)e._x_cleanups.pop()();t.forEach((e=>{e._x_ignoreSelf=!0,e._x_ignore=!0}));for(let e of t)r.includes(e)||e.isConnected&&(delete e._x_ignoreSelf,delete e._x_ignore,ls.forEach((t=>t(e))),e._x_ignore=!0,e._x_ignoreSelf=!0);t.forEach((e=>{delete e._x_ignoreSelf,delete e._x_ignore})),t=null,r=null,n=null,i=null}function ws(e){return Ts(Ss(e))}function Es(e,t,r){return e._x_dataStack=[t,...Ss(r||e)],()=>{e._x_dataStack=e._x_dataStack.filter((e=>e!==t))}}function Ss(e){return e._x_dataStack?e._x_dataStack:"function"==typeof ShadowRoot&&e instanceof ShadowRoot?Ss(e.host):e.parentNode?Ss(e.parentNode):[]}function Ts(e){let t=new Proxy({},{ownKeys:()=>Array.from(new Set(e.flatMap((e=>Object.keys(e))))),has:(t,r)=>e.some((e=>e.hasOwnProperty(r))),get:(r,n)=>(e.find((e=>{if(e.hasOwnProperty(n)){let r=Object.getOwnPropertyDescriptor(e,n);if(r.get&&r.get._x_alreadyBound||r.set&&r.set._x_alreadyBound)return!0;if((r.get||r.set)&&r.enumerable){let i=r.get,s=r.set,o=r;i=i&&i.bind(t),s=s&&s.bind(t),i&&(i._x_alreadyBound=!0),s&&(s._x_alreadyBound=!0),Object.defineProperty(e,n,{...o,get:i,set:s})}return!0}return!1}))||{})[n],set:(t,r,n)=>{let i=e.find((e=>e.hasOwnProperty(r)));return i?i[r]=n:e[e.length-1][r]=n,!0}});return t}function As(e){let t=(r,n="")=>{Object.entries(Object.getOwnPropertyDescriptors(r)).forEach((([i,{value:s,enumerable:o}])=>{if(!1===o||void 0===s)return;let a=""===n?i:`${n}.${i}`;var l;"object"==typeof s&&null!==s&&s._x_interceptor?r[i]=s.initialize(e,a,i):"object"!=typeof(l=s)||Array.isArray(l)||null===l||s===r||s instanceof Element||t(s,a)}))};return t(e)}function Ds(e,t=(()=>{})){let r={initialValue:void 0,_x_interceptor:!0,initialize(t,r,n){return e(this.initialValue,(()=>function(e,t){return t.split(".").reduce(((e,t)=>e[t]),e)}(t,r)),(e=>Ns(t,r,e)),r,n)}};return t(r),e=>{if("object"==typeof e&&null!==e&&e._x_interceptor){let t=r.initialize.bind(r);r.initialize=(n,i,s)=>{let o=e.initialize(n,i,s);return r.initialValue=o,t(n,i,s)}}else r.initialValue=e;return r}}function Ns(e,t,r){if("string"==typeof t&&(t=t.split(".")),1!==t.length){if(0===t.length)throw error;return e[t[0]]||(e[t[0]]={}),Ns(e[t[0]],t.slice(1),r)}e[t[0]]=r}var Cs={};function ks(e,t){Cs[e]=t}function Ms(e,t){return Object.entries(Cs).forEach((([r,n])=>{let i=null;Object.defineProperty(e,`$${r}`,{get:()=>n(t,function(){if(i)return i;{let[e,r]=Js(t);return i={interceptor:Ds,...e},us(t,r),i}}()),enumerable:!1})})),e}function Os(e,t,r,...n){try{return r(...n)}catch(r){_s(r,e,t)}}function _s(e,t,r=void 0){Object.assign(e,{el:t,expression:r}),console.warn(`Alpine Expression Error: ${e.message}\n\n${r?'Expression: "'+r+'"\n\n':""}`,t),setTimeout((()=>{throw e}),0)}var Ls=!0;function Rs(e){let t=Ls;Ls=!1;let r=e();return Ls=t,r}function Is(e,t,r={}){let n;return Fs(e,t)((e=>n=e),r),n}function Fs(...e){return Ps(...e)}var Ps=Bs;function Bs(e,t){let r={};Ms(r,e);let n=[r,...Ss(e)],i="function"==typeof t?function(e,t){return(r=(()=>{}),{scope:n={},params:i=[]}={})=>{$s(r,t.apply(Ts([n,...e]),i))}}(n,t):function(e,t,r){let n=function(e,t){if(Us[e])return Us[e];let r=Object.getPrototypeOf((async function(){})).constructor,n=/^[\n\s]*if.*\(.*\)/.test(e)||/^(let|const)\s/.test(e)?`(async()=>{ ${e} })()`:e;const i=()=>{try{return new r(["__self","scope"],`with (scope) { __self.result = ${n} }; __self.finished = true; return __self.result;`)}catch(r){return _s(r,t,e),Promise.resolve()}};let s=i();return Us[e]=s,s}(t,r);return(i=(()=>{}),{scope:s={},params:o=[]}={})=>{n.result=void 0,n.finished=!1;let a=Ts([s,...e]);if("function"==typeof n){let e=n(n,a).catch((e=>_s(e,r,t)));n.finished?($s(i,n.result,a,o,r),n.result=void 0):e.then((e=>{$s(i,e,a,o,r)})).catch((e=>_s(e,r,t))).finally((()=>n.result=void 0))}}}(n,t,e);return Os.bind(null,e,t,i)}var Us={};function $s(e,t,r,n,i){if(Ls&&"function"==typeof t){let s=t.apply(r,n);s instanceof Promise?s.then((t=>$s(e,t,r,n))).catch((e=>_s(e,i,t))):e(s)}else"object"==typeof t&&t instanceof Promise?t.then((t=>e(t))):e(t)}var js="x-";function zs(e=""){return js+e}var qs={};function Hs(e,t){return qs[e]=t,{before(t){if(!qs[t])return void console.warn("Cannot find directive `${directive}`. `${name}` will use the default order of execution");const r=io.indexOf(t);io.splice(r>=0?r:io.indexOf("DEFAULT"),0,e)}}}function Vs(e,t,r){if(t=Array.from(t),e._x_virtualDirectives){let r=Object.entries(e._x_virtualDirectives).map((([e,t])=>({name:e,value:t}))),n=Gs(r);r=r.map((e=>n.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),t=t.concat(r)}let n={},i=t.map(Xs(((e,t)=>n[e]=t))).filter(to).map(function(e,t){return({name:r,value:n})=>{let i=r.match(ro()),s=r.match(/:([a-zA-Z0-9\-:]+)/),o=r.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=t||e[r]||r;return{type:i?i[1]:null,value:s?s[1]:null,modifiers:o.map((e=>e.replace(".",""))),expression:n,original:a}}}(n,r)).sort(so);return i.map((t=>function(e,t){let r=()=>{},n=qs[t.type]||r,[i,s]=Js(e);!function(e,t,r){e._x_attributeCleanups||(e._x_attributeCleanups={}),e._x_attributeCleanups[t]||(e._x_attributeCleanups[t]=[]),e._x_attributeCleanups[t].push(r)}(e,t.original,s);let o=()=>{e._x_ignore||e._x_ignoreSelf||(n.inline&&n.inline(e,t,i),n=n.bind(n,e,t,i),Ws?Ks.get(Ys).push(n):n())};return o.runCleanups=s,o}(e,t)))}function Gs(e){return Array.from(e).map(Xs()).filter((e=>!to(e)))}var Ws=!1,Ks=new Map,Ys=Symbol();function Js(e){let t=[],[r,n]=function(e){let t=()=>{};return[r=>{let n=Wi(r);return e._x_effects||(e._x_effects=new Set,e._x_runEffects=()=>{e._x_effects.forEach((e=>e()))}),e._x_effects.add(n),t=()=>{void 0!==n&&(e._x_effects.delete(n),Ki(n))},n},()=>{t()}]}(e);t.push(n);return[{Alpine:Yo,effect:r,cleanup:e=>t.push(e),evaluateLater:Fs.bind(Fs,e),evaluate:Is.bind(Is,e)},()=>t.forEach((e=>e()))]}var Zs=(e,t)=>({name:r,value:n})=>(r.startsWith(e)&&(r=r.replace(e,t)),{name:r,value:n});function Xs(e=(()=>{})){return({name:t,value:r})=>{let{name:n,value:i}=Qs.reduce(((e,t)=>t(e)),{name:t,value:r});return n!==t&&e(n,t),{name:n,value:i}}}var Qs=[];function eo(e){Qs.push(e)}function to({name:e}){return ro().test(e)}var ro=()=>new RegExp(`^${js}([^:^.]+)\\b`);var no="DEFAULT",io=["ignore","ref","data","id","bind","init","for","model","modelable","transition","show","if",no,"teleport"];function so(e,t){let r=-1===io.indexOf(e.type)?no:e.type,n=-1===io.indexOf(t.type)?no:t.type;return io.indexOf(r)-io.indexOf(n)}function oo(e,t,r={}){e.dispatchEvent(new CustomEvent(t,{detail:r,bubbles:!0,composed:!0,cancelable:!0}))}function ao(e,t){if("function"==typeof ShadowRoot&&e instanceof ShadowRoot)return void Array.from(e.children).forEach((e=>ao(e,t)));let r=!1;if(t(e,(()=>r=!0)),r)return;let n=e.firstElementChild;for(;n;)ao(n,t),n=n.nextElementSibling}function lo(e,...t){console.warn(`Alpine Warning: ${e}`,...t)}var uo=!1;var co=[],ho=[];function fo(){return co.map((e=>e()))}function po(){return co.concat(ho).map((e=>e()))}function mo(e){co.push(e)}function go(e){ho.push(e)}function yo(e,t=!1){return vo(e,(e=>{if((t?po():fo()).some((t=>e.matches(t))))return!0}))}function vo(e,t){if(e){if(t(e))return e;if(e._x_teleportBack&&(e=e._x_teleportBack),e.parentElement)return vo(e.parentElement,t)}}var bo=[];function xo(e,t=ao,r=(()=>{})){!function(e){Ws=!0;let t=Symbol();Ys=t,Ks.set(t,[]);let r=()=>{for(;Ks.get(t).length;)Ks.get(t).shift()();Ks.delete(t)};e(r),Ws=!1,r()}((()=>{t(e,((e,t)=>{r(e,t),bo.forEach((r=>r(e,t))),Vs(e,e.attributes).forEach((e=>e())),e._x_ignore&&t()}))}))}function wo(e){ao(e,(e=>cs(e)))}var Eo=[],So=!1;function To(e=(()=>{})){return queueMicrotask((()=>{So||setTimeout((()=>{Ao()}))})),new Promise((t=>{Eo.push((()=>{e(),t()}))}))}function Ao(){for(So=!1;Eo.length;)Eo.shift()()}function Do(e,t){return Array.isArray(t)?No(e,t.join(" ")):"object"==typeof t&&null!==t?function(e,t){let r=e=>e.split(" ").filter(Boolean),n=Object.entries(t).flatMap((([e,t])=>!!t&&r(e))).filter(Boolean),i=Object.entries(t).flatMap((([e,t])=>!t&&r(e))).filter(Boolean),s=[],o=[];return i.forEach((t=>{e.classList.contains(t)&&(e.classList.remove(t),o.push(t))})),n.forEach((t=>{e.classList.contains(t)||(e.classList.add(t),s.push(t))})),()=>{o.forEach((t=>e.classList.add(t))),s.forEach((t=>e.classList.remove(t)))}}(e,t):"function"==typeof t?Do(e,t()):No(e,t)}function No(e,t){return t=!0===t?t="":t||"",(t=>(e.classList.add(...t),()=>{e.classList.remove(...t)}))(t.split(" ").filter((t=>!e.classList.contains(t))).filter(Boolean))}function Co(e,t){return"object"==typeof t&&null!==t?function(e,t){let r={};return Object.entries(t).forEach((([t,n])=>{r[t]=e.style[t],t.startsWith("--")||(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),e.style.setProperty(t,n)})),setTimeout((()=>{0===e.style.length&&e.removeAttribute("style")})),()=>{Co(e,r)}}(e,t):function(e,t){let r=e.getAttribute("style",t);return e.setAttribute("style",t),()=>{e.setAttribute("style",r||"")}}(e,t)}function ko(e,t=(()=>{})){let r=!1;return function(){r?t.apply(this,arguments):(r=!0,e.apply(this,arguments))}}function Mo(e,t,r={}){e._x_transition||(e._x_transition={enter:{during:r,start:r,end:r},leave:{during:r,start:r,end:r},in(r=(()=>{}),n=(()=>{})){_o(e,t,{during:this.enter.during,start:this.enter.start,end:this.enter.end},r,n)},out(r=(()=>{}),n=(()=>{})){_o(e,t,{during:this.leave.during,start:this.leave.start,end:this.leave.end},r,n)}})}function Oo(e){let t=e.parentNode;if(t)return t._x_hidePromise?t:Oo(t)}function _o(e,t,{during:r,start:n,end:i}={},s=(()=>{}),o=(()=>{})){if(e._x_transitioning&&e._x_transitioning.cancel(),0===Object.keys(r).length&&0===Object.keys(n).length&&0===Object.keys(i).length)return s(),void o();let a,l,u;!function(e,t){let r,n,i,s=ko((()=>{ys((()=>{r=!0,n||t.before(),i||(t.end(),Ao()),t.after(),e.isConnected&&t.cleanup(),delete e._x_transitioning}))}));e._x_transitioning={beforeCancels:[],beforeCancel(e){this.beforeCancels.push(e)},cancel:ko((function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();s()})),finish:s},ys((()=>{t.start(),t.during()})),So=!0,requestAnimationFrame((()=>{if(r)return;let s=1e3*Number(getComputedStyle(e).transitionDuration.replace(/,.*/,"").replace("s","")),o=1e3*Number(getComputedStyle(e).transitionDelay.replace(/,.*/,"").replace("s",""));0===s&&(s=1e3*Number(getComputedStyle(e).animationDuration.replace("s",""))),ys((()=>{t.before()})),n=!0,requestAnimationFrame((()=>{r||(ys((()=>{t.end()})),Ao(),setTimeout(e._x_transitioning.finish,s+o),i=!0)}))}))}(e,{start(){a=t(e,n)},during(){l=t(e,r)},before:s,end(){a(),u=t(e,i)},after:o,cleanup(){l(),u()}})}function Lo(e,t,r){if(-1===e.indexOf(t))return r;const n=e[e.indexOf(t)+1];if(!n)return r;if("scale"===t&&isNaN(n))return r;if("duration"===t||"delay"===t){let e=n.match(/([0-9]+)ms/);if(e)return e[1]}return"origin"===t&&["top","right","left","center","bottom"].includes(e[e.indexOf(t)+2])?[n,e[e.indexOf(t)+2]].join(" "):n}Hs("transition",((e,{value:t,modifiers:r,expression:n},{evaluate:i})=>{"function"==typeof n&&(n=i(n)),!1!==n&&(n&&"boolean"!=typeof n?function(e,t,r){Mo(e,Do,"");let n={enter:t=>{e._x_transition.enter.during=t},"enter-start":t=>{e._x_transition.enter.start=t},"enter-end":t=>{e._x_transition.enter.end=t},leave:t=>{e._x_transition.leave.during=t},"leave-start":t=>{e._x_transition.leave.start=t},"leave-end":t=>{e._x_transition.leave.end=t}};n[r](t)}(e,n,t):function(e,t,r){Mo(e,Co);let n=!t.includes("in")&&!t.includes("out")&&!r,i=n||t.includes("in")||["enter"].includes(r),s=n||t.includes("out")||["leave"].includes(r);t.includes("in")&&!n&&(t=t.filter(((e,r)=>r<t.indexOf("out"))));t.includes("out")&&!n&&(t=t.filter(((e,r)=>r>t.indexOf("out"))));let o=!t.includes("opacity")&&!t.includes("scale"),a=o||t.includes("opacity"),l=o||t.includes("scale"),u=a?0:1,c=l?Lo(t,"scale",95)/100:1,d=Lo(t,"delay",0)/1e3,h=Lo(t,"origin","center"),f="opacity, transform",p=Lo(t,"duration",150)/1e3,m=Lo(t,"duration",75)/1e3,g="cubic-bezier(0.4, 0.0, 0.2, 1)";i&&(e._x_transition.enter.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:f,transitionDuration:`${p}s`,transitionTimingFunction:g},e._x_transition.enter.start={opacity:u,transform:`scale(${c})`},e._x_transition.enter.end={opacity:1,transform:"scale(1)"});s&&(e._x_transition.leave.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:f,transitionDuration:`${m}s`,transitionTimingFunction:g},e._x_transition.leave.start={opacity:1,transform:"scale(1)"},e._x_transition.leave.end={opacity:u,transform:`scale(${c})`})}(e,r,t))})),window.Element.prototype._x_toggleAndCascadeWithTransitions=function(e,t,r,n){const i="visible"===document.visibilityState?requestAnimationFrame:setTimeout;let s=()=>i(r);t?e._x_transition&&(e._x_transition.enter||e._x_transition.leave)?e._x_transition.enter&&(Object.entries(e._x_transition.enter.during).length||Object.entries(e._x_transition.enter.start).length||Object.entries(e._x_transition.enter.end).length)?e._x_transition.in(r):s():e._x_transition?e._x_transition.in(r):s():(e._x_hidePromise=e._x_transition?new Promise(((t,r)=>{e._x_transition.out((()=>{}),(()=>t(n))),e._x_transitioning.beforeCancel((()=>r({isFromCancelledTransition:!0})))})):Promise.resolve(n),queueMicrotask((()=>{let t=Oo(e);t?(t._x_hideChildren||(t._x_hideChildren=[]),t._x_hideChildren.push(e)):i((()=>{let t=e=>{let r=Promise.all([e._x_hidePromise,...(e._x_hideChildren||[]).map(t)]).then((([e])=>e()));return delete e._x_hidePromise,delete e._x_hideChildren,r};t(e).catch((e=>{if(!e.isFromCancelledTransition)throw e}))}))})))};var Ro=!1;function Io(e,t=(()=>{})){return(...r)=>Ro?t(...r):e(...r)}function Fo(e,t,r,n=[]){switch(e._x_bindings||(e._x_bindings=Gi({})),e._x_bindings[t]=r,t=n.includes("camel")?t.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase())):t){case"value":!function(e,t){if("radio"===e.type)void 0===e.attributes.value&&(e.value=t),window.fromModel&&(e.checked=Bo(e.value,t));else if("checkbox"===e.type)Number.isInteger(t)?e.value=t:Number.isInteger(t)||Array.isArray(t)||"boolean"==typeof t||[null,void 0].includes(t)?Array.isArray(t)?e.checked=t.some((t=>Bo(t,e.value))):e.checked=!!t:e.value=String(t);else if("SELECT"===e.tagName)!function(e,t){const r=[].concat(t).map((e=>e+""));Array.from(e.options).forEach((e=>{e.selected=r.includes(e.value)}))}(e,t);else{if(e.value===t)return;e.value=t}}(e,r);break;case"style":!function(e,t){e._x_undoAddedStyles&&e._x_undoAddedStyles();e._x_undoAddedStyles=Co(e,t)}(e,r);break;case"class":!function(e,t){e._x_undoAddedClasses&&e._x_undoAddedClasses();e._x_undoAddedClasses=Do(e,t)}(e,r);break;case"selected":case"checked":!function(e,t,r){Po(e,t,r),function(e,t,r){e[t]!==r&&(e[t]=r)}(e,t,r)}(e,t,r);break;default:Po(e,t,r)}}function Po(e,t,r){[null,void 0,!1].includes(r)&&function(e){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(e)}(t)?e.removeAttribute(t):(Uo(t)&&(r=t),function(e,t,r){e.getAttribute(t)!=r&&e.setAttribute(t,r)}(e,t,r))}function Bo(e,t){return e==t}function Uo(e){return["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(e)}function $o(e,t,r){let n=e.getAttribute(t);return null===n?"function"==typeof r?r():r:""===n||(Uo(t)?!![t,"true"].includes(n):n)}function jo(e,t){var r;return function(){var n=this,i=arguments;clearTimeout(r),r=setTimeout((function(){r=null,e.apply(n,i)}),t)}}function zo(e,t){let r;return function(){let n=this,i=arguments;r||(e.apply(n,i),r=!0,setTimeout((()=>r=!1),t))}}var qo={},Ho=!1;var Vo={};function Go(e,t,r){let n=[];for(;n.length;)n.pop()();let i=Object.entries(t).map((([e,t])=>({name:e,value:t}))),s=Gs(i);i=i.map((e=>s.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),Vs(e,i,r).map((e=>{n.push(e.runCleanups),e()}))}var Wo={};var Ko={get reactive(){return Gi},get release(){return Ki},get effect(){return Wi},get raw(){return Yi},version:"3.12.3",flushAndStopDeferringMutations:function(){vs=!1,xs(bs),bs=[]},dontAutoEvaluateFunctions:Rs,disableEffectScheduling:function(e){is=!1,e(),is=!0},startObservingMutations:fs,stopObservingMutations:ps,setReactivityEngine:function(e){Gi=e.reactive,Ki=e.release,Wi=t=>e.effect(t,{scheduler:e=>{is?ts(e):e()}}),Yi=e.raw},closestDataStack:Ss,skipDuringClone:Io,onlyDuringClone:function(e){return(...t)=>Ro&&e(...t)},addRootSelector:mo,addInitSelector:go,addScopeToNode:Es,deferMutations:function(){vs=!0},mapAttributes:eo,evaluateLater:Fs,interceptInit:function(e){bo.push(e)},setEvaluator:function(e){Ps=e},mergeProxies:Ts,extractProp:function(e,t,r,n=!0){if(e._x_bindings&&void 0!==e._x_bindings[t])return e._x_bindings[t];if(e._x_inlineBindings&&void 0!==e._x_inlineBindings[t]){let r=e._x_inlineBindings[t];return r.extract=n,Rs((()=>Is(e,r.expression)))}return $o(e,t,r)},findClosest:vo,closestRoot:yo,destroyTree:wo,interceptor:Ds,transition:_o,setStyles:Co,mutateDom:ys,directive:Hs,throttle:zo,debounce:jo,evaluate:Is,initTree:xo,nextTick:To,prefixed:zs,prefix:function(e){js=e},plugin:function(e){(Array.isArray(e)?e:[e]).forEach((e=>e(Yo)))},magic:ks,store:function(e,t){if(Ho||(qo=Gi(qo),Ho=!0),void 0===t)return qo[e];qo[e]=t,"object"==typeof t&&null!==t&&t.hasOwnProperty("init")&&"function"==typeof t.init&&qo[e].init(),As(qo[e])},start:function(){var e;uo&&lo("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),uo=!0,document.body||lo("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),oo(document,"alpine:init"),oo(document,"alpine:initializing"),fs(),e=e=>xo(e,ao),ls.push(e),us((e=>wo(e))),function(e){os.push(e)}(((e,t)=>{Vs(e,t).forEach((e=>e()))})),Array.from(document.querySelectorAll(po())).filter((e=>!yo(e.parentElement,!0))).forEach((e=>{xo(e)})),oo(document,"alpine:initialized")},clone:function(e,t){t._x_dataStack||(t._x_dataStack=e._x_dataStack),Ro=!0,function(e){let t=Wi;ss(((e,r)=>{let n=t(e);return Ki(n),()=>{}})),e(),ss(t)}((()=>{!function(e){let t=!1;xo(e,((e,r)=>{ao(e,((e,n)=>{if(t&&function(e){return fo().some((t=>e.matches(t)))}(e))return n();t=!0,r(e,n)}))}))}(t)})),Ro=!1},bound:function(e,t,r){return e._x_bindings&&void 0!==e._x_bindings[t]?e._x_bindings[t]:$o(e,t,r)},$data:ws,walk:ao,data:function(e,t){Wo[e]=t},bind:function(e,t){let r="function"!=typeof t?()=>t:t;e instanceof Element?Go(e,r()):Vo[e]=r}},Yo=Ko;function Jo(e,t){const r=Object.create(null),n=e.split(",");for(let e=0;e<n.length;e++)r[n[e]]=!0;return t?e=>!!r[e.toLowerCase()]:e=>!!r[e]}var Zo,Xo=Object.freeze({}),Qo=(Object.freeze([]),Object.assign),ea=Object.prototype.hasOwnProperty,ta=(e,t)=>ea.call(e,t),ra=Array.isArray,na=e=>"[object Map]"===aa(e),ia=e=>"symbol"==typeof e,sa=e=>null!==e&&"object"==typeof e,oa=Object.prototype.toString,aa=e=>oa.call(e),la=e=>aa(e).slice(8,-1),ua=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,ca=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},da=/-(\w)/g,ha=(ca((e=>e.replace(da,((e,t)=>t?t.toUpperCase():"")))),/\B([A-Z])/g),fa=(ca((e=>e.replace(ha,"-$1").toLowerCase())),ca((e=>e.charAt(0).toUpperCase()+e.slice(1)))),pa=(ca((e=>e?`on${fa(e)}`:"")),(e,t)=>e!==t&&(e==e||t==t)),ma=new WeakMap,ga=[],ya=Symbol("iterate"),va=Symbol("Map key iterate");var ba=0;function xa(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}var wa=!0,Ea=[];function Sa(){const e=Ea.pop();wa=void 0===e||e}function Ta(e,t,r){if(!wa||void 0===Zo)return;let n=ma.get(e);n||ma.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=new Set),i.has(Zo)||(i.add(Zo),Zo.deps.push(i),Zo.options.onTrack&&Zo.options.onTrack({effect:Zo,target:e,type:t,key:r}))}function Aa(e,t,r,n,i,s){const o=ma.get(e);if(!o)return;const a=new Set,l=e=>{e&&e.forEach((e=>{(e!==Zo||e.allowRecurse)&&a.add(e)}))};if("clear"===t)o.forEach(l);else if("length"===r&&ra(e))o.forEach(((e,t)=>{("length"===t||t>=n)&&l(e)}));else switch(void 0!==r&&l(o.get(r)),t){case"add":ra(e)?ua(r)&&l(o.get("length")):(l(o.get(ya)),na(e)&&l(o.get(va)));break;case"delete":ra(e)||(l(o.get(ya)),na(e)&&l(o.get(va)));break;case"set":na(e)&&l(o.get(ya))}a.forEach((o=>{o.options.onTrigger&&o.options.onTrigger({effect:o,target:e,key:r,type:t,newValue:n,oldValue:i,oldTarget:s}),o.options.scheduler?o.options.scheduler(o):o()}))}var Da=Jo("__proto__,__v_isRef,__isVue"),Na=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(ia)),Ca=La(),ka=La(!1,!0),Ma=La(!0),Oa=La(!0,!0),_a={};function La(e=!1,t=!1){return function(r,n,i){if("__v_isReactive"===n)return!e;if("__v_isReadonly"===n)return e;if("__v_raw"===n&&i===(e?t?ll:al:t?ol:sl).get(r))return r;const s=ra(r);if(!e&&s&&ta(_a,n))return Reflect.get(_a,n,i);const o=Reflect.get(r,n,i);if(ia(n)?Na.has(n):Da(n))return o;if(e||Ta(r,"get",n),t)return o;if(fl(o)){return!s||!ua(n)?o.value:o}return sa(o)?e?cl(o):ul(o):o}}function Ra(e=!1){return function(t,r,n,i){let s=t[r];if(!e&&(n=hl(n),s=hl(s),!ra(t)&&fl(s)&&!fl(n)))return s.value=n,!0;const o=ra(t)&&ua(r)?Number(r)<t.length:ta(t,r),a=Reflect.set(t,r,n,i);return t===hl(i)&&(o?pa(n,s)&&Aa(t,"set",r,n,s):Aa(t,"add",r,n)),a}}["includes","indexOf","lastIndexOf"].forEach((e=>{const t=Array.prototype[e];_a[e]=function(...e){const r=hl(this);for(let e=0,t=this.length;e<t;e++)Ta(r,"get",e+"");const n=t.apply(r,e);return-1===n||!1===n?t.apply(r,e.map(hl)):n}})),["push","pop","shift","unshift","splice"].forEach((e=>{const t=Array.prototype[e];_a[e]=function(...e){Ea.push(wa),wa=!1;const r=t.apply(this,e);return Sa(),r}}));var Ia={get:Ca,set:Ra(),deleteProperty:function(e,t){const r=ta(e,t),n=e[t],i=Reflect.deleteProperty(e,t);return i&&r&&Aa(e,"delete",t,void 0,n),i},has:function(e,t){const r=Reflect.has(e,t);return ia(t)&&Na.has(t)||Ta(e,"has",t),r},ownKeys:function(e){return Ta(e,"iterate",ra(e)?"length":ya),Reflect.ownKeys(e)}},Fa={get:Ma,set:(e,t)=>(console.warn(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0),deleteProperty:(e,t)=>(console.warn(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0)},Pa=(Qo({},Ia,{get:ka,set:Ra(!0)}),Qo({},Fa,{get:Oa}),e=>sa(e)?ul(e):e),Ba=e=>sa(e)?cl(e):e,Ua=e=>e,$a=e=>Reflect.getPrototypeOf(e);function ja(e,t,r=!1,n=!1){const i=hl(e=e.__v_raw),s=hl(t);t!==s&&!r&&Ta(i,"get",t),!r&&Ta(i,"get",s);const{has:o}=$a(i),a=n?Ua:r?Ba:Pa;return o.call(i,t)?a(e.get(t)):o.call(i,s)?a(e.get(s)):void(e!==i&&e.get(t))}function za(e,t=!1){const r=this.__v_raw,n=hl(r),i=hl(e);return e!==i&&!t&&Ta(n,"has",e),!t&&Ta(n,"has",i),e===i?r.has(e):r.has(e)||r.has(i)}function qa(e,t=!1){return e=e.__v_raw,!t&&Ta(hl(e),"iterate",ya),Reflect.get(e,"size",e)}function Ha(e){e=hl(e);const t=hl(this);return $a(t).has.call(t,e)||(t.add(e),Aa(t,"add",e,e)),this}function Va(e,t){t=hl(t);const r=hl(this),{has:n,get:i}=$a(r);let s=n.call(r,e);s?il(r,n,e):(e=hl(e),s=n.call(r,e));const o=i.call(r,e);return r.set(e,t),s?pa(t,o)&&Aa(r,"set",e,t,o):Aa(r,"add",e,t),this}function Ga(e){const t=hl(this),{has:r,get:n}=$a(t);let i=r.call(t,e);i?il(t,r,e):(e=hl(e),i=r.call(t,e));const s=n?n.call(t,e):void 0,o=t.delete(e);return i&&Aa(t,"delete",e,void 0,s),o}function Wa(){const e=hl(this),t=0!==e.size,r=na(e)?new Map(e):new Set(e),n=e.clear();return t&&Aa(e,"clear",void 0,void 0,r),n}function Ka(e,t){return function(r,n){const i=this,s=i.__v_raw,o=hl(s),a=t?Ua:e?Ba:Pa;return!e&&Ta(o,"iterate",ya),s.forEach(((e,t)=>r.call(n,a(e),a(t),i)))}}function Ya(e,t,r){return function(...n){const i=this.__v_raw,s=hl(i),o=na(s),a="entries"===e||e===Symbol.iterator&&o,l="keys"===e&&o,u=i[e](...n),c=r?Ua:t?Ba:Pa;return!t&&Ta(s,"iterate",l?va:ya),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:a?[c(e[0]),c(e[1])]:c(e),done:t}},[Symbol.iterator](){return this}}}}function Ja(e){return function(...t){{const r=t[0]?`on key "${t[0]}" `:"";console.warn(`${fa(e)} operation ${r}failed: target is readonly.`,hl(this))}return"delete"!==e&&this}}var Za={get(e){return ja(this,e)},get size(){return qa(this)},has:za,add:Ha,set:Va,delete:Ga,clear:Wa,forEach:Ka(!1,!1)},Xa={get(e){return ja(this,e,!1,!0)},get size(){return qa(this)},has:za,add:Ha,set:Va,delete:Ga,clear:Wa,forEach:Ka(!1,!0)},Qa={get(e){return ja(this,e,!0)},get size(){return qa(this,!0)},has(e){return za.call(this,e,!0)},add:Ja("add"),set:Ja("set"),delete:Ja("delete"),clear:Ja("clear"),forEach:Ka(!0,!1)},el={get(e){return ja(this,e,!0,!0)},get size(){return qa(this,!0)},has(e){return za.call(this,e,!0)},add:Ja("add"),set:Ja("set"),delete:Ja("delete"),clear:Ja("clear"),forEach:Ka(!0,!0)};function tl(e,t){const r=t?e?el:Xa:e?Qa:Za;return(t,n,i)=>"__v_isReactive"===n?!e:"__v_isReadonly"===n?e:"__v_raw"===n?t:Reflect.get(ta(r,n)&&n in t?r:t,n,i)}["keys","values","entries",Symbol.iterator].forEach((e=>{Za[e]=Ya(e,!1,!1),Qa[e]=Ya(e,!0,!1),Xa[e]=Ya(e,!1,!0),el[e]=Ya(e,!0,!0)}));var rl={get:tl(!1,!1)},nl=(tl(!1,!0),{get:tl(!0,!1)});tl(!0,!0);function il(e,t,r){const n=hl(r);if(n!==r&&t.call(e,n)){const t=la(e);console.warn(`Reactive ${t} contains both the raw and reactive versions of the same object${"Map"===t?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var sl=new WeakMap,ol=new WeakMap,al=new WeakMap,ll=new WeakMap;function ul(e){return e&&e.__v_isReadonly?e:dl(e,!1,Ia,rl,sl)}function cl(e){return dl(e,!0,Fa,nl,al)}function dl(e,t,r,n,i){if(!sa(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const s=i.get(e);if(s)return s;const o=(a=e).__v_skip||!Object.isExtensible(a)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(la(a));var a;if(0===o)return e;const l=new Proxy(e,2===o?n:r);return i.set(e,l),l}function hl(e){return e&&hl(e.__v_raw)||e}function fl(e){return Boolean(e&&!0===e.__v_isRef)}ks("nextTick",(()=>To)),ks("dispatch",(e=>oo.bind(oo,e))),ks("watch",((e,{evaluateLater:t,effect:r})=>(n,i)=>{let s,o=t(n),a=!0,l=r((()=>o((e=>{JSON.stringify(e),a?s=e:queueMicrotask((()=>{i(e,s),s=e})),a=!1}))));e._x_effects.delete(l)})),ks("store",(function(){return qo})),ks("data",(e=>ws(e))),ks("root",(e=>yo(e))),ks("refs",(e=>(e._x_refs_proxy||(e._x_refs_proxy=Ts(function(e){let t=[],r=e;for(;r;)r._x_refs&&t.push(r._x_refs),r=r.parentNode;return t}(e))),e._x_refs_proxy)));var pl={};function ml(e){return pl[e]||(pl[e]=0),++pl[e]}function gl(e,t,r){ks(t,(t=>lo(`You can't use [$${directiveName}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${r}`,t)))}ks("id",(e=>(t,r=null)=>{let n=function(e,t){return vo(e,(e=>{if(e._x_ids&&e._x_ids[t])return!0}))}(e,t),i=n?n._x_ids[t]:ml(t);return r?`${t}-${i}-${r}`:`${t}-${i}`})),ks("el",(e=>e)),gl("Focus","focus","focus"),gl("Persist","persist","persist"),Hs("modelable",((e,{expression:t},{effect:r,evaluateLater:n,cleanup:i})=>{let s=n(t),o=()=>{let e;return s((t=>e=t)),e},a=n(`${t} = __placeholder`),l=e=>a((()=>{}),{scope:{__placeholder:e}}),u=o();l(u),queueMicrotask((()=>{if(!e._x_model)return;e._x_removeModelListeners.default();let t=e._x_model.get,r=e._x_model.set,n=function({get:e,set:t},{get:r,set:n}){let i,s,o,a,l=!0,u=Wi((()=>{let u,c;l?(u=e(),n(u),c=r(),l=!1):(u=e(),c=r(),o=JSON.stringify(u),a=JSON.stringify(c),o!==i?(c=r(),n(u),c=u):(t(c),u=c)),i=JSON.stringify(u),s=JSON.stringify(c)}));return()=>{Ki(u)}}({get:()=>t(),set(e){r(e)}},{get:()=>o(),set(e){l(e)}});i(n)}))}));var yl=document.createElement("div");Hs("teleport",((e,{modifiers:t,expression:r},{cleanup:n})=>{"template"!==e.tagName.toLowerCase()&&lo("x-teleport can only be used on a <template> tag",e);let i=Io((()=>document.querySelector(r)),(()=>yl))();i||lo(`Cannot find x-teleport element for selector: "${r}"`);let s=e.content.cloneNode(!0).firstElementChild;e._x_teleport=s,s._x_teleportBack=e,e._x_forwardEvents&&e._x_forwardEvents.forEach((t=>{s.addEventListener(t,(t=>{t.stopPropagation(),e.dispatchEvent(new t.constructor(t.type,t))}))})),Es(s,{},e),ys((()=>{t.includes("prepend")?i.parentNode.insertBefore(s,i):t.includes("append")?i.parentNode.insertBefore(s,i.nextSibling):i.appendChild(s),xo(s),s._x_ignore=!0})),n((()=>s.remove()))}));var vl=()=>{};function bl(e,t,r,n){let i=e,s=e=>n(e),o={},a=(e,t)=>r=>t(e,r);if(r.includes("dot")&&(t=t.replace(/-/g,".")),r.includes("camel")&&(t=function(e){return e.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase()))}(t)),r.includes("passive")&&(o.passive=!0),r.includes("capture")&&(o.capture=!0),r.includes("window")&&(i=window),r.includes("document")&&(i=document),r.includes("debounce")){let e=r[r.indexOf("debounce")+1]||"invalid-wait",t=xl(e.split("ms")[0])?Number(e.split("ms")[0]):250;s=jo(s,t)}if(r.includes("throttle")){let e=r[r.indexOf("throttle")+1]||"invalid-wait",t=xl(e.split("ms")[0])?Number(e.split("ms")[0]):250;s=zo(s,t)}return r.includes("prevent")&&(s=a(s,((e,t)=>{t.preventDefault(),e(t)}))),r.includes("stop")&&(s=a(s,((e,t)=>{t.stopPropagation(),e(t)}))),r.includes("self")&&(s=a(s,((t,r)=>{r.target===e&&t(r)}))),(r.includes("away")||r.includes("outside"))&&(i=document,s=a(s,((t,r)=>{e.contains(r.target)||!1!==r.target.isConnected&&(e.offsetWidth<1&&e.offsetHeight<1||!1!==e._x_isShown&&t(r))}))),r.includes("once")&&(s=a(s,((e,r)=>{e(r),i.removeEventListener(t,s,o)}))),s=a(s,((e,n)=>{(function(e){return["keydown","keyup"].includes(e)})(t)&&function(e,t){let r=t.filter((e=>!["window","document","prevent","stop","once","capture"].includes(e)));if(r.includes("debounce")){let e=r.indexOf("debounce");r.splice(e,xl((r[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(r.includes("throttle")){let e=r.indexOf("throttle");r.splice(e,xl((r[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(0===r.length)return!1;if(1===r.length&&wl(e.key).includes(r[0]))return!1;const n=["ctrl","shift","alt","meta","cmd","super"].filter((e=>r.includes(e)));if(r=r.filter((e=>!n.includes(e))),n.length>0){if(n.filter((t=>("cmd"!==t&&"super"!==t||(t="meta"),e[`${t}Key`]))).length===n.length&&wl(e.key).includes(r[0]))return!1}return!0}(n,r)||e(n)})),i.addEventListener(t,s,o),()=>{i.removeEventListener(t,s,o)}}function xl(e){return!Array.isArray(e)&&!isNaN(e)}function wl(e){if(!e)return[];var t;e=[" ","_"].includes(t=e)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase();let r={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",equal:"=",minus:"-",underscore:"_"};return r[e]=e,Object.keys(r).map((t=>{if(r[t]===e)return t})).filter((e=>e))}function El(e){let t=e?parseFloat(e):null;return r=t,Array.isArray(r)||isNaN(r)?e:t;var r}function Sl(e){return null!==e&&"object"==typeof e&&"function"==typeof e.get&&"function"==typeof e.set}vl.inline=(e,{modifiers:t},{cleanup:r})=>{t.includes("self")?e._x_ignoreSelf=!0:e._x_ignore=!0,r((()=>{t.includes("self")?delete e._x_ignoreSelf:delete e._x_ignore}))},Hs("ignore",vl),Hs("effect",((e,{expression:t},{effect:r})=>r(Fs(e,t)))),Hs("model",((e,{modifiers:t,expression:r},{effect:n,cleanup:i})=>{let s=e;t.includes("parent")&&(s=e.parentNode);let o,a=Fs(s,r);o="string"==typeof r?Fs(s,`${r} = __placeholder`):"function"==typeof r&&"string"==typeof r()?Fs(s,`${r()} = __placeholder`):()=>{};let l=()=>{let e;return a((t=>e=t)),Sl(e)?e.get():e},u=e=>{let t;a((e=>t=e)),Sl(t)?t.set(e):o((()=>{}),{scope:{__placeholder:e}})};"string"==typeof r&&"radio"===e.type&&ys((()=>{e.hasAttribute("name")||e.setAttribute("name",r)}));var c="select"===e.tagName.toLowerCase()||["checkbox","radio"].includes(e.type)||t.includes("lazy")?"change":"input";let d=Ro?()=>{}:bl(e,c,t,(r=>{u(function(e,t,r,n){return ys((()=>{if(r instanceof CustomEvent&&void 0!==r.detail)return r.detail??r.target.value;if("checkbox"===e.type){if(Array.isArray(n)){let e=t.includes("number")?El(r.target.value):r.target.value;return r.target.checked?n.concat([e]):n.filter((t=>!(t==e)))}return r.target.checked}if("select"===e.tagName.toLowerCase()&&e.multiple)return t.includes("number")?Array.from(r.target.selectedOptions).map((e=>El(e.value||e.text))):Array.from(r.target.selectedOptions).map((e=>e.value||e.text));{let e=r.target.value;return t.includes("number")?El(e):t.includes("trim")?e.trim():e}}))}(e,t,r,l()))}));if(t.includes("fill")&&[null,""].includes(l())&&e.dispatchEvent(new Event(c,{})),e._x_removeModelListeners||(e._x_removeModelListeners={}),e._x_removeModelListeners.default=d,i((()=>e._x_removeModelListeners.default())),e.form){let t=bl(e.form,"reset",[],(t=>{To((()=>e._x_model&&e._x_model.set(e.value)))}));i((()=>t()))}e._x_model={get:()=>l(),set(e){u(e)}},e._x_forceModelUpdate=t=>{void 0===(t=void 0===t?l():t)&&"string"==typeof r&&r.match(/\./)&&(t=""),window.fromModel=!0,ys((()=>Fo(e,"value",t))),delete window.fromModel},n((()=>{let r=l();t.includes("unintrusive")&&document.activeElement.isSameNode(e)||e._x_forceModelUpdate(r)}))})),Hs("cloak",(e=>queueMicrotask((()=>ys((()=>e.removeAttribute(zs("cloak")))))))),go((()=>`[${zs("init")}]`)),Hs("init",Io(((e,{expression:t},{evaluate:r})=>"string"==typeof t?!!t.trim()&&r(t,{},!1):r(t,{},!1)))),Hs("text",((e,{expression:t},{effect:r,evaluateLater:n})=>{let i=n(t);r((()=>{i((t=>{ys((()=>{e.textContent=t}))}))}))})),Hs("html",((e,{expression:t},{effect:r,evaluateLater:n})=>{let i=n(t);r((()=>{i((t=>{ys((()=>{e.innerHTML=t,e._x_ignoreSelf=!0,xo(e),delete e._x_ignoreSelf}))}))}))})),eo(Zs(":",zs("bind:")));var Tl=(e,{value:t,modifiers:r,expression:n,original:i},{effect:s})=>{if(!t){let t={};return o=t,Object.entries(Vo).forEach((([e,t])=>{Object.defineProperty(o,e,{get:()=>(...e)=>t(...e)})})),void Fs(e,n)((t=>{Go(e,t,i)}),{scope:t})}var o;if("key"===t)return function(e,t){e._x_keyExpression=t}(e,n);if(e._x_inlineBindings&&e._x_inlineBindings[t]&&e._x_inlineBindings[t].extract)return;let a=Fs(e,n);s((()=>a((i=>{void 0===i&&"string"==typeof n&&n.match(/\./)&&(i=""),ys((()=>Fo(e,t,i,r)))}))))};function Al(e,t,r,n){let i={};if(/^\[.*\]$/.test(e.item)&&Array.isArray(t)){let r=e.item.replace("[","").replace("]","").split(",").map((e=>e.trim()));r.forEach(((e,r)=>{i[e]=t[r]}))}else if(/^\{.*\}$/.test(e.item)&&!Array.isArray(t)&&"object"==typeof t){let r=e.item.replace("{","").replace("}","").split(",").map((e=>e.trim()));r.forEach((e=>{i[e]=t[e]}))}else i[e.item]=t;return e.index&&(i[e.index]=r),e.collection&&(i[e.collection]=n),i}function Dl(){}function Nl(e,t,r){Hs(t,(n=>lo(`You can't use [x-${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${r}`,n)))}Tl.inline=(e,{value:t,modifiers:r,expression:n})=>{t&&(e._x_inlineBindings||(e._x_inlineBindings={}),e._x_inlineBindings[t]={expression:n,extract:!1})},Hs("bind",Tl),mo((()=>`[${zs("data")}]`)),Hs("data",Io(((e,{expression:t},{cleanup:r})=>{t=""===t?"{}":t;let n={};Ms(n,e);let i={};var s,o;s=i,o=n,Object.entries(Wo).forEach((([e,t])=>{Object.defineProperty(s,e,{get:()=>(...e)=>t.bind(o)(...e),enumerable:!1})}));let a=Is(e,t,{scope:i});void 0!==a&&!0!==a||(a={}),Ms(a,e);let l=Gi(a);As(l);let u=Es(e,l);l.init&&Is(e,l.init),r((()=>{l.destroy&&Is(e,l.destroy),u()}))}))),Hs("show",((e,{modifiers:t,expression:r},{effect:n})=>{let i=Fs(e,r);e._x_doHide||(e._x_doHide=()=>{ys((()=>{e.style.setProperty("display","none",t.includes("important")?"important":void 0)}))}),e._x_doShow||(e._x_doShow=()=>{ys((()=>{1===e.style.length&&"none"===e.style.display?e.removeAttribute("style"):e.style.removeProperty("display")}))});let s,o=()=>{e._x_doHide(),e._x_isShown=!1},a=()=>{e._x_doShow(),e._x_isShown=!0},l=()=>setTimeout(a),u=ko((e=>e?a():o()),(t=>{"function"==typeof e._x_toggleAndCascadeWithTransitions?e._x_toggleAndCascadeWithTransitions(e,t,a,o):t?l():o()})),c=!0;n((()=>i((e=>{(c||e!==s)&&(t.includes("immediate")&&(e?l():o()),u(e),s=e,c=!1)}))))})),Hs("for",((e,{expression:t},{effect:r,cleanup:n})=>{let i=function(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,r=/^\s*\(|\)\s*$/g,n=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=e.match(n);if(!i)return;let s={};s.items=i[2].trim();let o=i[1].replace(r,"").trim(),a=o.match(t);a?(s.item=o.replace(t,"").trim(),s.index=a[1].trim(),a[2]&&(s.collection=a[2].trim())):s.item=o;return s}(t),s=Fs(e,i.items),o=Fs(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},r((()=>function(e,t,r,n){let i=e=>"object"==typeof e&&!Array.isArray(e),s=e;r((r=>{var o;o=r,!Array.isArray(o)&&!isNaN(o)&&r>=0&&(r=Array.from(Array(r).keys(),(e=>e+1))),void 0===r&&(r=[]);let a=e._x_lookup,l=e._x_prevKeys,u=[],c=[];if(i(r))r=Object.entries(r).map((([e,i])=>{let s=Al(t,i,e,r);n((e=>c.push(e)),{scope:{index:e,...s}}),u.push(s)}));else for(let e=0;e<r.length;e++){let i=Al(t,r[e],e,r);n((e=>c.push(e)),{scope:{index:e,...i}}),u.push(i)}let d=[],h=[],f=[],p=[];for(let e=0;e<l.length;e++){let t=l[e];-1===c.indexOf(t)&&f.push(t)}l=l.filter((e=>!f.includes(e)));let m="template";for(let e=0;e<c.length;e++){let t=c[e],r=l.indexOf(t);if(-1===r)l.splice(e,0,t),d.push([m,e]);else if(r!==e){let t=l.splice(e,1)[0],n=l.splice(r-1,1)[0];l.splice(e,0,n),l.splice(r,0,t),h.push([t,n])}else p.push(t);m=t}for(let e=0;e<f.length;e++){let t=f[e];a[t]._x_effects&&a[t]._x_effects.forEach(rs),a[t].remove(),a[t]=null,delete a[t]}for(let e=0;e<h.length;e++){let[t,r]=h[e],n=a[t],i=a[r],o=document.createElement("div");ys((()=>{i||lo('x-for ":key" is undefined or invalid',s),i.after(o),n.after(i),i._x_currentIfEl&&i.after(i._x_currentIfEl),o.before(n),n._x_currentIfEl&&n.after(n._x_currentIfEl),o.remove()})),i._x_refreshXForScope(u[c.indexOf(r)])}for(let e=0;e<d.length;e++){let[t,r]=d[e],n="template"===t?s:a[t];n._x_currentIfEl&&(n=n._x_currentIfEl);let i=u[r],o=c[r],l=document.importNode(s.content,!0).firstElementChild,h=Gi(i);Es(l,h,s),l._x_refreshXForScope=e=>{Object.entries(e).forEach((([e,t])=>{h[e]=t}))},ys((()=>{n.after(l),xo(l)})),"object"==typeof o&&lo("x-for key cannot be an object, it must be a string or an integer",s),a[o]=l}for(let e=0;e<p.length;e++)a[p[e]]._x_refreshXForScope(u[c.indexOf(p[e])]);s._x_prevKeys=c}))}(e,i,s,o))),n((()=>{Object.values(e._x_lookup).forEach((e=>e.remove())),delete e._x_prevKeys,delete e._x_lookup}))})),Dl.inline=(e,{expression:t},{cleanup:r})=>{let n=yo(e);n._x_refs||(n._x_refs={}),n._x_refs[t]=e,r((()=>delete n._x_refs[t]))},Hs("ref",Dl),Hs("if",((e,{expression:t},{effect:r,cleanup:n})=>{let i=Fs(e,t);r((()=>i((t=>{t?(()=>{if(e._x_currentIfEl)return e._x_currentIfEl;let t=e.content.cloneNode(!0).firstElementChild;Es(t,{},e),ys((()=>{e.after(t),xo(t)})),e._x_currentIfEl=t,e._x_undoIf=()=>{ao(t,(e=>{e._x_effects&&e._x_effects.forEach(rs)})),t.remove(),delete e._x_currentIfEl}})():e._x_undoIf&&(e._x_undoIf(),delete e._x_undoIf)})))),n((()=>e._x_undoIf&&e._x_undoIf()))})),Hs("id",((e,{expression:t},{evaluate:r})=>{r(t).forEach((t=>function(e,t){e._x_ids||(e._x_ids={}),e._x_ids[t]||(e._x_ids[t]=ml(t))}(e,t)))})),eo(Zs("@",zs("on:"))),Hs("on",Io(((e,{value:t,modifiers:r,expression:n},{cleanup:i})=>{let s=n?Fs(e,n):()=>{};"template"===e.tagName.toLowerCase()&&(e._x_forwardEvents||(e._x_forwardEvents=[]),e._x_forwardEvents.includes(t)||e._x_forwardEvents.push(t));let o=bl(e,t,r,(e=>{s((()=>{}),{scope:{$event:e},params:[e]})}));i((()=>o()))}))),Nl("Collapse","collapse","collapse"),Nl("Intersect","intersect","intersect"),Nl("Focus","trap","focus"),Nl("Mask","mask","mask"),Yo.setEvaluator(Bs),Yo.setReactivityEngine({reactive:ul,effect:function(e,t=Xo){(function(e){return e&&!0===e._isEffect})(e)&&(e=e.raw);const r=function(e,t){const r=function(){if(!r.active)return e();if(!ga.includes(r)){xa(r);try{return Ea.push(wa),wa=!0,ga.push(r),Zo=r,e()}finally{ga.pop(),Sa(),Zo=ga[ga.length-1]}}};return r.id=ba++,r.allowRecurse=!!t.allowRecurse,r._isEffect=!0,r.active=!0,r.raw=e,r.deps=[],r.options=t,r}(e,t);return t.lazy||r(),r},release:function(e){e.active&&(xa(e),e.options.onStop&&e.options.onStop(),e.active=!1)},raw:hl});var Cl=Yo;function kl(e){if(e.includes("full"))return.99;if(e.includes("half"))return.5;if(!e.includes("threshold"))return 0;let t=e[e.indexOf("threshold")+1];return"100"===t?1:"0"===t?0:Number(`.${t}`)}function Ml(e){let t=e.match(/^(-?[0-9]+)(px|%)?$/);return t?t[1]+(t[2]||"px"):void 0}function Ol(e){const t="0px 0px 0px 0px",r=e.indexOf("margin");if(-1===r)return t;let n=[];for(let t=1;t<5;t++)n.push(Ml(e[r+t]||""));return n=n.filter((e=>void 0!==e)),n.length?n.join(" ").trim():t}var _l=function(e){e.directive("intersect",((e,{value:t,expression:r,modifiers:n},{evaluateLater:i,cleanup:s})=>{let o=i(r),a={rootMargin:Ol(n),threshold:kl(n)},l=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting!==("leave"===t)&&(o(),n.includes("once")&&l.disconnect())}))}),a);l.observe(e),s((()=>{l.disconnect()}))}))};function Ll(){return Ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ll.apply(this,arguments)}var Rl={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null},Il=["Matrix","Array"],Fl=["number","BigNumber","Fraction"];var Pl=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(Rl)};function Bl(e){return"number"==typeof e}function Ul(e){return!(!e||"object"!=typeof e||"function"!=typeof e.constructor)&&(!0===e.isBigNumber&&"object"==typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"==typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function $l(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function jl(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function zl(e){return e&&!0===e.constructor.prototype.isUnit||!1}function ql(e){return"string"==typeof e}Ll(Pl,Rl,{MATRIX_OPTIONS:Il,NUMBER_OPTIONS:Fl});var Hl=Array.isArray;function Vl(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function Gl(e){return Array.isArray(e)||Vl(e)}function Wl(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Kl(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Yl(e){return e&&!0===e.constructor.prototype.isRange||!1}function Jl(e){return e&&!0===e.constructor.prototype.isIndex||!1}function Zl(e){return"boolean"==typeof e}function Xl(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function Ql(e){return e&&!0===e.constructor.prototype.isHelp||!1}function eu(e){return"function"==typeof e}function tu(e){return e instanceof Date}function ru(e){return e instanceof RegExp}function nu(e){return!(!e||"object"!=typeof e||e.constructor!==Object||$l(e)||jl(e))}function iu(e){return null===e}function su(e){return void 0===e}function ou(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function au(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function lu(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function uu(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function cu(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function du(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function hu(e){return du(e)||vu(e)&&1===e.args.length&&du(e.args[0])&&"-+~".includes(e.op)}function fu(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function pu(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function mu(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function gu(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function yu(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function vu(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function bu(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function xu(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function wu(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function Eu(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function Su(e){return e&&!0===e.constructor.prototype.isChain||!1}function Tu(e){var t=typeof e;return"object"===t?null===e?"null":Ul(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}var Au=new Set(["end"]);function Du(e){var t=typeof e;if("number"===t||"string"===t||"boolean"===t||null==e)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map((function(e){return Du(e)}));if(e instanceof Date)return new Date(e.valueOf());if(Ul(e))return e;if(e instanceof RegExp)throw new TypeError("Cannot clone "+e);return function(e,t){var r={};for(var n in e)ku(e,n)&&(r[n]=t(e[n]));return r}(e,Du)}function Nu(e,t){for(var r in t)ku(t,r)&&(e[r]=t[r]);return e}function Cu(e,t){var r,n,i;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(n=0,i=e.length;n<i;n++)if(!Cu(e[n],t[n]))return!1;return!0}if("function"==typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(r in e)if(!(r in t)||!Cu(e[r],t[r]))return!1;for(r in t)if(!(r in e))return!1;return!0}return e===t}function ku(e,t){return e&&Object.hasOwnProperty.call(e,t)}function Mu(e,t,r,n){function i(n){var i=function(e,t){for(var r={},n=0;n<t.length;n++){var i=t[n],s=e[i];void 0!==s&&(r[i]=s)}return r}(n,t.map(Ou));return function(e,t,r){var n=t.filter((e=>!function(e){return e&&"?"===e[0]}(e))).every((e=>void 0!==r[e]));if(!n){var i=t.filter((e=>void 0===r[e]));throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(i.map((e=>'"'.concat(e,'"'))).join(", "),"."))}}(e,t,n),r(i)}return i.isFactory=!0,i.fn=e,i.dependencies=t.slice().sort(),n&&(i.meta=n),i}function Ou(e){return e&&"?"===e[0]?e.slice(1):e}function _u(e,t){if(Fu(e)&&Ru(e,t))return e[t];if("function"==typeof e[t]&&Iu(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function Lu(e,t,r){if(Fu(e)&&Ru(e,t))return e[t]=r,r;throw new Error('No access to property "'+t+'"')}function Ru(e,t){return!(!e||"object"!=typeof e)&&(!!ku(Pu,t)||!(t in Object.prototype)&&!(t in Function.prototype))}function Iu(e,t){return null!=e&&"function"==typeof e[t]&&(!(ku(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e))&&(!!ku(Bu,t)||!(t in Object.prototype)&&!(t in Function.prototype)))}function Fu(e){return"object"==typeof e&&e&&e.constructor===Object}var Pu={length:!0,name:!0},Bu={toString:!0,valueOf:!0,toLocaleString:!0};class Uu{constructor(e){this.wrappedObject=e}keys(){return Object.keys(this.wrappedObject)}get(e){return _u(this.wrappedObject,e)}set(e,t){return Lu(this.wrappedObject,e,t),this}has(e){return t=this.wrappedObject,e in t;var t}}function $u(){return new Map}function ju(e){if(!e)return $u();if(zu(e))return e;if(nu(e))return new Uu(e);throw new Error("createMap can create maps from objects or Maps")}function zu(e){return!!e&&(e instanceof Map||e instanceof Uu||"function"==typeof e.set&&"function"==typeof e.get&&"function"==typeof e.keys&&"function"==typeof e.has)}function qu(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i of r)if(i)if(zu(i))for(var s of i.keys())e.set(s,i.get(s));else if(nu(i))for(var o of Object.keys(i))e.set(o,i[o]);return e}var Hu=Mu("Node",["mathWithTransform"],(e=>{var{mathWithTransform:t}=e;return class{get type(){return"Node"}get isNode(){return!0}evaluate(e){return this.compile().evaluate(e)}compile(){var e=this._compile(t,{}),r={};return{evaluate:function(t){var n=ju(t);return function(e){for(var t of[...Au])if(e.has(t))throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}(n),e(n,r,null)}}}_compile(e,t){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(e){throw new Error("Cannot run forEach on a Node interface")}map(e){throw new Error("Cannot run map on a Node interface")}_ifNode(e){if(!gu(e))throw new TypeError("Callback function must return a Node");return e}traverse(e){e(this,null,null),function e(t,r){t.forEach((function(t,n,i){r(t,n,i),e(t,r)}))}(this,e)}transform(e){return function t(r,n,i){var s=e(r,n,i);return s!==r?s:r.map(t)}(this,null,null)}filter(e){var t=[];return this.traverse((function(r,n,i){e(r,n,i)&&t.push(r)})),t}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map((function(e){return e.cloneDeep()}))}equals(e){return!!e&&(this.type===e.type&&Cu(this,e))}toString(e){var t=this._getCustomString(e);return void 0!==t?t:this._toString(e)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(e){var t=this._getCustomString(e);return void 0!==t?t:this.toHTML(e)}_toString(){throw new Error("_toString not implemented for "+this.type)}toTex(e){var t=this._getCustomString(e);return void 0!==t?t:this._toTex(e)}_toTex(e){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(e){if(e&&"object"==typeof e)switch(typeof e.handler){case"object":case"undefined":return;case"function":return e.handler(this,e);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}}),{isClass:!0,isNode:!0});function Vu(e){return Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vu(e)}function Gu(e){var t=function(e,t){if("object"!==Vu(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Vu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Vu(t)?t:String(t)}function Wu(e,t,r){return(t=Gu(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ku(e){return"boolean"==typeof e||!!isFinite(e)&&e===Math.round(e)}var Yu=Math.sign||function(e){return e>0?1:e<0?-1:0},Ju=Math.log2||function(e){return Math.log(e)/Math.LN2},Zu=Math.log10||function(e){return Math.log(e)/Math.LN10},Xu=Math.log1p||function(e){return Math.log(e+1)},Qu=Math.cbrt||function(e){if(0===e)return e;var t,r=e<0;return r&&(e=-e),t=isFinite(e)?(e/((t=Math.exp(Math.log(e)/3))*t)+2*t)/3:e,r?-t:t},ec=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function tc(e,t,r){var n={2:"0b",8:"0o",16:"0x"}[t],i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Ku(r))throw new Error("size must be an integer");if(e>2**(r-1)-1||e<-(2**(r-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!Ku(e))throw new Error("Value must be an integer");e<0&&(e+=2**r),i="i".concat(r)}var s="";return e<0&&(e=-e,s="-"),"".concat(s).concat(n).concat(e.toString(t)).concat(i)}function rc(e,t){if("function"==typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var r,n,i="auto";if(t&&(t.notation&&(i=t.notation),Bl(t)?r=t:Bl(t.precision)&&(r=t.precision),t.wordSize&&"number"!=typeof(n=t.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return ic(e,r);case"exponential":return sc(e,r);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=nc(e),n=oc(r,t),i=n.exponent,s=n.coefficients,o=i%3==0?i:i<0?i-3-i%3:i-i%3;if(Bl(t))for(;t>s.length||i-o+1>s.length;)s.push(0);else for(var a=Math.abs(i-o)-(s.length-1),l=0;l<a;l++)s.push(0);var u=Math.abs(i-o),c=1;for(;u>0;)c++,u--;var d=s.slice(c).join(""),h=Bl(t)&&d.length||d.match(/[1-9]/)?"."+d:"",f=s.slice(0,c).join("")+h+"e"+(i>=0?"+":"")+o.toString();return n.sign+f}(e,r);case"bin":return tc(e,2,n);case"oct":return tc(e,8,n);case"hex":return tc(e,16,n);case"auto":return function(e,t,r){if(isNaN(e)||!isFinite(e))return String(e);var n=r&&void 0!==r.lowerExp?r.lowerExp:-3,i=r&&void 0!==r.upperExp?r.upperExp:5,s=nc(e),o=t?oc(s,t):s;if(o.exponent<n||o.exponent>=i)return sc(e,t);var a=o.coefficients,l=o.exponent;a.length<t&&(a=a.concat(ac(t-a.length))),a=a.concat(ac(l-a.length+1+(a.length<t?t-a.length:0)));var u=l>0?l:0;return u<(a=ac(-l).concat(a)).length-1&&a.splice(u+1,0,"."),o.sign+a.join("")}(e,r,t&&t).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nc(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var r=t[1],n=t[2],i=parseFloat(t[4]||"0"),s=n.indexOf(".");i+=-1!==s?s-1:n.length-1;var o=n.replace(".","").replace(/^0*/,(function(e){return i-=e.length,""})).replace(/0*$/,"").split("").map((function(e){return parseInt(e)}));return 0===o.length&&(o.push(0),i++),{sign:r,coefficients:o,exponent:i}}function ic(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=nc(e),n="number"==typeof t?oc(r,r.exponent+1+t):r,i=n.coefficients,s=n.exponent+1,o=s+(t||0);return i.length<o&&(i=i.concat(ac(o-i.length))),s<0&&(i=ac(1-s).concat(i),s=1),s<i.length&&i.splice(s,0,0===s?"0.":"."),n.sign+i.join("")}function sc(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=nc(e),n=t?oc(r,t):r,i=n.coefficients,s=n.exponent;i.length<t&&(i=i.concat(ac(t-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(s>=0?"+":"")+s}function oc(e,t){for(var r={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},n=r.coefficients;t<=0;)n.unshift(0),r.exponent++,t++;if(n.length>t&&n.splice(t,n.length-t)[0]>=5){var i=t-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),r.exponent++,i++),n[--i]++}return r}function ac(e){for(var t=[],r=0;r<e;r++)t.push(0);return t}var lc=Number.EPSILON||2220446049250313e-31;function uc(e,t,r){if(null==r)return e===t;if(e===t)return!0;if(isNaN(e)||isNaN(t))return!1;if(isFinite(e)&&isFinite(t)){var n=Math.abs(e-t);return n<lc||n<=Math.max(Math.abs(e),Math.abs(t))*r}return!1}var cc=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)},dc=Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},hc=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2},fc=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2},pc=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2},mc=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};function gc(e,t,r){var n=new(0,e.constructor)(2),i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Ku(r))throw new Error("size must be an integer");if(e.greaterThan(n.pow(r-1).sub(1))||e.lessThan(n.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(n.pow(r))),i="i".concat(r)}switch(t){case 2:return"".concat(e.toBinary()).concat(i);case 8:return"".concat(e.toOctal()).concat(i);case 16:return"".concat(e.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(t," not supported "))}}function yc(e,t){if("function"==typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var r,n,i="auto";if(void 0!==t&&(t.notation&&(i=t.notation),"number"==typeof t?r=t:void 0!==t.precision&&(r=t.precision),t.wordSize&&"number"!=typeof(n=t.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(e,t){return e.toFixed(t)}(e,r);case"exponential":return vc(e,r);case"engineering":return function(e,t){var r=e.e,n=r%3==0?r:r<0?r-3-r%3:r-r%3,i=e.mul(Math.pow(10,-n)),s=i.toPrecision(t);if(-1!==s.indexOf("e")){s=new(0,e.constructor)(s).toFixed()}return s+"e"+(r>=0?"+":"")+n.toString()}(e,r);case"bin":return gc(e,2,n);case"oct":return gc(e,8,n);case"hex":return gc(e,16,n);case"auto":var s=t&&void 0!==t.lowerExp?t.lowerExp:-3,o=t&&void 0!==t.upperExp?t.upperExp:5;if(e.isZero())return"0";var a=e.toSignificantDigits(r),l=a.e;return(l>=s&&l<o?a.toFixed():vc(e,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function vc(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function bc(e,t){var r=e.length-t.length,n=e.length;return e.substring(r,n)===t}function xc(e,t){var r=function(e,t){if("number"==typeof e)return rc(e,t);if(Ul(e))return yc(e,t);if(function(e){return e&&"object"==typeof e&&"number"==typeof e.s&&"number"==typeof e.n&&"number"==typeof e.d||!1}(e))return t&&"decimal"===t.fraction?e.toString():e.s*e.n+"/"+e.d;if(Array.isArray(e))return Sc(e,t);if(ql(e))return'"'+e+'"';if("function"==typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"==typeof e){return"function"==typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map((r=>'"'+r+'": '+xc(e[r],t))).join(", ")+"}"}return String(e)}(e,t);return t&&"object"==typeof t&&"truncate"in t&&r.length>t.truncate?r.substring(0,t.truncate-3)+"...":r}function wc(e){for(var t=String(e),r="",n=0;n<t.length;){var i=t.charAt(n);"\\"===i?(r+=i,n++,""!==(i=t.charAt(n))&&-1!=='"\\/bfnrtu'.indexOf(i)||(r+="\\"),r+=i):r+='"'===i?'\\"':i,n++}return'"'+r+'"'}function Ec(e){var t=String(e);return t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Sc(e,t){if(Array.isArray(e)){for(var r="[",n=e.length,i=0;i<n;i++)0!==i&&(r+=", "),r+=Sc(e[i],t);return r+="]"}return xc(e,t)}function Tc(e,t){if(!ql(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Tu(e)+", index: 0)");if(!ql(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Tu(t)+", index: 1)");return e===t?0:e>t?1:-1}var Ac="ObjectNode",Dc=Mu(Ac,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),this.properties=e||{},e&&("object"!=typeof e||!Object.keys(e).every((function(t){return gu(e[t])}))))throw new TypeError("Object containing Nodes expected")}get type(){return Ac}get isObjectNode(){return!0}_compile(e,t){var r={};for(var n in this.properties)if(ku(this.properties,n)){var i=wc(n),s=JSON.parse(i),o=_u(this.properties,n);r[s]=o._compile(e,t)}return function(e,t,n){var i={};for(var s in r)ku(r,s)&&(i[s]=r[s](e,t,n));return i}}forEach(e){for(var t in this.properties)ku(this.properties,t)&&e(this.properties[t],"properties["+wc(t)+"]",this)}map(e){var t={};for(var n in this.properties)ku(this.properties,n)&&(t[n]=this._ifNode(e(this.properties[n],"properties["+wc(n)+"]",this)));return new r(t)}clone(){var e={};for(var t in this.properties)ku(this.properties,t)&&(e[t]=this.properties[t]);return new r(e)}_toString(e){var t=[];for(var r in this.properties)ku(this.properties,r)&&t.push(wc(r)+": "+this.properties[r].toString(e));return"{"+t.join(", ")+"}"}toJSON(){return{mathjs:Ac,properties:this.properties}}static fromJSON(e){return new r(e.properties)}toHTML(e){var t=[];for(var r in this.properties)ku(this.properties,r)&&t.push('<span class="math-symbol math-property">'+Ec(r)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[r].toHTML(e));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(e){var t=[];for(var r in this.properties)ku(this.properties,r)&&t.push("\\mathbf{"+r+":} & "+this.properties[r].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"}}return Wu(r,"name",Ac),r}),{isClass:!0,isNode:!0});function Nc(e,t,r){if(!(this instanceof Nc))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function Cc(e,t,r){if(!(this instanceof Cc))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function kc(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function Mc(e,t,r){var n,i=e.length;if(i!==t[r])throw new Nc(i,t[r]);if(r<t.length-1){var s=r+1;for(n=0;n<i;n++){var o=e[n];if(!Array.isArray(o))throw new Nc(t.length-1,t.length,"<");Mc(e[n],t,s)}}else for(n=0;n<i;n++)if(Array.isArray(e[n]))throw new Nc(t.length+1,t.length,">")}function Oc(e,t){if(0===t.length){if(Array.isArray(e))throw new Nc(e.length,0)}else Mc(e,t,0)}function _c(e,t){if(!Bl(e)||!Ku(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"==typeof t&&e>=t)throw new Cc(e,t)}function Lc(e,t,r){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach((function(e){if(!Bl(e)||!Ku(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+xc(t)+")")})),Rc(e,t,0,void 0!==r?r:0),e}function Rc(e,t,r,n){var i,s,o=e.length,a=t[r],l=Math.min(o,a);if(e.length=a,r<t.length-1){var u=r+1;for(i=0;i<l;i++)s=e[i],Array.isArray(s)||(s=[s],e[i]=s),Rc(s,t,u,n);for(i=l;i<a;i++)s=[],e[i]=s,Rc(s,t,u,n)}else{for(i=0;i<l;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=l;i<a;i++)e[i]=n}}function Ic(e,t){var r=zc(e),n=r.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Nc(0,n,"!=");var i=Pc(t=Fc(t,n));if(n!==i)throw new Nc(i,n,"!=");try{return function(e,t){for(var r,n=e,i=t.length-1;i>0;i--){var s=t[i];r=[];for(var o=n.length/s,a=0;a<o;a++)r.push(n.slice(a*s,(a+1)*s));n=r}return n}(r,t)}catch(e){if(e instanceof Nc)throw new Nc(i,n,"!=");throw e}}function Fc(e,t){var r=Pc(e),n=e.slice(),i=e.indexOf(-1);if(e.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(t%r==0))throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-r);n[i]=-t/r}return n}function Pc(e){return e.reduce(((e,t)=>e*t),1)}function Bc(e,t){for(var r=t||kc(e);Array.isArray(e)&&1===e.length;)e=e[0],r.shift();for(var n=r.length;1===r[n-1];)n--;return n<r.length&&(e=Uc(e,n,0),r.length=n),e}function Uc(e,t,r){var n,i;if(r<t){var s=r+1;for(n=0,i=e.length;n<i;n++)e[n]=Uc(e[n],t,s)}else for(;Array.isArray(e);)e=e[0];return e}function $c(e,t,r,n){var i=n||kc(e);if(r)for(var s=0;s<r;s++)e=[e],i.unshift(1);for(e=jc(e,t,0);i.length<t;)i.push(1);return e}function jc(e,t,r){var n,i;if(Array.isArray(e)){var s=r+1;for(n=0,i=e.length;n<i;n++)e[n]=jc(e[n],t,s)}else for(var o=r;o<t;o++)e=[e];return e}function zc(e){if(!Array.isArray(e))return e;var t=[];return e.forEach((function e(r){Array.isArray(r)?r.forEach(e):t.push(r)})),t}function qc(e,t){return Array.prototype.map.call(e,t)}function Hc(e,t){Array.prototype.forEach.call(e,t)}function Vc(e,t){if(1!==kc(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,t)}function Gc(e,t){if(1!==kc(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,(e=>t.test(e)))}function Wc(e,t){return Array.prototype.join.call(e,t)}function Kc(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],r=0;t[0]={value:e[0],identifier:0};for(var n=1;n<e.length;n++)e[n]===e[n-1]?r++:r=0,t.push({value:e[n],identifier:r});return t}function Yc(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],r=0;r<e.length;r++)t.push(e[r].value);return t}function Jc(e,t){for(var r,n=0,i=0;i<e.length;i++){var s=e[i],o=Array.isArray(s);if(0===i&&o&&(n=s.length),o&&s.length!==n)return;var a=o?Jc(s,t):t(s);if(void 0===r)r=a;else if(r!==a)return"mixed"}return r}Nc.prototype=new RangeError,Nc.prototype.constructor=RangeError,Nc.prototype.name="DimensionError",Nc.prototype.isDimensionError=!0,Cc.prototype=new RangeError,Cc.prototype.constructor=RangeError,Cc.prototype.name="IndexError",Cc.prototype.isIndexError=!0;var Zc=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function Xc(e,t){if(!t||"auto"!==t)return e;for(var r=e;bu(r);)r=r.content;return r}function Qc(e,t,r,n){var i=e;"keep"!==t&&(i=e.getContent());for(var s=i.getIdentifier(),o=null,a=0;a<Zc.length;a++)if(s in Zc[a]){o=a;break}if("OperatorNode:multiply"===s&&i.implicit&&"show"!==r){var l=Xc(i.args[0],t);du(l)&&n&&"OperatorNode:divide"===n.getIdentifier()&&hu(Xc(n.args[0],t))||"OperatorNode:divide"===l.getIdentifier()&&hu(Xc(l.args[0],t))&&du(Xc(l.args[1]))||(o+=1)}return o}function ed(e,t){var r=e;"keep"!==t&&(r=e.getContent());var n=r.getIdentifier(),i=Qc(r,t);if(null===i)return null;var s=Zc[i][n];if(ku(s,"associativity")){if("left"===s.associativity)return"left";if("right"===s.associativity)return"right";throw Error("'"+n+"' has the invalid associativity '"+s.associativity+"'.")}return null}function td(e,t,r){var n="keep"!==r?e.getContent():e,i="keep"!==r?e.getContent():t,s=n.getIdentifier(),o=i.getIdentifier(),a=Qc(n,r);if(null===a)return null;var l=Zc[a][s];if(ku(l,"associativeWith")&&l.associativeWith instanceof Array){for(var u=0;u<l.associativeWith.length;u++)if(l.associativeWith[u]===o)return!0;return!1}return null}var rd=r(77928),nd={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},id={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},sd={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(id.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(id.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(id.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(id.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(id.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(id.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(id.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(id.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(id.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(id.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(id.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(id.bitAnd,"${args[1]}\\right)")},bitNot:{1:id.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(id.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(id.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(id.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(id.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(id.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(id.and,"${args[1]}\\right)")},not:{1:id.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(id.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(id.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(id.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(id.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(id.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(id.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(id.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(id.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(id.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(id.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(id.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(id.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(id.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(nd.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},od={deg:"^\\circ"};function ad(e){return rd(e,{preserveFormatting:!0})}function ld(e,t){return(t=void 0!==t&&t)?ku(od,e)?od[e]:"\\mathrm{"+ad(e)+"}":ku(nd,e)?nd[e]:ad(e)}var ud="OperatorNode",cd=Mu(ud,["Node"],(e=>{var{Node:t}=e;function r(e,t){var n=e;if("auto"===t)for(;bu(n);)n=n.content;return!!du(n)||!!vu(n)&&r(n.args[0],t)}function n(e,t,n,i,s){var o,a=Qc(e,t,n),l=ed(e,t);if("all"===t||i.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier())return i.map((function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(i.length){case 0:o=[];break;case 1:var u=Qc(i[0],t,n,e);if(s&&null!==u){var c,d;if("keep"===t?(c=i[0].getIdentifier(),d=e.getIdentifier()):(c=i[0].getContent().getIdentifier(),d=e.getContent().getIdentifier()),!1===Zc[a][d].latexLeftParens){o=[!1];break}if(!1===Zc[u][c].latexParens){o=[!1];break}}if(null===u){o=[!1];break}if(u<=a){o=[!0];break}o=[!1];break;case 2:var h,f,p=Qc(i[0],t,n,e),m=td(e,i[0],t);h=null!==p&&(p===a&&"right"===l&&!m||p<a);var g,y,v,b=Qc(i[1],t,n,e),x=td(e,i[1],t);if(f=null!==b&&(b===a&&"left"===l&&!x||b<a),s)"keep"===t?(g=e.getIdentifier(),y=e.args[0].getIdentifier(),v=e.args[1].getIdentifier()):(g=e.getContent().getIdentifier(),y=e.args[0].getContent().getIdentifier(),v=e.args[1].getContent().getIdentifier()),null!==p&&(!1===Zc[a][g].latexLeftParens&&(h=!1),!1===Zc[p][y].latexParens&&(h=!1)),null!==b&&(!1===Zc[a][g].latexRightParens&&(f=!1),!1===Zc[b][v].latexParens&&(f=!1));o=[h,f];break;default:"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()||(o=i.map((function(r){var i=Qc(r,t,n,e),s=td(e,r,t),o=ed(r,t);return null!==i&&(a===i&&l===o&&!s||i<a)})))}if(i.length>=2&&"OperatorNode:multiply"===e.getIdentifier()&&e.implicit&&"all"!==t&&"hide"===n)for(var w=1;w<o.length;++w)!r(i[w],t)||o[w-1]||"keep"===t&&bu(i[w-1])||(o[w]=!0);return o}class i extends t{constructor(e,t,r,n,i){if(super(),"string"!=typeof e)throw new TypeError('string expected for parameter "op"');if("string"!=typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(gu))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===n,this.isPercentage=!0===i,this.op=e,this.fn=t,this.args=r||[]}get type(){return ud}get isOperatorNode(){return!0}_compile(e,t){if("string"!=typeof this.fn||!Iu(e,this.fn))throw e[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var r=_u(e,this.fn),n=qc(this.args,(function(r){return r._compile(e,t)}));if(1===n.length){var i=n[0];return function(e,t,n){return r(i(e,t,n))}}if(2===n.length){var s=n[0],o=n[1];return function(e,t,n){return r(s(e,t,n),o(e,t,n))}}return function(e,t,i){return r.apply(null,qc(n,(function(r){return r(e,t,i)})))}}forEach(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=[],r=0;r<this.args.length;r++)t[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new i(this.op,this.fn,t,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return 1===this.args.length}isBinary(){return 2===this.args.length}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,s=n(this,t,r,i,!1);if(1===i.length){var o=ed(this,t),a=i[0].toString(e);s[0]&&(a="("+a+")");var l=/[a-zA-Z]+/.test(this.op);return"right"===o?this.op+(l?" ":"")+a:"left"===o?a+(l?" ":"")+this.op:a+this.op}if(2===i.length){var u=i[0].toString(e),c=i[1].toString(e);return s[0]&&(u="("+u+")"),s[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?u+" "+c:u+" "+this.op+" "+c}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var d=i.map((function(t,r){return t=t.toString(e),s[r]&&(t="("+t+")"),t}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?d.join(" "):d.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:ud,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(e){return new i(e.op,e.fn,e.args,e.implicit,e.isPercentage)}toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,s=n(this,t,r,i,!1);if(1===i.length){var o=ed(this,t),a=i[0].toHTML(e);return s[0]&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===o?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+Ec(this.op)+"</span>"+a:a+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+Ec(this.op)+"</span>"}if(2===i.length){var l=i[0].toHTML(e),u=i[1].toHTML(e);return s[0]&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),s[1]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?l+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+u:l+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Ec(this.op)+"</span>"+u}var c=i.map((function(t,r){return t=t.toHTML(e),s[r]&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t}));return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?c.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):c.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Ec(this.op)+"</span>"):'<span class="math-function">'+Ec(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,s=n(this,t,r,i,!0),o=id[this.fn];if(o=void 0===o?this.op:o,1===i.length){var a=ed(this,t),l=i[0].toTex(e);return s[0]&&(l="\\left(".concat(l,"\\right)")),"right"===a?o+l:l+o}if(2===i.length){var u=i[0],c=u.toTex(e);s[0]&&(c="\\left(".concat(c,"\\right)"));var d,h=i[1].toTex(e);switch(s[1]&&(h="\\left(".concat(h,"\\right)")),d="keep"===t?u.getIdentifier():u.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return o+"{"+c+"}{"+h+"}";case"OperatorNode:pow":switch(c="{"+c+"}",h="{"+h+"}",d){case"ConditionalNode":case"OperatorNode:divide":c="\\left(".concat(c,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===r)return c+"~"+h}return c+o+h}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var f=i.map((function(t,r){return t=t.toTex(e),s[r]&&(t="\\left(".concat(t,"\\right)")),t}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===r?f.join("~"):f.join(o)}return"\\mathrm{"+this.fn+"}\\left("+i.map((function(t){return t.toTex(e)})).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return Wu(i,"name",ud),i}),{isClass:!0,isNode:!0}),dd="ParenthesisNode",hd=Mu(dd,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),!gu(e))throw new TypeError('Node expected for parameter "content"');this.content=e}get type(){return dd}get isParenthesisNode(){return!0}_compile(e,t){return this.content._compile(e,t)}getContent(){return this.content.getContent()}forEach(e){e(this.content,"content",this)}map(e){var t=e(this.content,"content",this);return new r(t)}clone(){return new r(this.content)}_toString(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)}toJSON(){return{mathjs:dd,content:this.content}}static fromJSON(e){return new r(e.content)}toHTML(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(e)}_toTex(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left(".concat(this.content.toTex(e),"\\right)"):this.content.toTex(e)}}return Wu(r,"name",dd),r}),{isClass:!0,isNode:!0}),fd="RelationalNode",pd=Mu(fd,["Node"],(e=>{var{Node:t}=e,r={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class n extends t{constructor(e,t){if(super(),!Array.isArray(e))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(t))throw new TypeError("Parameter params must be an array");if(e.length!==t.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=e,this.params=t}get type(){return fd}get isRelationalNode(){return!0}_compile(e,t){var r=this,n=this.params.map((r=>r._compile(e,t)));return function(t,i,s){for(var o,a=n[0](t,i,s),l=0;l<r.conditionals.length;l++){if(o=a,a=n[l+1](t,i,s),!_u(e,r.conditionals[l])(o,a))return!1}return!0}}forEach(e){this.params.forEach(((t,r)=>e(t,"params["+r+"]",this)),this)}map(e){return new n(this.conditionals.slice(),this.params.map(((t,r)=>this._ifNode(e(t,"params["+r+"]",this))),this))}clone(){return new n(this.conditionals,this.params)}_toString(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=Qc(this,t,e&&e.implicit),i=this.params.map((function(r,i){var s=Qc(r,t,e&&e.implicit);return"all"===t||null!==s&&s<=n?"("+r.toString(e)+")":r.toString(e)})),s=i[0],o=0;o<this.conditionals.length;o++)s+=" "+r[this.conditionals[o]],s+=" "+i[o+1];return s}toJSON(){return{mathjs:fd,conditionals:this.conditionals,params:this.params}}static fromJSON(e){return new n(e.conditionals,e.params)}toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=Qc(this,t,e&&e.implicit),i=this.params.map((function(r,i){var s=Qc(r,t,e&&e.implicit);return"all"===t||null!==s&&s<=n?'<span class="math-parenthesis math-round-parenthesis">(</span>'+r.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':r.toHTML(e)})),s=i[0],o=0;o<this.conditionals.length;o++)s+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Ec(r[this.conditionals[o]])+"</span>"+i[o+1];return s}_toTex(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=Qc(this,t,e&&e.implicit),n=this.params.map((function(n,i){var s=Qc(n,t,e&&e.implicit);return"all"===t||null!==s&&s<=r?"\\left("+n.toTex(e)+"\right)":n.toTex(e)})),i=n[0],s=0;s<this.conditionals.length;s++)i+=id[this.conditionals[s]]+n[s+1];return i}}return Wu(n,"name",fd),n}),{isClass:!0,isNode:!0}),md="ArrayNode",gd=Mu(md,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),this.items=e||[],!Array.isArray(this.items)||!this.items.every(gu))throw new TypeError("Array containing Nodes expected")}get type(){return md}get isArrayNode(){return!0}_compile(e,t){var r=qc(this.items,(function(r){return r._compile(e,t)}));if("Array"!==e.config.matrix){var n=e.matrix;return function(e,t,i){return n(qc(r,(function(r){return r(e,t,i)})))}}return function(e,t,n){return qc(r,(function(r){return r(e,t,n)}))}}forEach(e){for(var t=0;t<this.items.length;t++){e(this.items[t],"items["+t+"]",this)}}map(e){for(var t=[],n=0;n<this.items.length;n++)t[n]=this._ifNode(e(this.items[n],"items["+n+"]",this));return new r(t)}clone(){return new r(this.items.slice(0))}_toString(e){return"["+this.items.map((function(t){return t.toString(e)})).join(", ")+"]"}toJSON(){return{mathjs:md,items:this.items}}static fromJSON(e){return new r(e.items)}toHTML(e){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(t){return t.toHTML(e)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){return function t(r,n){var i=r.some(au)&&!r.every(au),s=n||i,o=s?"&":"\\\\",a=r.map((function(r){return r.items?t(r.items,!n):r.toTex(e)})).join(o);return i||!s||s&&!n?"\\begin{bmatrix}"+a+"\\end{bmatrix}":a}(this.items,!1)}}return Wu(r,"name",md),r}),{isClass:!0,isNode:!0}),yd="BlockNode",vd=Mu(yd,["ResultSet","Node"],(e=>{var{ResultSet:t,Node:r}=e;class n extends r{constructor(e){if(super(),!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map((function(e){var t=e&&e.node,r=!e||void 0===e.visible||e.visible;if(!gu(t))throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof r)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:r}}))}get type(){return yd}get isBlockNode(){return!0}_compile(e,r){var n=qc(this.blocks,(function(t){return{evaluate:t.node._compile(e,r),visible:t.visible}}));return function(e,r,i){var s=[];return Hc(n,(function(t){var n=t.evaluate(e,r,i);t.visible&&s.push(n)})),new t(s)}}forEach(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)}map(e){for(var t=[],r=0;r<this.blocks.length;r++){var i=this.blocks[r],s=this._ifNode(e(i.node,"blocks["+r+"].node",this));t[r]={node:s,visible:i.visible}}return new n(t)}clone(){var e=this.blocks.map((function(e){return{node:e.node,visible:e.visible}}));return new n(e)}_toString(e){return this.blocks.map((function(t){return t.node.toString(e)+(t.visible?"":";")})).join("\n")}toJSON(){return{mathjs:yd,blocks:this.blocks}}static fromJSON(e){return new n(e.blocks)}toHTML(e){return this.blocks.map((function(t){return t.node.toHTML(e)+(t.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')}_toTex(e){return this.blocks.map((function(t){return t.node.toTex(e)+(t.visible?"":";")})).join("\\;\\;\n")}}return Wu(n,"name",yd),n}),{isClass:!0,isNode:!0}),bd="ConditionalNode",xd=Mu(bd,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e,t,r){if(super(),!gu(e))throw new TypeError("Parameter condition must be a Node");if(!gu(t))throw new TypeError("Parameter trueExpr must be a Node");if(!gu(r))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=r}get type(){return bd}get isConditionalNode(){return!0}_compile(e,t){var r=this.condition._compile(e,t),n=this.trueExpr._compile(e,t),i=this.falseExpr._compile(e,t);return function(e,t,s){return function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(Ul(e))return!e.isZero();if($l(e))return!(!e.re&&!e.im);if(zl(e))return!!e.value}if(null==e)return!1;throw new TypeError('Unsupported type of condition "'+Tu(e)+'"')}(r(e,t,s))?n(e,t,s):i(e,t,s)}}forEach(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)}map(e){return new r(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))}clone(){return new r(this.condition,this.trueExpr,this.falseExpr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=Qc(this,t,e&&e.implicit),n=this.condition.toString(e),i=Qc(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=r)&&(n="("+n+")");var s=this.trueExpr.toString(e),o=Qc(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=r)&&(s="("+s+")");var a=this.falseExpr.toString(e),l=Qc(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=r)&&(a="("+a+")"),n+" ? "+s+" : "+a}toJSON(){return{mathjs:bd,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(e){return new r(e.condition,e.trueExpr,e.falseExpr)}toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=Qc(this,t,e&&e.implicit),n=this.condition.toHTML(e),i=Qc(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=r)&&(n='<span class="math-parenthesis math-round-parenthesis">(</span>'+n+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.trueExpr.toHTML(e),o=Qc(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=r)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>');var a=this.falseExpr.toHTML(e),l=Qc(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=r)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),n+'<span class="math-operator math-conditional-operator">?</span>'+s+'<span class="math-operator math-conditional-operator">:</span>'+a}_toTex(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return Wu(r,"name",bd),r}),{isClass:!0,isNode:!0}),wd="ConstantNode",Ed=Mu(wd,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){super(),this.value=e}get type(){return wd}get isConstantNode(){return!0}_compile(e,t){var r=this.value;return function(){return r}}forEach(e){}map(e){return this.clone()}clone(){return new r(this.value)}_toString(e){return xc(this.value,e)}toHTML(e){var t=this._toString(e);switch(Tu(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+t+"</span>";case"string":return'<span class="math-string">'+t+"</span>";case"boolean":return'<span class="math-boolean">'+t+"</span>";case"null":return'<span class="math-null-symbol">'+t+"</span>";case"undefined":return'<span class="math-undefined">'+t+"</span>";default:return'<span class="math-symbol">'+t+"</span>"}}toJSON(){return{mathjs:wd,value:this.value}}static fromJSON(e){return new r(e.value)}_toTex(e){var t=this._toString(e);switch(Tu(this.value)){case"string":return"\\mathtt{"+ad(t)+"}";case"number":case"BigNumber":if(!isFinite(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var r=t.toLowerCase().indexOf("e");return-1!==r?t.substring(0,r)+"\\cdot10^{"+t.substring(r+1)+"}":t;case"Fraction":return this.value.toLatex();default:return t}}}return Wu(r,"name",wd),r}),{isClass:!0,isNode:!0}),Sd="RangeNode",Td=Mu(Sd,["Node"],(e=>{var{Node:t}=e;function r(e,t,r){var n=Qc(e,t,r),i={},s=Qc(e.start,t,r);if(i.start=null!==s&&s<=n||"all"===t,e.step){var o=Qc(e.step,t,r);i.step=null!==o&&o<=n||"all"===t}var a=Qc(e.end,t,r);return i.end=null!==a&&a<=n||"all"===t,i}class n extends t{constructor(e,t,r){if(super(),!gu(e))throw new TypeError("Node expected");if(!gu(t))throw new TypeError("Node expected");if(r&&!gu(r))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=r||null}get type(){return Sd}get isRangeNode(){return!0}needsEnd(){return this.filter((function(e){return Eu(e)&&"end"===e.name})).length>0}_compile(e,t){var r=e.range,n=this.start._compile(e,t),i=this.end._compile(e,t);if(this.step){var s=this.step._compile(e,t);return function(e,t,o){return r(n(e,t,o),i(e,t,o),s(e,t,o))}}return function(e,t,s){return r(n(e,t,s),i(e,t,s))}}forEach(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)}map(e){return new n(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))}clone(){return new n(this.start,this.end,this.step&&this.step)}_toString(e){var t,n=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toString(e);if(n.start&&(i="("+i+")"),t=i,this.step){var s=this.step.toString(e);n.step&&(s="("+s+")"),t+=":"+s}var o=this.end.toString(e);return n.end&&(o="("+o+")"),t+=":"+o}toJSON(){return{mathjs:Sd,start:this.start,end:this.end,step:this.step}}static fromJSON(e){return new n(e.start,e.end,e.step)}toHTML(e){var t,n=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toHTML(e);if(n.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=i,this.step){var s=this.step.toHTML(e);n.step&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+s}var o=this.end.toHTML(e);return n.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+o}_toTex(e){var t=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),n=this.start.toTex(e);if(t.start&&(n="\\left(".concat(n,"\\right)")),this.step){var i=this.step.toTex(e);t.step&&(i="\\left(".concat(i,"\\right)")),n+=":"+i}var s=this.end.toTex(e);return t.end&&(s="\\left(".concat(s,"\\right)")),n+=":"+s}}return Wu(n,"name",Sd),n}),{isClass:!0,isNode:!0}),Ad=Mu("reviver",["classes"],(e=>{var{classes:t}=e;return function(e,r){var n=t[r&&r.mathjs];return n&&"function"==typeof n.fromJSON?n.fromJSON(r):r}})),Dd=Mu("Chain",["?on","math","typed"],(e=>{var{on:t,math:r,typed:n}=e;function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");Su(e)?this.value=e.value:this.value=e}function s(e,t){var r,n,s,a,l;r=i.prototype,n=e,s=function(){var e=t();if("function"==typeof e)return o(e)},l=!0,Object.defineProperty(r,n,{get:function(){return l&&(a=s(),l=!1),a},set:function(e){a=e,l=!1},configurable:!0,enumerable:!0})}function o(e){return function(){if(0===arguments.length)return new i(e(this.value));for(var t=[this.value],r=0;r<arguments.length;r++)t[r+1]=arguments[r];if(n.isTypedFunction(e)){var s=n.resolve(e,t);if(1===s.params.length)throw new Error("chain function "+e.name+" cannot match rest parameter between chain value and additional arguments.");return new i(s.implementation.apply(e,t))}return new i(e.apply(e,t))}}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return xc(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(e){return new i(e.value)},i.createProxy=function(e,t){if("string"==typeof e)l=e,"function"==typeof(u=t)&&(i.prototype[l]=o(u));else{var r=function(t){ku(e,t)&&void 0===a[t]&&s(t,(()=>e[t]))};for(var n in e)r(n)}var l,u};var a={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(r),t&&t("import",(function(e,t,r){r||s(e,t)})),i}),{isClass:!0}),Nd="FunctionAssignmentNode",Cd=Mu(Nd,["typed","Node"],(e=>{var{typed:t,Node:r}=e;function n(e,t,r){var n=Qc(e,t,r),i=Qc(e.expr,t,r);return"all"===t||null!==i&&i<=n}class i extends r{constructor(e,t,r){if(super(),"string"!=typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!gu(r))throw new TypeError('Node expected for parameter "expr"');if(Au.has(e))throw new Error('Illegal function name, "'+e+'" is a reserved keyword');var n=new Set;for(var i of t){var s="string"==typeof i?i:i.name;if(n.has(s))throw new Error('Duplicate parameter name "'.concat(s,'"'));n.add(s)}this.name=e,this.params=t.map((function(e){return e&&e.name||e})),this.types=t.map((function(e){return e&&e.type||"any"})),this.expr=r}get type(){return Nd}get isFunctionAssignmentNode(){return!0}_compile(e,r){var n=Object.create(r);Hc(this.params,(function(e){n[e]=!0}));var i=this.expr._compile(e,n),s=this.name,o=this.params,a=Wc(this.types,","),l=s+"("+Wc(this.params,", ")+")";return function(e,r,n){var u={};u[a]=function(){for(var t=Object.create(r),s=0;s<o.length;s++)t[o[s]]=arguments[s];return i(e,t,n)};var c=t(s,u);return c.syntax=l,e.set(s,c),c}}forEach(e){e(this.expr,"expr",this)}map(e){var t=this._ifNode(e(this.expr,"expr",this));return new i(this.name,this.params.slice(0),t)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=this.expr.toString(e);return n(this,t,e&&e.implicit)&&(r="("+r+")"),this.name+"("+this.params.join(", ")+") = "+r}toJSON(){var e=this.types;return{mathjs:Nd,name:this.name,params:this.params.map((function(t,r){return{name:t,type:e[r]}})),expr:this.expr}}static fromJSON(e){return new i(e.name,e.params,e.expr)}toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=[],i=0;i<this.params.length;i++)r.push('<span class="math-symbol math-parameter">'+Ec(this.params[i])+"</span>");var s=this.expr.toHTML(e);return n(this,t,e&&e.implicit)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+Ec(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+r.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+s}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=this.expr.toTex(e);return n(this,t,e&&e.implicit)&&(r="\\left(".concat(r,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(ld).join(",")+"\\right):="+r}}return Wu(i,"name",Nd),i}),{isClass:!0,isNode:!0}),kd="chain",Md=Mu(kd,["typed","Chain"],(e=>{var{typed:t,Chain:r}=e;return t(kd,{"":function(){return new r},any:function(e){return new r(e)}})}));function Od(e){return e&&e.isIndexError?new Cc(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}function _d(e){var{subset:t}=e;return function(e,r){try{if(Array.isArray(e))return t(e,r);if(e&&"function"==typeof e.subset)return e.subset(r);if("string"==typeof e)return t(e,r);if("object"==typeof e){if(!r.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return _u(e,r.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw Od(e)}}}var Ld="AccessorNode",Rd=Mu(Ld,["subset","Node"],(e=>{var{subset:t,Node:r}=e,n=_d({subset:t});function i(e){return!(ou(e)||au(e)||du(e)||pu(e)||yu(e)||bu(e)||Eu(e))}class s extends r{constructor(e,t){if(super(),!gu(e))throw new TypeError('Node expected for parameter "object"');if(!mu(t))throw new TypeError('IndexNode expected for parameter "index"');this.object=e,this.index=t}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Ld}get isAccessorNode(){return!0}_compile(e,t){var r=this.object._compile(e,t),i=this.index._compile(e,t);if(this.index.isObjectProperty()){var s=this.index.getObjectProperty();return function(e,t,n){return _u(r(e,t,n),s)}}return function(e,t,s){var o=r(e,t,s),a=i(e,t,o);return n(o,a)}}forEach(e){e(this.object,"object",this),e(this.index,"index",this)}map(e){return new s(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))}clone(){return new s(this.object,this.index)}_toString(e){var t=this.object.toString(e);return i(this.object)&&(t="("+t+")"),t+this.index.toString(e)}toHTML(e){var t=this.object.toHTML(e);return i(this.object)&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+this.index.toHTML(e)}_toTex(e){var t=this.object.toTex(e);return i(this.object)&&(t="\\left(' + object + '\\right)"),t+this.index.toTex(e)}toJSON(){return{mathjs:Ld,object:this.object,index:this.index}}static fromJSON(e){return new s(e.object,e.index)}}return Wu(s,"name",Ld),s}),{isClass:!0,isNode:!0}),Id="IndexNode",Fd=Mu(Id,["Node","size"],(e=>{var{Node:t,size:r}=e;class n extends t{constructor(e,t){if(super(),this.dimensions=e,this.dotNotation=t||!1,!Array.isArray(e)||!e.every(gu))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return Id}get isIndexNode(){return!0}_compile(e,t){var n=qc(this.dimensions,(function(n,i){if(n.filter((e=>e.isSymbolNode&&"end"===e.name)).length>0){var s=Object.create(t);s.end=!0;var o=n._compile(e,s);return function(e,t,n){if(!Vl(n)&&!Hl(n)&&!ql(n))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+Tu(n));var s=r(n).valueOf(),a=Object.create(t);return a.end=s[i],o(e,a,n)}}return n._compile(e,t)})),i=_u(e,"index");return function(e,t,r){var s=qc(n,(function(n){return n(e,t,r)}));return i(...s)}}forEach(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)}map(e){for(var t=[],r=0;r<this.dimensions.length;r++)t[r]=this._ifNode(e(this.dimensions[r],"dimensions["+r+"]",this));return new n(t,this.dotNotation)}clone(){return new n(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return 1===this.dimensions.length&&du(this.dimensions[0])&&"string"==typeof this.dimensions[0].value}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:Id,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(e){return new n(e.dimensions,e.dotNotation)}toHTML(e){for(var t=[],r=0;r<this.dimensions.length;r++)t[r]=this.dimensions[r].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+Ec(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){var t=this.dimensions.map((function(t){return t.toTex(e)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"}}return Wu(n,"name",Id),n}),{isClass:!0,isNode:!0});var Pd="AssignmentNode",Bd=Mu(Pd,["subset","?matrix","Node"],(e=>{var{subset:t,matrix:r,Node:n}=e,i=_d({subset:t}),s=function(e){var{subset:t,matrix:r}=e;return function(e,n,i){try{if(Array.isArray(e))return r(e).subset(n,i).valueOf();if(e&&"function"==typeof e.subset)return e.subset(n,i);if("string"==typeof e)return t(e,n,i);if("object"==typeof e){if(!n.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return Lu(e,n.getObjectProperty(),i),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw Od(e)}}}({subset:t,matrix:r});function o(e,t,r){t||(t="keep");var n=Qc(e,t,r),i=Qc(e.value,t,r);return"all"===t||null!==i&&i<=n}class a extends n{constructor(e,t,r){if(super(),this.object=e,this.index=r?t:null,this.value=r||t,!Eu(e)&&!ou(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(Eu(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!mu(this.index))throw new TypeError('IndexNode expected as "index"');if(!gu(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Pd}get isAssignmentNode(){return!0}_compile(e,t){var r=this.object._compile(e,t),n=this.index?this.index._compile(e,t):null,o=this.value._compile(e,t),a=this.object.name;if(this.index){if(this.index.isObjectProperty()){var l=this.index.getObjectProperty();return function(e,t,n){var i=r(e,t,n),s=o(e,t,n);return Lu(i,l,s),s}}if(Eu(this.object))return function(e,t,i){var l=r(e,t,i),u=o(e,t,i),c=n(e,t,l);return e.set(a,s(l,c,u)),u};var u=this.object.object._compile(e,t);if(this.object.index.isObjectProperty()){var c=this.object.index.getObjectProperty();return function(e,t,r){var i=u(e,t,r),a=_u(i,c),l=n(e,t,a),d=o(e,t,r);return Lu(i,c,s(a,l,d)),d}}var d=this.object.index._compile(e,t);return function(e,t,r){var a=u(e,t,r),l=d(e,t,a),c=i(a,l),h=n(e,t,c),f=o(e,t,r);return s(a,l,s(c,h,f)),f}}if(!Eu(this.object))throw new TypeError("SymbolNode expected as object");return function(e,t,r){var n=o(e,t,r);return e.set(a,n),n}}forEach(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)}map(e){var t=this._ifNode(e(this.object,"object",this)),r=this.index?this._ifNode(e(this.index,"index",this)):null,n=this._ifNode(e(this.value,"value",this));return new a(t,r,n)}clone(){return new a(this.object,this.index,this.value)}_toString(e){var t=this.object.toString(e),r=this.index?this.index.toString(e):"",n=this.value.toString(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n="("+n+")"),t+r+" = "+n}toJSON(){return{mathjs:Pd,object:this.object,index:this.index,value:this.value}}static fromJSON(e){return new a(e.object,e.index,e.value)}toHTML(e){var t=this.object.toHTML(e),r=this.index?this.index.toHTML(e):"",n=this.value.toHTML(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n='<span class="math-paranthesis math-round-parenthesis">(</span>'+n+'<span class="math-paranthesis math-round-parenthesis">)</span>'),t+r+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+n}_toTex(e){var t=this.object.toTex(e),r=this.index?this.index.toTex(e):"",n=this.value.toTex(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n="\\left(".concat(n,"\\right)")),t+r+":="+n}}return Wu(a,"name",Pd),a}),{isClass:!0,isNode:!0}),Ud=Mu("SymbolNode",["math","?Unit","Node"],(e=>{var{math:t,Unit:r,Node:n}=e;function i(e){return!!r&&r.isValuelessUnit(e)}class s extends n{constructor(e){if(super(),"string"!=typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(e,t){var n=this.name;if(!0===t[n])return function(e,t,r){return _u(t,n)};if(n in e)return function(t,r,i){return t.has(n)?t.get(n):_u(e,n)};var o=i(n);return function(e,t,i){return e.has(n)?e.get(n):o?new r(null,n):s.onUndefinedSymbol(n)}}forEach(e){}map(e){return this.clone()}static onUndefinedSymbol(e){throw new Error("Undefined symbol "+e)}clone(){return new s(this.name)}_toString(e){return this.name}toHTML(e){var t=Ec(this.name);return"true"===t||"false"===t?'<span class="math-symbol math-boolean">'+t+"</span>":"i"===t?'<span class="math-symbol math-imaginary-symbol">'+t+"</span>":"Infinity"===t?'<span class="math-symbol math-infinity-symbol">'+t+"</span>":"NaN"===t?'<span class="math-symbol math-nan-symbol">'+t+"</span>":"null"===t?'<span class="math-symbol math-null-symbol">'+t+"</span>":"undefined"===t?'<span class="math-symbol math-undefined-symbol">'+t+"</span>":'<span class="math-symbol">'+t+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(e){return new s(e.name)}_toTex(e){var r=!1;void 0===t[this.name]&&i(this.name)&&(r=!0);var n=ld(this.name,r);return"\\"===n[0]?n:" "+n}}return s}),{isClass:!0,isNode:!0});function $d(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"function"==typeof e.createSubScope?qu(e.createSubScope(),...r):qu($u(),e,...r)}var jd="FunctionNode",zd=Mu(jd,["math","Node","SymbolNode"],(e=>{var{math:t,Node:r,SymbolNode:n}=e,i=e=>xc(e,{truncate:78});function s(e,t,r){for(var n,i="",s=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,o=0;null!==(n=s.exec(e));)if(i+=e.substring(o,n.index),o=n.index,"$$"===n[0])i+="$",o++;else{o+=n[0].length;var a=t[n[1]];if(!a)throw new ReferenceError("Template: Property "+n[1]+" does not exist.");if(void 0===n[2])switch(typeof a){case"string":i+=a;break;case"object":if(gu(a))i+=a.toTex(r);else{if(!Array.isArray(a))throw new TypeError("Template: "+n[1]+" has to be a Node, String or array of Nodes");i+=a.map((function(e,t){if(gu(e))return e.toTex(r);throw new TypeError("Template: "+n[1]+"["+t+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+n[1]+" has to be a Node, String or array of Nodes")}else{if(!gu(a[n[2]]&&a[n[2]]))throw new TypeError("Template: "+n[1]+"["+n[2]+"] is not a Node.");i+=a[n[2]].toTex(r)}}return i+=e.slice(o)}class o extends r{constructor(e,t){if(super(),"string"==typeof e&&(e=new n(e)),!gu(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(gu))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[]}get name(){return this.fn.name||""}get type(){return jd}get isFunctionNode(){return!0}_compile(e,t){var r=this.args.map((r=>r._compile(e,t)));if(!Eu(this.fn)){if(ou(this.fn)&&mu(this.fn.index)&&this.fn.index.isObjectProperty()){var n=this.fn.object._compile(e,t),s=this.fn.index.getObjectProperty(),a=this.args;return function(t,i,o){var l=n(t,i,o),u=function(e,t){if(!Iu(e,t))throw new Error('No access to method "'+t+'"');return e[t]}(l,s);if(null!=u&&u.rawArgs)return u(a,e,$d(t,i),t);var c=r.map((e=>e(t,i,o)));return u.apply(l,c)}}var l=this.fn.toString(),u=this.fn._compile(e,t),c=this.args;return function(t,n,s){var o=u(t,n,s);if("function"!=typeof o)throw new TypeError("Expression '".concat(l,"' did not evaluate to a function; value is:")+"\n  ".concat(i(o)));if(o.rawArgs)return o(c,e,$d(t,n),t);var a=r.map((e=>e(t,n,s)));return o.apply(o,a)}}var d=this.fn.name;if(t[d]){var h=this.args;return function(t,n,s){var o=_u(n,d);if("function"!=typeof o)throw new TypeError("Argument '".concat(d,"' was not a function; received: ").concat(i(o)));if(o.rawArgs)return o(h,e,$d(t,n),t);var a=r.map((e=>e(t,n,s)));return o.apply(o,a)}}var f=d in e?_u(e,d):void 0,p="function"==typeof f&&!0===f.rawArgs,m=t=>{var r;if(t.has(d))r=t.get(d);else{if(!(d in e))return o.onUndefinedFunction(d);r=_u(e,d)}if("function"==typeof r)return r;throw new TypeError("'".concat(d,"' is not a function; its value is:\n  ").concat(i(r)))};if(p){var g=this.args;return function(t,r,n){return m(t)(g,e,$d(t,r),t)}}switch(r.length){case 0:return function(e,t,r){return m(e)()};case 1:return function(e,t,n){return m(e)((0,r[0])(e,t,n))};case 2:return function(e,t,n){var i=m(e),s=r[0],o=r[1];return i(s(e,t,n),o(e,t,n))};default:return function(e,t,n){return m(e)(...r.map((r=>r(e,t,n))))}}}forEach(e){e(this.fn,"fn",this);for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=this._ifNode(e(this.fn,"fn",this)),r=[],n=0;n<this.args.length;n++)r[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new o(t,r)}clone(){return new o(this.fn,this.args.slice(0))}toString(e){var t,r=this.fn.toString(e);return e&&"object"==typeof e.handler&&ku(e.handler,r)&&(t=e.handler[r](this,e)),void 0!==t?t:super.toString(e)}_toString(e){var t=this.args.map((function(t){return t.toString(e)}));return(fu(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+t.join(", ")+")"}toJSON(){return{mathjs:jd,fn:this.fn,args:this.args}}toHTML(e){var t=this.args.map((function(t){return t.toHTML(e)}));return'<span class="math-function">'+Ec(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(e){var t;return e&&"object"==typeof e.handler&&ku(e.handler,this.name)&&(t=e.handler[this.name](this,e)),void 0!==t?t:super.toTex(e)}_toTex(e){var r,n,i=this.args.map((function(t){return t.toTex(e)}));switch(sd[this.name]&&(r=sd[this.name]),!t[this.name]||"function"!=typeof t[this.name].toTex&&"object"!=typeof t[this.name].toTex&&"string"!=typeof t[this.name].toTex||(r=t[this.name].toTex),typeof r){case"function":n=r(this,e);break;case"string":n=s(r,this,e);break;case"object":switch(typeof r[i.length]){case"function":n=r[i.length](this,e);break;case"string":n=s(r[i.length],this,e)}}return void 0!==n?n:s("\\mathrm{${name}}\\left(${args}\\right)",this,e)}getIdentifier(){return this.type+":"+this.name}}return Wu(o,"name",jd),Wu(o,"onUndefinedFunction",(function(e){throw new Error("Undefined function "+e)})),Wu(o,"fromJSON",(function(e){return new o(e.fn,e.args)})),o}),{isClass:!0,isNode:!0});function qd(e){var t,r,n=e.length,i=e[0].length,s=[];for(r=0;r<i;r++){var o=[];for(t=0;t<n;t++)o.push(e[t][r]);s.push(o)}return s}function Hd(e){for(var t=0;t<e.length;t++)if(Gl(e[t]))return!0;return!1}function Vd(e,t){Vl(e)&&(e=e.valueOf());for(var r=0,n=e.length;r<n;r++){var i=e[r];Array.isArray(i)?Vd(i,t):t(i)}}function Gd(e,t,r){return e&&"function"==typeof e.map?e.map((function(e){return Gd(e,t,r)})):t(e)}function Wd(e,t,r){var n=Array.isArray(e)?kc(e):e.size();if(t<0||t>=n.length)throw new Cc(t,n.length);return Vl(e)?e.create(Kd(e.valueOf(),t,r)):Kd(e,t,r)}function Kd(e,t,r){var n,i,s,o;if(t<=0){if(Array.isArray(e[0])){for(o=qd(e),i=[],n=0;n<o.length;n++)i[n]=Kd(o[n],t-1,r);return i}for(s=e[0],n=1;n<e.length;n++)s=r(s,e[n]);return s}for(i=[],n=0;n<e.length;n++)i[n]=Kd(e[n],t-1,r);return i}function Yd(e,t,r,n,i,s,o,a,l,u,c){var d,h,f,p,m=e._values,g=e._index,y=e._ptr;if(n)for(h=y[t],f=y[t+1],d=h;d<f;d++)r[p=g[d]]!==s?(r[p]=s,o.push(p),u?(n[p]=l?a(m[d],c):a(c,m[d]),i[p]=s):n[p]=m[d]):(n[p]=l?a(m[d],n[p]):a(n[p],m[d]),i[p]=s);else for(h=y[t],f=y[t+1],d=h;d<f;d++)r[p=g[d]]!==s?(r[p]=s,o.push(p)):i[p]=s}var Jd="parse",Zd=Mu(Jd,["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(e=>{var{typed:t,numeric:r,config:n,AccessorNode:i,ArrayNode:s,AssignmentNode:o,BlockNode:a,ConditionalNode:l,ConstantNode:u,FunctionAssignmentNode:c,FunctionNode:d,IndexNode:h,ObjectNode:f,OperatorNode:p,ParenthesisNode:m,RangeNode:g,RelationalNode:y,SymbolNode:v}=e,b=t(Jd,{string:function(e){return I(e,{})},"Array | Matrix":function(e){return x(e,{})},"string, Object":function(e,t){return I(e,void 0!==t.nodes?t.nodes:{})},"Array | Matrix, Object":x});function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0!==t.nodes?t.nodes:{};return Gd(e,(function(e){if("string"!=typeof e)throw new TypeError("String expected");return I(e,r)}))}var w={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},E={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},S={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},T={true:!0,false:!1,null:null,undefined:void 0},A=["NaN","Infinity"];function D(e,t){return e.expression.substr(e.index,t)}function N(e){return D(e,1)}function C(e){e.index++}function k(e){return e.expression.charAt(e.index-1)}function M(e){return e.expression.charAt(e.index+1)}function O(e){for(e.tokenType=w.NULL,e.token="",e.comment="";;){if("#"===N(e))for(;"\n"!==N(e)&&""!==N(e);)e.comment+=N(e),C(e);if(!b.isWhitespace(N(e),e.nestingLevel))break;C(e)}if(""!==N(e)){if("\n"===N(e)&&!e.nestingLevel)return e.tokenType=w.DELIMITER,e.token=N(e),void C(e);var t=N(e),r=D(e,2),n=D(e,3);if(3===n.length&&E[n])return e.tokenType=w.DELIMITER,e.token=n,C(e),C(e),void C(e);if(2===r.length&&E[r])return e.tokenType=w.DELIMITER,e.token=r,C(e),void C(e);if(E[t])return e.tokenType=w.DELIMITER,e.token=t,void C(e);if(b.isDigitDot(t)){e.tokenType=w.NUMBER;var i=D(e,2);if("0b"===i||"0o"===i||"0x"===i){for(e.token+=N(e),C(e),e.token+=N(e),C(e);b.isHexDigit(N(e));)e.token+=N(e),C(e);if("."===N(e))for(e.token+=".",C(e);b.isHexDigit(N(e));)e.token+=N(e),C(e);else if("i"===N(e))for(e.token+="i",C(e);b.isDigit(N(e));)e.token+=N(e),C(e);return}if("."===N(e)){if(e.token+=N(e),C(e),!b.isDigit(N(e)))return void(e.tokenType=w.DELIMITER)}else{for(;b.isDigit(N(e));)e.token+=N(e),C(e);b.isDecimalMark(N(e),M(e))&&(e.token+=N(e),C(e))}for(;b.isDigit(N(e));)e.token+=N(e),C(e);if("E"===N(e)||"e"===N(e))if(b.isDigit(M(e))||"-"===M(e)||"+"===M(e)){if(e.token+=N(e),C(e),"+"!==N(e)&&"-"!==N(e)||(e.token+=N(e),C(e)),!b.isDigit(N(e)))throw ne(e,'Digit expected, got "'+N(e)+'"');for(;b.isDigit(N(e));)e.token+=N(e),C(e);if(b.isDecimalMark(N(e),M(e)))throw ne(e,'Digit expected, got "'+N(e)+'"')}else if("."===M(e))throw C(e),ne(e,'Digit expected, got "'+N(e)+'"')}else{if(!b.isAlpha(N(e),k(e),M(e))){for(e.tokenType=w.UNKNOWN;""!==N(e);)e.token+=N(e),C(e);throw ne(e,'Syntax error in part "'+e.token+'"')}for(;b.isAlpha(N(e),k(e),M(e))||b.isDigit(N(e));)e.token+=N(e),C(e);ku(S,e.token)?e.tokenType=w.DELIMITER:e.tokenType=w.SYMBOL}}else e.tokenType=w.DELIMITER}function _(e){do{O(e)}while("\n"===e.token)}function L(e){e.nestingLevel++}function R(e){e.nestingLevel--}function I(e,t){var r={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:w.NULL,nestingLevel:0,conditionalLevel:null};Ll(r,{expression:e,extraNodes:t}),O(r);var n=function(e){var t,r,n=[];""!==e.token&&"\n"!==e.token&&";"!==e.token&&(t=F(e),e.comment&&(t.comment=e.comment));for(;"\n"===e.token||";"===e.token;)0===n.length&&t&&(r=";"!==e.token,n.push({node:t,visible:r})),O(e),"\n"!==e.token&&";"!==e.token&&""!==e.token&&(t=F(e),e.comment&&(t.comment=e.comment),r=";"!==e.token,n.push({node:t,visible:r}));return n.length>0?new a(n):(t||(t=new u(void 0),e.comment&&(t.comment=e.comment)),t)}(r);if(""!==r.token)throw r.tokenType===w.DELIMITER?ie(r,"Unexpected operator "+r.token):ne(r,'Unexpected part "'+r.token+'"');return n}function F(e){var t,r,n,i,s=function(e){var t=function(e){var t=P(e);for(;"or"===e.token;)_(e),t=new p("or","or",[t,P(e)]);return t}(e);for(;"?"===e.token;){var r=e.conditionalLevel;e.conditionalLevel=e.nestingLevel,_(e);var n=t,i=F(e);if(":"!==e.token)throw ne(e,"False part of conditional expression expected");e.conditionalLevel=null,_(e);var s=F(e);t=new l(n,i,s),e.conditionalLevel=r}return t}(e);if("="===e.token){if(Eu(s))return t=s.name,_(e),n=F(e),new o(new v(t),n);if(ou(s))return _(e),n=F(e),new o(s.object,s.index,n);if(pu(s)&&Eu(s.fn)&&(i=!0,r=[],t=s.name,s.args.forEach((function(e,t){Eu(e)?r[t]=e.name:i=!1})),i))return _(e),n=F(e),new c(t,r,n);throw ne(e,"Invalid left hand side of assignment operator =")}return s}function P(e){for(var t=B(e);"xor"===e.token;)_(e),t=new p("xor","xor",[t,B(e)]);return t}function B(e){for(var t=U(e);"and"===e.token;)_(e),t=new p("and","and",[t,U(e)]);return t}function U(e){for(var t=$(e);"|"===e.token;)_(e),t=new p("|","bitOr",[t,$(e)]);return t}function $(e){for(var t=j(e);"^|"===e.token;)_(e),t=new p("^|","bitXor",[t,j(e)]);return t}function j(e){for(var t=z(e);"&"===e.token;)_(e),t=new p("&","bitAnd",[t,z(e)]);return t}function z(e){for(var t=[q(e)],r=[],n={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};ku(n,e.token);){var i={name:e.token,fn:n[e.token]};r.push(i),_(e),t.push(q(e))}return 1===t.length?t[0]:2===t.length?new p(r[0].name,r[0].fn,t):new y(r.map((e=>e.fn)),t)}function q(e){var t,r,n,i;t=H(e);for(var s={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};ku(s,e.token);)n=s[r=e.token],_(e),i=[t,H(e)],t=new p(r,n,i);return t}function H(e){var t,r,n,i;t=V(e);for(var s={to:"to",in:"to"};ku(s,e.token);)n=s[r=e.token],_(e),"in"===r&&""===e.token?t=new p("*","multiply",[t,new v("in")],!0):(i=[t,V(e)],t=new p(r,n,i));return t}function V(e){var t,r=[];if(t=":"===e.token?new u(1):G(e),":"===e.token&&e.conditionalLevel!==e.nestingLevel){for(r.push(t);":"===e.token&&r.length<3;)_(e),")"===e.token||"]"===e.token||","===e.token||""===e.token?r.push(new v("end")):r.push(G(e));t=3===r.length?new g(r[0],r[2],r[1]):new g(r[0],r[1])}return t}function G(e){var t,r,n,i;t=W(e);for(var s={"+":"add","-":"subtract"};ku(s,e.token);){n=s[r=e.token],_(e);var o=W(e);i=o.isPercentage?[t,new p("*","multiply",[t,o])]:[t,o],t=new p(r,n,i)}return t}function W(e){var t,r,n,i;r=t=K(e);for(var s={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide"};ku(s,e.token);)i=s[n=e.token],_(e),r=K(e),t=new p(n,i,[t,r]);return t}function K(e){var t,r;for(r=t=Y(e);e.tokenType===w.SYMBOL||"in"===e.token&&du(t)||!(e.tokenType!==w.NUMBER||du(r)||vu(r)&&"!"!==r.op)||"("===e.token;)r=Y(e),t=new p("*","multiply",[t,r],!0);return t}function Y(e){for(var t=J(e),r=t,n=[];"/"===e.token&&hu(r);){if(n.push(Ll({},e)),_(e),e.tokenType!==w.NUMBER){Ll(e,n.pop());break}if(n.push(Ll({},e)),_(e),e.tokenType!==w.SYMBOL&&"("!==e.token){n.pop(),Ll(e,n.pop());break}Ll(e,n.pop()),n.pop(),r=J(e),t=new p("/","divide",[t,r])}return t}function J(e){var t,r,n,i;t=Z(e);for(var s={"%":"mod",mod:"mod"};ku(s,e.token);)n=s[r=e.token],_(e),"%"===r&&e.tokenType===w.DELIMITER&&"("!==e.token?t=new p("/","divide",[t,new u(100)],!1,!0):(i=[t,Z(e)],t=new p(r,n,i));return t}function Z(e){var t,i,o,a={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return ku(a,e.token)?(o=a[e.token],t=e.token,_(e),i=[Z(e)],new p(t,o,i)):function(e){var t,i,o,a;t=function(e){var t,i,o;t=function(e){var t=[];if(e.tokenType===w.SYMBOL&&ku(e.extraNodes,e.token)){var i=e.extraNodes[e.token];if(O(e),"("===e.token){if(t=[],L(e),O(e),")"!==e.token)for(t.push(F(e));","===e.token;)O(e),t.push(F(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");R(e),O(e)}return new i(t)}return function(e){var t;if(e.tokenType===w.SYMBOL||e.tokenType===w.DELIMITER&&e.token in S)return t=e.token,O(e),X(e,ku(T,t)?new u(T[t]):-1!==A.indexOf(t)?new u(r(t,"number")):new v(t));return function(e){var t;if('"'===e.token)return t=Q(e),X(e,new u(t));return function(e){var t;if("'"===e.token)return t=ee(e),X(e,new u(t));return function(e){var t,i,o,a;if("["===e.token){if(L(e),O(e),"]"!==e.token){var l=te(e);if(";"===e.token){for(o=1,i=[l];";"===e.token;)O(e),i[o]=te(e),o++;if("]"!==e.token)throw ne(e,"End of matrix ] expected");R(e),O(e),a=i[0].items.length;for(var c=1;c<o;c++)if(i[c].items.length!==a)throw ie(e,"Column dimensions mismatch ("+i[c].items.length+" !== "+a+")");t=new s(i)}else{if("]"!==e.token)throw ne(e,"End of matrix ] expected");R(e),O(e),t=l}}else R(e),O(e),t=new s([]);return X(e,t)}return function(e){if("{"===e.token){var t;L(e);var i={};do{if(O(e),"}"!==e.token){if('"'===e.token)t=Q(e);else if("'"===e.token)t=ee(e);else{if(!(e.tokenType===w.SYMBOL||e.tokenType===w.DELIMITER&&e.token in S))throw ne(e,"Symbol or string expected as object key");t=e.token,O(e)}if(":"!==e.token)throw ne(e,"Colon : expected after object key");O(e),i[t]=F(e)}}while(","===e.token);if("}"!==e.token)throw ne(e,"Comma , or bracket } expected after object value");R(e),O(e);var s=new f(i);return s=X(e,s)}return function(e){var t;if(e.tokenType===w.NUMBER)return t=e.token,O(e),new u(r(t,n.number));return function(e){var t;if("("===e.token){if(L(e),O(e),t=F(e),")"!==e.token)throw ne(e,"Parenthesis ) expected");return R(e),O(e),t=X(e,t=new m(t))}return function(e){throw""===e.token?ne(e,"Unexpected end of expression"):ne(e,"Value expected")}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e);var a={"!":"factorial","'":"ctranspose"};for(;ku(a,e.token);)o=a[i=e.token],O(e),t=X(e,t=new p(i,o,[t]));return t}(e),("^"===e.token||".^"===e.token)&&(o="^"===(i=e.token)?"pow":"dotPow",_(e),a=[t,Z(e)],t=new p(i,o,a));return t}(e)}function X(e,t,r){for(var n;!("("!==e.token&&"["!==e.token&&"."!==e.token||r&&-1===r.indexOf(e.token));)if(n=[],"("===e.token){if(!Eu(t)&&!ou(t))return t;if(L(e),O(e),")"!==e.token)for(n.push(F(e));","===e.token;)O(e),n.push(F(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");R(e),O(e),t=new d(t,n)}else if("["===e.token){if(L(e),O(e),"]"!==e.token)for(n.push(F(e));","===e.token;)O(e),n.push(F(e));if("]"!==e.token)throw ne(e,"Parenthesis ] expected");R(e),O(e),t=new i(t,new h(n))}else{if(O(e),e.tokenType!==w.SYMBOL)throw ne(e,"Property name expected after dot");n.push(new u(e.token)),O(e);t=new i(t,new h(n,!0))}return t}function Q(e){for(var t="";""!==N(e)&&'"'!==N(e);)"\\"===N(e)&&(t+=N(e),C(e)),t+=N(e),C(e);if(O(e),'"'!==e.token)throw ne(e,'End of string " expected');return O(e),JSON.parse('"'+t+'"')}function ee(e){for(var t="";""!==N(e)&&"'"!==N(e);)"\\"===N(e)&&(t+=N(e),C(e)),t+=N(e),C(e);if(O(e),"'"!==e.token)throw ne(e,"End of string ' expected");return O(e),JSON.parse('"'+t+'"')}function te(e){for(var t=[F(e)],r=1;","===e.token;)O(e),t[r]=F(e),r++;return new s(t)}function re(e){return e.index-e.token.length+1}function ne(e,t){var r=re(e),n=new SyntaxError(t+" (char "+r+")");return n.char=r,n}function ie(e,t){var r=re(e),n=new SyntaxError(t+" (char "+r+")");return n.char=r,n}return b.isAlpha=function(e,t,r){return b.isValidLatinOrGreek(e)||b.isValidMathSymbol(e,r)||b.isValidMathSymbol(t,e)},b.isValidLatinOrGreek=function(e){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},b.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},b.isWhitespace=function(e,t){return" "===e||"\t"===e||"\n"===e&&t>0},b.isDecimalMark=function(e,t){return"."===e&&"/"!==t&&"*"!==t&&"^"!==t},b.isDigitDot=function(e){return e>="0"&&e<="9"||"."===e},b.isDigit=function(e){return e>="0"&&e<="9"},b.isHexDigit=function(e){return e>="0"&&e<="9"||e>="a"&&e<="f"||e>="A"&&e<="F"},t.addConversion({from:"string",to:"Node",convert:b}),b})),Xd=Mu("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],(e=>{var{typed:t,parse:r,ConstantNode:n,FunctionNode:i,OperatorNode:s,ParenthesisNode:o}=e;function a(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!t)return e;if(Eu(e)){if(l.has(e.name)){var u=Array.from(l).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(u,"}"))}var c=t.get(e.name);if(gu(c)){var d=new Set(l);return d.add(e.name),a(c,t,d)}return"number"==typeof c?r(String(c)):void 0!==c?new n(c):e}if(vu(e)){var h=e.args.map((function(e){return a(e,t,l)}));return new s(e.op,e.fn,h,e.implicit)}if(bu(e))return new o(a(e.content,t,l));if(pu(e)){var f=e.args.map((function(e){return a(e,t,l)}));return new i(e.name,f)}return e.map((e=>a(e,t,l)))}return t("resolve",{Node:a,"Node, Map | null | undefined":a,"Node, Object":(e,t)=>a(e,ju(t)),"Array | Matrix":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array | Matrix, null | undefined":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array, Object":t.referTo("Array,Map",(e=>(t,r)=>e(t,ju(r)))),"Matrix, Object":t.referTo("Matrix,Map",(e=>(t,r)=>e(t,ju(r)))),"Array | Matrix, Map":t.referToSelf((e=>(t,r)=>t.map((t=>e(t,r)))))})}));function Qd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function eh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qd(Object(r),!0).forEach((function(t){Wu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var th=Mu("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(e=>{var{FunctionNode:t,OperatorNode:r,SymbolNode:n}=e,i=!0,s=!1,o="defaultF",a={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:s,total:i,commutative:s,associative:s},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:s,total:i,commutative:s,associative:s},paren:{trivial:i,total:i,commutative:i,associative:s},defaultF:{trivial:s,total:i,commutative:s,associative:s}};function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,n=o;if("string"==typeof e?n=e:vu(e)?n=e.fn.toString():pu(e)?n=e.name:bu(e)&&(n="paren"),ku(r,n)){var i=r[n];if(ku(i,t))return i[t];if(ku(a,n))return a[n][t]}if(ku(r,o)){var s=r[o];return ku(s,t)?s[t]:a[o][t]}if(ku(a,n)){var l=a[n];if(ku(l,t))return l[t]}return a[o][t]}function u(e){return l(e,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:a)}function c(e,t){var r,n=[];return u(e,t)?(r=e.op,function e(t){for(var i=0;i<t.args.length;i++){var s=t.args[i];vu(s)&&r===s.op?e(s):n.push(s)}}(e),n):e.args}function d(e){return vu(e)?function(t){try{return new r(e.op,e.fn,t,e.implicit)}catch(e){return console.error(e),[]}}:function(r){return new t(new n(e.name),r)}}return{createMakeNodeFunction:d,hasProperty:l,isCommutative:function(e){return l(e,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:a)},isAssociative:u,mergeContext:function(e,t){var r=eh({},e);for(var n in t)ku(e,n)?r[n]=eh(eh({},t[n]),e[n]):r[n]=t[n];return r},flatten:function e(t,r){if(!t.args||0===t.args.length)return t;t.args=c(t,r);for(var n=0;n<t.args.length;n++)e(t.args[n],r)},allChildren:c,unflattenr:function e(t,r){if(t.args&&0!==t.args.length){for(var n=d(t),i=t.args.length,s=0;s<i;s++)e(t.args[s],r);if(i>2&&u(t,r)){for(var o=t.args.pop();t.args.length>0;)o=n([t.args.pop(),o]);t.args=o.args}}},unflattenl:function e(t,r){if(t.args&&0!==t.args.length){for(var n=d(t),i=t.args.length,s=0;s<i;s++)e(t.args[s],r);if(i>2&&u(t,r)){for(var o=t.args.shift();t.args.length>0;)o=n([o,t.args.shift()]);t.args=o.args}}},defaultContext:a,realContext:{divide:{total:s},log:{total:s}},positiveContext:{subtract:{total:s},abs:{trivial:i},log:{total:i}}}}));function rh(){throw new Error('No "bignumber" implementation available')}function nh(){throw new Error('No "fraction" implementation available')}function ih(){throw new Error('No "matrix" implementation available')}var sh=["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],oh=Mu("simplifyConstant",sh,(e=>{var{typed:t,config:r,mathWithTransform:n,matrix:i,fraction:s,bignumber:o,AccessorNode:a,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:d,ObjectNode:h,OperatorNode:f,SymbolNode:p}=e,{isCommutative:m,isAssociative:g,allChildren:y,createMakeNodeFunction:v}=th({FunctionNode:c,OperatorNode:f,SymbolNode:p}),b=t("simplifyConstant",{Node:e=>S(C(e,{})),"Node, Object":function(e,t){return S(C(e,t))}});function x(e){return jl(e)?e.valueOf():e instanceof Array?e.map(x):Vl(e)?i(x(e.valueOf())):e}function w(e,t,r){try{return n[e].apply(null,t)}catch(i){return t=t.map(x),A(n[e].apply(null,t),r)}}var E=t({Fraction:function(e){var t,r=e.s*e.n;t=r<0?new f("-","unaryMinus",[new u(-r)]):new u(r);if(1===e.d)return t;return new f("/","divide",[t,new u(e.d)])},number:function(e){return e<0?D(new u(-e)):new u(e)},BigNumber:function(e){return e<0?D(new u(-e)):new u(e)},Complex:function(e){throw new Error("Cannot convert Complex number to Node")},string:function(e){return new u(e)},Matrix:function(e){return new l(e.valueOf().map((e=>E(e))))}});function S(e){return gu(e)?e:E(e)}function T(e,t){if(t&&!1!==t.exactFractions&&isFinite(e)&&s){var r=s(e),n=t&&"number"==typeof t.fractionsLimit?t.fractionsLimit:1/0;if(r.valueOf()===e&&r.n<n&&r.d<n)return r}return e}var A=t({"string, Object":function(e,t){return"BigNumber"===r.number?(void 0===o&&rh(),o(e)):"Fraction"===r.number?(void 0===s&&nh(),s(e)):T(parseFloat(e),t)},"Fraction, Object":function(e,t){return e},"BigNumber, Object":function(e,t){return e},"number, Object":function(e,t){return T(e,t)},"Complex, Object":function(e,t){return 0!==e.im?e:T(e.re,t)},"Matrix, Object":function(e,t){return i(T(e.valueOf()))},"Array, Object":function(e,t){return e.map(T)}});function D(e){return new f("-","unaryMinus",[e])}function N(e,t,r,n){var i=t.shift(),s=t.reduce(((t,i)=>{if(!gu(i)){var s=t.pop();if(gu(s))return[s,i];try{return t.push(w(e,[s,i],n)),t}catch(e){t.push(s)}}t.push(S(t.pop()));var o=1===t.length?t[0]:r(t);return[r([o,S(i)])]}),[i]);return 1===s.length?s[0]:r([s[0],E(s[1])])}function C(e,t){switch(e.type){case"SymbolNode":return e;case"ConstantNode":switch(typeof e.value){case"number":return A(e.value,t);case"string":return e.value;default:if(!isNaN(e.value))return A(e.value,t)}return e;case"FunctionNode":if(n[e.name]&&n[e.name].rawArgs)return e;if(-1===["add","multiply"].indexOf(e.name)){var r=e.args.map((e=>C(e,t)));if(!r.some(gu))try{return w(e.name,r,t)}catch(e){}if("size"===e.name&&1===r.length&&au(r[0])){for(var s=[],o=r[0];au(o);)s.push(o.items.length),o=o.items[0];return i(s)}return new c(e.name,r.map(S))}case"OperatorNode":var f,p,x=e.fn.toString(),E=v(e);if(vu(e)&&e.isUnary())p=gu((f=[C(e.args[0],t)])[0])?E(f):w(x,f,t);else if(g(e,t.context))if(f=(f=y(e,t.context)).map((e=>C(e,t))),m(x,t.context)){for(var T=[],D=[],k=0;k<f.length;k++)gu(f[k])?D.push(f[k]):T.push(f[k]);T.length>1?(p=N(x,T,E,t),D.unshift(p),p=N(x,D,E,t)):p=N(x,f,E,t)}else p=N(x,f,E,t);else f=e.args.map((e=>C(e,t))),p=N(x,f,E,t);return p;case"ParenthesisNode":return C(e.content,t);case"AccessorNode":return function(e,t,r){if(!mu(t))return new a(S(e),S(t));if(au(e)||Vl(e)){for(var n=Array.from(t.dimensions);n.length>0;)if(du(n[0])&&"string"!=typeof n[0].value){var s=A(n.shift().value,r);au(e)?e=e.items[s-1]:(e=e.valueOf()[s-1])instanceof Array&&(e=i(e))}else{if(!(n.length>1&&du(n[1])&&"string"!=typeof n[1].value))break;var o=A(n[1].value,r),c=[],h=au(e)?e.items:e.valueOf();for(var f of h)if(au(f))c.push(f.items[o-1]);else{if(!Vl(e))break;c.push(f[o-1])}if(c.length!==h.length)break;e=au(e)?new l(c):i(c),n.splice(1,1)}return n.length===t.dimensions.length?new a(S(e),t):n.length>0?(t=new d(n),new a(S(e),t)):e}if(yu(e)&&1===t.dimensions.length&&du(t.dimensions[0])){var p=t.dimensions[0].value;return p in e.properties?e.properties[p]:new u}return new a(S(e),t)}(C(e.object,t),C(e.index,t),t);case"ArrayNode":var M=e.items.map((e=>C(e,t)));return M.some(gu)?new l(M.map(S)):i(M);case"IndexNode":return new d(e.dimensions.map((e=>b(e,t))));case"ObjectNode":var O={};for(var _ in e.properties)O[_]=b(e.properties[_],t);return new h(O);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}return b})),ah="compile",lh=["typed","parse"],uh=Mu(ah,lh,(e=>{var{typed:t,parse:r}=e;return t(ah,{string:function(e){return r(e).compile()},"Array | Matrix":function(e){return Gd(e,(function(e){return r(e).compile()}))}})})),ch=["parse"],dh=Mu("Help",ch,(e=>{var{parse:t}=e;function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}return r.prototype.type="Help",r.prototype.isHelp=!0,r.prototype.toString=function(){var e=this.doc||{},r="\n";if(e.name&&(r+="Name: "+e.name+"\n\n"),e.category&&(r+="Category: "+e.category+"\n\n"),e.description&&(r+="Description:\n    "+e.description+"\n\n"),e.syntax&&(r+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){r+="Examples:\n";for(var n={},i=0;i<e.examples.length;i++){var s=e.examples[i];r+="    "+s+"\n";var o=void 0;try{o=t(s).compile().evaluate(n)}catch(e){o=e}void 0===o||Ql(o)||(r+="        "+xc(o,{precision:14})+"\n")}r+="\n"}return e.mayThrow&&e.mayThrow.length&&(r+="Throws: "+e.mayThrow.join(", ")+"\n\n"),e.seealso&&e.seealso.length&&(r+="See also: "+e.seealso.join(", ")+"\n"),r},r.prototype.toJSON=function(){var e=Du(this.doc);return e.mathjs="Help",e},r.fromJSON=function(e){var t={};return Object.keys(e).filter((e=>"mathjs"!==e)).forEach((r=>{t[r]=e[r]})),new r(t)},r.prototype.valueOf=r.prototype.toString,r}),{isClass:!0}),hh="leafCount",fh=["parse","typed"],ph=Mu(hh,fh,(e=>{var{parse:t,typed:r}=e;function n(e){var t=0;return e.forEach((e=>{t+=n(e)})),t||1}return r(hh,{Node:function(e){return n(e)}})})),mh="simplifyCore",gh=["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],yh=Mu(mh,gh,(e=>{var{typed:t,parse:r,equal:n,isZero:i,add:s,subtract:o,multiply:a,divide:l,pow:u,AccessorNode:c,ArrayNode:d,ConstantNode:h,FunctionNode:f,IndexNode:p,ObjectNode:m,OperatorNode:g,ParenthesisNode:y,SymbolNode:v}=e,b=new h(0),x=new h(1),w=new h(!0),E=new h(!1);function S(e){return vu(e)&&["and","not","or"].includes(e.op)}var{hasProperty:T,isCommutative:A}=th({FunctionNode:f,OperatorNode:g,SymbolNode:v});function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t?t.context:void 0;if(T(e,"trivial",r)){if(pu(e)&&1===e.args.length)return D(e.args[0],t);var s=!1,o=0;if(e.forEach((e=>{1===++o&&(s=D(e,t))})),1===o)return s}var a=e;if(pu(a)){var l=function(e){var t="OperatorNode:"+e;for(var r of Zc)if(t in r)return r[t].op;return null}(a.name);if(!l)return new f(D(a.fn),a.args.map((e=>D(e,t))));if(a.args.length>2&&T(a,"associative",r))for(;a.args.length>2;){var u=a.args.pop(),h=a.args.pop();a.args.push(new g(l,a.name,[u,h]))}a=new g(l,a.name,a.args)}if(vu(a)&&a.isUnary()){var y=D(a.args[0],t);if("~"===a.op&&vu(y)&&y.isUnary()&&"~"===y.op)return y.args[0];if("not"===a.op&&vu(y)&&y.isUnary()&&"not"===y.op&&S(y.args[0]))return y.args[0];var v=!0;if("-"===a.op&&vu(y)&&(y.isBinary()&&"subtract"===y.fn&&(a=new g("-","subtract",[y.args[1],y.args[0]]),v=!1),y.isUnary()&&"-"===y.op))return y.args[0];if(v)return new g(a.op,a.fn,[y])}if(vu(a)&&a.isBinary()){var N=D(a.args[0],t),C=D(a.args[1],t);if("+"===a.op){if(du(N)&&i(N.value))return C;if(du(C)&&i(C.value))return N;vu(C)&&C.isUnary()&&"-"===C.op&&(C=C.args[0],a=new g("-","subtract",[N,C]))}if("-"===a.op)return vu(C)&&C.isUnary()&&"-"===C.op?D(new g("+","add",[N,C.args[0]]),t):du(N)&&i(N.value)?D(new g("-","unaryMinus",[C])):du(C)&&i(C.value)?N:new g(a.op,a.fn,[N,C]);if("*"===a.op){if(du(N)){if(i(N.value))return b;if(n(N.value,1))return C}if(du(C)){if(i(C.value))return b;if(n(C.value,1))return N;if(A(a,r))return new g(a.op,a.fn,[C,N],a.implicit)}return new g(a.op,a.fn,[N,C],a.implicit)}if("/"===a.op)return du(N)&&i(N.value)?b:du(C)&&n(C.value,1)?N:new g(a.op,a.fn,[N,C]);if("^"===a.op&&du(C)){if(i(C.value))return x;if(n(C.value,1))return N}if("and"===a.op){if(du(N)){if(!N.value)return E;if(S(C))return C}if(du(C)){if(!C.value)return E;if(S(N))return N}}if("or"===a.op){if(du(N)){if(N.value)return w;if(S(C))return C}if(du(C)){if(C.value)return w;if(S(N))return N}}return new g(a.op,a.fn,[N,C])}if(vu(a))return new g(a.op,a.fn,a.args.map((e=>D(e,t))));if(au(a))return new d(a.items.map((e=>D(e,t))));if(ou(a))return new c(D(a.object,t),D(a.index,t));if(mu(a))return new p(a.dimensions.map((e=>D(e,t))));if(yu(a)){var k={};for(var M in a.properties)k[M]=D(a.properties[M],t);return new m(k)}return a}return t(mh,{Node:D,"Node,Object":D})})),vh="evaluate",bh=["typed","parse"],xh=Mu(vh,bh,(e=>{var{typed:t,parse:r}=e;return t(vh,{string:function(e){var t=$u();return r(e).compile().evaluate(t)},"string, Map | Object":function(e,t){return r(e).compile().evaluate(t)},"Array | Matrix":function(e){var t=$u();return Gd(e,(function(e){return r(e).compile().evaluate(t)}))},"Array | Matrix, Map | Object":function(e,t){return Gd(e,(function(e){return r(e).compile().evaluate(t)}))}})})),wh={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},Eh={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},Sh={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:wh,E:wh,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:Eh,PI:Eh,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant",examples:["coulomb"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Borh magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Borh radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax ≣ 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:[]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicant the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore–Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and eigenvectors of a real symmetric matrix",examples:["eigs([[5, 2.3], [2.3, 1]])"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], square)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $0, $1, $2", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","fraction","bignumber","string","format"]}},Th="help",Ah=Mu(Th,["typed","mathWithTransform","Help"],(e=>{var{typed:t,mathWithTransform:r,Help:n}=e;return t(Th,{any:function(e){var t,i=e;if("string"!=typeof e)for(t in r)if(ku(r,t)&&e===r[t]){i=t;break}var s=_u(Sh,i);if(!s){var o="function"==typeof i?i.name:i;throw new Error('No documentation found on "'+o+'"')}return new n(s)}})})),Dh=Mu("Parser",["evaluate"],(e=>{var{evaluate:t}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:$u(),writable:!1})}return r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(e){return t(e,this.scope)},r.prototype.get=function(e){if(this.scope.has(e))return this.scope.get(e)},r.prototype.getAll=function(){return function(e){if(e instanceof Uu)return e.wrappedObject;var t={};for(var r of e.keys())Lu(t,r,e.get(r));return t}(this.scope)},r.prototype.getAllAsMap=function(){return this.scope},r.prototype.set=function(e,t){return this.scope.set(e,t),t},r.prototype.remove=function(e){this.scope.delete(e)},r.prototype.clear=function(){this.scope.clear()},r}),{isClass:!0});function Nh(e){return du(e)||vu(e)&&e.isUnary()&&du(e.args[0])}function Ch(e){return!!du(e)||(!(!pu(e)&&!vu(e)||!e.args.every(Ch))||!(!bu(e)||!Ch(e.content)))}var kh=Mu("simplify",["config","typed","parse","add","subtract","multiply","divide","pow","isZero","equal","resolve","simplifyConstant","simplifyCore","?fraction","?bignumber","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{config:t,typed:r,parse:n,add:i,subtract:s,multiply:o,divide:a,pow:l,isZero:u,equal:c,resolve:d,simplifyConstant:h,simplifyCore:f,fraction:p,bignumber:m,mathWithTransform:g,matrix:y,AccessorNode:v,ArrayNode:b,ConstantNode:x,FunctionNode:w,IndexNode:E,ObjectNode:S,OperatorNode:T,ParenthesisNode:A,SymbolNode:D}=e,{hasProperty:N,isCommutative:C,isAssociative:k,mergeContext:M,flatten:O,unflattenr:_,unflattenl:L,createMakeNodeFunction:R,defaultContext:I,realContext:F,positiveContext:P}=th({FunctionNode:w,OperatorNode:T,SymbolNode:D});r.addConversion({from:"Object",to:"Map",convert:ju});var B=r("simplify",{Node:H,"Node, Map":(e,t)=>H(e,!1,t),"Node, Map, Object":(e,t,r)=>H(e,!1,t,r),"Node, Array":H,"Node, Array, Map":H,"Node, Array, Map, Object":H});function U(e){return e.transform((function(e,t,r){return bu(e)?U(e.content):e}))}r.removeConversion({from:"Object",to:"Map",convert:ju}),B.defaultContext=I,B.realContext=F,B.positiveContext=P;var $={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function j(e,t){var r={};if(e.s){var i=e.s.split("->");if(2!==i.length)throw SyntaxError("Could not parse rule: "+e.s);r.l=i[0],r.r=i[1]}else r.l=e.l,r.r=e.r;for(var s of(r.l=U(n(r.l)),r.r=U(n(r.r)),["imposeContext","repeat","assuming"]))s in e&&(r[s]=e[s]);if(e.evaluate&&(r.evaluate=n(e.evaluate)),k(r.l,t)){var o,a=!C(r.l,t);a&&(o=q());var l=R(r.l),u=q();r.expanded={},r.expanded.l=l([r.l,u]),O(r.expanded.l,t),_(r.expanded.l,t),r.expanded.r=l([r.r,u]),a&&(r.expandedNC1={},r.expandedNC1.l=l([o,r.l]),r.expandedNC1.r=l([o,r.r]),r.expandedNC2={},r.expandedNC2.l=l([o,r.expanded.l]),r.expandedNC2.r=l([o,r.expanded.r]))}return r}B.rules=[f,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},h,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},h,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var z=0;function q(){return new D("_p"+z++)}function H(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$u(),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.consoleDebug;t=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],s=void 0,o=typeof i;switch(o){case"string":i={s:i};case"object":s=j(i,t);break;case"function":s=i;break;default:throw TypeError("Unsupported type of rule: "+o)}r.push(s)}return r}(t||B.rules,n.context);for(var s=d(e,r),o={},a=(s=U(s)).toString({parenthesis:"all"});!o[a];){o[a]=!0,z=0;var l=a;i&&console.log("Working on: ",a);for(var u=0;u<t.length;u++){var c="";if("function"==typeof t[u]?(s=t[u](s,n),i&&(c=t[u].name)):(O(s,n.context),s=G(s,t[u],n.context),i&&(c="".concat(t[u].l.toString()," -> ").concat(t[u].r.toString()))),i){var h=s.toString({parenthesis:"all"});h!==l&&(console.log("Applying",c,"produced",h),l=h)}L(s,n.context)}a=s.toString({parenthesis:"all"})}return s}function V(e,t,r){var n=e;if(e)for(var i=0;i<e.length;++i){var s=G(e[i],t,r);s!==e[i]&&(n===e&&(n=e.slice()),n[i]=s)}return n}function G(e,t,r){if(t.assuming)for(var n in t.assuming)for(var i in t.assuming[n])if(N(n,i,r)!==t.assuming[n][i])return e;var s=M(t.imposeContext,r),o=e;if(o instanceof T||o instanceof w){var a=V(o.args,t,r);a!==o.args&&((o=o.clone()).args=a)}else if(o instanceof A){if(o.content){var l=G(o.content,t,r);l!==o.content&&(o=new A(l))}}else if(o instanceof b){var u=V(o.items,t,r);u!==o.items&&(o=new b(u))}else if(o instanceof v){var c=o.object;o.object&&(c=G(o.object,t,r));var d=o.index;o.index&&(d=G(o.index,t,r)),c===o.object&&d===o.index||(o=new v(c,d))}else if(o instanceof E){var h=V(o.dimensions,t,r);h!==o.dimensions&&(o=new E(h))}else if(o instanceof S){var f=!1,p={};for(var m in o.properties)p[m]=G(o.properties[m],t,r),p[m]!==o.properties[m]&&(f=!0);f&&(o=new S(p))}var g=t.r,y=Y(t.l,o,s)[0];if(!y&&t.expanded&&(g=t.expanded.r,y=Y(t.expanded.l,o,s)[0]),!y&&t.expandedNC1&&(g=t.expandedNC1.r,(y=Y(t.expandedNC1.l,o,s)[0])||(g=t.expandedNC2.r,y=Y(t.expandedNC2.l,o,s)[0])),y){var x=o.implicit;o=g.clone(),x&&"implicit"in g&&(o.implicit=!0),o=o.transform((function(e){return e.isSymbolNode&&ku(y.placeholders,e.name)?y.placeholders[e.name].clone():e}))}return t.repeat&&o!==e&&(o=G(o,t,r)),o}function W(e,t){var r={placeholders:{}};if(!e.placeholders&&!t.placeholders)return r;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var n in e.placeholders)if(ku(e.placeholders,n)&&(r.placeholders[n]=e.placeholders[n],ku(t.placeholders,n)&&!J(e.placeholders[n],t.placeholders[n])))return null;for(var i in t.placeholders)ku(t.placeholders,i)&&(r.placeholders[i]=t.placeholders[i]);return r}function K(e,t){var r,n=[];if(0===e.length||0===t.length)return n;for(var i=0;i<e.length;i++)for(var s=0;s<t.length;s++)(r=W(e[i],t[s]))&&n.push(r);return n}function Y(e,t,r,n){var i=[{placeholders:{}}];if(e instanceof T&&t instanceof T||e instanceof w&&t instanceof w){if(e instanceof T){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof w&&e.name!==t.name)return[];if(!(1===t.args.length&&1===e.args.length||!k(t,r)&&t.args.length===e.args.length||n)){if(t.args.length>=2&&2===e.args.length){for(var s=function(e,t){var r,n,i=[],s=R(e);if(C(e,t))for(var o=0;o<e.args.length;o++)(n=e.args.slice(0)).splice(o,1),r=1===n.length?n[0]:s(n),i.push(s([e.args[o],r]));else for(var a=1;a<e.args.length;a++){var l=e.args[0];a>1&&(l=s(e.args.slice(0,a))),r=1===(n=e.args.slice(a)).length?n[0]:s(n),i.push(s([l,r]))}return i}(t,r),o=[],a=0;a<s.length;a++){var l=Y(e,s[a],r,!0);o=o.concat(l)}return o}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var u=[],d=0;d<e.args.length;d++){var h=Y(e.args[d],t.args[d],r);if(0===h.length)break;u.push(h)}if(u.length!==e.args.length){if(!C(t,r)||1===e.args.length)return[];if(e.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var f=Y(e.args[0],t.args[1],r);if(0===f.length)return[];var p=Y(e.args[1],t.args[0],r);if(0===p.length)return[];u=[f,p]}i=function(e){if(0===e.length)return e;for(var t=e.reduce(K),r=[],n={},i=0;i<t.length;i++){var s=JSON.stringify(t[i]);n[s]||(n[s]=!0,r.push(t[i]))}return r}(u)}else if(e instanceof D){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if($[e.name]){if(e.name!==t.name)return[]}else switch(e.name[1]>="a"&&e.name[1]<="z"?e.name.substring(0,2):e.name[0]){case"n":case"_p":i[0].placeholders[e.name]=t;break;case"c":case"cl":if(!du(t))return[];i[0].placeholders[e.name]=t;break;case"v":if(du(t))return[];i[0].placeholders[e.name]=t;break;case"vl":if(!Eu(t))return[];i[0].placeholders[e.name]=t;break;case"cd":if(!Nh(t))return[];i[0].placeholders[e.name]=t;break;case"vd":if(Nh(t))return[];i[0].placeholders[e.name]=t;break;case"ce":if(!Ch(t))return[];i[0].placeholders[e.name]=t;break;case"ve":if(Ch(t))return[];i[0].placeholders[e.name]=t;break;default:throw new Error("Invalid symbol in rule: "+e.name)}}else{if(!(e instanceof x))return[];if(!c(e.value,t.value))return[]}return i}function J(e,t){if(e instanceof x&&t instanceof x){if(!c(e.value,t.value))return!1}else if(e instanceof D&&t instanceof D){if(e.name!==t.name)return!1}else{if(!(e instanceof T&&t instanceof T||e instanceof w&&t instanceof w))return!1;if(e instanceof T){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof w&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var r=0;r<e.args.length;r++)if(!J(e.args[r],t.args[r]))return!1}return!0}return B})),Mh="symbolicEqual",Oh=Mu(Mh,["parse","simplify","typed","OperatorNode"],(e=>{var{parse:t,simplify:r,typed:n,OperatorNode:i}=e;function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=new i("-","subtract",[e,t]),o=r(s,{},n);return du(o)&&!o.value}return n(Mh,{"Node, Node":s,"Node, Node, Object":s})})),_h="derivative",Lh=Mu(_h,["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,config:r,parse:n,simplify:i,equal:s,isZero:o,numeric:a,ConstantNode:l,FunctionNode:u,OperatorNode:c,ParenthesisNode:d,SymbolNode:h}=e;function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},n={};g(n,e,t.name);var s=y(e,n);return r.simplify?i(s):s}t.addConversion({from:"identifier",to:"SymbolNode",convert:n});var p=t(_h,{"Node, SymbolNode":f,"Node, SymbolNode, Object":f});t.removeConversion({from:"identifier",to:"SymbolNode",convert:n}),p._simplify=!0,p.toTex=function(e){return m.apply(null,e.args)};var m=t("_derivTex",{"Node, SymbolNode":function(e,t){return du(e)&&"string"===Tu(e.value)?m(n(e.value).toString(),t.toString(),1):m(e.toTex(),t.toString(),1)},"Node, ConstantNode":function(e,t){if("string"===Tu(t.value))return m(e,n(t.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(e,t,r){return m(e.toString(),t.name,r.value)},"string, string, number":function(e,t,r){return(1===r?"{d\\over d"+t+"}":"{d^{"+r+"}\\over d"+t+"^{"+r+"}}")+"\\left[".concat(e,"\\right]")}}),g=t("constTag",{"Object, ConstantNode, string":function(e,t){return e[t]=!0,!0},"Object, SymbolNode, string":function(e,t,r){return t.name!==r&&(e[t]=!0,!0)},"Object, ParenthesisNode, string":function(e,t,r){return g(e,t.content,r)},"Object, FunctionAssignmentNode, string":function(e,t,r){return-1===t.params.indexOf(r)?(e[t]=!0,!0):g(e,t.expr,r)},"Object, FunctionNode | OperatorNode, string":function(e,t,r){if(t.args.length>0){for(var n=g(e,t.args[0],r),i=1;i<t.args.length;++i)n=g(e,t.args[i],r)&&n;if(n)return e[t]=!0,!0}return!1}}),y=t("_derivative",{"ConstantNode, Object":function(e){return v(0)},"SymbolNode, Object":function(e,t){return void 0!==t[e]?v(0):v(1)},"ParenthesisNode, Object":function(e,t){return new d(y(e.content,t))},"FunctionAssignmentNode, Object":function(e,t){return void 0!==t[e]?v(0):y(e.expr,t)},"FunctionNode, Object":function(e,t){if(1!==e.args.length&&function(e){if(("log"===e.name||"nthRoot"===e.name||"pow"===e.name)&&2===e.args.length)return;for(var t=0;t<e.args.length;++t)e.args[t]=v(0);throw e.compile().evaluate(),new Error("Expected TypeError, but none found")}(e),void 0!==t[e])return v(0);var r,n,i,s,o=e.args[0],a=!1,l=!1;switch(e.name){case"cbrt":a=!0,n=new c("*","multiply",[v(3),new c("^","pow",[o,new c("/","divide",[v(2),v(3)])])]);break;case"sqrt":case"nthRoot":if(1===e.args.length)a=!0,n=new c("*","multiply",[v(2),new u("sqrt",[o])]);else if(2===e.args.length)return t[r=new c("/","divide",[v(1),e.args[1]])]=t[e.args[1]],y(new c("^","pow",[o,r]),t);break;case"log10":r=v(10);case"log":if(r||1!==e.args.length){if(1===e.args.length&&r||2===e.args.length&&void 0!==t[e.args[1]])n=new c("*","multiply",[o.clone(),new u("log",[r||e.args[1]])]),a=!0;else if(2===e.args.length)return y(new c("/","divide",[new u("log",[o]),new u("log",[e.args[1]])]),t)}else n=o.clone(),a=!0;break;case"pow":return t[r]=t[e.args[1]],y(new c("^","pow",[o,e.args[1]]),t);case"exp":n=new u("exp",[o.clone()]);break;case"sin":n=new u("cos",[o.clone()]);break;case"cos":n=new c("-","unaryMinus",[new u("sin",[o.clone()])]);break;case"tan":n=new c("^","pow",[new u("sec",[o.clone()]),v(2)]);break;case"sec":n=new c("*","multiply",[e,new u("tan",[o.clone()])]);break;case"csc":l=!0,n=new c("*","multiply",[e,new u("cot",[o.clone()])]);break;case"cot":l=!0,n=new c("^","pow",[new u("csc",[o.clone()]),v(2)]);break;case"asin":a=!0,n=new u("sqrt",[new c("-","subtract",[v(1),new c("^","pow",[o.clone(),v(2)])])]);break;case"acos":a=!0,l=!0,n=new u("sqrt",[new c("-","subtract",[v(1),new c("^","pow",[o.clone(),v(2)])])]);break;case"atan":a=!0,n=new c("+","add",[new c("^","pow",[o.clone(),v(2)]),v(1)]);break;case"asec":a=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),v(2)]),v(1)])])]);break;case"acsc":a=!0,l=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),v(2)]),v(1)])])]);break;case"acot":a=!0,l=!0,n=new c("+","add",[new c("^","pow",[o.clone(),v(2)]),v(1)]);break;case"sinh":n=new u("cosh",[o.clone()]);break;case"cosh":n=new u("sinh",[o.clone()]);break;case"tanh":n=new c("^","pow",[new u("sech",[o.clone()]),v(2)]);break;case"sech":l=!0,n=new c("*","multiply",[e,new u("tanh",[o.clone()])]);break;case"csch":l=!0,n=new c("*","multiply",[e,new u("coth",[o.clone()])]);break;case"coth":l=!0,n=new c("^","pow",[new u("csch",[o.clone()]),v(2)]);break;case"asinh":a=!0,n=new u("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),v(2)]),v(1)])]);break;case"acosh":a=!0,n=new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),v(2)]),v(1)])]);break;case"atanh":a=!0,n=new c("-","subtract",[v(1),new c("^","pow",[o.clone(),v(2)])]);break;case"asech":a=!0,l=!0,n=new c("*","multiply",[o.clone(),new u("sqrt",[new c("-","subtract",[v(1),new c("^","pow",[o.clone(),v(2)])])])]);break;case"acsch":a=!0,l=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),v(2)]),v(1)])])]);break;case"acoth":a=!0,l=!0,n=new c("-","subtract",[v(1),new c("^","pow",[o.clone(),v(2)])]);break;case"abs":n=new c("/","divide",[new u(new h("abs"),[o.clone()]),o.clone()]);break;default:throw new Error('Function "'+e.name+'" is not supported by derivative, or a wrong number of arguments is passed')}a?(i="/",s="divide"):(i="*",s="multiply");var d=y(o,t);return l&&(d=new c("-","unaryMinus",[d])),new c(i,s,[d,n])},"OperatorNode, Object":function(e,t){if(void 0!==t[e])return v(0);if("+"===e.op)return new c(e.op,e.fn,e.args.map((function(e){return y(e,t)})));if("-"===e.op){if(e.isUnary())return new c(e.op,e.fn,[y(e.args[0],t)]);if(e.isBinary())return new c(e.op,e.fn,[y(e.args[0],t),y(e.args[1],t)])}if("*"===e.op){var r=e.args.filter((function(e){return void 0!==t[e]}));if(r.length>0){var n=e.args.filter((function(e){return void 0===t[e]})),i=1===n.length?n[0]:new c("*","multiply",n),a=r.concat(y(i,t));return new c("*","multiply",a)}return new c("+","add",e.args.map((function(r){return new c("*","multiply",e.args.map((function(e){return e===r?y(e,t):e.clone()})))})))}if("/"===e.op&&e.isBinary()){var l=e.args[0],d=e.args[1];return void 0!==t[d]?new c("/","divide",[y(l,t),d]):void 0!==t[l]?new c("*","multiply",[new c("-","unaryMinus",[l]),new c("/","divide",[y(d,t),new c("^","pow",[d.clone(),v(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[y(l,t),d.clone()]),new c("*","multiply",[l.clone(),y(d,t)])]),new c("^","pow",[d.clone(),v(2)])])}if("^"===e.op&&e.isBinary()){var h=e.args[0],f=e.args[1];if(void 0!==t[h])return du(h)&&(o(h.value)||s(h.value,1))?v(0):new c("*","multiply",[e,new c("*","multiply",[new u("log",[h.clone()]),y(f.clone(),t)])]);if(void 0!==t[f]){if(du(f)){if(o(f.value))return v(0);if(s(f.value,1))return y(h,t)}var p=new c("^","pow",[h.clone(),new c("-","subtract",[f,v(1)])]);return new c("*","multiply",[f.clone(),new c("*","multiply",[y(h,t),p])])}return new c("*","multiply",[new c("^","pow",[h.clone(),f.clone()]),new c("+","add",[new c("*","multiply",[y(h,t),new c("/","divide",[f.clone(),h.clone()])]),new c("*","multiply",[y(f,t),new u("log",[h.clone()])])])])}throw new Error('Operator "'+e.op+'" is not supported by derivative, or a wrong number of arguments is passed')}});function v(e,t){return new l(a(e,t||r.number))}return p})),Rh="parser",Ih=Mu(Rh,["typed","Parser"],(e=>{var{typed:t,Parser:r}=e;return t(Rh,{"":function(){return new r}})})),Fh="rationalize",Ph=Mu(Fh,["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],(e=>{var{config:t,typed:r,equal:n,isZero:i,add:s,subtract:o,multiply:a,divide:l,pow:u,parse:c,simplifyConstant:d,simplifyCore:h,simplify:f,fraction:p,bignumber:m,mathWithTransform:g,matrix:y,AccessorNode:v,ArrayNode:b,ConstantNode:x,FunctionNode:w,IndexNode:E,ObjectNode:S,OperatorNode:T,SymbolNode:A,ParenthesisNode:D}=e;function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(){var e=[h,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},d,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],t=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],r=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],n=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],i={};return i.firstRules=e.concat(t,n),i.distrDivRules=r,i.sucDivRules=n,i.firstRulesAgain=e.concat(t),i.finalRules=[h,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},d,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],i}(),i=function(e,t,r,n){var i=[],s=f(e,n,t,{exactFractions:!1}),o="+-*"+((r=!!r)?"/":"");l(s);var a={};return a.expression=s,a.variables=i,a;function l(e){var t=e.type;if("FunctionNode"===t)throw new Error("There is an unsolved function call");if("OperatorNode"===t)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!Ku(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");l(e.args[0])}else{if(-1===o.indexOf(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var r=0;r<e.args.length;r++)l(e.args[r])}else if("SymbolNode"===t){var n=e.name;-1===i.indexOf(n)&&i.push(n)}else if("ParenthesisNode"===t)l(e.content);else if("ConstantNode"!==t)throw new Error("type "+t+" is not allowed in polynomial expression")}}(e,t,!0,n.firstRules),s=i.variables.length,o={exactFractions:!1},a={exactFractions:!0};if(e=i.expression,s>=1){var l,u;e=C(e);var c,p=!0,m=!1;for(e=f(e,n.firstRules,{},o);u=p?n.distrDivRules:n.sucDivRules,p=!p,(c=(e=f(e,u,{},a)).toString())!==l;)m=!0,l=c;m&&(e=f(e,n.firstRulesAgain,{},o)),e=f(e,n.finalRules,{},o)}var g=[],y={};return"OperatorNode"===e.type&&e.isBinary()&&"/"===e.op?(1===s&&(e.args[0]=k(e.args[0],g),e.args[1]=k(e.args[1])),r&&(y.numerator=e.args[0],y.denominator=e.args[1])):(1===s&&(e=k(e,g)),r&&(y.numerator=e,y.denominator=null)),r?(y.coefficients=g,y.variables=i.variables,y.expression=e,y):e}return r(Fh,{Node:N,"Node, boolean":(e,t)=>N(e,{},t),"Node, Object":N,"Node, Object, boolean":N});function C(e,t,r){var n=e.type,i=arguments.length>1;if("OperatorNode"===n&&e.isBinary()){var s,o=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(o=(s=parseFloat(e.args[1].value))>=2&&Ku(s))),o){if(s>2){var a=e.args[0],l=new T("^","pow",[e.args[0].cloneDeep(),new x(s-1)]);e=new T("*","multiply",[a,l])}else e=new T("*","multiply",[e.args[0],e.args[0].cloneDeep()]);i&&("content"===r?t.content=e:t.args[r]=e)}}if("ParenthesisNode"===n)C(e.content,e,"content");else if("ConstantNode"!==n&&"SymbolNode"!==n)for(var u=0;u<e.args.length;u++)C(e.args[u],e,u);if(!i)return e}function k(e,t){void 0===t&&(t=[]),t[0]=0;var r={cte:1,oper:"+",fire:""},n=0,i="";!function e(r,s,o){var a=r.type;if("FunctionNode"===a)throw new Error("There is an unsolved function call");if("OperatorNode"===a){if(-1==="+-*^".indexOf(r.op))throw new Error("Operator "+r.op+" invalid");if(null!==s){if(("unaryMinus"===r.fn||"pow"===r.fn)&&"add"!==s.fn&&"subtract"!==s.fn&&"multiply"!==s.fn)throw new Error("Invalid "+r.op+" placing");if(("subtract"===r.fn||"add"===r.fn||"multiply"===r.fn)&&"add"!==s.fn&&"subtract"!==s.fn)throw new Error("Invalid "+r.op+" placing");if(("subtract"===r.fn||"add"===r.fn||"unaryMinus"===r.fn)&&0!==o.noFil)throw new Error("Invalid "+r.op+" placing")}"^"!==r.op&&"*"!==r.op||(o.fire=r.op);for(var l=0;l<r.args.length;l++)"unaryMinus"===r.fn&&(o.oper="-"),"+"!==r.op&&"subtract"!==r.fn||(o.fire="",o.cte=1,o.oper=0===l?"+":r.op),o.noFil=l,e(r.args[l],r,o)}else if("SymbolNode"===a){if(r.name!==i&&""!==i)throw new Error("There is more than one variable");if(i=r.name,null===s)return void(t[1]=1);if("^"===s.op&&0!==o.noFil)throw new Error("In power the variable should be the first parameter");if("*"===s.op&&1!==o.noFil)throw new Error("In multiply the variable should be the second parameter");""!==o.fire&&"*"!==o.fire||(n<1&&(t[1]=0),t[1]+=o.cte*("+"===o.oper?1:-1),n=Math.max(1,n))}else{if("ConstantNode"!==a)throw new Error("Type "+a+" is not allowed");var u=parseFloat(r.value);if(null===s)return void(t[0]=u);if("^"===s.op){if(1!==o.noFil)throw new Error("Constant cannot be powered");if(!Ku(u)||u<=0)throw new Error("Non-integer exponent is not allowed");for(var c=n+1;c<u;c++)t[c]=0;return u>n&&(t[u]=0),t[u]+=o.cte*("+"===o.oper?1:-1),void(n=Math.max(u,n))}o.cte=u,""===o.fire&&(t[0]+=o.cte*("+"===o.oper?1:-1))}}(e,null,r);for(var s,o=!0,a=n=t.length-1;a>=0;a--)if(0!==t[a]){var l=new x(o?t[a]:Math.abs(t[a])),u=t[a]<0?"-":"+";if(a>0){var c=new A(i);if(a>1){var d=new x(a);c=new T("^","pow",[c,d])}l=-1===t[a]&&o?new T("-","unaryMinus",[c]):1===Math.abs(t[a])?c:new T("*","multiply",[l,c])}s=o?l:"+"===u?new T("+","add",[s,l]):new T("-","subtract",[s,l]),o=!1}return o?new x(0):s}})),Bh=r(44814);function Uh(e,t,r,n,i){if(Bh.isTypedFunction(e)){var s=[t,r,n],o=Bh.resolve(e,s);if(o)return d(o.implementation,s);var a=[t,r],l=Bh.resolve(e,a);if(l)return d(l.implementation,a);var u=[t],c=Bh.resolve(e,u);return c?d(c.implementation,u):d(e,s)}return e(t,r,n);function d(s,o){try{return s.apply(s,o)}catch(s){var a;if(s instanceof TypeError&&"wrongType"===(null===(a=s.data)||void 0===a?void 0:a.category)){var l=[];throw l.push("value: ".concat(Tu(t))),o.length>=2&&l.push("index: ".concat(Tu(r))),o.length>=3&&l.push("array: ".concat(Tu(n))),new TypeError("Function ".concat(i," cannot apply callback arguments ")+"".concat(e.name,"(").concat(l.join(", "),") at index ").concat(JSON.stringify(r)))}throw new TypeError("Function ".concat(i," cannot apply callback arguments ")+"to function ".concat(e.name,": ").concat(s.message))}}}function $h(e,t,r){var n=e.filter((function(e){return Eu(e)&&!(e.name in t)&&!r.has(e.name)}))[0];if(!n)throw new Error('No undefined variable found in inline expression "'+e+'"');var i=n.name,s=$d(r),o=e.compile();return function(e){return s.set(i,e),o.evaluate(s)}}var jh=Mu("filter",["typed"],(e=>{var{typed:t}=e;function r(e,t,r){var i,s;return e[0]&&(i=e[0].compile().evaluate(r)),e[1]&&(s=Eu(e[1])||fu(e[1])?e[1].compile().evaluate(r):$h(e[1],t,r)),n(i,s)}r.rawArgs=!0;var n=t("filter",{"Array, function":zh,"Matrix, function":function(e,t){return e.create(zh(e.toArray(),t))},"Array, RegExp":Gc,"Matrix, RegExp":function(e,t){return e.create(Gc(e.toArray(),t))}});return r}),{isTransformFunction:!0});function zh(e,t){return Vc(e,(function(e,r,n){return Uh(t,e,[r+1],n,"filter")}))}var qh=Mu("forEach",["typed"],(e=>{var{typed:t}=e;function r(e,t,r){var i,s;return e[0]&&(i=e[0].compile().evaluate(r)),e[1]&&(s=Eu(e[1])||fu(e[1])?e[1].compile().evaluate(r):$h(e[1],t,r)),n(i,s)}r.rawArgs=!0;var n=t("forEach",{"Array | Matrix, function":function(e,t){!function r(n,i){if(!Array.isArray(n))return Uh(t,n,i,e,"forEach");Hc(n,(function(e,t){r(e,i.concat(t+1))}))}(e.valueOf(),[])}});return r}),{isTransformFunction:!0}),Hh=Mu("map",["typed"],(e=>{var{typed:t}=e;function r(e,t,r){var i,s;return e[0]&&(i=e[0].compile().evaluate(r)),e[1]&&(s=Eu(e[1])||fu(e[1])?e[1].compile().evaluate(r):$h(e[1],t,r)),n(i,s)}r.rawArgs=!0;var n=t("map",{"Array, function":function(e,t){return Vh(e,t,e)},"Matrix, function":function(e,t){return e.create(Vh(e.valueOf(),t,e))}});return r}),{isTransformFunction:!0});function Vh(e,t,r){return function e(n,i){return Array.isArray(n)?qc(n,(function(t,r){return e(t,i.concat(r+1))})):Uh(t,n,i,r,"map")}(e,[])}var Gh="apply",Wh=Mu(Gh,["typed","isInteger"],(e=>{var{typed:t,isInteger:r}=e;return t(Gh,{"Array | Matrix, number | BigNumber, function":function(e,t,n){if(!r(t))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(e)?kc(e):e.size();if(t<0||t>=i.length)throw new Cc(t,i.length);return Vl(e)?e.create(Kh(e.valueOf(),t,n)):Kh(e,t,n)}})}));function Kh(e,t,r){var n,i,s;if(t<=0){if(Array.isArray(e[0])){for(s=function(e){var t,r,n=e.length,i=e[0].length,s=[];for(r=0;r<i;r++){var o=[];for(t=0;t<n;t++)o.push(e[t][r]);s.push(o)}return s}(e),i=[],n=0;n<s.length;n++)i[n]=Kh(s[n],t-1,r);return i}return r(e)}for(i=[],n=0;n<e.length;n++)i[n]=Kh(e[n],t-1,r);return i}var Yh=Mu("apply",["typed","isInteger"],(e=>{var{typed:t,isInteger:r}=e,n=Wh({typed:t,isInteger:r});return t("apply",{"...any":function(e){var t=e[1];Bl(t)?e[1]=t-1:Ul(t)&&(e[1]=t.minus(1));try{return n.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),Jh="subset",Zh=Mu(Jh,["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return t(Jh,{"Array, Index":function(e,t){var n=r(e).subset(t);return t.isScalar()?n:n.valueOf()},"Matrix, Index":function(e,t){return e.subset(t)},"Object, Index":ef,"string, Index":Xh,"Array, Index, any":function(e,t,n){return r(Du(e)).subset(t,n,void 0).valueOf()},"Array, Index, any, any":function(e,t,n,i){return r(Du(e)).subset(t,n,i).valueOf()},"Matrix, Index, any":function(e,t,r){return e.clone().subset(t,r)},"Matrix, Index, any, any":function(e,t,r,n){return e.clone().subset(t,r,n)},"string, Index, string":Qh,"string, Index, string, string":Qh,"Object, Index, any":tf})}));function Xh(e,t){if(!Jl(t))throw new TypeError("Index expected");if(1!==t.size().length)throw new Nc(t.size().length,1);var r=e.length;_c(t.min()[0],r),_c(t.max()[0],r);var n=t.dimension(0),i="";return n.forEach((function(t){i+=e.charAt(t)})),i}function Qh(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Index expected");if(1!==t.size().length)throw new Nc(t.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";var i=t.dimension(0);if(i.size()[0]!==r.length)throw new Nc(i.size()[0],r.length);var s=e.length;_c(t.min()[0]),_c(t.max()[0]);for(var o=[],a=0;a<s;a++)o[a]=e.charAt(a);if(i.forEach((function(e,t){o[e]=r.charAt(t[0])})),o.length>s)for(var l=s-1,u=o.length;l<u;l++)o[l]||(o[l]=n);return o.join("")}function ef(e,t){if(1!==t.size().length)throw new Nc(t.size(),1);var r=t.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");return _u(e,r)}function tf(e,t,r){if(1!==t.size().length)throw new Nc(t.size(),1);var n=t.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");var i=Du(e);return Lu(i,n,r),i}var rf=Mu("subset",["typed","matrix"],(e=>{var{typed:t,matrix:r}=e,n=Zh({typed:t,matrix:r});return t("subset",{"...any":function(e){try{return n.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),nf="concat",sf=Mu(nf,["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:r,isInteger:n}=e;return t(nf,{"...Array | Matrix | number | BigNumber":function(e){var t,i,s=e.length,o=-1,a=!1,l=[];for(t=0;t<s;t++){var u=e[t];if(Vl(u)&&(a=!0),Bl(u)||Ul(u)){if(t!==s-1)throw new Error("Dimension must be specified as last argument");if(i=o,o=u.valueOf(),!n(o))throw new TypeError("Integer number expected for dimension");if(o<0||t>0&&o>i)throw new Cc(o,i+1)}else{var c=Du(u).valueOf(),d=kc(c);if(l[t]=c,i=o,o=d.length-1,t>0&&o!==i)throw new Nc(i+1,o+1)}}if(0===l.length)throw new SyntaxError("At least one matrix expected");for(var h=l.shift();l.length;)h=of(h,l.shift(),o,0);return a?r(h):h},"...string":function(e){return e.join("")}})}));function of(e,t,r,n){if(n<r){if(e.length!==t.length)throw new Nc(e.length,t.length);for(var i=[],s=0;s<e.length;s++)i[s]=of(e[s],t[s],r,n+1);return i}return e.concat(t)}var af=Mu("concat",["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:r,isInteger:n}=e,i=sf({typed:t,matrix:r,isInteger:n});return t("concat",{"...any":function(e){var t=e.length-1,r=e[t];Bl(r)?e[t]=r-1:Ul(r)&&(e[t]=r.minus(1));try{return i.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0});function lf(e,t,r){var n;return-1!==String(e).indexOf("Unexpected type")?(n=arguments.length>2?" (type: "+Tu(r)+", value: "+JSON.stringify(r)+")":" (type: "+e.data.actual+")",new TypeError("Cannot calculate "+t+", unexpected type of argument"+n)):-1!==String(e).indexOf("complex numbers")?(n=arguments.length>2?" (type: "+Tu(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+t+", no ordering relation is defined for complex numbers"+n)):e}var uf=Mu("max",["typed","config","numeric","larger"],(e=>{var{typed:t,config:r,numeric:n,larger:i}=e;return t("max",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){return Wd(e,t.valueOf(),s)},"...":function(e){if(Hd(e))throw new TypeError("Scalar values expected in function max");return o(e)}});function s(e,t){try{return i(e,t)?e:t}catch(e){throw lf(e,"max",t)}}function o(e){var t;if(Vd(e,(function(e){try{isNaN(e)&&"number"==typeof e?t=NaN:(void 0===t||i(e,t))&&(t=e)}catch(t){throw lf(t,"max",e)}})),void 0===t)throw new Error("Cannot calculate max of an empty array");return"string"==typeof t&&(t=n(t,r.number)),t}}));function cf(e){if(2===e.length&&Gl(e[0])){var t=(e=e.slice())[1];Bl(t)?e[1]=t-1:Ul(t)&&(e[1]=t.minus(1))}return e}var df,hf,ff=Mu("max",["typed","config","numeric","larger"],(e=>{var{typed:t,config:r,numeric:n,larger:i}=e,s=uf({typed:t,config:r,numeric:n,larger:i});return t("max",{"...any":function(e){e=cf(e);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),pf=Mu("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:r,add:n,numeric:i}=e;return t("sum",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){try{return Wd(e,t,n)}catch(e){throw lf(e,"sum")}},"...":function(e){if(Hd(e))throw new TypeError("Scalar values expected in function sum");return s(e)}});function s(e){var t;return Vd(e,(function(e){try{t=void 0===t?e:n(t,e)}catch(t){throw lf(t,"sum",e)}})),void 0===t&&(t=i(0,r.number)),"string"==typeof t&&(t=i(t,r.number)),t}})),mf=Mu("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:r,add:n,numeric:i}=e,s=pf({typed:t,config:r,add:n,numeric:i});return t("sum",{"...any":function(e){e=cf(e);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),gf=Mu("min",["typed","config","numeric","smaller"],(e=>{var{typed:t,config:r,numeric:n,smaller:i}=e;return t("min",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){return Wd(e,t.valueOf(),s)},"...":function(e){if(Hd(e))throw new TypeError("Scalar values expected in function min");return o(e)}});function s(e,t){try{return i(e,t)?e:t}catch(e){throw lf(e,"min",t)}}function o(e){var t;if(Vd(e,(function(e){try{isNaN(e)&&"number"==typeof e?t=NaN:(void 0===t||i(e,t))&&(t=e)}catch(t){throw lf(t,"min",e)}})),void 0===t)throw new Error("Cannot calculate min of an empty array");return"string"==typeof t&&(t=n(t,r.number)),t}})),yf=Mu("min",["typed","config","numeric","smaller"],(e=>{var{typed:t,config:r,numeric:n,smaller:i}=e,s=gf({typed:t,config:r,numeric:n,smaller:i});return t("min",{"...any":function(e){e=cf(e);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),vf="cumsum",bf=Mu(vf,["typed","add","unaryPlus"],(e=>{var{typed:t,add:r,unaryPlus:n}=e;return t(vf,{Array:i,Matrix:function(e){return e.create(i(e.valueOf()))},"Array, number | BigNumber":o,"Matrix, number | BigNumber":function(e,t){return e.create(o(e.valueOf(),t))},"...":function(e){if(Hd(e))throw new TypeError("All values expected to be scalar in function cumsum");return i(e)}});function i(e){try{return s(e)}catch(e){throw lf(e,vf)}}function s(e){if(0===e.length)return[];for(var t=[n(e[0])],i=1;i<e.length;++i)t.push(r(t[i-1],e[i]));return t}function o(e,t){var r=kc(e);if(t<0||t>=r.length)throw new Cc(t,r.length);try{return a(e,t)}catch(e){throw lf(e,vf)}}function a(e,t){var r,n,i;if(t<=0){var o=e[0][0];if(Array.isArray(o)){for(i=qd(e),n=[],r=0;r<i.length;r++)n[r]=a(i[r],t-1);return n}return s(e)}for(n=[],r=0;r<e.length;r++)n[r]=a(e[r],t-1);return n}})),xf="cumsum",wf=Mu(xf,["typed","add","unaryPlus"],(e=>{var{typed:t,add:r,unaryPlus:n}=e,i=bf({typed:t,add:r,unaryPlus:n});return t(xf,{"...any":function(e){if(2===e.length&&Gl(e[0])){var t=e[1];Bl(t)?e[1]=t-1:Ul(t)&&(e[1]=t.minus(1))}try{return i.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),Ef="diff",Sf=Mu(Ef,["typed","matrix","subtract","number"],(e=>{var{typed:t,matrix:r,subtract:n,number:i}=e;return t(Ef,{"Array | Matrix":function(e){return Vl(e)?r(o(e.toArray())):o(e)},"Array | Matrix, number":function(e,t){if(!Ku(t))throw new RangeError("Dimension must be a whole number");return Vl(e)?r(s(e.toArray(),t)):s(e,t)},"Array, BigNumber":t.referTo("Array,number",(e=>(t,r)=>e(t,i(r)))),"Matrix, BigNumber":t.referTo("Matrix,number",(e=>(t,r)=>e(t,i(r))))});function s(e,t){if(Vl(e)&&(e=e.toArray()),!Array.isArray(e))throw RangeError("Array/Matrix does not have that many dimensions");if(t>0){var r=[];return e.forEach((e=>{r.push(s(e,t-1))})),r}if(0===t)return o(e);throw RangeError("Cannot have negative dimension")}function o(e){for(var t=[],r=e.length,n=1;n<r;n++)t.push(a(e[n-1],e[n]));return t}function a(e,t){Vl(e)&&(e=e.toArray()),Vl(t)&&(t=t.toArray());var r=Array.isArray(e),i=Array.isArray(t);if(r&&i)return function(e,t){if(e.length!==t.length)throw RangeError("Not all sub-arrays have the same length");for(var r=[],n=e.length,i=0;i<n;i++)r.push(a(e[i],t[i]));return r}(e,t);if(!r&&!i)return n(t,e);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}})),Tf="diff",Af=Mu(Tf,["typed","matrix","subtract","number","bignumber"],(e=>{var{typed:t,matrix:r,subtract:n,number:i,bignumber:s}=e,o=Sf({typed:t,matrix:r,subtract:n,number:i,bignumber:s});return t(Tf,{"...any":function(e){e=cf(e);try{return o.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),Df=Mu("index",["Index"],(e=>{var{Index:t}=e;return function(){for(var e=[],r=0,n=arguments.length;r<n;r++){var i=arguments[r];if(Yl(i))i.start--,i.end-=i.step>0?0:2;else if(i&&!0===i.isSet)i=i.map((function(e){return e-1}));else if(Hl(i)||Vl(i))i=i.map((function(e){return e-1}));else if(Bl(i))i--;else if(Ul(i))i=i.toNumber()-1;else if("string"!=typeof i)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");e[r]=i}var s=new t;return t.apply(s,e),s}}),{isTransformFunction:!0}),Nf="range",Cf=Mu(Nf,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:r,matrix:n,bignumber:i,smaller:s,smallerEq:o,larger:a,largerEq:l,add:u,isPositive:c}=e;return t(Nf,{string:h,"string, boolean":h,"number, number":function(e,t){return d(f(e,t,1,!1))},"number, number, number":function(e,t,r){return d(f(e,t,r,!1))},"number, number, boolean":function(e,t,r){return d(f(e,t,1,r))},"number, number, number, boolean":function(e,t,r,n){return d(f(e,t,r,n))},"BigNumber, BigNumber":function(e,t){return d(f(e,t,new(0,e.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(e,t,r){return d(f(e,t,r,!1))},"BigNumber, BigNumber, boolean":function(e,t,r){return d(f(e,t,new(0,e.constructor)(1),r))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,r,n){return d(f(e,t,r,n))},"Unit, Unit, Unit":function(e,t,r){return d(f(e,t,r,!1))},"Unit, Unit, Unit, boolean":function(e,t,r,n){return d(f(e,t,r,n))}});function d(e){return"Matrix"===r.matrix?n?n(e):ih():e}function h(e,t){var n=function(e){var t=e.split(":"),r=t.map((function(e){return Number(e)}));if(r.some((function(e){return isNaN(e)})))return null;switch(r.length){case 2:return{start:r[0],end:r[1],step:1};case 3:return{start:r[0],end:r[2],step:r[1]};default:return null}}(e);if(!n)throw new SyntaxError('String "'+e+'" is no valid range');return"BigNumber"===r.number?(void 0===i&&rh(),d(f(i(n.start),i(n.end),i(n.step)))):d(f(n.start,n.end,n.step,t))}function f(e,t,r,n){for(var i=[],d=c(r)?n?o:s:n?l:a,h=e;d(h,t);)i.push(h),h=u(h,r);return i}})),kf=Mu("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:r,matrix:n,bignumber:i,smaller:s,smallerEq:o,larger:a,largerEq:l,add:u,isPositive:c}=e,d=Cf({typed:t,config:r,matrix:n,bignumber:i,smaller:s,smallerEq:o,larger:a,largerEq:l,add:u,isPositive:c});return t("range",{"...any":function(e){return"boolean"!=typeof e[e.length-1]&&e.push(!0),d.apply(null,e)}})}),{isTransformFunction:!0}),Mf=Mu("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e;return t("row",{"Matrix, number":s,"Array, number":function(e,t){return s(n(Du(e)),t).valueOf()}});function s(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");_c(t,e.size()[0]);var s=i(0,e.size()[1]),o=new r(t,s),a=e.subset(o);return Vl(a)?a:n([[a]])}})),Of=Mu("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e,s=Mf({typed:t,Index:r,matrix:n,range:i});return t("row",{"...any":function(e){var t=e.length-1,r=e[t];Bl(r)&&(e[t]=r-1);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),_f="column",Lf=Mu(_f,["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e;return t(_f,{"Matrix, number":s,"Array, number":function(e,t){return s(n(Du(e)),t).valueOf()}});function s(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");_c(t,e.size()[1]);var s=i(0,e.size()[0]),o=new r(s,t),a=e.subset(o);return Vl(a)?a:n([[a]])}})),Rf=Mu("column",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e,s=Lf({typed:t,Index:r,matrix:n,range:i});return t("column",{"...any":function(e){var t=e.length-1,r=e[t];Bl(r)&&(e[t]=r-1);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),If="mean",Ff=Mu(If,["typed","add","divide"],(e=>{var{typed:t,add:r,divide:n}=e;return t(If,{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){try{var i=Wd(e,t,r),s=Array.isArray(e)?kc(e):e.size();return n(i,s[t])}catch(e){throw lf(e,"mean")}},"...":function(e){if(Hd(e))throw new TypeError("Scalar values expected in function mean");return i(e)}});function i(e){var t,i=0;if(Vd(e,(function(e){try{t=void 0===t?e:r(t,e),i++}catch(t){throw lf(t,"mean",e)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return n(t,i)}})),Pf=Mu("mean",["typed","add","divide"],(e=>{var{typed:t,add:r,divide:n}=e,i=Ff({typed:t,add:r,divide:n});return t("mean",{"...any":function(e){e=cf(e);try{return i.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),Bf="unbiased",Uf="variance",$f=Mu(Uf,["typed","add","subtract","multiply","divide","apply","isNaN"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:s,apply:o,isNaN:a}=e;return t(Uf,{"Array | Matrix":function(e){return l(e,Bf)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(e,t){return u(e,t,Bf)},"Array | Matrix, number | BigNumber, string":u,"...":function(e){return l(e,Bf)}});function l(e,t){var o,l=0;if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Vd(e,(function(e){try{o=void 0===o?e:r(o,e),l++}catch(t){throw lf(t,"variance",e)}})),0===l)throw new Error("Cannot calculate variance of an empty array");var u=s(o,l);if(o=void 0,Vd(e,(function(e){var t=n(e,u);o=void 0===o?i(t,t):r(o,i(t,t))})),a(o))return o;switch(t){case"uncorrected":return s(o,l);case"biased":return s(o,l+1);case"unbiased":var c=Ul(o)?o.mul(0):0;return 1===l?c:s(o,l-1);default:throw new Error('Unknown normalization "'+t+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(e,t,r){try{if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return o(e,t,(e=>l(e,r)))}catch(e){throw lf(e,"variance")}}})),jf="variance",zf=Mu(jf,["typed","add","subtract","multiply","divide","apply","isNaN"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:s,apply:o,isNaN:a}=e,l=$f({typed:t,add:r,subtract:n,multiply:i,divide:s,apply:o,isNaN:a});return t(jf,{"...any":function(e){e=cf(e);try{return l.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),qf=Mu("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:r,sqrt:n,variance:i}=e;return t("std",{"Array | Matrix":s,"Array | Matrix, string":s,"Array | Matrix, number | BigNumber":s,"Array | Matrix, number | BigNumber, string":s,"...":function(e){return s(e)}});function s(e,t){if(0===e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var s=i.apply(null,arguments);return Gl(s)?r(s,n):n(s)}catch(e){throw e instanceof TypeError&&-1!==e.message.indexOf(" variance")?new TypeError(e.message.replace(" variance"," std")):e}}})),Hf=Mu("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:r,sqrt:n,variance:i}=e,s=qf({typed:t,map:r,sqrt:n,variance:i});return t("std",{"...any":function(e){e=cf(e);try{return s.apply(null,e)}catch(e){throw Od(e)}}})}),{isTransformFunction:!0}),Vf=9e15,Gf=1e9,Wf="0123456789abcdef",Kf="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Yf="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Jf={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Vf,maxE:Vf,crypto:!1},Zf=!0,Xf="[DecimalError] ",Qf=Xf+"Invalid argument: ",ep=Xf+"Precision limit exceeded",tp=Xf+"crypto unavailable",rp="[object Decimal]",np=Math.floor,ip=Math.pow,sp=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,op=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,ap=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,lp=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,cp=1e7,dp=7,hp=Kf.length-1,fp=Yf.length-1,pp={toStringTag:rp};function mp(e){var t,r,n,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)n=e[t]+"",(r=dp-n.length)&&(s+=Dp(r)),s+=n;o=e[t],(r=dp-(n=o+"").length)&&(s+=Dp(r))}else if(0===o)return"0";for(;o%10==0;)o/=10;return s+o}function gp(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Qf+e)}function yp(e,t,r,n){var i,s,o,a;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=dp,i=0):(i=Math.ceil((t+1)/dp),t%=dp),s=ip(10,dp-t),a=e[i]%s|0,null==n?t<3?(0==t?a=a/100|0:1==t&&(a=a/10|0),o=r<4&&99999==a||r>3&&49999==a||5e4==a||0==a):o=(r<4&&a+1==s||r>3&&a+1==s/2)&&(e[i+1]/s/100|0)==ip(10,t-2)-1||(a==s/2||0==a)&&0==(e[i+1]/s/100|0):t<4?(0==t?a=a/1e3|0:1==t?a=a/100|0:2==t&&(a=a/10|0),o=(n||r<4)&&9999==a||!n&&r>3&&4999==a):o=((n||r<4)&&a+1==s||!n&&r>3&&a+1==s/2)&&(e[i+1]/s/1e3|0)==ip(10,t-3)-1,o}function vp(e,t,r){for(var n,i,s=[0],o=0,a=e.length;o<a;){for(i=s.length;i--;)s[i]*=t;for(s[0]+=Wf.indexOf(e.charAt(o++)),n=0;n<s.length;n++)s[n]>r-1&&(void 0===s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/r|0,s[n]%=r)}return s.reverse()}pp.absoluteValue=pp.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),xp(e)},pp.ceil=function(){return xp(new this.constructor(this),this.e+1,2)},pp.clampedTo=pp.clamp=function(e,t){var r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(Qf+t);return r.cmp(e)<0?e:r.cmp(t)>0?t:new n(r)},pp.comparedTo=pp.cmp=function(e){var t,r,n,i,s=this,o=s.d,a=(e=new s.constructor(e)).d,l=s.s,u=e.s;if(!o||!a)return l&&u?l!==u?l:o===a?0:!o^l<0?1:-1:NaN;if(!o[0]||!a[0])return o[0]?l:a[0]?-u:0;if(l!==u)return l;if(s.e!==e.e)return s.e>e.e^l<0?1:-1;for(t=0,r=(n=o.length)<(i=a.length)?n:i;t<r;++t)if(o[t]!==a[t])return o[t]>a[t]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1},pp.cosine=pp.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+dp,n.rounding=1,r=function(e,t){var r,n,i;if(t.isZero())return t;n=t.d.length,n<32?i=(1/Fp(4,r=Math.ceil(n/3))).toString():(r=16,i="2.3283064365386962890625e-10");e.precision+=r,t=Ip(e,1,t.times(i),new e(1));for(var s=r;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=r,t}(n,Pp(n,r)),n.precision=e,n.rounding=t,xp(2==hf||3==hf?r.neg():r,e,t,!0)):new n(1):new n(NaN)},pp.cubeRoot=pp.cbrt=function(){var e,t,r,n,i,s,o,a,l,u,c=this,d=c.constructor;if(!c.isFinite()||c.isZero())return new d(c);for(Zf=!1,(s=c.s*ip(c.s*c,1/3))&&Math.abs(s)!=1/0?n=new d(s.toString()):(r=mp(c.d),(s=((e=c.e)-r.length+1)%3)&&(r+=1==s||-2==s?"0":"00"),s=ip(r,1/3),e=np((e+1)/3)-(e%3==(e<0?-1:2)),(n=new d(r=s==1/0?"5e"+e:(r=s.toExponential()).slice(0,r.indexOf("e")+1)+e)).s=c.s),o=(e=d.precision)+3;;)if(u=(l=(a=n).times(a).times(a)).plus(c),n=bp(u.plus(c).times(a),u.plus(l),o+2,1),mp(a.d).slice(0,o)===(r=mp(n.d)).slice(0,o)){if("9999"!=(r=r.slice(o-3,o+1))&&(i||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(xp(n,e+1,1),t=!n.times(n).times(n).eq(c));break}if(!i&&(xp(a,e+1,0),a.times(a).times(a).eq(c))){n=a;break}o+=4,i=1}return Zf=!0,xp(n,e,d.rounding,t)},pp.decimalPlaces=pp.dp=function(){var e,t=this.d,r=NaN;if(t){if(r=((e=t.length-1)-np(this.e/dp))*dp,e=t[e])for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r},pp.dividedBy=pp.div=function(e){return bp(this,new this.constructor(e))},pp.dividedToIntegerBy=pp.divToInt=function(e){var t=this.constructor;return xp(bp(this,new t(e),0,1,1),t.precision,t.rounding)},pp.equals=pp.eq=function(e){return 0===this.cmp(e)},pp.floor=function(){return xp(new this.constructor(this),this.e+1,3)},pp.greaterThan=pp.gt=function(e){return this.cmp(e)>0},pp.greaterThanOrEqualTo=pp.gte=function(e){var t=this.cmp(e);return 1==t||0===t},pp.hyperbolicCosine=pp.cosh=function(){var e,t,r,n,i,s=this,o=s.constructor,a=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return a;r=o.precision,n=o.rounding,o.precision=r+Math.max(s.e,s.sd())+4,o.rounding=1,(i=s.d.length)<32?t=(1/Fp(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),s=Ip(o,1,s.times(t),new o(1),!0);for(var l,u=e,c=new o(8);u--;)l=s.times(s),s=a.minus(l.times(c.minus(l.times(c))));return xp(s,o.precision=r,o.rounding=n,!0)},pp.hyperbolicSine=pp.sinh=function(){var e,t,r,n,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(t=s.precision,r=s.rounding,s.precision=t+Math.max(i.e,i.sd())+4,s.rounding=1,(n=i.d.length)<3)i=Ip(s,2,i,i,!0);else{e=(e=1.4*Math.sqrt(n))>16?16:0|e,i=Ip(s,2,i=i.times(1/Fp(5,e)),i,!0);for(var o,a=new s(5),l=new s(16),u=new s(20);e--;)o=i.times(i),i=i.times(a.plus(o.times(l.times(o).plus(u))))}return s.precision=t,s.rounding=r,xp(i,t,r,!0)},pp.hyperbolicTangent=pp.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,bp(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)},pp.inverseCosine=pp.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),i=r.precision,s=r.rounding;return-1!==n?0===n?t.isNeg()?Tp(r,i,s):new r(0):new r(NaN):t.isZero()?Tp(r,i+4,s).times(.5):(r.precision=i+6,r.rounding=1,t=t.asin(),e=Tp(r,i+4,s).times(.5),r.precision=i,r.rounding=s,e.minus(t))},pp.inverseHyperbolicCosine=pp.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,Zf=!1,r=r.times(r).minus(1).sqrt().plus(r),Zf=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)},pp.inverseHyperbolicSine=pp.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,Zf=!1,r=r.times(r).plus(1).sqrt().plus(r),Zf=!0,n.precision=e,n.rounding=t,r.ln())},pp.inverseHyperbolicTangent=pp.atanh=function(){var e,t,r,n,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,t=s.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?xp(new s(i),e,t,!0):(s.precision=r=n-i.e,i=bp(i.plus(1),new s(1).minus(i),r+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=t,i.times(.5))):new s(NaN)},pp.inverseSine=pp.asin=function(){var e,t,r,n,i=this,s=i.constructor;return i.isZero()?new s(i):(t=i.abs().cmp(1),r=s.precision,n=s.rounding,-1!==t?0===t?((e=Tp(s,r+4,n).times(.5)).s=i.s,e):new s(NaN):(s.precision=r+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=r,s.rounding=n,i.times(2)))},pp.inverseTangent=pp.atan=function(){var e,t,r,n,i,s,o,a,l,u=this,c=u.constructor,d=c.precision,h=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&d+4<=fp)return(o=Tp(c,d+4,h).times(.25)).s=u.s,o}else{if(!u.s)return new c(NaN);if(d+4<=fp)return(o=Tp(c,d+4,h).times(.5)).s=u.s,o}for(c.precision=a=d+10,c.rounding=1,e=r=Math.min(28,a/dp+2|0);e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(Zf=!1,t=Math.ceil(a/dp),n=1,l=u.times(u),o=new c(u),i=u;-1!==e;)if(i=i.times(l),s=o.minus(i.div(n+=2)),i=i.times(l),void 0!==(o=s.plus(i.div(n+=2))).d[t])for(e=t;o.d[e]===s.d[e]&&e--;);return r&&(o=o.times(2<<r-1)),Zf=!0,xp(o,c.precision=d,c.rounding=h,!0)},pp.isFinite=function(){return!!this.d},pp.isInteger=pp.isInt=function(){return!!this.d&&np(this.e/dp)>this.d.length-2},pp.isNaN=function(){return!this.s},pp.isNegative=pp.isNeg=function(){return this.s<0},pp.isPositive=pp.isPos=function(){return this.s>0},pp.isZero=function(){return!!this.d&&0===this.d[0]},pp.lessThan=pp.lt=function(e){return this.cmp(e)<0},pp.lessThanOrEqualTo=pp.lte=function(e){return this.cmp(e)<1},pp.logarithm=pp.log=function(e){var t,r,n,i,s,o,a,l,u=this,c=u.constructor,d=c.precision,h=c.rounding;if(null==e)e=new c(10),t=!0;else{if(r=(e=new c(e)).d,e.s<0||!r||!r[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new c(r&&!r[0]?-1/0:1!=u.s?NaN:r?0:1/0);if(t)if(r.length>1)s=!0;else{for(i=r[0];i%10==0;)i/=10;s=1!==i}if(Zf=!1,o=Op(u,a=d+5),n=t?Sp(c,a+10):Op(e,a),yp((l=bp(o,n,a,1)).d,i=d,h))do{if(o=Op(u,a+=10),n=t?Sp(c,a+10):Op(e,a),l=bp(o,n,a,1),!s){+mp(l.d).slice(i+1,i+15)+1==1e14&&(l=xp(l,d+1,0));break}}while(yp(l.d,i+=10,h));return Zf=!0,xp(l,d,h)},pp.minus=pp.sub=function(e){var t,r,n,i,s,o,a,l,u,c,d,h,f=this,p=f.constructor;if(e=new p(e),!f.d||!e.d)return f.s&&e.s?f.d?e.s=-e.s:e=new p(e.d||f.s!==e.s?f:NaN):e=new p(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.plus(e);if(u=f.d,h=e.d,a=p.precision,l=p.rounding,!u[0]||!h[0]){if(h[0])e.s=-e.s;else{if(!u[0])return new p(3===l?-0:0);e=new p(f)}return Zf?xp(e,a,l):e}if(r=np(e.e/dp),c=np(f.e/dp),u=u.slice(),s=c-r){for((d=s<0)?(t=u,s=-s,o=h.length):(t=h,r=c,o=u.length),s>(n=Math.max(Math.ceil(a/dp),o)+2)&&(s=n,t.length=1),t.reverse(),n=s;n--;)t.push(0);t.reverse()}else{for((d=(n=u.length)<(o=h.length))&&(o=n),n=0;n<o;n++)if(u[n]!=h[n]){d=u[n]<h[n];break}s=0}for(d&&(t=u,u=h,h=t,e.s=-e.s),o=u.length,n=h.length-o;n>0;--n)u[o++]=0;for(n=h.length;n>s;){if(u[--n]<h[n]){for(i=n;i&&0===u[--i];)u[i]=cp-1;--u[i],u[n]+=cp}u[n]-=h[n]}for(;0===u[--o];)u.pop();for(;0===u[0];u.shift())--r;return u[0]?(e.d=u,e.e=Ep(u,r),Zf?xp(e,a,l):e):new p(3===l?-0:0)},pp.modulo=pp.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?xp(new n(r),n.precision,n.rounding):(Zf=!1,9==n.modulo?(t=bp(r,e.abs(),0,3,1)).s*=e.s:t=bp(r,e,0,n.modulo,1),t=t.times(e),Zf=!0,r.minus(t))},pp.naturalExponential=pp.exp=function(){return Mp(this)},pp.naturalLogarithm=pp.ln=function(){return Op(this)},pp.negated=pp.neg=function(){var e=new this.constructor(this);return e.s=-e.s,xp(e)},pp.plus=pp.add=function(e){var t,r,n,i,s,o,a,l,u,c,d=this,h=d.constructor;if(e=new h(e),!d.d||!e.d)return d.s&&e.s?d.d||(e=new h(e.d||d.s===e.s?d:NaN)):e=new h(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,c=e.d,a=h.precision,l=h.rounding,!u[0]||!c[0])return c[0]||(e=new h(d)),Zf?xp(e,a,l):e;if(s=np(d.e/dp),n=np(e.e/dp),u=u.slice(),i=s-n){for(i<0?(r=u,i=-i,o=c.length):(r=c,n=s,o=u.length),i>(o=(s=Math.ceil(a/dp))>o?s+1:o+1)&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((o=u.length)-(i=c.length)<0&&(i=o,r=c,c=u,u=r),t=0;i;)t=(u[--i]=u[i]+c[i]+t)/cp|0,u[i]%=cp;for(t&&(u.unshift(t),++n),o=u.length;0==u[--o];)u.pop();return e.d=u,e.e=Ep(u,n),Zf?xp(e,a,l):e},pp.precision=pp.sd=function(e){var t,r=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(Qf+e);return r.d?(t=Ap(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t},pp.round=function(){var e=this,t=e.constructor;return xp(new t(e),e.e+1,t.rounding)},pp.sine=pp.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+dp,n.rounding=1,r=function(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Ip(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:0|r,t=t.times(1/Fp(5,r)),t=Ip(e,2,t,t);for(var i,s=new e(5),o=new e(16),a=new e(20);r--;)i=t.times(t),t=t.times(s.plus(i.times(o.times(i).minus(a))));return t}(n,Pp(n,r)),n.precision=e,n.rounding=t,xp(hf>2?r.neg():r,e,t,!0)):new n(NaN)},pp.squareRoot=pp.sqrt=function(){var e,t,r,n,i,s,o=this,a=o.d,l=o.e,u=o.s,c=o.constructor;if(1!==u||!a||!a[0])return new c(!u||u<0&&(!a||a[0])?NaN:a?o:1/0);for(Zf=!1,0==(u=Math.sqrt(+o))||u==1/0?(((t=mp(a)).length+l)%2==0&&(t+="0"),u=Math.sqrt(t),l=np((l+1)/2)-(l<0||l%2),n=new c(t=u==1/0?"5e"+l:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new c(u.toString()),r=(l=c.precision)+3;;)if(n=(s=n).plus(bp(o,s,r+2,1)).times(.5),mp(s.d).slice(0,r)===(t=mp(n.d)).slice(0,r)){if("9999"!=(t=t.slice(r-3,r+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(xp(n,l+1,1),e=!n.times(n).eq(o));break}if(!i&&(xp(s,l+1,0),s.times(s).eq(o))){n=s;break}r+=4,i=1}return Zf=!0,xp(n,l,c.rounding,e)},pp.tangent=pp.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,(r=r.sin()).s=1,r=bp(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,xp(2==hf||4==hf?r.neg():r,e,t,!0)):new n(NaN)},pp.times=pp.mul=function(e){var t,r,n,i,s,o,a,l,u,c=this,d=c.constructor,h=c.d,f=(e=new d(e)).d;if(e.s*=c.s,!(h&&h[0]&&f&&f[0]))return new d(!e.s||h&&!h[0]&&!f||f&&!f[0]&&!h?NaN:h&&f?0*e.s:e.s/0);for(r=np(c.e/dp)+np(e.e/dp),(l=h.length)<(u=f.length)&&(s=h,h=f,f=s,o=l,l=u,u=o),s=[],n=o=l+u;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,i=l+n;i>n;)a=s[i]+f[n]*h[i-n-1]+t,s[i--]=a%cp|0,t=a/cp|0;s[i]=(s[i]+t)%cp|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=Ep(s,r),Zf?xp(e,d.precision,d.rounding):e},pp.toBinary=function(e,t){return Bp(this,2,e,t)},pp.toDecimalPlaces=pp.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),void 0===e?r:(gp(e,0,Gf),void 0===t?t=n.rounding:gp(t,0,8),xp(r,e+r.e+1,t))},pp.toExponential=function(e,t){var r,n=this,i=n.constructor;return void 0===e?r=wp(n,!0):(gp(e,0,Gf),void 0===t?t=i.rounding:gp(t,0,8),r=wp(n=xp(new i(n),e+1,t),!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},pp.toFixed=function(e,t){var r,n,i=this,s=i.constructor;return void 0===e?r=wp(i):(gp(e,0,Gf),void 0===t?t=s.rounding:gp(t,0,8),r=wp(n=xp(new s(i),e+i.e+1,t),!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r},pp.toFraction=function(e){var t,r,n,i,s,o,a,l,u,c,d,h,f=this,p=f.d,m=f.constructor;if(!p)return new m(f);if(u=r=new m(1),n=l=new m(0),o=(s=(t=new m(n)).e=Ap(p)-f.e-1)%dp,t.d[0]=ip(10,o<0?dp+o:o),null==e)e=s>0?t:u;else{if(!(a=new m(e)).isInt()||a.lt(u))throw Error(Qf+a);e=a.gt(t)?s>0?t:u:a}for(Zf=!1,a=new m(mp(p)),c=m.precision,m.precision=s=p.length*dp*2;d=bp(a,t,0,1,1),1!=(i=r.plus(d.times(n))).cmp(e);)r=n,n=i,i=u,u=l.plus(d.times(i)),l=i,i=t,t=a.minus(d.times(i)),a=i;return i=bp(e.minus(r),n,0,1,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=f.s,h=bp(u,n,s,1).minus(f).abs().cmp(bp(l,r,s,1).minus(f).abs())<1?[u,n]:[l,r],m.precision=c,Zf=!0,h},pp.toHexadecimal=pp.toHex=function(e,t){return Bp(this,16,e,t)},pp.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),null==e){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:gp(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(Zf=!1,r=bp(r,e,0,t,1).times(e),Zf=!0,xp(r)):(e.s=r.s,r=e),r},pp.toNumber=function(){return+this},pp.toOctal=function(e,t){return Bp(this,8,e,t)},pp.toPower=pp.pow=function(e){var t,r,n,i,s,o,a=this,l=a.constructor,u=+(e=new l(e));if(!(a.d&&e.d&&a.d[0]&&e.d[0]))return new l(ip(+a,u));if((a=new l(a)).eq(1))return a;if(n=l.precision,s=l.rounding,e.eq(1))return xp(a,n,s);if((t=np(e.e/dp))>=e.d.length-1&&(r=u<0?-u:u)<=9007199254740991)return i=Np(l,a,r,n),e.s<0?new l(1).div(i):xp(i,n,s);if((o=a.s)<0){if(t<e.d.length-1)return new l(NaN);if(0==(1&e.d[t])&&(o=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=o,a}return(t=0!=(r=ip(+a,u))&&isFinite(r)?new l(r+"").e:np(u*(Math.log("0."+mp(a.d))/Math.LN10+a.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?o/0:0):(Zf=!1,l.rounding=a.s=1,r=Math.min(12,(t+"").length),(i=Mp(e.times(Op(a,n+r)),n)).d&&yp((i=xp(i,n+5,1)).d,n,s)&&(t=n+10,+mp((i=xp(Mp(e.times(Op(a,t+r)),t),t+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=xp(i,n+1,0))),i.s=o,Zf=!0,l.rounding=s,xp(i,n,s))},pp.toPrecision=function(e,t){var r,n=this,i=n.constructor;return void 0===e?r=wp(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(gp(e,1,Gf),void 0===t?t=i.rounding:gp(t,0,8),r=wp(n=xp(new i(n),e,t),e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r},pp.toSignificantDigits=pp.toSD=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(gp(e,1,Gf),void 0===t?t=r.rounding:gp(t,0,8)),xp(new r(this),e,t)},pp.toString=function(){var e=this,t=e.constructor,r=wp(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r},pp.truncated=pp.trunc=function(){return xp(new this.constructor(this),this.e+1,1)},pp.valueOf=pp.toJSON=function(){var e=this,t=e.constructor,r=wp(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};var bp=function(){function e(e,t,r){var n,i=0,s=e.length;for(e=e.slice();s--;)n=e[s]*t+i,e[s]=n%r|0,i=n/r|0;return i&&e.unshift(i),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(n,i,s,o,a,l){var u,c,d,h,f,p,m,g,y,v,b,x,w,E,S,T,A,D,N,C,k=n.constructor,M=n.s==i.s?1:-1,O=n.d,_=i.d;if(!(O&&O[0]&&_&&_[0]))return new k(n.s&&i.s&&(O?!_||O[0]!=_[0]:_)?O&&0==O[0]||!_?0*M:M/0:NaN);for(l?(f=1,c=n.e-i.e):(l=cp,f=dp,c=np(n.e/f)-np(i.e/f)),N=_.length,A=O.length,v=(y=new k(M)).d=[],d=0;_[d]==(O[d]||0);d++);if(_[d]>(O[d]||0)&&c--,null==s?(E=s=k.precision,o=k.rounding):E=a?s+(n.e-i.e)+1:s,E<0)v.push(1),p=!0;else{if(E=E/f+2|0,d=0,1==N){for(h=0,_=_[0],E++;(d<A||h)&&E--;d++)S=h*l+(O[d]||0),v[d]=S/_|0,h=S%_|0;p=h||d<A}else{for((h=l/(_[0]+1)|0)>1&&(_=e(_,h,l),O=e(O,h,l),N=_.length,A=O.length),T=N,x=(b=O.slice(0,N)).length;x<N;)b[x++]=0;(C=_.slice()).unshift(0),D=_[0],_[1]>=l/2&&++D;do{h=0,(u=t(_,b,N,x))<0?(w=b[0],N!=x&&(w=w*l+(b[1]||0)),(h=w/D|0)>1?(h>=l&&(h=l-1),1==(u=t(m=e(_,h,l),b,g=m.length,x=b.length))&&(h--,r(m,N<g?C:_,g,l))):(0==h&&(u=h=1),m=_.slice()),(g=m.length)<x&&m.unshift(0),r(b,m,x,l),-1==u&&(u=t(_,b,N,x=b.length))<1&&(h++,r(b,N<x?C:_,x,l)),x=b.length):0===u&&(h++,b=[0]),v[d++]=h,u&&b[0]?b[x++]=O[T]||0:(b=[O[T]],x=1)}while((T++<A||void 0!==b[0])&&E--);p=void 0!==b[0]}v[0]||v.shift()}if(1==f)y.e=c,df=p;else{for(d=1,h=v[0];h>=10;h/=10)d++;y.e=d+c*f-1,xp(y,a?s+y.e+1:s,o,p)}return y}}();function xp(e,t,r,n){var i,s,o,a,l,u,c,d,h,f=e.constructor;e:if(null!=t){if(!(d=e.d))return e;for(i=1,a=d[0];a>=10;a/=10)i++;if((s=t-i)<0)s+=dp,o=t,l=(c=d[h=0])/ip(10,i-o-1)%10|0;else if((h=Math.ceil((s+1)/dp))>=(a=d.length)){if(!n)break e;for(;a++<=h;)d.push(0);c=l=0,i=1,o=(s%=dp)-dp+1}else{for(c=a=d[h],i=1;a>=10;a/=10)i++;l=(o=(s%=dp)-dp+i)<0?0:c/ip(10,i-o-1)%10|0}if(n=n||t<0||void 0!==d[h+1]||(o<0?c:c%ip(10,i-o-1)),u=r<4?(l||n)&&(0==r||r==(e.s<0?3:2)):l>5||5==l&&(4==r||n||6==r&&(s>0?o>0?c/ip(10,i-o):0:d[h-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=ip(10,(dp-t%dp)%dp),e.e=-t||0):d[0]=e.e=0,e;if(0==s?(d.length=h,a=1,h--):(d.length=h+1,a=ip(10,dp-s),d[h]=o>0?(c/ip(10,i-o)%ip(10,o)|0)*a:0),u)for(;;){if(0==h){for(s=1,o=d[0];o>=10;o/=10)s++;for(o=d[0]+=a,a=1;o>=10;o/=10)a++;s!=a&&(e.e++,d[0]==cp&&(d[0]=1));break}if(d[h]+=a,d[h]!=cp)break;d[h--]=0,a=1}for(s=d.length;0===d[--s];)d.pop()}return Zf&&(e.e>f.maxE?(e.d=null,e.e=NaN):e.e<f.minE&&(e.e=0,e.d=[0])),e}function wp(e,t,r){if(!e.isFinite())return _p(e);var n,i=e.e,s=mp(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Dp(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+Dp(-i-1)+s,r&&(n=r-o)>0&&(s+=Dp(n))):i>=o?(s+=Dp(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Dp(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Dp(n))),s}function Ep(e,t){var r=e[0];for(t*=dp;r>=10;r/=10)t++;return t}function Sp(e,t,r){if(t>hp)throw Zf=!0,r&&(e.precision=r),Error(ep);return xp(new e(Kf),t,1,!0)}function Tp(e,t,r){if(t>fp)throw Error(ep);return xp(new e(Yf),t,r,!0)}function Ap(e){var t=e.length-1,r=t*dp+1;if(t=e[t]){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function Dp(e){for(var t="";e--;)t+="0";return t}function Np(e,t,r,n){var i,s=new e(1),o=Math.ceil(n/dp+4);for(Zf=!1;;){if(r%2&&Up((s=s.times(t)).d,o)&&(i=!0),0===(r=np(r/2))){r=s.d.length-1,i&&0===s.d[r]&&++s.d[r];break}Up((t=t.times(t)).d,o)}return Zf=!0,s}function Cp(e){return 1&e.d[e.d.length-1]}function kp(e,t,r){for(var n,i=new e(t[0]),s=0;++s<t.length;){if(!(n=new e(t[s])).s){i=n;break}i[r](n)&&(i=n)}return i}function Mp(e,t){var r,n,i,s,o,a,l,u=0,c=0,d=0,h=e.constructor,f=h.rounding,p=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(Zf=!1,l=p):l=t,a=new h(.03125);e.e>-2;)e=e.times(a),d+=5;for(l+=n=Math.log(ip(2,d))/Math.LN10*2+5|0,r=s=o=new h(1),h.precision=l;;){if(s=xp(s.times(e),l,1),r=r.times(++c),mp((a=o.plus(bp(s,r,l,1))).d).slice(0,l)===mp(o.d).slice(0,l)){for(i=d;i--;)o=xp(o.times(o),l,1);if(null!=t)return h.precision=p,o;if(!(u<3&&yp(o.d,l-n,f,u)))return xp(o,h.precision=p,f,Zf=!0);h.precision=l+=10,r=s=a=new h(1),c=0,u++}o=a}}function Op(e,t){var r,n,i,s,o,a,l,u,c,d,h,f=1,p=e,m=p.d,g=p.constructor,y=g.rounding,v=g.precision;if(p.s<0||!m||!m[0]||!p.e&&1==m[0]&&1==m.length)return new g(m&&!m[0]?-1/0:1!=p.s?NaN:m?0:p);if(null==t?(Zf=!1,c=v):c=t,g.precision=c+=10,n=(r=mp(m)).charAt(0),!(Math.abs(s=p.e)<15e14))return u=Sp(g,c+2,v).times(s+""),p=Op(new g(n+"."+r.slice(1)),c-10).plus(u),g.precision=v,null==t?xp(p,v,y,Zf=!0):p;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=mp((p=p.times(e)).d)).charAt(0),f++;for(s=p.e,n>1?(p=new g("0."+r),s++):p=new g(n+"."+r.slice(1)),d=p,l=o=p=bp(p.minus(1),p.plus(1),c,1),h=xp(p.times(p),c,1),i=3;;){if(o=xp(o.times(h),c,1),mp((u=l.plus(bp(o,new g(i),c,1))).d).slice(0,c)===mp(l.d).slice(0,c)){if(l=l.times(2),0!==s&&(l=l.plus(Sp(g,c+2,v).times(s+""))),l=bp(l,new g(f),c,1),null!=t)return g.precision=v,l;if(!yp(l.d,c-10,y,a))return xp(l,g.precision=v,y,Zf=!0);g.precision=c+=10,u=o=p=bp(d.minus(1),d.plus(1),c,1),h=xp(p.times(p),c,1),i=a=1}l=u,i+=2}}function _p(e){return String(e.s*e.s/0)}function Lp(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;48===t.charCodeAt(n);n++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(n,i)){if(i-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%dp,r<0&&(n+=dp),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=dp;n<i;)e.d.push(+t.slice(n,n+=dp));t=t.slice(n),n=dp-t.length}else n-=i;for(;n--;)t+="0";e.d.push(+t),Zf&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Rp(e,t){var r,n,i,s,o,a,l,u,c;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),lp.test(t))return Lp(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(op.test(t))r=16,t=t.toLowerCase();else if(sp.test(t))r=2;else{if(!ap.test(t))throw Error(Qf+t);r=8}for((s=t.search(/p/i))>0?(l=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),o=(s=t.indexOf("."))>=0,n=e.constructor,o&&(s=(a=(t=t.replace(".","")).length)-s,i=Np(n,new n(r),s,2*s)),s=c=(u=vp(t,r,cp)).length-1;0===u[s];--s)u.pop();return s<0?new n(0*e.s):(e.e=Ep(u,c),e.d=u,Zf=!1,o&&(e=bp(e,i,4*a)),l&&(e=e.times(Math.abs(l)<54?ip(2,l):Dm.pow(2,l))),Zf=!0,e)}function Ip(e,t,r,n,i){var s,o,a,l,u=e.precision,c=Math.ceil(u/dp);for(Zf=!1,l=r.times(r),a=new e(n);;){if(o=bp(a.times(l),new e(t++*t++),u,1),a=i?n.plus(o):n.minus(o),n=bp(o.times(l),new e(t++*t++),u,1),void 0!==(o=a.plus(n)).d[c]){for(s=c;o.d[s]===a.d[s]&&s--;);if(-1==s)break}s=a,a=n,n=o,o=s}return Zf=!0,o.d.length=c+1,o}function Fp(e,t){for(var r=e;--t;)r*=e;return r}function Pp(e,t){var r,n=t.s<0,i=Tp(e,e.precision,1),s=i.times(.5);if((t=t.abs()).lte(s))return hf=n?4:1,t;if((r=t.divToInt(i)).isZero())hf=n?3:2;else{if((t=t.minus(r.times(i))).lte(s))return hf=Cp(r)?n?2:3:n?4:1,t;hf=Cp(r)?n?1:4:n?3:2}return t.minus(i).abs()}function Bp(e,t,r,n){var i,s,o,a,l,u,c,d,h,f=e.constructor,p=void 0!==r;if(p?(gp(r,1,Gf),void 0===n?n=f.rounding:gp(n,0,8)):(r=f.precision,n=f.rounding),e.isFinite()){for(p?(i=2,16==t?r=4*r-3:8==t&&(r=3*r-2)):i=t,(o=(c=wp(e)).indexOf("."))>=0&&(c=c.replace(".",""),(h=new f(1)).e=c.length-o,h.d=vp(wp(h),10,i),h.e=h.d.length),s=l=(d=vp(c,10,i)).length;0==d[--l];)d.pop();if(d[0]){if(o<0?s--:((e=new f(e)).d=d,e.e=s,d=(e=bp(e,h,r,n,0,i)).d,s=e.e,u=df),o=d[r],a=i/2,u=u||void 0!==d[r+1],u=n<4?(void 0!==o||u)&&(0===n||n===(e.s<0?3:2)):o>a||o===a&&(4===n||u||6===n&&1&d[r-1]||n===(e.s<0?8:7)),d.length=r,u)for(;++d[--r]>i-1;)d[r]=0,r||(++s,d.unshift(1));for(l=d.length;!d[l-1];--l);for(o=0,c="";o<l;o++)c+=Wf.charAt(d[o]);if(p){if(l>1)if(16==t||8==t){for(o=16==t?4:3,--l;l%o;l++)c+="0";for(l=(d=vp(c,i,t)).length;!d[l-1];--l);for(o=1,c="1.";o<l;o++)c+=Wf.charAt(d[o])}else c=c.charAt(0)+"."+c.slice(1);c=c+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)c="0"+c;c="0."+c}else if(++s>l)for(s-=l;s--;)c+="0";else s<l&&(c=c.slice(0,s)+"."+c.slice(s))}else c=p?"0p+0":"0";c=(16==t?"0x":2==t?"0b":8==t?"0o":"")+c}else c=_p(e);return e.s<0?"-"+c:c}function Up(e,t){if(e.length>t)return e.length=t,!0}function $p(e){return new this(e).abs()}function jp(e){return new this(e).acos()}function zp(e){return new this(e).acosh()}function qp(e,t){return new this(e).plus(t)}function Hp(e){return new this(e).asin()}function Vp(e){return new this(e).asinh()}function Gp(e){return new this(e).atan()}function Wp(e){return new this(e).atanh()}function Kp(e,t){e=new this(e),t=new this(t);var r,n=this.precision,i=this.rounding,s=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(r=t.s<0?Tp(this,n,i):new this(0)).s=e.s:!e.d||t.isZero()?(r=Tp(this,s,1).times(.5)).s=e.s:t.s<0?(this.precision=s,this.rounding=1,r=this.atan(bp(e,t,s,1)),t=Tp(this,s,1),this.precision=n,this.rounding=i,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(bp(e,t,s,1)):(r=Tp(this,s,1).times(t.s>0?.25:.75)).s=e.s:r=new this(NaN),r}function Yp(e){return new this(e).cbrt()}function Jp(e){return xp(e=new this(e),e.e+1,2)}function Zp(e,t,r){return new this(e).clamp(t,r)}function Xp(e){if(!e||"object"!=typeof e)throw Error(Xf+"Object expected");var t,r,n,i=!0===e.defaults,s=["precision",1,Gf,"rounding",0,8,"toExpNeg",-Vf,0,"toExpPos",0,Vf,"maxE",0,Vf,"minE",-Vf,0,"modulo",0,9];for(t=0;t<s.length;t+=3)if(r=s[t],i&&(this[r]=Jf[r]),void 0!==(n=e[r])){if(!(np(n)===n&&n>=s[t+1]&&n<=s[t+2]))throw Error(Qf+r+": "+n);this[r]=n}if(r="crypto",i&&(this[r]=Jf[r]),void 0!==(n=e[r])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(Qf+r+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(tp);this[r]=!0}else this[r]=!1}return this}function Qp(e){return new this(e).cos()}function em(e){return new this(e).cosh()}function tm(e,t){return new this(e).div(t)}function rm(e){return new this(e).exp()}function nm(e){return xp(e=new this(e),e.e+1,3)}function im(){var e,t,r=new this(0);for(Zf=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return Zf=!0,new this(1/0);r=t}return Zf=!0,r.sqrt()}function sm(e){return e instanceof Dm||e&&e.toStringTag===rp||!1}function om(e){return new this(e).ln()}function am(e,t){return new this(e).log(t)}function lm(e){return new this(e).log(2)}function um(e){return new this(e).log(10)}function cm(){return kp(this,arguments,"lt")}function dm(){return kp(this,arguments,"gt")}function hm(e,t){return new this(e).mod(t)}function fm(e,t){return new this(e).mul(t)}function pm(e,t){return new this(e).pow(t)}function mm(e){var t,r,n,i,s=0,o=new this(1),a=[];if(void 0===e?e=this.precision:gp(e,1,Gf),n=Math.ceil(e/dp),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));s<n;)(i=t[s])>=429e7?t[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=i%1e7;else{if(!crypto.randomBytes)throw Error(tp);for(t=crypto.randomBytes(n*=4);s<n;)(i=t[s]+(t[s+1]<<8)+(t[s+2]<<16)+((127&t[s+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,s):(a.push(i%1e7),s+=4);s=n/4}else for(;s<n;)a[s++]=1e7*Math.random()|0;for(n=a[--s],e%=dp,n&&e&&(i=ip(10,dp-e),a[s]=(n/i|0)*i);0===a[s];s--)a.pop();if(s<0)r=0,a=[0];else{for(r=-1;0===a[0];r-=dp)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<dp&&(r-=dp-n)}return o.e=r,o.d=a,o}function gm(e){return xp(e=new this(e),e.e+1,this.rounding)}function ym(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function vm(e){return new this(e).sin()}function bm(e){return new this(e).sinh()}function xm(e){return new this(e).sqrt()}function wm(e,t){return new this(e).sub(t)}function Em(){var e=0,t=arguments,r=new this(t[e]);for(Zf=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return Zf=!0,xp(r,this.precision,this.rounding)}function Sm(e){return new this(e).tan()}function Tm(e){return new this(e).tanh()}function Am(e){return xp(e=new this(e),e.e+1,1)}pp[Symbol.for("nodejs.util.inspect.custom")]=pp.toString,pp[Symbol.toStringTag]="Decimal";var Dm=pp.constructor=function e(t){var r,n,i;function s(e){var t,r,n,i=this;if(!(i instanceof s))return new s(e);if(i.constructor=s,sm(e))return i.s=e.s,void(Zf?!e.d||e.e>s.maxE?(i.e=NaN,i.d=null):e.e<s.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(n=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,r=e;r>=10;r/=10)t++;return void(Zf?t>s.maxE?(i.e=NaN,i.d=null):t<s.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):Lp(i,e.toString())}if("string"!==n)throw Error(Qf+e);return 45===(r=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===r&&(e=e.slice(1)),i.s=1),lp.test(e)?Lp(i,e):Rp(i,e)}if(s.prototype=pp,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=Xp,s.clone=e,s.isDecimal=sm,s.abs=$p,s.acos=jp,s.acosh=zp,s.add=qp,s.asin=Hp,s.asinh=Vp,s.atan=Gp,s.atanh=Wp,s.atan2=Kp,s.cbrt=Yp,s.ceil=Jp,s.clamp=Zp,s.cos=Qp,s.cosh=em,s.div=tm,s.exp=rm,s.floor=nm,s.hypot=im,s.ln=om,s.log=am,s.log10=um,s.log2=lm,s.max=cm,s.min=dm,s.mod=hm,s.mul=fm,s.pow=pm,s.random=mm,s.round=gm,s.sign=ym,s.sin=vm,s.sinh=bm,s.sqrt=xm,s.sub=wm,s.sum=Em,s.tan=Sm,s.tanh=Tm,s.trunc=Am,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<i.length;)t.hasOwnProperty(n=i[r++])||(t[n]=this[n]);return s.config(t),s}(Jf);Kf=new Dm(Kf),Yf=new Dm(Yf);const Nm=Dm;var Cm=Mu("BigNumber",["?on","config"],(e=>{var{on:t,config:r}=e,n=Nm.clone({precision:r.precision,modulo:Nm.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(e){return new n(e.value)},t&&t("config",(function(e,t){e.precision!==t.precision&&n.config({precision:e.precision})})),n}),{isClass:!0}),km=r(61977),Mm=Mu("Complex",[],(()=>(Object.defineProperty(km,"name",{value:"Complex"}),km.prototype.constructor=km,km.prototype.type="Complex",km.prototype.isComplex=!0,km.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},km.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},km.prototype.format=function(e){var t=this.im,r=this.re,n=rc(this.re,e),i=rc(this.im,e),s=Bl(e)?e:e?e.precision:null;if(null!==s){var o=Math.pow(10,-s);Math.abs(r/t)<o&&(r=0),Math.abs(t/r)<o&&(t=0)}return 0===t?n:0===r?1===t?"i":-1===t?"-i":i+"i":t<0?-1===t?n+" - i":n+" - "+i.substring(1)+"i":1===t?n+" + i":n+" + "+i+"i"},km.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"==typeof t)return km(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],n=arguments[1];if(Bl(r)){if(zl(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),Bl(n))return new km({r,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},km.prototype.valueOf=km.prototype.toString,km.fromJSON=function(e){return new km(e)},km.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},km)),{isClass:!0});function Om(e){var t=0,r=1,n=Object.create(null),i=Object.create(null),s=0,o=function(e){var o=i[e];if(o&&(delete n[o],delete i[e],--t,r===o)){if(!t)return s=0,void(r=1);for(;!hasOwnProperty.call(n,++r);)continue}};return e=Math.abs(e),{hit:function(a){var l=i[a],u=++s;if(n[u]=a,i[a]=u,!l){if(++t<=e)return;return a=n[r],o(a),a}if(delete n[l],r===l)for(;!hasOwnProperty.call(n,++r);)continue},delete:o,clear:function(){t=s=0,r=1,n=Object.create(null),i=Object.create(null)}}}function _m(e){var{hasher:t,limit:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=null==r?Number.POSITIVE_INFINITY:r,t=null==t?JSON.stringify:t,function n(){"object"!=typeof n.cache&&(n.cache={values:new Map,lru:Om(r||Number.POSITIVE_INFINITY)});for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=t(i);if(n.cache.values.has(o))return n.cache.lru.hit(o),n.cache.values.get(o);var a=e.apply(e,i);return n.cache.values.set(o,a),n.cache.values.delete(n.cache.lru.hit(o)),a}}function Lm(e){return Object.keys(e.signatures||{}).reduce((function(e,t){var r=(t.match(/,/g)||[]).length+1;return Math.max(e,r)}),-1)}var Rm=_m((function(e){return new e(1).exp()}),{hasher:Bm}),Im=_m((function(e){return new e(1).plus(new e(5).sqrt()).div(2)}),{hasher:Bm}),Fm=_m((function(e){return e.acos(-1)}),{hasher:Bm}),Pm=_m((function(e){return Fm(e).times(2)}),{hasher:Bm});function Bm(e){return e[0].precision}var Um=Math.PI,$m=2*Math.PI,jm=Math.E,zm=Mu("true",[],(()=>!0)),qm=Mu("false",[],(()=>!1)),Hm=Mu("null",[],(()=>null)),Vm=sg("Infinity",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1/0):1/0})),Gm=sg("NaN",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(NaN):NaN})),Wm=sg("pi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Fm(r):Um})),Km=sg("tau",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Pm(r):$m})),Ym=sg("e",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Rm(r):jm})),Jm=sg("phi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Im(r):1.618033988749895})),Zm=sg("LN2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(2).ln():Math.LN2})),Xm=sg("LN10",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(10).ln():Math.LN10})),Qm=sg("LOG2E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1).div(new r(2).ln()):Math.LOG2E})),eg=sg("LOG10E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1).div(new r(10).ln()):Math.LOG10E})),tg=sg("SQRT1_2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r("0.5").sqrt():Math.SQRT1_2})),rg=sg("SQRT2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(2).sqrt():Math.SQRT2})),ng=sg("i",["Complex"],(e=>{var{Complex:t}=e;return t.I})),ig=Mu("version",[],(()=>"11.9.1"));function sg(e,t,r){return Mu(e,t,r,{recreateOnConfigChange:!0})}var og=ry("speedOfLight","299792458","m s^-1"),ag=ry("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),lg=ry("planckConstant","6.62607015e-34","J s"),ug=ry("reducedPlanckConstant","1.0545718176461565e-34","J s"),cg=ry("magneticConstant","1.25663706212e-6","N A^-2"),dg=ry("electricConstant","8.8541878128e-12","F m^-1"),hg=ry("vacuumImpedance","376.730313667","ohm"),fg=ry("coulomb","8.987551792261171e9","N m^2 C^-2"),pg=ry("elementaryCharge","1.602176634e-19","C"),mg=ry("bohrMagneton","9.2740100783e-24","J T^-1"),gg=ry("conductanceQuantum","7.748091729863649e-5","S"),yg=ry("inverseConductanceQuantum","12906.403729652257","ohm"),vg=ry("magneticFluxQuantum","2.0678338484619295e-15","Wb"),bg=ry("nuclearMagneton","5.0507837461e-27","J T^-1"),xg=ry("klitzing","25812.807459304513","ohm"),wg=ry("bohrRadius","5.29177210903e-11","m"),Eg=ry("classicalElectronRadius","2.8179403262e-15","m"),Sg=ry("electronMass","9.1093837015e-31","kg"),Tg=ry("fermiCoupling","1.1663787e-5","GeV^-2"),Ag=ny("fineStructure",.0072973525693),Dg=ry("hartreeEnergy","4.3597447222071e-18","J"),Ng=ry("protonMass","1.67262192369e-27","kg"),Cg=ry("deuteronMass","3.3435830926e-27","kg"),kg=ry("neutronMass","1.6749271613e-27","kg"),Mg=ry("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),Og=ry("rydberg","10973731.568160","m^-1"),_g=ry("thomsonCrossSection","6.6524587321e-29","m^2"),Lg=ny("weakMixingAngle",.2229),Rg=ny("efimovFactor",22.7),Ig=ry("atomicMass","1.66053906660e-27","kg"),Fg=ry("avogadro","6.02214076e23","mol^-1"),Pg=ry("boltzmann","1.380649e-23","J K^-1"),Bg=ry("faraday","96485.33212331001","C mol^-1"),Ug=ry("firstRadiation","3.7417718521927573e-16","W m^2"),$g=ry("loschmidt","2.686780111798444e25","m^-3"),jg=ry("gasConstant","8.31446261815324","J K^-1 mol^-1"),zg=ry("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),qg=ry("molarVolume","0.022413969545014137","m^3 mol^-1"),Hg=ny("sackurTetrode",-1.16487052358),Vg=ry("secondRadiation","0.014387768775039337","m K"),Gg=ry("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),Wg=ry("wienDisplacement","2.897771955e-3","m K"),Kg=ry("molarMass","0.99999999965e-3","kg mol^-1"),Yg=ry("molarMassC12","11.9999999958e-3","kg mol^-1"),Jg=ry("gravity","9.80665","m s^-2"),Zg=ry("planckLength","1.616255e-35","m"),Xg=ry("planckMass","2.176435e-8","kg"),Qg=ry("planckTime","5.391245e-44","s"),ey=ry("planckCharge","1.87554603778e-18","C"),ty=ry("planckTemperature","1.416785e+32","K");function ry(e,t,r){return Mu(e,["config","Unit","BigNumber"],(e=>{var{config:n,Unit:i,BigNumber:s}=e,o=new i("BigNumber"===n.number?new s(t):parseFloat(t),r);return o.fixPrefix=!0,o}))}function ny(e,t){return Mu(e,["config","BigNumber"],(e=>{var{config:r,BigNumber:n}=e;return"BigNumber"===r.number?new n(t):t}))}var iy=r(85628),sy=Mu("Fraction",[],(()=>(Object.defineProperty(iy,"name",{value:"Fraction"}),iy.prototype.constructor=iy,iy.prototype.type="Fraction",iy.prototype.isFraction=!0,iy.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},iy.fromJSON=function(e){return new iy(e)},iy)),{isClass:!0}),oy=Mu("Matrix",[],(()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,r){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,r){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e}),{isClass:!0}),ay=Mu("Range",[],(()=>{function e(t,r,n){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");var i=null!=t,s=null!=r,o=null!=n;if(i)if(Ul(t))t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter start must be a number");if(s)if(Ul(r))r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter end must be a number");if(o)if(Ul(n))n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter step must be a number");this.start=i?parseFloat(t):0,this.end=s?parseFloat(r):0,this.step=o?parseFloat(n):1}return e.prototype.type="Range",e.prototype.isRange=!0,e.parse=function(t){if("string"!=typeof t)return null;var r=t.split(":").map((function(e){return parseFloat(e)}));if(r.some((function(e){return isNaN(e)})))return null;switch(r.length){case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[2],r[1]);default:return null}},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.size=function(){var e=0,t=this.start,r=this.step,n=this.end-t;return Yu(r)===Yu(n)?e=Math.ceil(n/r):0===n&&(e=0),isNaN(e)&&(e=0),[e]},e.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},e.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},e.prototype.forEach=function(e){var t=this.start,r=this.step,n=this.end,i=0;if(r>0)for(;t<n;)e(t,[i],this),t+=r,i++;else if(r<0)for(;t>n;)e(t,[i],this),t+=r,i++},e.prototype.map=function(e){var t=[];return this.forEach((function(r,n,i){t[n[0]]=e(r,n,i)})),t},e.prototype.toArray=function(){var e=[];return this.forEach((function(t,r){e[r[0]]=t})),e},e.prototype.valueOf=function(){return this.toArray()},e.prototype.format=function(e){var t=rc(this.start,e);return 1!==this.step&&(t+=":"+rc(this.step,e)),t+=":"+rc(this.end,e)},e.prototype.toString=function(){return this.format()},e.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e}),{isClass:!0}),ly=Mu("ResultSet",[],(()=>{function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return e.prototype.type="ResultSet",e.prototype.isResultSet=!0,e.prototype.valueOf=function(){return this.entries},e.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},e.fromJSON=function(t){return new e(t.entries)},e}),{isClass:!0}),uy=Mu("DenseMatrix",["Matrix"],(e=>{var{Matrix:t}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!ql(t))throw new Error("Invalid datatype: "+t);if(Vl(e))"DenseMatrix"===e.type?(this._data=Du(e._data),this._size=Du(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&Hl(e.data)&&Hl(e.size))this._data=e.data,this._size=e.size,Oc(this._data,this._size),this._datatype=t||e.datatype;else if(Hl(e))this._data=a(e),this._size=kc(this._data),Oc(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+Tu(e)+")");this._data=[],this._size=[0],this._datatype=t}}function n(e,t,r,i){var s=i===r-1,o=t.dimension(i);return s?o.map((function(t){return _c(t,e.length),e[t]})).valueOf():o.map((function(s){return _c(s,e.length),n(e[s],t,r,i+1)})).valueOf()}function i(e,t,r,n,s){var o=s===n-1,a=t.dimension(s);o?a.forEach((function(t,n){_c(t),e[t]=r[n[0]]})):a.forEach((function(o,a){_c(o),i(e[o],t,r[a[0]],n,s+1)}))}function s(e,t,r){if(0===t.length){for(var n=e._data;Hl(n);)n=n[0];return n}return e._size=t.slice(0),e._data=Lc(e._data,e._size,r),e}function o(e,t,r){for(var n=e._size.slice(0),i=!1;n.length<t.length;)n.push(0),i=!0;for(var o=0,a=t.length;o<a;o++)t[o]>n[o]&&(n[o]=t[o],i=!0);i&&s(e,n,r)}function a(e){for(var t=0,r=e.length;t<r;t++){var n=e[t];Hl(n)?e[t]=a(n):n&&!0===n.isMatrix&&(e[t]=a(n.valueOf()))}return e}return r.prototype=new t,r.prototype.createDenseMatrix=function(e,t){return new r(e,t)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return Jc(this._data,Tu)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(e,t){return new r(e,t)},r.prototype.subset=function(e,t,s){switch(arguments.length){case 1:return function(e,t){if(!Jl(t))throw new TypeError("Invalid index");var i=t.isScalar();if(i)return e.get(t.min());var s=t.size();if(s.length!==e._size.length)throw new Nc(s.length,e._size.length);for(var o=t.min(),a=t.max(),l=0,u=e._size.length;l<u;l++)_c(o[l],e._size[l]),_c(a[l],e._size[l]);return new r(n(e._data,t,s.length,0),e._datatype)}(this,e);case 2:case 3:return function(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var s,a=t.size(),l=t.isScalar();Vl(r)?(s=r.size(),r=r.valueOf()):s=kc(r);if(l){if(0!==s.length)throw new TypeError("Scalar expected");e.set(t.min(),r,n)}else{if(a.length<e._size.length)throw new Nc(a.length,e._size.length,"<");if(s.length<a.length){for(var u=0,c=0;1===a[u]&&1===s[u];)u++;for(;1===a[u];)c++,u++;r=$c(r,a.length,c,s)}if(!Cu(a,s))throw new Nc(a,s,">");var d=t.max().map((function(e){return e+1}));o(e,d,n);var h=a.length,f=0;i(e._data,t,r,h,f)}return e}(this,e,t,s);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(e){if(!Hl(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nc(e.length,this._size.length);for(var t=0;t<e.length;t++)_c(e[t],this._size[t]);for(var r=this._data,n=0,i=e.length;n<i;n++){var s=e[n];_c(s,r.length),r=r[s]}return r},r.prototype.set=function(e,t,r){if(!Hl(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new Nc(e.length,this._size.length,"<");var n,i,s,a=e.map((function(e){return e+1}));o(this,a,r);var l=this._data;for(n=0,i=e.length-1;n<i;n++)_c(s=e[n],l.length),l=l[s];return _c(s=e[e.length-1],l.length),l[s]=t,this},r.prototype.resize=function(e,t,r){if(!Gl(e))throw new TypeError("Array or Matrix expected");var n=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));return s(r?this.clone():this,n,t)},r.prototype.reshape=function(e,t){var r=t?this.clone():this;r._data=Ic(r._data,e);var n=r._size.reduce(((e,t)=>e*t));return r._size=Fc(e,n),r},r.prototype.clone=function(){return new r({data:Du(this._data),size:Du(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(e){var t=this,n=Lm(e),i=function r(i,s){return Hl(i)?i.map((function(e,t){return r(e,s.concat(t))})):1===n?e(i):2===n?e(i,s):e(i,s,t)}(this._data,[]);return new r(i,void 0!==this._datatype?Jc(i,Tu):void 0)},r.prototype.forEach=function(e){var t=this;!function r(n,i){Hl(n)?n.forEach((function(e,t){r(e,i.concat(t))})):e(n,i,t)}(this._data,[])},r.prototype[Symbol.iterator]=function*(){yield*function*e(t,r){if(Hl(t))for(var n=0;n<t.length;n++)yield*e(t[n],r.concat(n));else yield{value:t,index:r}}(this._data,[])},r.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var n of t)e.push(new r([n],this._datatype));return e},r.prototype.columns=function(){var e=this,t=[],n=this.size();if(2!==n.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,s=function(n){var s=i.map((e=>[e[n]]));t.push(new r(s,e._datatype))},o=0;o<n[1];o++)s(o);return t},r.prototype.toArray=function(){return Du(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(e){return xc(this._data,e)},r.prototype.toString=function(){return xc(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(e){if(e){if(Ul(e)&&(e=e.toNumber()),!Bl(e)||!Ku(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,n=e<0?-e:0,i=this._size[0],s=this._size[1],o=Math.min(i-n,s-t),a=[],l=0;l<o;l++)a[l]=this._data[l+n][l+t];return new r({data:a,size:[o],datatype:this._datatype})},r.diagonal=function(e,t,n,i){if(!Hl(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Ul(e)&&(e=e.toNumber()),!Bl(e)||!Ku(e)||e<1)throw new Error("Size values must be positive integers");return e})),n){if(Ul(n)&&(n=n.toNumber()),!Bl(n)||!Ku(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var s,o=n>0?n:0,a=n<0?-n:0,l=e[0],u=e[1],c=Math.min(l-a,u-o);if(Hl(t)){if(t.length!==c)throw new Error("Invalid value array length");s=function(e){return t[e]}}else if(Vl(t)){var d=t.size();if(1!==d.length||d[0]!==c)throw new Error("Invalid matrix length");s=function(e){return t.get([e])}}else s=function(){return t};i||(i=Ul(s(0))?s(0).mul(0):0);var h=[];if(e.length>0){h=Lc(h,e,i);for(var f=0;f<c;f++)h[f+a][f+o]=s(f)}return new r({data:h,size:[l,u]})},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(e,t){if(!(Bl(e)&&Ku(e)&&Bl(t)&&Ku(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return _c(e,this._size[0]),_c(t,this._size[0]),r._swapRows(e,t,this._data),this},r._swapRows=function(e,t,r){var n=r[e];r[e]=r[t],r[t]=n},r}),{isClass:!0}),cy=Mu("replacer",[],(()=>function(e,t){return"number"!=typeof t||isFinite(t)&&!isNaN(t)?t:{mathjs:"number",value:String(t)}})),dy=function(){return dy=Bh.create,Bh},hy=Mu("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(e){var{BigNumber:t,Complex:r,DenseMatrix:n,Fraction:i}=e,s=dy();return s.clear(),s.addTypes([{name:"number",test:Bl},{name:"Complex",test:$l},{name:"BigNumber",test:Ul},{name:"Fraction",test:jl},{name:"Unit",test:zl},{name:"identifier",test:e=>ql&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:ql},{name:"Chain",test:Su},{name:"Array",test:Hl},{name:"Matrix",test:Vl},{name:"DenseMatrix",test:Wl},{name:"SparseMatrix",test:Kl},{name:"Range",test:Yl},{name:"Index",test:Jl},{name:"boolean",test:Zl},{name:"ResultSet",test:Xl},{name:"Help",test:Ql},{name:"function",test:eu},{name:"Date",test:tu},{name:"RegExp",test:ru},{name:"null",test:iu},{name:"undefined",test:su},{name:"AccessorNode",test:ou},{name:"ArrayNode",test:au},{name:"AssignmentNode",test:lu},{name:"BlockNode",test:uu},{name:"ConditionalNode",test:cu},{name:"ConstantNode",test:du},{name:"FunctionNode",test:pu},{name:"FunctionAssignmentNode",test:fu},{name:"IndexNode",test:mu},{name:"Node",test:gu},{name:"ObjectNode",test:yu},{name:"OperatorNode",test:vu},{name:"ParenthesisNode",test:bu},{name:"RangeNode",test:xu},{name:"RelationalNode",test:wu},{name:"SymbolNode",test:Eu},{name:"Map",test:zu},{name:"Object",test:nu}]),s.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||fy(e),e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return r||py(e),new r(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return r||py(e),new r(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return r||py(e),new r(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){i||my(e);var t=new i(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||fy(e);try{return new t(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(e){i||my(e);try{return new i(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){r||py(e);try{return new r(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||fy(e),new t(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return i||my(e),new i(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return n||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),s.onMismatch=(e,t,r)=>{var n=s.createError(e,t,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Gl(t[0])&&r.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},s.onMismatch=(e,t,r)=>{var n=s.createError(e,t,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Gl(t[0])&&r.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},s}));function fy(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function py(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function my(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var gy="number",yy="number, number";function vy(e){return Math.abs(e)}function by(e,t){return e+t}function xy(e,t){return e*t}function wy(e){return-e}function Ey(e){return e}function Sy(e){return Qu(e)}function Ty(e){return e*e*e}function Ay(e){return Math.exp(e)}function Dy(e){return ec(e)}function Ny(e,t){if(!Ku(e)||!Ku(t))throw new Error("Parameters in function gcd must be integer numbers");for(var r;0!==t;)r=e%t,e=t,t=r;return e<0?-e:e}function Cy(e,t){if(!Ku(e)||!Ku(t))throw new Error("Parameters in function lcm must be integer numbers");if(0===e||0===t)return 0;for(var r,n=e*t;0!==t;)t=e%(r=t),e=r;return Math.abs(n/e)}function ky(e){return Zu(e)}function My(e){return Ju(e)}function Oy(e,t){if(t>0)return e-t*Math.floor(e/t);if(0===t)return e;throw new Error("Cannot calculate mod for a negative divisor")}function _y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=t<0;if(r&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!=1)throw new Error("Root must be odd when a is negative.");if(0===e)return r?1/0:0;if(!isFinite(e))return r?0:e;var n=Math.pow(Math.abs(e),1/t);return n=e<0?-n:n,r?1/n:n}function Ly(e){return Yu(e)}function Ry(e){return e*e}function Iy(e,t){var r,n,i,s=0,o=1,a=1,l=0;if(!Ku(e)||!Ku(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)i=e-(n=Math.floor(e/t))*t,r=s,s=o-n*s,o=r,r=a,a=l-n*a,l=r,e=t,t=i;return e<0?[-e,-o,-l]:[e,e?o:0,l]}function Fy(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}function Py(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Ku(t)||t<0||t>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(ic(e,t))}vy.signature=gy,by.signature=yy,xy.signature=yy,wy.signature=gy,Ey.signature=gy,Sy.signature=gy,Ty.signature=gy,Ay.signature=gy,Dy.signature=gy,Ny.signature=yy,Cy.signature=yy,ky.signature=gy,My.signature=gy,Oy.signature=yy,Ly.signature=gy,Ry.signature=gy,Iy.signature=yy,Fy.signature=yy;var By="unaryPlus",Uy=Mu(By,["typed","config","BigNumber"],(e=>{var{typed:t,config:r,BigNumber:n}=e;return t(By,{number:Ey,Complex:function(e){return e},BigNumber:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),"boolean | string":function(e){return"BigNumber"===r.number?new n(+e):+e}})})),$y=Mu("abs",["typed"],(e=>{var{typed:t}=e;return t("abs",{number:vy,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0)))})})),jy="acos",zy=Mu(jy,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(jy,{number:function(e){return e>=-1&&e<=1||r.predictable?Math.acos(e):new n(e,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()}})})),qy="number";function Hy(e){return cc(e)}function Vy(e){return Math.atan(1/e)}function Gy(e){return isFinite(e)?(Math.log((e+1)/e)+Math.log(e/(e-1)))/2:0}function Wy(e){return Math.asin(1/e)}function Ky(e){var t=1/e;return Math.log(t+Math.sqrt(t*t+1))}function Yy(e){return Math.acos(1/e)}function Jy(e){var t=1/e,r=Math.sqrt(t*t-1);return Math.log(r+t)}function Zy(e){return dc(e)}function Xy(e){return hc(e)}function Qy(e){return 1/Math.tan(e)}function ev(e){var t=Math.exp(2*e);return(t+1)/(t-1)}function tv(e){return 1/Math.sin(e)}function rv(e){return 0===e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*Yu(e)}function nv(e){return 1/Math.cos(e)}function iv(e){return 2/(Math.exp(e)+Math.exp(-e))}function sv(e){return pc(e)}Hy.signature=qy,Vy.signature=qy,Gy.signature=qy,Wy.signature=qy,Ky.signature=qy,Yy.signature=qy,Jy.signature=qy,Zy.signature=qy,Xy.signature=qy,Qy.signature=qy,ev.signature=qy,tv.signature=qy,rv.signature=qy,nv.signature=qy,iv.signature=qy,sv.signature=qy;var ov="acot",av=Mu(ov,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(ov,{number:Vy,Complex:function(e){return e.acot()},BigNumber:function(e){return new r(1).div(e).atan()}})})),lv="acsc",uv=Mu(lv,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(lv,{number:function(e){return e<=-1||e>=1||r.predictable?Wy(e):new n(e,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(e){return new i(1).div(e).asin()}})})),cv="addScalar",dv=Mu(cv,["typed"],(e=>{var{typed:t}=e;return t(cv,{"number, number":by,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(null===r.value||void 0===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=t.find(e,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))})})),hv=Mu("arg",["typed"],(e=>{var{typed:t}=e;return t("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(e){return e.constructor.atan2(0,e)},Complex:function(e){return e.arg()},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),fv="asech",pv=Mu(fv,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(fv,{number:function(e){if(e<=1&&e>=-1||r.predictable){var t=1/e;if(t>0||r.predictable)return Jy(e);var i=Math.sqrt(t*t-1);return new n(Math.log(i-t),Math.PI)}return new n(e,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(e){return new i(1).div(e).acosh()}})})),mv=Mu("asinh",["typed"],(e=>{var{typed:t}=e;return t("asinh",{number:Zy,Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()}})})),gv=Mu("atan",["typed"],(e=>{var{typed:t}=e;return t("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()}})})),yv="atanh",vv=Mu(yv,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(yv,{number:function(e){return e<=1&&e>=-1||r.predictable?Xy(e):new n(e,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()}})})),bv=Mu("bignumber",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("bignumber",{"":function(){return new r(0)},number:function(e){return new r(e+"")},string:function(e){var t=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(t){var n=t[2],i=r(t[1]),s=new r(2).pow(Number(n));if(i.gt(s.sub(1)))throw new SyntaxError('String "'.concat(e,'" is out of range'));var o=new r(2).pow(Number(n)-1);return i.gte(o)?i.sub(s):i}return new r(e)},BigNumber:function(e){return e},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),Fraction:function(e){return new r(e.n).div(e.d).times(e.s)},null:function(e){return new r(0)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})}));function xv(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()===t.isNegative()?e:new r(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new r(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new r(0):e}return Sv(e,t,(function(e,t){return e&t}))}function wv(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,r=t.precision;t.config({precision:1e9});var n=e.plus(new t(1));return n.s=-n.s||null,t.config({precision:r}),n}function Ev(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);var n=new r(-1);return e.isZero()||t.eq(n)||e.eq(t)?t:t.isZero()||e.eq(n)?e:e.isFinite()&&t.isFinite()?Sv(e,t,(function(e,t){return e|t})):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?n:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}function Sv(e,t,r){var n,i,s,o,a,l=e.constructor,u=+(e.s<0),c=+(t.s<0);if(u){n=Tv(wv(e));for(var d=0;d<n.length;++d)n[d]^=1}else n=Tv(e);if(c){i=Tv(wv(t));for(var h=0;h<i.length;++h)i[h]^=1}else i=Tv(t);n.length<=i.length?(s=n,o=i,a=u):(s=i,o=n,a=c);var f=s.length,p=o.length,m=1^r(u,c),g=new l(1^m),y=new l(1),v=new l(2),b=l.precision;for(l.config({precision:1e9});f>0;)r(s[--f],o[--p])===m&&(g=g.plus(y)),y=y.times(v);for(;p>0;)r(a,o[--p])===m&&(g=g.plus(y)),y=y.times(v);return l.config({precision:b}),0===m&&(g.s=-g.s),g}function Tv(e){for(var t=e.d,r=t[0]+"",n=1;n<t.length;++n){for(var i=t[n]+"",s=7-i.length;s--;)i="0"+i;r+=i}for(var o=r.length;"0"===r.charAt(o);)o--;var a=e.e,l=r.slice(0,o+1||1),u=l.length;if(a>0)if(++a>u)for(a-=u;a--;)l+="0";else a<u&&(l=l.slice(0,a)+"."+l.slice(a));for(var c=[0],d=0;d<l.length;){for(var h=c.length;h--;)c[h]*=10;c[0]+=parseInt(l.charAt(d++));for(var f=0;f<c.length;++f)c[f]>1&&(null!==c[f+1]&&void 0!==c[f+1]||(c[f+1]=0),c[f+1]+=c[f]>>1,c[f]&=1)}return c.reverse()}function Av(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new r(0);var n=new r(-1);return e.eq(n)?wv(t):t.eq(n)?wv(e):e.isFinite()&&t.isFinite()?Sv(e,t,(function(e,t){return e^t})):e.isFinite()||t.isFinite()?new r(e.isNegative()===t.isNegative()?1/0:-1/0):n}function Dv(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var r=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new r(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new r(2).pow(t)):new r(NaN)}function Nv(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var r=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new r(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new r(2).pow(t)).floor():e.isNegative()?new r(-1):e.isFinite()?new r(0):new r(NaN)}var Cv="number, number";function kv(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function bitAnd");return e&t}function Mv(e){if(!Ku(e))throw new Error("Integer expected in function bitNot");return~e}function Ov(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function bitOr");return e|t}function _v(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function bitXor");return e^t}function Lv(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function leftShift");return e<<t}function Rv(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function rightArithShift");return e>>t}function Iv(e,t){if(!Ku(e)||!Ku(t))throw new Error("Integers expected in function rightLogShift");return e>>>t}kv.signature=Cv,Mv.signature="number",Ov.signature=Cv,_v.signature=Cv,Lv.signature=Cv,Rv.signature=Cv,Iv.signature=Cv;var Fv="bitNot",Pv=Mu(Fv,["typed"],(e=>{var{typed:t}=e;return t(Fv,{number:Mv,BigNumber:wv,"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Bv="boolean",Uv=Mu(Bv,["typed"],(e=>{var{typed:t}=e;return t(Bv,{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},null:function(e){return!1},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var r=Number(e);if(""!==e&&!isNaN(r))return!!r;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),$v="clone",jv=Mu($v,["typed"],(e=>{var{typed:t}=e;return t($v,{any:Du})}));function zv(e,t){if(t<e)return 1;if(t===e)return t;var r=t+e>>1;return zv(e,r)*zv(r+1,t)}function qv(e,t){if(!Ku(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!Ku(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(var r=e-t,n=1,i=2,s=t<r?t:r,o=t<r?r+1:t+1;o<=e;++o)for(n*=o;i<=s&&n%i==0;)n/=i,++i;return i<=s&&(n/=zv(i,s)),n}qv.signature="number, number";var Hv="combinations",Vv=Mu(Hv,["typed"],(e=>{var{typed:t}=e;return t(Hv,{"number, number":qv,"BigNumber, BigNumber":function(e,t){var r,n,i=e.constructor,s=e.minus(t),o=new i(1);if(!Gv(e)||!Gv(t))throw new TypeError("Positive integer value expected in function combinations");if(t.gt(e))throw new TypeError("k must be less than n in function combinations");if(r=o,t.lt(s))for(n=o;n.lte(s);n=n.plus(o))r=r.times(t.plus(n)).dividedBy(n);else for(n=o;n.lte(t);n=n.plus(o))r=r.times(s.plus(n)).dividedBy(n);return r}})}));function Gv(e){return e.isInteger()&&e.gte(0)}var Wv=Mu("complex",["typed","Complex"],(e=>{var{typed:t,Complex:r}=e;return t("complex",{"":function(){return r.ZERO},number:function(e){return new r(e,0)},"number, number":function(e,t){return new r(e,t)},"BigNumber, BigNumber":function(e,t){return new r(e.toNumber(),t.toNumber())},Fraction:function(e){return new r(e.valueOf(),0)},Complex:function(e){return e.clone()},string:function(e){return r(e)},null:function(e){return r(0)},Object:function(e){if("re"in e&&"im"in e)return new r(e.re,e.im);if("r"in e&&"phi"in e||"abs"in e&&"arg"in e)return new r(e);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Kv="conj",Yv=Mu(Kv,["typed"],(e=>{var{typed:t}=e;return t(Kv,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Jv="cosh",Zv=Mu(Jv,["typed"],(e=>{var{typed:t}=e;return t(Jv,{number:fc,"Complex | BigNumber":e=>e.cosh()})})),Xv="coth",Qv=Mu(Xv,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(Xv,{number:ev,Complex:e=>e.coth(),BigNumber:e=>new r(1).div(e.tanh())})})),eb=Mu("trigUnit",["typed"],(e=>{var{typed:t}=e;return{Unit:t.referToSelf((e=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(e,r.valueType())(r.value)}))}})),tb=Mu("csc",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("csc",{number:tv,Complex:e=>e.csc(),BigNumber:e=>new r(1).div(e.sin())},eb({typed:t}))})),rb="cube",nb=Mu(rb,["typed"],(e=>{var{typed:t}=e;return t(rb,{number:Ty,Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},Fraction:function(e){return e.pow(3)},Unit:function(e){return e.pow(3)}})}));function ib(e,t,r){if(null==r)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var n=e.minus(t).abs();if(n.isZero())return!0;var i=e.constructor.max(e.abs(),t.abs());return n.lte(i.times(r))}return!1}var sb=Mu("compareUnits",["typed"],(e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return t.find(e,[r.valueType(),n.valueType()])(r.value,n.value)}))}})),ob="equalScalar",ab=Mu(ob,["typed","config"],(e=>{var{typed:t,config:r}=e,n=sb({typed:t});return t(ob,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return uc(e,t,r.epsilon)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||ib(e,t,r.epsilon)},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,r){return uc(e.re,t.re,r)&&uc(e.im,t.im,r)}(e,t,r.epsilon)}},n)})),lb=(Mu(ob,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(ob,{"number, number":function(e,t){return uc(e,t,r.epsilon)}})})),Mu("erf",["typed"],(e=>{var{typed:t}=e;return t("name",{number:function(e){var t=Math.abs(e);return t>=fb?Yu(e):t<=ub?Yu(e)*function(e){var t,r=e*e,n=db[0][4]*r,i=r;for(t=0;t<3;t+=1)n=(n+db[0][t])*r,i=(i+hb[0][t])*r;return e*(n+db[0][3])/(i+hb[0][3])}(t):t<=4?Yu(e)*(1-function(e){var t,r=db[1][8]*e,n=e;for(t=0;t<7;t+=1)r=(r+db[1][t])*e,n=(n+hb[1][t])*e;var i=(r+db[1][7])/(n+hb[1][7]),s=parseInt(16*e)/16,o=(e-s)*(e+s);return Math.exp(-s*s)*Math.exp(-o)*i}(t)):Yu(e)*(1-function(e){var t,r=1/(e*e),n=db[2][5]*r,i=r;for(t=0;t<4;t+=1)n=(n+db[2][t])*r,i=(i+hb[2][t])*r;var s=r*(n+db[2][4])/(i+hb[2][4]);s=(cb-s)/e,r=parseInt(16*e)/16;var o=(e-r)*(e+r);return Math.exp(-r*r)*Math.exp(-o)*s}(t))},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})}))),ub=.46875,cb=.5641895835477563,db=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],hb=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],fb=Math.pow(2,53),pb=Mu("exp",["typed"],(e=>{var{typed:t}=e;return t("exp",{number:Ay,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()}})})),mb="expm1",gb=Mu(mb,["typed","Complex"],(e=>{var{typed:t,Complex:r}=e;return t(mb,{number:Dy,Complex:function(e){var t=Math.exp(e.re);return new r(t*Math.cos(e.im)-1,t*Math.sin(e.im))},BigNumber:function(e){return e.exp().minus(1)}})})),yb=Mu("filter",["typed"],(e=>{var{typed:t}=e;return t("filter",{"Array, function":vb,"Matrix, function":function(e,t){return e.create(vb(e.toArray(),t))},"Array, RegExp":Gc,"Matrix, RegExp":function(e,t){return e.create(Gc(e.toArray(),t))}})}));function vb(e,t){return Vc(e,(function(e,r,n){return Uh(t,e,[r],n,"filter")}))}var bb="forEach",xb=Mu(bb,["typed"],(e=>{var{typed:t}=e;return t(bb,{"Array, function":wb,"Matrix, function":function(e,t){e.forEach(t)}})}));function wb(e,t){!function r(n,i){if(!Array.isArray(n))return Uh(t,n,i,e,"forEach");Hc(n,(function(e,t){r(e,i.concat(t))}))}(e,[])}var Eb="format",Sb=Mu(Eb,["typed"],(e=>{var{typed:t}=e;return t(Eb,{any:xc,"any, Object | function | number":xc})})),Tb="getMatrixDataType",Ab=Mu(Tb,["typed"],(e=>{var{typed:t}=e;return t(Tb,{Array:function(e){return Jc(e,Tu)},Matrix:function(e){return e.getDataType()}})})),Db=Mu("hex",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("hex",{"number | BigNumber":function(e){return r(e,{notation:"hex"})},"number | BigNumber, number":function(e,t){return r(e,{notation:"hex",wordSize:t})}})})),Nb=Mu("im",["typed"],(e=>{var{typed:t}=e;return t("im",{number:()=>0,"BigNumber | Fraction":e=>e.mul(0),Complex:e=>e.im,"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Cb="isInteger",kb=Mu(Cb,["typed"],(e=>{var{typed:t}=e;return t(Cb,{number:Ku,BigNumber:function(e){return e.isInt()},Fraction:function(e){return 1===e.d&&isFinite(e.n)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Mb="number";function Ob(e){return e<0}function _b(e){return e>0}function Lb(e){return 0===e}function Rb(e){return Number.isNaN(e)}Ob.signature=Mb,_b.signature=Mb,Lb.signature=Mb,Rb.signature=Mb;var Ib="isNegative",Fb=Mu(Ib,["typed"],(e=>{var{typed:t}=e;return t(Ib,{number:Ob,BigNumber:function(e){return e.isNeg()&&!e.isZero()&&!e.isNaN()},Fraction:function(e){return e.s<0},Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Pb="isPositive",Bb=Mu(Pb,["typed"],(e=>{var{typed:t}=e;return t(Pb,{number:_b,BigNumber:function(e){return!e.isNeg()&&!e.isZero()&&!e.isNaN()},Fraction:function(e){return e.s>0&&e.n>0},Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Ub="isZero",$b=Mu(Ub,["typed"],(e=>{var{typed:t}=e;return t(Ub,{number:Lb,BigNumber:function(e){return e.isZero()},Complex:function(e){return 0===e.re&&0===e.im},Fraction:function(e){return 1===e.d&&0===e.n},Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})}));function jb(e){var t;if(Ku(e))return e<=0?isFinite(e)?1/0:NaN:e>171?1/0:zv(1,e-1);if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*jb(1-e));if(e>=171.35)return 1/0;if(e>85){var r=e*e,n=r*e,i=n*e,s=i*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*r)-139/(51840*n)-571/(2488320*i)+163879/(209018880*s)+5246819/(75246796800*s*e))}--e,t=qb[0];for(var o=1;o<qb.length;++o)t+=qb[o]/(e+o);var a=e+zb+.5;return Math.sqrt(2*Math.PI)*Math.pow(a,e+.5)*Math.exp(-a)*t}jb.signature="number";var zb=4.7421875,qb=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Hb=.9189385332046728,Vb=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function Gb(e){if(e<0)return NaN;if(0===e)return 1/0;if(!isFinite(e))return e;if(e<.5)return Math.log(Math.PI/Math.sin(Math.PI*e))-Gb(1-e);for(var t=(e-=1)+5+.5,r=Vb[0],n=6;n>=1;n--)r+=Vb[n]/(e+n);return Hb+(e+.5)*Math.log(t)-t+Math.log(r)}Gb.signature="number";var Wb="lgamma",Kb=Mu(Wb,["Complex","typed"],(e=>{var{Complex:t,typed:r}=e,n=7,i=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return r(Wb,{number:Gb,Complex:function e(r){if(r.isNaN())return new t(NaN,NaN);if(0===r.im)return new t(Gb(r.re),0);if(r.re>=n||Math.abs(r.im)>=7)return s(r);if(r.re<=.1){var i=function(e,t){return(e>0||!(e<0)&&1/e==1/0)^(t>0||!(t<0)&&1/t==1/0)?-e:e}(6.283185307179586,r.im)*Math.floor(.5*r.re+.25),a=r.mul(Math.PI).sin().log(),l=e(new t(1-r.re,-r.im));return new t(1.1447298858494002,i).sub(a).sub(l)}return r.im>=0?o(r):o(r.conjugate()).conjugate()},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function s(e){for(var r=e.sub(.5).mul(e.log()).sub(e).add(Hb),n=new t(1,0).div(e),s=n.div(e),o=i[0],a=i[1],l=2*s.re,u=s.re*s.re+s.im*s.im,c=2;c<8;c++){var d=a;a=-u*o+i[c],o=l*o+d}var h=n.mul(s.mul(o).add(a));return r.add(h)}function o(e){var r=0,i=0,o=e;for(e=e.add(1);e.re<=n;){var a=(o=o.mul(e)).im<0?1:0;0!==a&&0===i&&r++,i=a,e=e.add(1)}return s(e).sub(o.log()).sub(new t(0,2*r*Math.PI*1))}})),Yb="log10",Jb=Mu(Yb,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(Yb,{number:function(e){return e>=0||r.predictable?ky(e):new n(e,0).log().div(Math.LN10)},Complex:function(e){return new n(e).log().div(Math.LN10)},BigNumber:function(e){return!e.isNegative()||r.predictable?e.log():new n(e.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Zb="log2",Xb=Mu(Zb,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(Zb,{number:function(e){return e>=0||r.predictable?My(e):i(new n(e,0))},Complex:i,BigNumber:function(e){return!e.isNegative()||r.predictable?e.log(2):i(new n(e.toNumber(),0))},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))});function i(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new n(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}})),Qb=Mu("map",["typed"],(e=>{var{typed:t}=e;return t("map",{"Array, function":ex,"Matrix, function":function(e,t){return e.map(t)}})}));function ex(e,t){return function r(n,i){return Array.isArray(n)?n.map((function(e,t){return r(e,i.concat(t))})):Uh(t,n,i,e,"map")}(e,[])}var tx=Mu("multiplyScalar",["typed"],(e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":xy,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(e,t)=>t.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,t)=>e.multiply(t)})})),rx="number, number";function nx(e){return!e}function ix(e,t){return!(!e&&!t)}function sx(e,t){return!!e!=!!t}function ox(e,t){return!(!e||!t)}nx.signature="number",ix.signature=rx,sx.signature=rx,ox.signature=rx;var ax=Mu("not",["typed"],(e=>{var{typed:t}=e;return t("not",{"null | undefined":()=>!0,number:nx,Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})}));var lx=Mu("number",["typed"],(e=>{var{typed:t}=e,r=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t,r,n=(r=(t=e).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:t,radix:{"0b":2,"0o":8,"0x":16}[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(n)return function(e){for(var t=parseInt(e.integerPart,e.radix),r=0,n=0;n<e.fractionalPart.length;n++)r+=parseInt(e.fractionalPart[n],e.radix)/Math.pow(e.radix,n+1);var i=t+r;if(isNaN(i))throw new SyntaxError('String "'+e.input+'" is no valid number');return i}(n);var i=0,s=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);s&&(i=Number(s[2]),e=s[1]);var o=Number(e);if(isNaN(o))throw new SyntaxError('String "'+e+'" is no valid number');if(s){if(o>2**i-1)throw new SyntaxError('String "'.concat(e,'" is out of range'));o>=2**(i-1)&&(o-=2**i)}return o},BigNumber:function(e){return e.toNumber()},Fraction:function(e){return e.valueOf()},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),null:function(e){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))});return r.fromJSON=function(e){return parseFloat(e.value)},r})),ux=Mu("oct",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("oct",{"number | BigNumber":function(e){return r(e,{notation:"oct"})},"number | BigNumber, number":function(e,t){return r(e,{notation:"oct",wordSize:t})}})})),cx=r(36377),dx=cx(Date.now());function hx(e){var t,r;return t=null===(r=e)?dx:cx(String(r)),function(){return t()}}var fx="pickRandom",px=Mu(fx,["typed","config","?on"],(e=>{var{typed:t,config:r,on:n}=e,i=hx(r.randomSeed);return n&&n("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=hx(e.randomSeed))})),t(fx,{"Array | Matrix":function(e){return s(e,{})},"Array | Matrix, Object":function(e,t){return s(e,t)},"Array | Matrix, number":function(e,t){return s(e,{number:t})},"Array | Matrix, Array | Matrix":function(e,t){return s(e,{weights:t})},"Array | Matrix, Array | Matrix, number":function(e,t,r){return s(e,{number:r,weights:t})},"Array | Matrix, number, Array | Matrix":function(e,t,r){return s(e,{number:t,weights:r})}});function s(e,t){var{number:r,weights:n,elementWise:s=!0}=t,o=void 0===r;o&&(r=1);var a=Vl(e)?e.create:Vl(n)?n.create:null;e=e.valueOf(),n&&(n=n.valueOf()),!0===s&&(e=zc(e),n=zc(n));var l=0;if(void 0!==n){if(n.length!==e.length)throw new Error("Weights must have the same length as possibles");for(var u=0,c=n.length;u<c;u++){if(!Bl(n[u])||n[u]<0)throw new Error("Weights must be an array of positive numbers");l+=n[u]}}for(var d,h=e.length,f=[];f.length<r;){if(void 0===n)d=e[Math.floor(i()*h)];else for(var p=i()*l,m=0,g=e.length;m<g;m++)if((p-=n[m])<0){d=e[m];break}f.push(d)}return o?f[0]:a?a(f):f}})),mx="print",gx=Mu(mx,["typed"],(e=>{var{typed:t}=e;return t(mx,{"string, Object | Array":yx,"string, Object | Array, number | Object":yx})}));function yx(e,t,r){return e.replace(/\$([\w.]+)/g,(function(e,n){for(var i=n.split("."),s=t[i.shift()];i.length&&void 0!==s;){var o=i.shift();s=o?s[o]:s+"."}return void 0!==s?ql(s)?s:xc(s,r):e}))}function vx(e,t){var r=[];if((e=e.slice(0)).length>1)for(var n=0,i=e.shift();n<i;n++)r.push(vx(e,t));else for(var s=0,o=e.shift();s<o;s++)r.push(t());return r}var bx="random",xx=Mu(bx,["typed","config","?on"],(e=>{var{typed:t,config:r,on:n}=e,i=hx(r.randomSeed);return n&&n("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=hx(e.randomSeed))})),t(bx,{"":()=>o(0,1),number:e=>o(0,e),"number, number":(e,t)=>o(e,t),"Array | Matrix":e=>s(e,0,1),"Array | Matrix, number":(e,t)=>s(e,0,t),"Array | Matrix, number, number":(e,t,r)=>s(e,t,r)});function s(e,t,r){var n=vx(e.valueOf(),(()=>o(t,r)));return Vl(e)?e.create(n):n}function o(e,t){return e+i()*(t-e)}})),wx=Mu("re",["typed"],(e=>{var{typed:t}=e;return t("re",{"number | BigNumber | Fraction":e=>e,Complex:e=>e.re,"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Ex=Mu("sec",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("sec",{number:nv,Complex:e=>e.sec(),BigNumber:e=>new r(1).div(e.cos())},eb({typed:t}))})),Sx="sign",Tx=Mu(Sx,["typed","BigNumber","Fraction","complex"],(e=>{var{typed:t,BigNumber:r,complex:n,Fraction:i}=e;return t(Sx,{number:Ly,Complex:function(e){return 0===e.im?n(Ly(e.re)):e.sign()},BigNumber:function(e){return new r(e.cmp(0))},Fraction:function(e){return new i(e.s,1)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),Unit:t.referToSelf((e=>r=>{if(!r._isDerived()&&0!==r.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return t.find(e,r.valueType())(r.value)}))})})),Ax=Mu("sin",["typed"],(e=>{var{typed:t}=e,r=eb({typed:t});return t("sin",{number:Math.sin,"Complex | BigNumber":e=>e.sin()},r)})),Dx=Mu("SparseMatrix",["typed","equalScalar","Matrix"],(e=>{var{typed:t,equalScalar:r,Matrix:n}=e;function i(e,t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!ql(t))throw new Error("Invalid datatype: "+t);if(Vl(e))!function(e,t,r){"SparseMatrix"===t.type?(e._values=t._values?Du(t._values):void 0,e._index=Du(t._index),e._ptr=Du(t._ptr),e._size=Du(t._size),e._datatype=r||t._datatype):s(e,t.valueOf(),r||t._datatype)}(this,e,t);else if(e&&Hl(e.index)&&Hl(e.ptr)&&Hl(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(Hl(e))s(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+Tu(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function s(e,n,i){e._values=[],e._index=[],e._ptr=[],e._datatype=i;var s=n.length,o=0,a=r,l=0;if(ql(i)&&(a=t.find(r,[i,i])||r,l=t.convert(0,i)),s>0){var u=0;do{e._ptr.push(e._index.length);for(var c=0;c<s;c++){var d=n[c];if(Hl(d)){if(0===u&&o<d.length&&(o=d.length),u<d.length){var h=d[u];a(h,l)||(e._values.push(h),e._index.push(c))}}else 0===u&&o<1&&(o=1),a(d,l)||(e._values.push(d),e._index.push(c))}u++}while(u<o)}e._ptr.push(e._index.length),e._size=[s,o]}function o(e,t,r,n){if(r-t==0)return r;for(var i=t;i<r;i++)if(n[i]===e)return i;return t}function a(e,t,r,n,i,s,o){i.splice(e,0,n),s.splice(e,0,t);for(var a=r+1;a<o.length;a++)o[a]++}function l(e,n,i,s){var o=s||0,a=r,l=0;ql(e._datatype)&&(a=t.find(r,[e._datatype,e._datatype])||r,l=t.convert(0,e._datatype),o=t.convert(o,e._datatype));var u,c,d,h=!a(o,l),f=e._size[0],p=e._size[1];if(i>p){for(c=p;c<i;c++)if(e._ptr[c]=e._values.length,h)for(u=0;u<f;u++)e._values.push(o),e._index.push(u);e._ptr[i]=e._values.length}else i<p&&(e._ptr.splice(i+1,p-i),e._values.splice(e._ptr[i],e._values.length),e._index.splice(e._ptr[i],e._index.length));if(p=i,n>f){if(h){var m=0;for(c=0;c<p;c++){e._ptr[c]=e._ptr[c]+m,d=e._ptr[c+1]+m;var g=0;for(u=f;u<n;u++,g++)e._values.splice(d+g,0,o),e._index.splice(d+g,0,u),m++}e._ptr[p]=e._values.length}}else if(n<f){var y=0;for(c=0;c<p;c++){e._ptr[c]=e._ptr[c]-y;var v=e._ptr[c],b=e._ptr[c+1]-y;for(d=v;d<b;d++)(u=e._index[d])>n-1&&(e._values.splice(d,1),e._index.splice(d,1),y++)}e._ptr[c]=e._values.length}return e._size[0]=n,e._size[1]=i,e}function u(e,t,r,n,i){var s,o,a=n[0],l=n[1],u=[];for(s=0;s<a;s++)for(u[s]=[],o=0;o<l;o++)u[s][o]=0;for(o=0;o<l;o++)for(var c=r[o],d=r[o+1],h=c;h<d;h++)u[s=t[h]][o]=e?i?Du(e[h]):e[h]:1;return u}return i.prototype=new n,i.prototype.createSparseMatrix=function(e,t){return new i(e,t)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Jc(this._values,Tu)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(e,t){return new i(e,t)},i.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},i.prototype.subset=function(e,t,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!Jl(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var r,n,s,o,a=t.size();if(a.length!==e._size.length)throw new Nc(a.length,e._size.length);var l=t.min(),u=t.max();for(r=0,n=e._size.length;r<n;r++)_c(l[r],e._size[r]),_c(u[r],e._size[r]);var c=e._values,d=e._index,h=e._ptr,f=t.dimension(0),p=t.dimension(1),m=[],g=[];f.forEach((function(e,t){g[e]=t[0],m[e]=!0}));var y=c?[]:void 0,v=[],b=[];return p.forEach((function(e){for(b.push(v.length),s=h[e],o=h[e+1];s<o;s++)r=d[s],!0===m[r]&&(v.push(g[r]),y&&y.push(c[s]))})),b.push(v.length),new i({values:y,index:v,ptr:b,size:a,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,s=t.size(),o=t.isScalar();Vl(r)?(i=r.size(),r=r.toArray()):i=kc(r);if(o){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),r,n)}else{if(1!==s.length&&2!==s.length)throw new Nc(s.length,e._size.length,"<");if(i.length<s.length){for(var a=0,l=0;1===s[a]&&1===i[a];)a++;for(;1===s[a];)l++,a++;r=$c(r,s.length,l,i)}if(!Cu(s,i))throw new Nc(s,i,">");if(1===s.length){t.dimension(0).forEach((function(t,i){_c(t),e.set([t,0],r[i[0]],n)}))}else{var u=t.dimension(0),c=t.dimension(1);u.forEach((function(t,i){_c(t),c.forEach((function(s,o){_c(s),e.set([t,s],r[i[0]][o[0]],n)}))}))}}return e}(this,e,t,r);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(e){if(!Hl(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nc(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],r=e[1];_c(t,this._size[0]),_c(r,this._size[1]);var n=o(t,this._ptr[r],this._ptr[r+1],this._index);return n<this._ptr[r+1]&&this._index[n]===t?this._values[n]:0},i.prototype.set=function(e,n,i){if(!Hl(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nc(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var s=e[0],u=e[1],c=this._size[0],d=this._size[1],h=r,f=0;ql(this._datatype)&&(h=t.find(r,[this._datatype,this._datatype])||r,f=t.convert(0,this._datatype)),(s>c-1||u>d-1)&&(l(this,Math.max(s+1,c),Math.max(u+1,d),i),c=this._size[0],d=this._size[1]),_c(s,c),_c(u,d);var p=o(s,this._ptr[u],this._ptr[u+1],this._index);return p<this._ptr[u+1]&&this._index[p]===s?h(n,f)?function(e,t,r,n,i){r.splice(e,1),n.splice(e,1);for(var s=t+1;s<i.length;s++)i[s]--}(p,u,this._values,this._index,this._ptr):this._values[p]=n:h(n,f)||a(p,s,u,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(e,t,r){if(!Gl(e))throw new TypeError("Array or Matrix expected");var n=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(2!==n.length)throw new Error("Only two dimensions matrix are supported");return n.forEach((function(e){if(!Bl(e)||!Ku(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+xc(n)+")")})),l(r?this.clone():this,n[0],n[1],t)},i.prototype.reshape=function(e,t){if(!Hl(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach((function(t){if(!Bl(t)||!Ku(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+xc(e)+")")}));var r=this._size[0]*this._size[1];if(r!==(e=Fc(e,r))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var i=[],s=0;s<n._ptr.length;s++)for(var l=0;l<n._ptr[s+1]-n._ptr[s];l++)i.push(s);for(var u=n._values.slice(),c=n._index.slice(),d=0;d<n._index.length;d++){var h=c[d],f=i[d],p=h*n._size[1]+f;i[d]=p%e[1],c[d]=Math.floor(p/e[1])}n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice();for(var m=0;m<n._ptr.length;m++)n._ptr[m]=0;for(var g=0;g<u.length;g++){var y=c[g],v=i[g],b=u[g];a(o(y,n._ptr[v],n._ptr[v+1],n._index),y,v,b,n._values,n._index,n._ptr)}return n},i.prototype.clone=function(){return new i({values:this._values?Du(this._values):void 0,index:Du(this._index),ptr:Du(this._ptr),size:Du(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(e,n){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var s=this,o=this._size[0],a=this._size[1],l=Lm(e);return function(e,n,s,o,a,l,u){var c=[],d=[],h=[],f=r,p=0;ql(e._datatype)&&(f=t.find(r,[e._datatype,e._datatype])||r,p=t.convert(0,e._datatype));for(var m=function(e,t,r){e=l(e,t,r),f(e,p)||(c.push(e),d.push(t))},g=o;g<=a;g++){h.push(c.length);var y=e._ptr[g],v=e._ptr[g+1];if(u)for(var b=y;b<v;b++){var x=e._index[b];x>=n&&x<=s&&m(e._values[b],x-n,g-o)}else{for(var w={},E=y;E<v;E++){w[e._index[E]]=e._values[E]}for(var S=n;S<=s;S++){m(S in w?w[S]:0,S-n,g-o)}}}return h.push(c.length),new i({values:c,index:d,ptr:h,size:[s-n+1,a-o+1]})}(this,0,o-1,0,a-1,(function(t,r,n){return 1===l?e(t):2===l?e(t,[r,n]):e(t,[r,n],s)}),n)},i.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],n=this._size[1],i=0;i<n;i++){var s=this._ptr[i],o=this._ptr[i+1];if(t)for(var a=s;a<o;a++){var l=this._index[a];e(this._values[a],[l,i],this)}else{for(var u={},c=s;c<o;c++){u[this._index[c]]=this._values[c]}for(var d=0;d<r;d++){e(d in u?u[d]:0,[d,i],this)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var r=this._ptr[t],n=this._ptr[t+1],i=r;i<n;i++){var s=this._index[i];yield{value:this._values[i],index:[s,t]}}},i.prototype.toArray=function(){return u(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return u(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(e){for(var t=this._size[0],r=this._size[1],n=this.density(),i="Sparse Matrix ["+xc(t,e)+" x "+xc(r,e)+"] density: "+xc(n,e)+"\n",s=0;s<r;s++)for(var o=this._ptr[s],a=this._ptr[s+1],l=o;l<a;l++){i+="\n    ("+xc(this._index[l],e)+", "+xc(s,e)+") ==> "+(this._values?xc(this._values[l],e):"X")}return i},i.prototype.toString=function(){return xc(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(e){if(e){if(Ul(e)&&(e=e.toNumber()),!Bl(e)||!Ku(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,r=e<0?-e:0,n=this._size[0],s=this._size[1],o=Math.min(n-r,s-t),a=[],l=[],u=[];u[0]=0;for(var c=t;c<s&&a.length<o;c++)for(var d=this._ptr[c],h=this._ptr[c+1],f=d;f<h;f++){var p=this._index[f];if(p===c-t+r){a.push(this._values[f]),l[a.length-1]=p-r;break}}return u.push(a.length),new i({values:a,index:l,ptr:u,size:[o,1]})},i.fromJSON=function(e){return new i(e)},i.diagonal=function(e,n,s,o,a){if(!Hl(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Ul(e)&&(e=e.toNumber()),!Bl(e)||!Ku(e)||e<1)throw new Error("Size values must be positive integers");return e})),s){if(Ul(s)&&(s=s.toNumber()),!Bl(s)||!Ku(s))throw new TypeError("The parameter k must be an integer number")}else s=0;var l=r,u=0;ql(a)&&(l=t.find(r,[a,a])||r,u=t.convert(0,a));var c,d=s>0?s:0,h=s<0?-s:0,f=e[0],p=e[1],m=Math.min(f-h,p-d);if(Hl(n)){if(n.length!==m)throw new Error("Invalid value array length");c=function(e){return n[e]}}else if(Vl(n)){var g=n.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");c=function(e){return n.get([e])}}else c=function(){return n};for(var y=[],v=[],b=[],x=0;x<p;x++){b.push(y.length);var w=x-d;if(w>=0&&w<m){var E=c(w);l(E,u)||(v.push(w+h),y.push(E))}}return b.push(y.length),new i({values:y,index:v,ptr:b,size:[f,p]})},i.prototype.swapRows=function(e,t){if(!(Bl(e)&&Ku(e)&&Bl(t)&&Ku(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return _c(e,this._size[0]),_c(t,this._size[0]),i._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(e,t,r,n,i){for(var s=n[e],o=n[e+1],a=s;a<o;a++)i(r[a],t[a])},i._swapRows=function(e,t,r,n,i,s){for(var a=0;a<r;a++){var l=s[a],u=s[a+1],c=o(e,l,u,i),d=o(t,l,u,i);if(c<u&&d<u&&i[c]===e&&i[d]===t){if(n){var h=n[c];n[c]=n[d],n[d]=h}}else if(c<u&&i[c]===e&&(d>=u||i[d]!==t)){var f=n?n[c]:void 0;i.splice(d,0,t),n&&n.splice(d,0,f),i.splice(d<=c?c+1:c,1),n&&n.splice(d<=c?c+1:c,1)}else if(d<u&&i[d]===t&&(c>=u||i[c]!==e)){var p=n?n[d]:void 0;i.splice(c,0,e),n&&n.splice(c,0,p),i.splice(c<=d?d+1:d,1),n&&n.splice(c<=d?d+1:d,1)}}},i}),{isClass:!0}),Nx="splitUnit",Cx=Mu(Nx,["typed"],(e=>{var{typed:t}=e;return t(Nx,{"Unit, Array":function(e,t){return e.splitUnit(t)}})})),kx="square",Mx=Mu(kx,["typed"],(e=>{var{typed:t}=e;return t(kx,{number:Ry,Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},Fraction:function(e){return e.mul(e)},Unit:function(e){return e.pow(2)}})})),Ox="string",_x=Mu(Ox,["typed"],(e=>{var{typed:t}=e;return t(Ox,{"":function(){return""},number:rc,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e))),any:function(e){return String(e)}})})),Lx=Mu("tan",["typed"],(e=>{var{typed:t}=e,r=eb({typed:t});return t("tan",{number:Math.tan,"Complex | BigNumber":e=>e.tan()},r)})),Rx="typeOf",Ix=Mu(Rx,["typed"],(e=>{var{typed:t}=e;return t(Rx,{any:Tu})})),Fx="acosh",Px=Mu(Fx,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(Fx,{number:function(e){return e>=1||r.predictable?Hy(e):e<=-1?new n(Math.log(Math.sqrt(e*e-1)-e),Math.PI):new n(e,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()}})})),Bx="acsch",Ux=Mu(Bx,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(Bx,{number:Ky,Complex:function(e){return e.acsch()},BigNumber:function(e){return new r(1).div(e).asinh()}})})),$x="asec",jx=Mu($x,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t($x,{number:function(e){return e<=-1||e>=1||r.predictable?Yy(e):new n(e,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(e){return new i(1).div(e).acos()}})})),zx=Mu("bin",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("bin",{"number | BigNumber":function(e){return r(e,{notation:"bin"})},"number | BigNumber, number":function(e,t){return r(e,{notation:"bin",wordSize:t})}})})),qx="combinationsWithRep",Hx=Mu(qx,["typed"],(e=>{var{typed:t}=e;return t(qx,{"number, number":function(e,t){if(!Ku(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!Ku(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e<1)throw new TypeError("k must be less than or equal to n + k - 1");return t<e-1?zv(e,e+t-1)/zv(1,t):zv(t+1,e+t-1)/zv(1,e-1)},"BigNumber, BigNumber":function(e,t){var r,n,i=new(0,e.constructor)(1),s=e.minus(i);if(!Vx(e)||!Vx(t))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(r=i,t.lt(s))for(n=i;n.lte(s);n=n.plus(i))r=r.times(t.plus(n)).dividedBy(n);else for(n=i;n.lte(t);n=n.plus(i))r=r.times(s.plus(n)).dividedBy(n);return r}})}));function Vx(e){return e.isInteger()&&e.gte(0)}var Gx=Mu("cos",["typed"],(e=>{var{typed:t}=e,r=eb({typed:t});return t("cos",{number:Math.cos,"Complex | BigNumber":e=>e.cos()},r)})),Wx="csch",Kx=Mu(Wx,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(Wx,{number:rv,Complex:e=>e.csch(),BigNumber:e=>new r(1).div(e.sinh())})})),Yx="isNaN",Jx=Mu(Yx,["typed"],(e=>{var{typed:t}=e;return t(Yx,{number:Rb,BigNumber:function(e){return e.isNaN()},Fraction:function(e){return!1},Complex:function(e){return e.isNaN()},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":function(e){return Gd(e,Number.isNaN)}})})),Zx="isPrime",Xx=Mu(Zx,["typed"],(e=>{var{typed:t}=e;return t(Zx,{number:function(e){if(0*e!=0)return!1;if(e<=3)return e>1;if(e%2==0||e%3==0)return!1;for(var t=5;t*t<=e;t+=6)if(e%t==0||e%(t+2)==0)return!1;return!0},BigNumber:function(e){if(0*e.toNumber()!=0)return!1;if(e.lte(3))return e.gt(1);if(e.mod(2).eq(0)||e.mod(3).eq(0))return!1;if(e.lt(Math.pow(2,32))){for(var t=e.toNumber(),r=5;r*r<=t;r+=6)if(t%r==0||t%(r+2)==0)return!1;return!0}function n(e,t,r){for(var n=1;!t.eq(0);)t.mod(2).eq(0)?(t=t.div(2),e=e.mul(e).mod(r)):(t=t.sub(1),n=e.mul(n).mod(r));return n}for(var i=e.constructor.clone({precision:2*e.toFixed(0).length}),s=0,o=(e=new i(e)).sub(1);o.mod(2).eq(0);)o=o.div(2),s+=1;var a=null;if(e.lt("3317044064679887385961981"))a=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter((t=>t<e));else{var l=Math.min(e.toNumber()-2,Math.floor(2*Math.pow(e.toFixed(0).length*Math.log(10),2)));a=[];for(var u=2;u<=l;u+=1)a.push(l)}for(var c=0;c<a.length;c+=1){var d=a[c],h=n(e.sub(e).add(d),o,e);if(!h.eq(1))for(var f=0,p=h;!p.eq(e.sub(1));f+=1,p=p.mul(p).mod(e))if(f===s-1)return!1}return!0},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),Qx="randomInt",ew=Mu(Qx,["typed","config","?on"],(e=>{var{typed:t,config:r,on:n}=e,i=hx(r.randomSeed);return n&&n("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=hx(e.randomSeed))})),t(Qx,{"":()=>o(0,1),number:e=>o(0,e),"number, number":(e,t)=>o(e,t),"Array | Matrix":e=>s(e,0,1),"Array | Matrix, number":(e,t)=>s(e,0,t),"Array | Matrix, number, number":(e,t,r)=>s(e,t,r)});function s(e,t,r){var n=vx(e.valueOf(),(()=>o(t,r)));return Vl(e)?e.create(n):n}function o(e,t){return Math.floor(e+i()*(t-e))}})),tw="sech",rw=Mu(tw,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(tw,{number:iv,Complex:e=>e.sech(),BigNumber:e=>new r(1).div(e.cosh())})})),nw="sinh",iw=Mu(nw,["typed"],(e=>{var{typed:t}=e;return t(nw,{number:sv,"Complex | BigNumber":e=>e.sinh()})})),sw="sparse",ow=Mu(sw,["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:r}=e;return t(sw,{"":function(){return new r([])},string:function(e){return new r([],e)},"Array | Matrix":function(e){return new r(e)},"Array | Matrix, string":function(e,t){return new r(e,t)}})})),aw=Mu("sqrt",["config","typed","Complex"],(e=>{var{config:t,typed:r,Complex:n}=e;return r("sqrt",{number:i,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():i(e.toNumber())},Unit:function(e){return e.pow(.5)}});function i(e){return isNaN(e)?NaN:e>=0||t.predictable?Math.sqrt(e):new n(e,0).sqrt()}})),lw=Mu("tanh",["typed"],(e=>{var{typed:t}=e;return t("tanh",{number:mc,"Complex | BigNumber":e=>e.tanh()})})),uw="unaryMinus",cw=Mu(uw,["typed"],(e=>{var{typed:t}=e;return t(uw,{number:wy,"Complex | BigNumber | Fraction":e=>e.neg(),Unit:t.referToSelf((e=>r=>{var n=r.clone();return n.value=t.find(e,n.valueType())(r.value),n})),"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0)))})})),dw="acoth",hw=Mu(dw,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(dw,{number:function(e){return e>=1||e<=-1||r.predictable?Gy(e):new n(e,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(e){return new i(1).div(e).atanh()}})})),fw=Mu("cot",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("cot",{number:Qy,Complex:e=>e.cot(),BigNumber:e=>new r(1).div(e.tan())},eb({typed:t}))})),pw=Mu("fraction",["typed","Fraction"],(e=>{var{typed:t,Fraction:r}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new r(e)},string:function(e){return new r(e)},"number, number":function(e,t){return new r(e,t)},null:function(e){return new r(0)},BigNumber:function(e){return new r(e.toString())},Fraction:function(e){return e},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),Object:function(e){return new r(e)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),mw="isNumeric",gw=Mu(mw,["typed"],(e=>{var{typed:t}=e;return t(mw,{"number | BigNumber | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),yw="matrix",vw=Mu(yw,["typed","Matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,Matrix:r,DenseMatrix:n,SparseMatrix:i}=e;return t(yw,{"":function(){return s([])},string:function(e){return s([],e)},"string, string":function(e,t){return s([],e,t)},Array:function(e){return s(e)},Matrix:function(e){return s(e,e.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(e,t,r){if("dense"===t||"default"===t||void 0===t)return new n(e,r);if("sparse"===t)return new i(e,r);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}})),bw="matrixFromFunction",xw=Mu(bw,["typed","matrix","isZero"],(e=>{var{typed:t,matrix:r,isZero:n}=e;return t(bw,{"Array | Matrix, function, string, string":function(e,t,r,n){return i(e,t,r,n)},"Array | Matrix, function, string":function(e,t,r){return i(e,t,r)},"Matrix, function":function(e,t){return i(e,t,"dense")},"Array, function":function(e,t){return i(e,t,"dense").toArray()},"Array | Matrix, string, function":function(e,t,r){return i(e,r,t)},"Array | Matrix, string, string, function":function(e,t,r,n){return i(e,n,t,r)}});function i(e,t,i,s){var o;return(o=void 0!==s?r(i,s):r(i)).resize(e),o.forEach((function(e,r){var i=t(r);n(i)||o.set(r,i)})),o}})),ww="mode",Ew=Mu(ww,["typed","isNaN","isNumeric"],(e=>{var{typed:t,isNaN:r,isNumeric:n}=e;return t(ww,{"Array | Matrix":i,"...":function(e){return i(e)}});function i(e){if(0===(e=zc(e.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var t={},i=[],s=0,o=0;o<e.length;o++){var a=e[o];if(n(a)&&r(a))throw new Error("Cannot calculate mode of an array containing NaN values");a in t||(t[a]=0),t[a]++,t[a]===s?i.push(a):t[a]>s&&(s=t[a],i=[a])}return i}})),Sw=Mu("numeric",["number","?bignumber","?fraction"],(e=>{var{number:t,bignumber:r,fraction:n}=e,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:e=>t(e),BigNumber:r?e=>r(e):rh,Fraction:n?e=>n(e):nh};return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var r=Tu(e);if(!(r in i))throw new TypeError("Cannot convert "+e+' of type "'+r+'"; valid input types are '+Object.keys(i).join(", "));if(!(t in s))throw new TypeError("Cannot convert "+e+' to type "'+t+'"; valid output types are '+Object.keys(s).join(", "));return t===r?e:s[t](e)}})),Tw="prod",Aw=Mu(Tw,["typed","config","multiplyScalar","numeric"],(e=>{var{typed:t,config:r,multiplyScalar:n,numeric:i}=e;return t(Tw,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return s(e)}});function s(e){var t;if(Vd(e,(function(e){try{t=void 0===t?e:n(t,e)}catch(t){throw lf(t,"prod",e)}})),"string"==typeof t&&(t=i(t,r.number)),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}})),Dw="reshape",Nw=Mu(Dw,["typed","isInteger","matrix"],(e=>{var{typed:t,isInteger:r}=e;return t(Dw,{"Matrix, Array":function(e,t){return e.reshape(t,!0)},"Array, Array":function(e,t){return t.forEach((function(e){if(!r(e))throw new TypeError("Invalid size for dimension: "+e)})),Ic(e,t)}})})),Cw="size",kw=Mu(Cw,["typed","config","?matrix"],(e=>{var{typed:t,config:r,matrix:n}=e;return t(Cw,{Matrix:function(e){return e.create(e.size())},Array:kc,string:function(e){return"Array"===r.matrix?[e.length]:n([e.length])},"number | Complex | BigNumber | Unit | boolean | null":function(e){return"Array"===r.matrix?[]:n?n([]):ih()}})})),Mw="squeeze",Ow=Mu(Mw,["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return t(Mw,{Array:function(e){return Bc(Du(e))},Matrix:function(e){var t=Bc(e.toArray());return Array.isArray(t)?r(t):t},any:function(e){return Du(e)}})})),_w="transpose",Lw=Mu(_w,["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return t(_w,{Array:e=>n(r(e)).valueOf(),Matrix:n,any:Du});function n(e){var t,r=e.size();switch(r.length){case 1:t=e.clone();break;case 2:var n=r[0],i=r[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+xc(r)+")");switch(e.storage()){case"dense":t=function(e,t,r){for(var n,i=e._data,s=[],o=0;o<r;o++){n=s[o]=[];for(var a=0;a<t;a++)n[a]=Du(i[a][o])}return e.createDenseMatrix({data:s,size:[r,t],datatype:e._datatype})}(e,n,i);break;case"sparse":t=function(e,t,r){for(var n,i,s,o=e._values,a=e._index,l=e._ptr,u=o?[]:void 0,c=[],d=[],h=[],f=0;f<t;f++)h[f]=0;for(n=0,i=a.length;n<i;n++)h[a[n]]++;for(var p=0,m=0;m<t;m++)d.push(p),p+=h[m],h[m]=d[m];for(d.push(p),s=0;s<r;s++)for(var g=l[s],y=l[s+1],v=g;v<y;v++){var b=h[a[v]]++;c[b]=s,o&&(u[b]=Du(o[v]))}return e.createSparseMatrix({values:u,index:c,ptr:d,size:[r,t],datatype:e._datatype})}(e,n,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+xc(r)+")")}return t}})),Rw="xgcd",Iw=Mu(Rw,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t(Rw,{"number, number":function(e,t){var i=Iy(e,t);return"Array"===r.matrix?i:n(i)},"BigNumber, BigNumber":function(e,t){var s,o,a,l,u=new i(0),c=new i(1),d=u,h=c,f=c,p=u;if(!e.isInt()||!t.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!t.isZero();)o=e.div(t).floor(),a=e.mod(t),s=d,d=h.minus(o.times(d)),h=s,s=f,f=p.minus(o.times(f)),p=s,e=t,t=a;l=e.lt(u)?[e.neg(),h.neg(),p.neg()]:[e,e.isZero()?0:h,p];return"Array"===r.matrix?l:n(l)}})})),Fw="zeros",Pw=Mu(Fw,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t(Fw,{"":function(){return"Array"===r.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(e){if("string"==typeof e[e.length-1]){var t=e.pop();return s(e,t)}return"Array"===r.matrix?s(e):s(e,"default")},Array:s,Matrix:function(e){var t=e.storage();return s(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){var r=function(e){var t=!1;return e.forEach((function(e,r,n){Ul(e)&&(t=!0,n[r]=e.toNumber())})),t}(e),s=r?new i(0):0;if(function(e){e.forEach((function(e){if("number"!=typeof e||!Ku(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")}))}(e),t){var o=n(t);return e.length>0?o.resize(e,s):o}var a=[];return e.length>0?Lc(a,e,s):a}})),Bw="asin",Uw=Mu(Bw,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(Bw,{number:function(e){return e>=-1&&e<=1||r.predictable?Math.asin(e):new n(e,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()}})})),$w="cbrt",jw=Mu($w,["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(e=>{var{config:t,typed:r,isNegative:n,unaryMinus:i,matrix:s,Complex:o,BigNumber:a,Fraction:l}=e;return r($w,{number:Sy,Complex:u,"Complex, boolean":u,BigNumber:function(e){return e.cbrt()},Unit:function(e){if(e.value&&$l(e.value)){var t=e.clone();return t.value=1,(t=t.pow(1/3)).value=u(e.value),t}var r,s=n(e.value);s&&(e.value=i(e.value)),r=Ul(e.value)?new a(1).div(3):jl(e.value)?new l(1,3):1/3;var o=e.pow(r);return s&&(o.value=i(o.value)),o}});function u(e,r){var n=e.arg()/3,i=e.abs(),a=new o(Sy(i),0).mul(new o(0,n).exp());if(r){var l=[a,new o(Sy(i),0).mul(new o(0,n+2*Math.PI/3).exp()),new o(Sy(i),0).mul(new o(0,n-2*Math.PI/3).exp())];return"Array"===t.matrix?l:s(l)}return a}})),zw="count",qw=Mu(zw,["typed","size","prod"],(e=>{var{typed:t,size:r,prod:n}=e;return t(zw,{string:function(e){return e.length},"Matrix | Array":function(e){return n(r(e))}})})),Hw="ctranspose",Vw=Mu(Hw,["typed","transpose","conj"],(e=>{var{typed:t,transpose:r,conj:n}=e;return t(Hw,{any:function(e){return n(r(e))}})})),Gw="diag",Ww=Mu(Gw,["typed","matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,SparseMatrix:i}=e;return t(Gw,{Array:function(e){return s(e,0,kc(e),null)},"Array, number":function(e,t){return s(e,t,kc(e),null)},"Array, BigNumber":function(e,t){return s(e,t.toNumber(),kc(e),null)},"Array, string":function(e,t){return s(e,0,kc(e),t)},"Array, number, string":function(e,t,r){return s(e,t,kc(e),r)},"Array, BigNumber, string":function(e,t,r){return s(e,t.toNumber(),kc(e),r)},Matrix:function(e){return s(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return s(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return s(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return s(e,0,e.size(),t)},"Matrix, number, string":function(e,t,r){return s(e,t,e.size(),r)},"Matrix, BigNumber, string":function(e,t,r){return s(e,t.toNumber(),e.size(),r)}});function s(e,t,s,o){if(!Ku(t))throw new TypeError("Second parameter in function diag must be an integer");var a=t>0?t:0,l=t<0?-t:0;switch(s.length){case 1:return function(e,t,r,s,o,a){var l=[s+o,s+a];if(r&&"sparse"!==r&&"dense"!==r)throw new TypeError("Unknown matrix type ".concat(r,'"'));var u="sparse"===r?i.diagonal(l,e,t):n.diagonal(l,e,t);return null!==r?u:u.valueOf()}(e,t,o,s[0],l,a);case 2:return function(e,t,n,i,s,o){if(Vl(e)){var a=e.diagonal(t);return null!==n?n!==a.storage()?r(a,n):a:a.valueOf()}for(var l=Math.min(i[0]-s,i[1]-o),u=[],c=0;c<l;c++)u[c]=e[c+s][c+o];return null!==n?r(u):u}(e,t,o,s,l,a)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),Kw="divideScalar",Yw=Mu(Kw,["typed","numeric"],(e=>{var{typed:t,numeric:r}=e;return t(Kw,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Complex | Fraction | BigNumber | Unit":(e,t)=>e.divide(t),"number | Fraction | Complex | BigNumber, Unit":(e,t)=>t.divideInto(e)})})),Jw=Mu("matAlgo02xDS0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i,s){var o=e._data,a=e._size,l=e._datatype,u=n._values,c=n._index,d=n._ptr,h=n._size,f=n._datatype;if(a.length!==h.length)throw new Nc(a.length,h.length);if(a[0]!==h[0]||a[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+h+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,m=a[0],g=a[1],y=r,v=0,b=i;"string"==typeof l&&l===f&&(p=l,y=t.find(r,[p,p]),v=t.convert(0,p),b=t.find(i,[p,p]));for(var x=[],w=[],E=[],S=0;S<g;S++){E[S]=w.length;for(var T=d[S],A=d[S+1],D=T;D<A;D++){var N=c[D],C=s?b(u[D],o[N][S]):b(o[N][S],u[D]);y(C,v)||(w.push(N),x.push(C))}}return E[g]=w.length,n.createSparseMatrix({values:x,index:w,ptr:E,size:[m,g],datatype:p})}})),Zw=Mu("matAlgo03xDSf",["typed"],(e=>{var{typed:t}=e;return function(e,r,n,i){var s=e._data,o=e._size,a=e._datatype,l=r._values,u=r._index,c=r._ptr,d=r._size,h=r._datatype;if(o.length!==d.length)throw new Nc(o.length,d.length);if(o[0]!==d[0]||o[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+d+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p=o[0],m=o[1],g=0,y=n;"string"==typeof a&&a===h&&(f=a,g=t.convert(0,f),y=t.find(n,[f,f]));for(var v=[],b=0;b<p;b++)v[b]=[];for(var x=[],w=[],E=0;E<m;E++){for(var S=E+1,T=c[E],A=c[E+1],D=T;D<A;D++){var N=u[D];x[N]=i?y(l[D],s[N][E]):y(s[N][E],l[D]),w[N]=S}for(var C=0;C<p;C++)w[C]===S?v[C][E]=x[C]:v[C][E]=i?y(g,s[C][E]):y(s[C][E],g)}return e.createDenseMatrix({data:v,size:[p,m],datatype:f})}})),Xw=Mu("matAlgo07xSSf",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:r}=e;return function(e,i,s){var o=e._size,a=e._datatype,l=i._size,u=i._datatype;if(o.length!==l.length)throw new Nc(o.length,l.length);if(o[0]!==l[0]||o[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");var c,d,h,f=o[0],p=o[1],m=0,g=s;"string"==typeof a&&a===u&&(c=a,m=t.convert(0,c),g=t.find(s,[c,c]));var y=[];for(d=0;d<f;d++)y[d]=[];var v=[],b=[],x=[],w=[];for(h=0;h<p;h++){var E=h+1;for(n(e,h,x,v,E),n(i,h,w,b,E),d=0;d<f;d++){var S=x[d]===E?v[d]:m,T=w[d]===E?b[d]:m;y[d][h]=g(S,T)}}return new r({data:y,size:[f,p],datatype:c})};function n(e,t,r,n,i){for(var s=e._values,o=e._index,a=e._ptr,l=a[t],u=a[t+1];l<u;l++){var c=o[l];r[c]=i,n[c]=s[l]}}})),Qw=Mu("matAlgo11xS0s",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i,s){var o=e._values,a=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=u[0],f=u[1],p=r,m=0,g=i;"string"==typeof c&&(d=c,p=t.find(r,[d,d]),m=t.convert(0,d),n=t.convert(n,d),g=t.find(i,[d,d]));for(var y=[],v=[],b=[],x=0;x<f;x++){b[x]=v.length;for(var w=l[x],E=l[x+1],S=w;S<E;S++){var T=a[S],A=s?g(n,o[S]):g(o[S],n);p(A,m)||(v.push(T),y.push(A))}}return b[f]=v.length,e.createSparseMatrix({values:y,index:v,ptr:b,size:[h,f],datatype:d})}})),eE=Mu("matAlgo12xSfs",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:r}=e;return function(e,n,i,s){var o=e._values,a=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=u[0],f=u[1],p=i;"string"==typeof c&&(d=c,n=t.convert(n,d),p=t.find(i,[d,d]));for(var m=[],g=[],y=[],v=0;v<f;v++){for(var b=v+1,x=l[v],w=l[v+1],E=x;E<w;E++){var S=a[E];g[S]=o[E],y[S]=b}for(var T=0;T<h;T++)0===v&&(m[T]=[]),y[T]===b?m[T][v]=s?p(n,g[T]):p(g[T],n):m[T][v]=s?p(n,0):p(0,n)}return new r({data:m,size:[h,f],datatype:d})}})),tE=Mu("matAlgo13xDD",["typed"],(e=>{var{typed:t}=e;return function(e,n,i){var s,o=e._data,a=e._size,l=e._datatype,u=n._data,c=n._size,d=n._datatype,h=[];if(a.length!==c.length)throw new Nc(a.length,c.length);for(var f=0;f<a.length;f++){if(a[f]!==c[f])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");h[f]=a[f]}var p=i;"string"==typeof l&&l===d&&(s=l,p=t.find(i,[s,s]));var m=h.length>0?r(p,0,h,h[0],o,u):[];return e.createDenseMatrix({data:m,size:h,datatype:s})};function r(e,t,n,i,s,o){var a=[];if(t===n.length-1)for(var l=0;l<i;l++)a[l]=e(s[l],o[l]);else for(var u=0;u<i;u++)a[u]=r(e,t+1,n,n[t+1],s[u],o[u]);return a}})),rE=Mu("matAlgo14xDs",["typed"],(e=>{var{typed:t}=e;return function(e,n,i,s){var o,a=e._data,l=e._size,u=e._datatype,c=i;"string"==typeof u&&(o=u,n=t.convert(n,o),c=t.find(i,[o,o]));var d=l.length>0?r(c,0,l,l[0],a,n,s):[];return e.createDenseMatrix({data:d,size:Du(l),datatype:o})};function r(e,t,n,i,s,o,a){var l=[];if(t===n.length-1)for(var u=0;u<i;u++)l[u]=a?e(o,s[u]):e(s[u],o);else for(var c=0;c<i;c++)l[c]=r(e,t+1,n,n[t+1],s[c],o,a);return l}})),nE=Mu("broadcast",["concat"],(e=>{var{concat:t}=e;return function(e,t){var s=Math.max(e._size.length,t._size.length);if(e._size.length===t._size.length&&e._size.every(((e,r)=>e===t._size[r])))return[e,t];for(var o=r(e._size,s,0),a=r(t._size,s,0),l=[],u=0;u<s;u++)l[u]=Math.max(o[u],a[u]);for(var c=0;c<s;c++)i(o,l,c),i(a,l,c);var d=e.clone(),h=t.clone();d._size.length<s?d.reshape(r(d._size,s,1)):h._size.length<s&&h.reshape(r(h._size,s,1));for(var f=0;f<s;f++)d._size[f]<l[f]&&(d=n(d,l[f],f)),h._size[f]<l[f]&&(h=n(h,l[f],f));return[d,h]};function r(e,t,r){return[...Array(t-e.length).fill(r),...e]}function n(e,r,n){return t(...Array(r).fill(e),n)}function i(e,t,r){if(e[r]<t[r]&e[r]>1)throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[r]," to size ").concat(t[r]))}})),iE=Mu("matrixAlgorithmSuite",["typed","matrix","concat"],(e=>{var{typed:t,matrix:r,concat:n}=e,i=tE({typed:t}),s=rE({typed:t}),o=nE({concat:n});return function(e){var n,a=e.elop,l=e.SD||e.DS;a?(n={"DenseMatrix, DenseMatrix":(e,t)=>i(...o(e,t),a),"Array, Array":(e,t)=>i(...o(r(e),r(t)),a).valueOf(),"Array, DenseMatrix":(e,t)=>i(...o(r(e),t),a),"DenseMatrix, Array":(e,t)=>i(...o(e,r(t)),a)},e.SS&&(n["SparseMatrix, SparseMatrix"]=(t,r)=>e.SS(...o(t,r),a,!1)),e.DS&&(n["DenseMatrix, SparseMatrix"]=(t,r)=>e.DS(...o(t,r),a,!1),n["Array, SparseMatrix"]=(t,n)=>e.DS(...o(r(t),n),a,!1)),l&&(n["SparseMatrix, DenseMatrix"]=(e,t)=>l(...o(t,e),a,!0),n["SparseMatrix, Array"]=(e,t)=>l(...o(r(t),e),a,!0))):(n={"DenseMatrix, DenseMatrix":t.referToSelf((e=>(t,r)=>i(...o(t,r),e))),"Array, Array":t.referToSelf((e=>(t,n)=>i(...o(r(t),r(n)),e).valueOf())),"Array, DenseMatrix":t.referToSelf((e=>(t,n)=>i(...o(r(t),n),e))),"DenseMatrix, Array":t.referToSelf((e=>(t,n)=>i(...o(t,r(n)),e)))},e.SS&&(n["SparseMatrix, SparseMatrix"]=t.referToSelf((t=>(r,n)=>e.SS(...o(r,n),t,!1)))),e.DS&&(n["DenseMatrix, SparseMatrix"]=t.referToSelf((t=>(r,n)=>e.DS(...o(r,n),t,!1))),n["Array, SparseMatrix"]=t.referToSelf((t=>(n,i)=>e.DS(...o(r(n),i),t,!1)))),l&&(n["SparseMatrix, DenseMatrix"]=t.referToSelf((e=>(t,r)=>l(...o(r,t),e,!0))),n["SparseMatrix, Array"]=t.referToSelf((e=>(t,n)=>l(...o(r(n),t),e,!0)))));var u=e.scalar||"any";(e.Ds||e.Ss)&&(a?(n["DenseMatrix,"+u]=(e,t)=>s(e,t,a,!1),n[u+", DenseMatrix"]=(e,t)=>s(t,e,a,!0),n["Array,"+u]=(e,t)=>s(r(e),t,a,!1).valueOf(),n[u+", Array"]=(e,t)=>s(r(t),e,a,!0).valueOf()):(n["DenseMatrix,"+u]=t.referToSelf((e=>(t,r)=>s(t,r,e,!1))),n[u+", DenseMatrix"]=t.referToSelf((e=>(t,r)=>s(r,t,e,!0))),n["Array,"+u]=t.referToSelf((e=>(t,n)=>s(r(t),n,e,!1).valueOf())),n[u+", Array"]=t.referToSelf((e=>(t,n)=>s(r(n),t,e,!0).valueOf()))));var c=void 0!==e.sS?e.sS:e.Ss;return a?(e.Ss&&(n["SparseMatrix,"+u]=(t,r)=>e.Ss(t,r,a,!1)),c&&(n[u+", SparseMatrix"]=(e,t)=>c(t,e,a,!0))):(e.Ss&&(n["SparseMatrix,"+u]=t.referToSelf((t=>(r,n)=>e.Ss(r,n,t,!1)))),c&&(n[u+", SparseMatrix"]=t.referToSelf((e=>(t,r)=>c(r,t,e,!0))))),a&&a.signatures&&Nu(n,a.signatures),n}})),sE="dotDivide",oE=Mu(sE,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,divideScalar:i,DenseMatrix:s,concat:o}=e,a=Jw({typed:t,equalScalar:n}),l=Zw({typed:t}),u=Xw({typed:t,DenseMatrix:s}),c=Qw({typed:t,equalScalar:n}),d=eE({typed:t,DenseMatrix:s}),h=iE({typed:t,matrix:r,concat:o});return t(sE,h({elop:i,SS:u,DS:l,SD:a,Ss:c,sS:d}))})),aE="equal",lE=Mu(aE,["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=Xw({typed:t,DenseMatrix:i}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:r,concat:s});return t(aE,uE({typed:t,equalScalar:n}),u({elop:n,SS:a,DS:o,Ss:l}))})),uE=Mu(aE,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return t(aE,{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:r(e,t)}})})),cE="flatten",dE=Mu(cE,["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return t(cE,{Array:function(e){return zc(e)},Matrix:function(e){var t=zc(e.toArray());return r(t)}})})),hE=Mu("matAlgo01xDSid",["typed"],(e=>{var{typed:t}=e;return function(e,r,n,i){var s=e._data,o=e._size,a=e._datatype,l=r._values,u=r._index,c=r._ptr,d=r._size,h=r._datatype;if(o.length!==d.length)throw new Nc(o.length,d.length);if(o[0]!==d[0]||o[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+d+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p,m=o[0],g=o[1],y="string"==typeof a&&a===h?a:void 0,v=y?t.find(n,[y,y]):n,b=[];for(f=0;f<m;f++)b[f]=[];var x=[],w=[];for(p=0;p<g;p++){for(var E=p+1,S=c[p],T=c[p+1],A=S;A<T;A++)x[f=u[A]]=i?v(l[A],s[f][p]):v(s[f][p],l[A]),w[f]=E;for(f=0;f<m;f++)w[f]===E?b[f][p]=x[f]:b[f][p]=s[f][p]}return e.createDenseMatrix({data:b,size:[m,g],datatype:y})}})),fE=Mu("matAlgo04xSidSid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var s=e._values,o=e._index,a=e._ptr,l=e._size,u=e._datatype,c=n._values,d=n._index,h=n._ptr,f=n._size,p=n._datatype;if(l.length!==f.length)throw new Nc(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],y=l[1],v=r,b=0,x=i;"string"==typeof u&&u===p&&(m=u,v=t.find(r,[m,m]),b=t.convert(0,m),x=t.find(i,[m,m]));var w,E,S,T,A,D=s&&c?[]:void 0,N=[],C=[],k=s&&c?[]:void 0,M=s&&c?[]:void 0,O=[],_=[];for(E=0;E<y;E++){C[E]=N.length;var L=E+1;for(T=a[E],A=a[E+1],S=T;S<A;S++)w=o[S],N.push(w),O[w]=L,k&&(k[w]=s[S]);for(T=h[E],A=h[E+1],S=T;S<A;S++)if(O[w=d[S]]===L){if(k){var R=x(k[w],c[S]);v(R,b)?O[w]=null:k[w]=R}}else N.push(w),_[w]=L,M&&(M[w]=c[S]);if(k&&M)for(S=C[E];S<N.length;)O[w=N[S]]===L?(D[S]=k[w],S++):_[w]===L?(D[S]=M[w],S++):N.splice(S,1)}return C[y]=N.length,e.createSparseMatrix({values:D,index:N,ptr:C,size:[g,y],datatype:m})}})),pE=Mu("matAlgo10xSids",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:r}=e;return function(e,n,i,s){var o=e._values,a=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=u[0],f=u[1],p=i;"string"==typeof c&&(d=c,n=t.convert(n,d),p=t.find(i,[d,d]));for(var m=[],g=[],y=[],v=0;v<f;v++){for(var b=v+1,x=l[v],w=l[v+1],E=x;E<w;E++){var S=a[E];g[S]=o[E],y[S]=b}for(var T=0;T<h;T++)0===v&&(m[T]=[]),y[T]===b?m[T][v]=s?p(n,g[T]):p(g[T],n):m[T][v]=n}return new r({data:m,size:[h,f],datatype:d})}}));function mE(e,t,r,n){if(!(this instanceof mE))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=r,this.max=n,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+r+(null!=n?"-"+n:"")+" expected)",this.stack=(new Error).stack}mE.prototype=new Error,mE.prototype.constructor=Error,mE.prototype.name="ArgumentsError",mE.prototype.isArgumentsError=!0;var gE=["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],yE="number | BigNumber | Fraction | Matrix | Array",vE="".concat(yE,", ").concat(yE,", ...").concat(yE);function bE(e){return!e.some((e=>Array.isArray(e)))}var xE=Mu("gcd",gE,(e=>{var{typed:t,matrix:r,equalScalar:n,BigNumber:i,DenseMatrix:s,concat:o}=e,a=hE({typed:t}),l=fE({typed:t,equalScalar:n}),u=pE({typed:t,DenseMatrix:s});return t("gcd",{"number, number":Ny,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");var r=new i(0);for(;!t.isZero();){var n=e.mod(t);e=t,t=n}return e.lt(r)?e.neg():e},"Fraction, Fraction":(e,t)=>e.gcd(t)},iE({typed:t,matrix:r,concat:o})({SS:l,DS:a,Ss:u}),{[vE]:t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),s=0;s<n.length;s++)i=e(i,n[s]);return i})),Array:t.referToSelf((e=>t=>{if(1===t.length&&Array.isArray(t[0])&&bE(t[0]))return e(...t[0]);if(bE(t))return e(...t);throw new mE("gcd() supports only 1d matrices!")})),Matrix:t.referToSelf((e=>t=>e(t.toArray())))})})),wE="hasNumericValue",EE=Mu(wE,["typed","isNumeric"],(e=>{var{typed:t,isNumeric:r}=e;return t(wE,{boolean:()=>!0,string:function(e){return e.trim().length>0&&!isNaN(Number(e))},any:function(e){return r(e)}})})),SE="identity",TE=Mu(SE,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i,DenseMatrix:s,SparseMatrix:o}=e;return t(SE,{"":function(){return"Matrix"===r.matrix?n([]):[]},string:function(e){return n(e)},"number | BigNumber":function(e){return l(e,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return l(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return l(e,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,r){return l(e,t,r)},Array:function(e){return a(e)},"Array, string":function(e,t){return a(e,t)},Matrix:function(e){return a(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return a(e.valueOf(),t)}});function a(e,t){switch(e.length){case 0:return t?n(t):[];case 1:return l(e[0],e[0],t);case 2:return l(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function l(e,t,r){var n=Ul(e)||Ul(t)?i:null;if(Ul(e)&&(e=e.toNumber()),Ul(t)&&(t=t.toNumber()),!Ku(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!Ku(t)||t<1)throw new Error("Parameters in function identity must be positive integers");var a=n?new i(1):1,l=n?new n(0):0,u=[e,t];if(r){if("sparse"===r)return o.diagonal(u,a,0,l);if("dense"===r)return s.diagonal(u,a,0,l);throw new TypeError('Unknown matrix type "'.concat(r,'"'))}for(var c=Lc([],u,l),d=e<t?e:t,h=0;h<d;h++)c[h][h]=a;return c}})),AE="kron",DE=Mu(AE,["typed","matrix","multiplyScalar"],(e=>{var{typed:t,matrix:r,multiplyScalar:n}=e;return t(AE,{"Matrix, Matrix":function(e,t){return r(i(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return r(i(e.toArray(),t))},"Array, Matrix":function(e,t){return r(i(e,t.toArray()))},"Array, Array":i});function i(e,t){if(1===kc(e).length&&(e=[e]),1===kc(t).length&&(t=[t]),kc(e).length>2||kc(t).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(e.length)+", y = "+JSON.stringify(t.length)+")");var r=[],i=[];return e.map((function(e){return t.map((function(t){return i=[],r.push(i),e.map((function(e){return t.map((function(t){return i.push(n(e,t))}))}))}))}))&&r}})),NE="largerEq",CE=Mu(NE,["typed","config","matrix","DenseMatrix","concat"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=Xw({typed:t,DenseMatrix:i}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:n,concat:s}),c=sb({typed:t});return t(NE,kE({typed:t,config:r}),{"boolean, boolean":(e,t)=>e>=t,"BigNumber, BigNumber":function(e,t){return e.gte(t)||ib(e,t,r.epsilon)},"Fraction, Fraction":(e,t)=>-1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,u({SS:a,DS:o,Ss:l}))})),kE=Mu(NE,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(NE,{"number, number":function(e,t){return e>=t||uc(e,t,r.epsilon)}})})),ME=Mu("matAlgo08xS0Sid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var s=e._values,o=e._index,a=e._ptr,l=e._size,u=e._datatype,c=n._values,d=n._index,h=n._ptr,f=n._size,p=n._datatype;if(l.length!==f.length)throw new Nc(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!s||!c)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var m,g=l[0],y=l[1],v=r,b=0,x=i;"string"==typeof u&&u===p&&(m=u,v=t.find(r,[m,m]),b=t.convert(0,m),x=t.find(i,[m,m]));for(var w,E,S,T,A=[],D=[],N=[],C=[],k=[],M=0;M<y;M++){N[M]=D.length;var O=M+1;for(E=a[M],S=a[M+1],w=E;w<S;w++)k[T=o[w]]=O,C[T]=s[w],D.push(T);for(E=h[M],S=h[M+1],w=E;w<S;w++)k[T=d[w]]===O&&(C[T]=x(C[T],c[w]));for(w=N[M];w<D.length;){var _=C[T=D[w]];v(_,b)?D.splice(w,1):(A.push(_),w++)}}return N[y]=D.length,e.createSparseMatrix({values:A,index:D,ptr:N,size:[g,y],datatype:m})}})),OE=Mu("useMatrixForArrayScalar",["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return{"Array, number":t.referTo("DenseMatrix, number",(e=>(t,n)=>e(r(t),n).valueOf())),"Array, BigNumber":t.referTo("DenseMatrix, BigNumber",(e=>(t,n)=>e(r(t),n).valueOf())),"number, Array":t.referTo("number, DenseMatrix",(e=>(t,n)=>e(t,r(n)).valueOf())),"BigNumber, Array":t.referTo("BigNumber, DenseMatrix",(e=>(t,n)=>e(t,r(n)).valueOf()))}})),_E="leftShift",LE=Mu(_E,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:s,concat:o}=e,a=hE({typed:t}),l=Jw({typed:t,equalScalar:n}),u=ME({typed:t,equalScalar:n}),c=pE({typed:t,DenseMatrix:s}),d=Qw({typed:t,equalScalar:n}),h=rE({typed:t}),f=iE({typed:t,matrix:r,concat:o}),p=OE({typed:t,matrix:r});return t(_E,{"number, number":Lv,"BigNumber, BigNumber":Dv,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():d(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):h(r,t,e,!0)))},p,f({SS:u,DS:a,SD:l}))})),RE="matrixFromColumns",IE=Mu(RE,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:r,flatten:n,size:i}=e;return t(RE,{"...Array":function(e){return s(e)},"...Matrix":function(e){return r(s(e.map((e=>e.toArray()))))}});function s(e){if(0===e.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var t=o(e[0]),r=[],i=0;i<t;i++)r[i]=[];for(var s of e){var a=o(s);if(a!==t)throw new TypeError("The vectors had different length: "+(0|t)+" ≠ "+(0|a));for(var l=n(s),u=0;u<t;u++)r[u].push(l[u])}return r}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),FE=Mu("matAlgo05xSfSf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var s=e._values,o=e._index,a=e._ptr,l=e._size,u=e._datatype,c=n._values,d=n._index,h=n._ptr,f=n._size,p=n._datatype;if(l.length!==f.length)throw new Nc(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],y=l[1],v=r,b=0,x=i;"string"==typeof u&&u===p&&(m=u,v=t.find(r,[m,m]),b=t.convert(0,m),x=t.find(i,[m,m]));var w,E,S,T,A=s&&c?[]:void 0,D=[],N=[],C=A?[]:void 0,k=A?[]:void 0,M=[],O=[];for(E=0;E<y;E++){N[E]=D.length;var _=E+1;for(S=a[E],T=a[E+1];S<T;S++)w=o[S],D.push(w),M[w]=_,C&&(C[w]=s[S]);for(S=h[E],T=h[E+1];S<T;S++)M[w=d[S]]!==_&&D.push(w),O[w]=_,k&&(k[w]=c[S]);if(A)for(S=N[E];S<D.length;){var L=M[w=D[S]],R=O[w];if(L===_||R===_){var I=x(L===_?C[w]:b,R===_?k[w]:b);v(I,b)?D.splice(S,1):(A.push(I),S++)}}}return N[y]=D.length,e.createSparseMatrix({values:A,index:D,ptr:N,size:[g,y],datatype:m})}})),PE=Mu("mod",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:s}=e,o=Jw({typed:t,equalScalar:n}),a=Zw({typed:t}),l=FE({typed:t,equalScalar:n}),u=Qw({typed:t,equalScalar:n}),c=eE({typed:t,DenseMatrix:i});return t("mod",{"number, number":Oy,"BigNumber, BigNumber":function(e,t){if(t.isNeg())throw new Error("Cannot calculate mod for a negative divisor");return t.isZero()?e:e.mod(t)},"Fraction, Fraction":function(e,t){if(t.compare(0)<0)throw new Error("Cannot calculate mod for a negative divisor");return e.compare(0)>=0?e.mod(t):e.mod(t).add(t).mod(t)}},iE({typed:t,matrix:r,concat:s})({SS:l,DS:a,SD:o,Ss:u,sS:c}))})),BE=Mu("matAlgo06xS0S0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var s=e._values,o=e._size,a=e._datatype,l=n._values,u=n._size,c=n._datatype;if(o.length!==u.length)throw new Nc(o.length,u.length);if(o[0]!==u[0]||o[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+u+")");var d,h=o[0],f=o[1],p=r,m=0,g=i;"string"==typeof a&&a===c&&(d=a,p=t.find(r,[d,d]),m=t.convert(0,d),g=t.find(i,[d,d]));for(var y=s&&l?[]:void 0,v=[],b=[],x=y?[]:void 0,w=[],E=[],S=0;S<f;S++){b[S]=v.length;var T=S+1;if(Yd(e,S,w,x,E,T,v,g),Yd(n,S,w,x,E,T,v,g),x)for(var A=b[S];A<v.length;){var D=v[A];if(E[D]===T){var N=x[D];p(N,m)?v.splice(A,1):(y.push(N),A++)}else v.splice(A,1)}else for(var C=b[S];C<v.length;){E[v[C]]!==T?v.splice(C,1):C++}}return b[f]=v.length,e.createSparseMatrix({values:y,index:v,ptr:b,size:[h,f],datatype:d})}})),UE="nthRoot",$E=Mu(UE,["typed","matrix","equalScalar","BigNumber","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,BigNumber:i,concat:s}=e,o=hE({typed:t}),a=Jw({typed:t,equalScalar:n}),l=BE({typed:t,equalScalar:n}),u=Qw({typed:t,equalScalar:n}),c=iE({typed:t,matrix:r,concat:s});function d(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return t(UE,{number:_y,"number, number":_y,BigNumber:e=>h(e,new i(2)),"BigNumber, BigNumber":h,Complex:d,"Complex, number":d,Array:t.referTo("DenseMatrix,number",(e=>t=>e(r(t),2).valueOf())),DenseMatrix:t.referTo("DenseMatrix,number",(e=>t=>e(t,2))),SparseMatrix:t.referTo("SparseMatrix,number",(e=>t=>e(t,2))),"SparseMatrix, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return l(t,r,e);throw new Error("Root must be non-zero")})),"DenseMatrix, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return o(t,r,e,!1);throw new Error("Root must be non-zero")})),"Array, SparseMatrix":t.referTo("DenseMatrix,SparseMatrix",(e=>(t,n)=>e(r(t),n))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return u(r,t,e,!0);throw new Error("Root must be non-zero")}))},c({scalar:"number | BigNumber",SD:a,Ss:u,sS:!1}));function h(e,t){var r=i.precision,n=i.clone({precision:r+2}),s=new i(0),o=new n(1),a=t.isNegative();if(a&&(t=t.neg()),t.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!t.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return a?new n(1/0):0;if(!e.isFinite())return a?s:e;var l=e.abs().pow(o.div(t));return l=e.isNeg()?l.neg():l,new i((a?o.div(l):l).toPrecision(r))}})),jE=Mu("ones",["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t("ones",{"":function(){return"Array"===r.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(e){if("string"==typeof e[e.length-1]){var t=e.pop();return s(e,t)}return"Array"===r.matrix?s(e):s(e,"default")},Array:s,Matrix:function(e){var t=e.storage();return s(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){var r=function(e){var t=!1;return e.forEach((function(e,r,n){Ul(e)&&(t=!0,n[r]=e.toNumber())})),t}(e),s=r?new i(1):1;if(function(e){e.forEach((function(e){if("number"!=typeof e||!Ku(e)||e<0)throw new Error("Parameters in function ones must be positive integers")}))}(e),t){var o=n(t);return e.length>0?o.resize(e,s):o}var a=[];return e.length>0?Lc(a,e,s):a}})),zE=Mu("resize",["config","matrix"],(e=>{var{config:t,matrix:r}=e;return function(e,n,i){if(2!==arguments.length&&3!==arguments.length)throw new mE("resize",arguments.length,2,3);if(Vl(n)&&(n=n.valueOf()),Ul(n[0])&&(n=n.map((function(e){return Ul(e)?e.toNumber():e}))),Vl(e))return e.resize(n,i,!0);if("string"==typeof e)return function(e,t,r){if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";if(1!==t.length)throw new Nc(t.length,1);var n=t[0];if("number"!=typeof n||!Ku(n))throw new TypeError("Invalid size, must contain positive integers (size: "+xc(t)+")");if(e.length>n)return e.substring(0,n);if(e.length<n){for(var i=e,s=0,o=n-e.length;s<o;s++)i+=r;return i}return e}(e,n,i);var s=!Array.isArray(e)&&"Array"!==t.matrix;if(0===n.length){for(;Array.isArray(e);)e=e[0];return Du(e)}Array.isArray(e)||(e=[e]);var o=Lc(e=Du(e),n,i);return s?r(o):o}})),qE="rightArithShift",HE=Mu(qE,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:s,concat:o}=e,a=hE({typed:t}),l=Jw({typed:t,equalScalar:n}),u=ME({typed:t,equalScalar:n}),c=pE({typed:t,DenseMatrix:s}),d=Qw({typed:t,equalScalar:n}),h=rE({typed:t}),f=iE({typed:t,matrix:r,concat:o}),p=OE({typed:t,matrix:r});return t(qE,{"number, number":Rv,"BigNumber, BigNumber":Nv,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():d(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):h(r,t,e,!0)))},p,f({SS:u,DS:a,SD:l}))})),VE="Number of decimals in function round must be an integer",GE="round",WE=Mu(GE,["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,BigNumber:s,DenseMatrix:o}=e,a=Qw({typed:t,equalScalar:n}),l=eE({typed:t,DenseMatrix:o}),u=rE({typed:t});return t(GE,{number:Py,"number, number":Py,"number, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(VE);return new s(e).toDecimalPlaces(t.toNumber())},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(VE);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(VE);var r=t.toNumber();return e.round(r)},BigNumber:function(e){return e.toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(VE);return e.toDecimalPlaces(t.toNumber())},Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(VE);return e.round(t)},"Fraction, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(VE);return e.round(t.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>a(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>u(t,r,e,!1))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>u(r(t),n,e,!1).valueOf())),"number | Complex | BigNumber | Fraction, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):l(r,t,e,!0))),"number | Complex | BigNumber | Fraction, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):u(r,t,e,!0))),"number | Complex | BigNumber | Fraction, Array":t.referToSelf((e=>(t,n)=>u(r(n),t,e,!0).valueOf()))})})),KE="smaller",YE=Mu(KE,["typed","config","matrix","DenseMatrix","concat"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=Xw({typed:t,DenseMatrix:i}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:n,concat:s}),c=sb({typed:t});return t(KE,JE({typed:t,config:r}),{"boolean, boolean":(e,t)=>e<t,"BigNumber, BigNumber":function(e,t){return e.lt(t)&&!ib(e,t,r.epsilon)},"Fraction, Fraction":(e,t)=>-1===e.compare(t),"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")}},c,u({SS:a,DS:o,Ss:l}))})),JE=Mu(KE,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(KE,{"number, number":function(e,t){return e<t&&!uc(e,t,r.epsilon)}})})),ZE=Mu("to",["typed","matrix","concat"],(e=>{var{typed:t,matrix:r,concat:n}=e;return t("to",{"Unit, Unit | string":(e,t)=>e.to(t)},iE({typed:t,matrix:r,concat:n})({Ds:!0}))})),XE="unequal",QE=Mu(XE,["typed","config","equalScalar","matrix","DenseMatrix","concat"],(e=>{var{typed:t,config:r,equalScalar:n,matrix:i,DenseMatrix:s,concat:o}=e,a=Zw({typed:t}),l=Xw({typed:t,DenseMatrix:s}),u=eE({typed:t,DenseMatrix:s}),c=iE({typed:t,matrix:i,concat:o});return t(XE,eS({typed:t,equalScalar:n}),c({elop:function(e,t){return!n(e,t)},SS:l,DS:a,Ss:u}))})),eS=Mu(XE,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return t(XE,{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:!r(e,t)}})})),tS=Mu("xor",["typed","matrix","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,concat:i}=e,s=Zw({typed:t}),o=Xw({typed:t,DenseMatrix:n}),a=eE({typed:t,DenseMatrix:n}),l=iE({typed:t,matrix:r,concat:i});return t("xor",{"number, number":sx,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!=(0!==t.re||0!==t.im)},"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!=(!t.isZero()&&!t.isNaN())},"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0)))},l({SS:o,DS:s,Ss:a}))})),rS=Mu("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(e=>{var{typed:t,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:s,SparseMatrix:o,concat:a}=e,l=hE({typed:t}),u=fE({typed:t,equalScalar:i}),c=pE({typed:t,DenseMatrix:s}),d=iE({typed:t,matrix:r,concat:a});return t("add",{"any, any":n,"any, any, ...any":t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),s=0;s<n.length;s++)i=e(i,n[s]);return i}))},d({elop:n,DS:l,SS:u,Ss:c}))})),nS="bitAnd",iS=Mu(nS,["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,concat:i}=e,s=Jw({typed:t,equalScalar:n}),o=BE({typed:t,equalScalar:n}),a=Qw({typed:t,equalScalar:n}),l=iE({typed:t,matrix:r,concat:i});return t(nS,{"number, number":kv,"BigNumber, BigNumber":xv},l({SS:o,DS:s,Ss:a}))})),sS="bitXor",oS=Mu(sS,["typed","matrix","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,concat:i}=e,s=Zw({typed:t}),o=Xw({typed:t,DenseMatrix:n}),a=eE({typed:t,DenseMatrix:n}),l=iE({typed:t,matrix:r,concat:i});return t(sS,{"number, number":_v,"BigNumber, BigNumber":Av},l({SS:o,DS:s,Ss:a}))})),aS="catalan",lS=Mu(aS,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(e=>{var{typed:t,addScalar:r,divideScalar:n,multiplyScalar:i,combinations:s,isNegative:o,isInteger:a}=e;return t(aS,{"number | BigNumber":function(e){if(!a(e)||o(e))throw new TypeError("Non-negative integer value expected in function catalan");return n(s(i(e,2),e),r(e,1))}})})),uS="compare",cS=Mu(uS,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],(e=>{var{typed:t,config:r,equalScalar:n,matrix:i,BigNumber:s,Fraction:o,DenseMatrix:a,concat:l}=e,u=Zw({typed:t}),c=FE({typed:t,equalScalar:n}),d=eE({typed:t,DenseMatrix:a}),h=iE({typed:t,matrix:i,concat:l}),f=sb({typed:t});return t(uS,dS({typed:t,config:r}),{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"BigNumber, BigNumber":function(e,t){return ib(e,t,r.epsilon)?new s(0):new s(e.cmp(t))},"Fraction, Fraction":function(e,t){return new o(e.compare(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,h({SS:c,DS:u,Ss:d}))})),dS=Mu(uS,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(uS,{"number, number":function(e,t){return uc(e,t,r.epsilon)?0:e>t?1:-1}})})),hS="compareText",fS=["typed","matrix","concat"];Tc.signature="any, any";var pS=Mu(hS,fS,(e=>{var{typed:t,matrix:r,concat:n}=e,i=iE({typed:t,matrix:r,concat:n});return t(hS,Tc,i({elop:Tc,Ds:!0}))})),mS="deepEqual",gS=Mu(mS,["typed","equal"],(e=>{var{typed:t,equal:r}=e;return t(mS,{"any, any":function(e,t){return n(e.valueOf(),t.valueOf())}});function n(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var i=e.length;if(i!==t.length)return!1;for(var s=0;s<i;s++)if(!n(e[s],t[s]))return!1;return!0}return!1}return!Array.isArray(t)&&r(e,t)}})),yS=Mu("dot",["typed","addScalar","multiplyScalar","conj","size"],(e=>{var{typed:t,addScalar:r,multiplyScalar:n,conj:i,size:s}=e;return t("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(e,s){var l=o(e,s),u=Vl(e)?e._data:e,c=Vl(e)?e._datatype:void 0,d=Vl(s)?s._data:s,h=Vl(s)?s._datatype:void 0,f=2===a(e).length,p=2===a(s).length,m=r,g=n;if(c&&h&&c===h&&"string"==typeof c){var y=c;m=t.find(r,[y,y]),g=t.find(n,[y,y])}if(!f&&!p){for(var v=g(i(u[0]),d[0]),b=1;b<l;b++)v=m(v,g(i(u[b]),d[b]));return v}if(!f&&p){for(var x=g(i(u[0]),d[0][0]),w=1;w<l;w++)x=m(x,g(i(u[w]),d[w][0]));return x}if(f&&!p){for(var E=g(i(u[0][0]),d[0]),S=1;S<l;S++)E=m(E,g(i(u[S][0]),d[S]));return E}if(f&&p){for(var T=g(i(u[0][0]),d[0][0]),A=1;A<l;A++)T=m(T,g(i(u[A][0]),d[A][0]));return T}},"SparseMatrix, SparseMatrix":function(e,t){o(e,t);var i=e._index,s=e._values,a=t._index,l=t._values,u=0,c=r,d=n,h=0,f=0;for(;h<i.length&&f<a.length;){var p=i[h],m=a[f];p<m?h++:p>m?f++:p===m&&(u=c(u,d(s[h],l[f])),h++,f++)}return u}});function o(e,t){var r,n,i=a(e),s=a(t);if(1===i.length)r=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");r=i[0]}if(1===s.length)n=s[0];else{if(2!==s.length||1!==s[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+s.join(", ")+")");n=s[0]}if(r!==n)throw new RangeError("Vectors must have equal length ("+r+" != "+n+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function a(e){return Vl(e)?e.size():s(e)}})),vS="equalText",bS=Mu(vS,["typed","compareText","isZero"],(e=>{var{typed:t,compareText:r,isZero:n}=e;return t(vS,{"any, any":function(e,t){return n(r(e,t))}})})),xS="floor",wS=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],ES=Mu(xS,["typed","config","round"],(e=>{var{typed:t,config:r,round:n}=e;return t(xS,{number:function(e){return uc(e,n(e),r.epsilon)?n(e):Math.floor(e)},"number, number":function(e,t){if(uc(e,n(e,t),r.epsilon))return n(e,t);var[i,s]="".concat(e,"e").split("e"),o=Math.floor(Number("".concat(i,"e").concat(Number(s)+t)));return[i,s]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(s)-t))}})})),SS=Mu(xS,wS,(e=>{var{typed:t,config:r,round:n,matrix:i,equalScalar:s,zeros:o,DenseMatrix:a}=e,l=Qw({typed:t,equalScalar:s}),u=eE({typed:t,DenseMatrix:a}),c=rE({typed:t}),d=ES({typed:t,config:r,round:n});return t("floor",{number:d.signatures.number,"number,number":d.signatures["number,number"],Complex:function(e){return e.floor()},"Complex, number":function(e,t){return e.floor(t)},"Complex, BigNumber":function(e,t){return e.floor(t.toNumber())},BigNumber:function(e){return ib(e,n(e),r.epsilon)?n(e):e.floor()},"BigNumber, BigNumber":function(e,t){return ib(e,n(e,t),r.epsilon)?n(e,t):e.toDecimalPlaces(t.toNumber(),Nm.ROUND_FLOOR)},Fraction:function(e){return e.floor()},"Fraction, number":function(e,t){return e.floor(t)},"Fraction, BigNumber":function(e,t){return e.floor(t.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,r)=>Gd(t,(t=>e(t,r)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>l(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>c(t,r,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(i(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>s(t,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),TS="hypot",AS=Mu(TS,["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(e=>{var{typed:t,abs:r,addScalar:n,divideScalar:i,multiplyScalar:s,sqrt:o,smaller:a,isPositive:l}=e;return t(TS,{"... number | BigNumber":u,Array:u,Matrix:e=>u(zc(e.toArray()))});function u(e){for(var t=0,u=0,c=0;c<e.length;c++){if($l(e[c]))throw new TypeError("Unexpected type of argument to hypot");var d=r(e[c]);a(u,d)?(t=s(t,s(i(u,d),i(u,d))),t=n(t,1),u=d):t=n(t,l(d)?s(i(d,u),i(d,u)):d)}return s(u,o(t))}})),DS=Mu("ImmutableDenseMatrix",["smaller","DenseMatrix"],(e=>{var{smaller:t,DenseMatrix:r}=e;function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!ql(t))throw new Error("Invalid datatype: "+t);if(Vl(e)||Hl(e)){var i=new r(e,t);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(e&&Hl(e.data)&&Hl(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min=void 0!==e.min?e.min:null,this._max=void 0!==e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+Tu(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}return n.prototype=new r,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(e){switch(arguments.length){case 1:var t=r.prototype.subset.call(this,e);return Vl(t)?new n({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:Du(this._data),size:Du(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(e){return new n(e)},n.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(null===this._min){var e=null;this.forEach((function(r){(null===e||t(r,e))&&(e=r)})),this._min=null!==e?e:void 0}return this._min},n.prototype.max=function(){if(null===this._max){var e=null;this.forEach((function(r){(null===e||t(e,r))&&(e=r)})),this._max=null!==e?e:void 0}return this._max},n}),{isClass:!0}),NS=Mu("Index",["ImmutableDenseMatrix"],(e=>{var{ImmutableDenseMatrix:t}=e;function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var t=0,i=arguments.length;t<i;t++){var s=arguments[t];if(Yl(s))this._dimensions.push(s),this._isScalar=!1;else if(Array.isArray(s)||Vl(s)){var o=n(s.valueOf());this._dimensions.push(o);var a=o.size();1===a.length&&1===a[0]||(this._isScalar=!1)}else if("number"==typeof s)this._dimensions.push(n([s]));else{if("string"!=typeof s)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(s)}}}function n(e){for(var r=0,n=e.length;r<n;r++)if("number"!=typeof e[r]||!Ku(e[r]))throw new TypeError("Index parameters must be positive integer numbers");return new t(e)}return r.prototype.type="Index",r.prototype.isIndex=!0,r.prototype.clone=function(){var e=new r;return e._dimensions=Du(this._dimensions),e._isScalar=this._isScalar,e},r.create=function(e){var t=new r;return r.apply(t,e),t},r.prototype.size=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?1:n.size()[0]}return e},r.prototype.max=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?n:n.max()}return e},r.prototype.min=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?n:n.min()}return e},r.prototype.forEach=function(e){for(var t=0,r=this._dimensions.length;t<r;t++)e(this._dimensions[t],t,this)},r.prototype.dimension=function(e){return this._dimensions[e]||null},r.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e.push("string"==typeof n?n:n.toArray())}return e},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];"string"==typeof n?e.push(JSON.stringify(n)):e.push(n.toString())}return"["+e.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(e){return r.create(e.dimensions)},r}),{isClass:!0}),CS="invmod",kS=Mu(CS,["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],(e=>{var{typed:t,config:r,BigNumber:n,xgcd:i,equal:s,smaller:o,mod:a,add:l,isInteger:u}=e;return t(CS,{"number, number":c,"BigNumber, BigNumber":c});function c(e,t){if(!u(e)||!u(t))throw new Error("Parameters in function invmod must be integer numbers");if(e=a(e,t),s(t,0))throw new Error("Divisor must be non zero");var r=i(e,t);r=r.valueOf();var[c,d]=r;return s(c,n(1))?(d=a(d,t),o(d,n(0))&&(d=l(d,t)),d):NaN}})),MS="larger",OS=Mu(MS,["typed","config","matrix","DenseMatrix","concat"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=Xw({typed:t,DenseMatrix:i}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:n,concat:s}),c=sb({typed:t});return t(MS,_S({typed:t,config:r}),{"boolean, boolean":(e,t)=>e>t,"BigNumber, BigNumber":function(e,t){return e.gt(t)&&!ib(e,t,r.epsilon)},"Fraction, Fraction":(e,t)=>1===e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,u({SS:a,DS:o,Ss:l}))})),_S=Mu(MS,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(MS,{"number, number":function(e,t){return e>t&&!uc(e,t,r.epsilon)}})})),LS=Mu("log",["config","typed","divideScalar","Complex"],(e=>{var{typed:t,config:r,divideScalar:n,Complex:i}=e;return t("log",{number:function(e){return e>=0||r.predictable?function(e,t){return t?Math.log(e)/Math.log(t):Math.log(e)}(e):new i(e,0).log()},Complex:function(e){return e.log()},BigNumber:function(e){return!e.isNegative()||r.predictable?e.ln():new i(e.toNumber(),0).log()},"any, any":t.referToSelf((e=>(t,r)=>n(e(t),e(r))))})})),RS="matrixFromRows",IS=Mu(RS,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:r,flatten:n,size:i}=e;return t(RS,{"...Array":function(e){return s(e)},"...Matrix":function(e){return r(s(e.map((e=>e.toArray()))))}});function s(e){if(0===e.length)throw new TypeError("At least one row is needed to construct a matrix.");var t=o(e[0]),r=[];for(var i of e){var s=o(i);if(s!==t)throw new TypeError("The vectors had different length: "+(0|t)+" ≠ "+(0|s));r.push(n(i))}return r}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),FS="multiply",PS=Mu(FS,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(e=>{var{typed:t,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:s,dot:o}=e,a=Qw({typed:t,equalScalar:s}),l=rE({typed:t});function u(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}}function c(e,r){if("dense"!==r.storage())throw new Error("Support for SparseMatrix not implemented");return function(e,r){var s,o=e._data,a=e._size,l=e._datatype,u=r._data,c=r._size,d=r._datatype,h=a[0],f=c[1],p=n,m=i;l&&d&&l===d&&"string"==typeof l&&(s=l,p=t.find(n,[s,s]),m=t.find(i,[s,s]));for(var g=[],y=0;y<f;y++){for(var v=m(o[0],u[0][y]),b=1;b<h;b++)v=p(v,m(o[b],u[b][y]));g[y]=v}return e.createDenseMatrix({data:g,size:[f],datatype:s})}(e,r)}var d=t("_multiplyMatrixVector",{"DenseMatrix, any":function(e,r){var s,o=e._data,a=e._size,l=e._datatype,u=r._data,c=r._datatype,d=a[0],h=a[1],f=n,p=i;l&&c&&l===c&&"string"==typeof l&&(s=l,f=t.find(n,[s,s]),p=t.find(i,[s,s]));for(var m=[],g=0;g<d;g++){for(var y=o[g],v=p(y[0],u[0]),b=1;b<h;b++)v=f(v,p(y[b],u[b]));m[g]=v}return e.createDenseMatrix({data:m,size:[d],datatype:s})},"SparseMatrix, any":function(e,r){var o=e._values,a=e._index,l=e._ptr,u=e._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,d=r._data,h=r._datatype,f=e._size[0],p=r._size[0],m=[],g=[],y=[],v=n,b=i,x=s,w=0;u&&h&&u===h&&"string"==typeof u&&(c=u,v=t.find(n,[c,c]),b=t.find(i,[c,c]),x=t.find(s,[c,c]),w=t.convert(0,c));var E=[],S=[];y[0]=0;for(var T=0;T<p;T++){var A=d[T];if(!x(A,w))for(var D=l[T],N=l[T+1],C=D;C<N;C++){var k=a[C];S[k]?E[k]=v(E[k],b(A,o[C])):(S[k]=!0,g.push(k),E[k]=b(A,o[C]))}}for(var M=g.length,O=0;O<M;O++){var _=g[O];m[O]=E[_]}return y[1]=g.length,e.createSparseMatrix({values:m,index:g,ptr:y,size:[f,1],datatype:c})}}),h=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,r){var s,o=e._data,a=e._size,l=e._datatype,u=r._data,c=r._size,d=r._datatype,h=a[0],f=a[1],p=c[1],m=n,g=i;l&&d&&l===d&&"string"==typeof l&&(s=l,m=t.find(n,[s,s]),g=t.find(i,[s,s]));for(var y=[],v=0;v<h;v++){var b=o[v];y[v]=[];for(var x=0;x<p;x++){for(var w=g(b[0],u[0][x]),E=1;E<f;E++)w=m(w,g(b[E],u[E][x]));y[v][x]=w}}return e.createDenseMatrix({data:y,size:[h,p],datatype:s})},"DenseMatrix, SparseMatrix":function(e,r){var o=e._data,a=e._size,l=e._datatype,u=r._values,c=r._index,d=r._ptr,h=r._size,f=r._datatype;if(!u)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,m=a[0],g=h[1],y=n,v=i,b=s,x=0;l&&f&&l===f&&"string"==typeof l&&(p=l,y=t.find(n,[p,p]),v=t.find(i,[p,p]),b=t.find(s,[p,p]),x=t.convert(0,p));for(var w=[],E=[],S=[],T=r.createSparseMatrix({values:w,index:E,ptr:S,size:[m,g],datatype:p}),A=0;A<g;A++){S[A]=E.length;var D=d[A],N=d[A+1];if(N>D)for(var C=0,k=0;k<m;k++){for(var M=k+1,O=void 0,_=D;_<N;_++){var L=c[_];C!==M?(O=v(o[k][L],u[_]),C=M):O=y(O,v(o[k][L],u[_]))}C!==M||b(O,x)||(E.push(k),w.push(O))}}return S[g]=E.length,T},"SparseMatrix, DenseMatrix":function(e,r){var o=e._values,a=e._index,l=e._ptr,u=e._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,d=r._data,h=r._datatype,f=e._size[0],p=r._size[0],m=r._size[1],g=n,y=i,v=s,b=0;u&&h&&u===h&&"string"==typeof u&&(c=u,g=t.find(n,[c,c]),y=t.find(i,[c,c]),v=t.find(s,[c,c]),b=t.convert(0,c));for(var x=[],w=[],E=[],S=e.createSparseMatrix({values:x,index:w,ptr:E,size:[f,m],datatype:c}),T=[],A=[],D=0;D<m;D++){E[D]=w.length;for(var N=D+1,C=0;C<p;C++){var k=d[C][D];if(!v(k,b))for(var M=l[C],O=l[C+1],_=M;_<O;_++){var L=a[_];A[L]!==N?(A[L]=N,w.push(L),T[L]=y(k,o[_])):T[L]=g(T[L],y(k,o[_]))}}for(var R=E[D],I=w.length,F=R;F<I;F++){var P=w[F];x[F]=T[P]}}return E[m]=w.length,S},"SparseMatrix, SparseMatrix":function(e,r){var s,o=e._values,a=e._index,l=e._ptr,u=e._datatype,c=r._values,d=r._index,h=r._ptr,f=r._datatype,p=e._size[0],m=r._size[1],g=o&&c,y=n,v=i;u&&f&&u===f&&"string"==typeof u&&(s=u,y=t.find(n,[s,s]),v=t.find(i,[s,s]));for(var b,x,w,E,S,T,A,D,N=g?[]:void 0,C=[],k=[],M=e.createSparseMatrix({values:N,index:C,ptr:k,size:[p,m],datatype:s}),O=g?[]:void 0,_=[],L=0;L<m;L++){k[L]=C.length;var R=L+1;for(S=h[L],T=h[L+1],E=S;E<T;E++)if(D=d[E],g)for(x=l[D],w=l[D+1],b=x;b<w;b++)_[A=a[b]]!==R?(_[A]=R,C.push(A),O[A]=v(c[E],o[b])):O[A]=y(O[A],v(c[E],o[b]));else for(x=l[D],w=l[D+1],b=x;b<w;b++)_[A=a[b]]!==R&&(_[A]=R,C.push(A));if(g)for(var I=k[L],F=C.length,P=I;P<F;P++){var B=C[P];N[P]=O[B]}}return k[m]=C.length,M}});return t(FS,i,{"Array, Array":t.referTo("Matrix, Matrix",(e=>(t,n)=>{u(kc(t),kc(n));var i=e(r(t),r(n));return Vl(i)?i.valueOf():i})),"Matrix, Matrix":function(e,t){var r=e.size(),n=t.size();return u(r,n),1===r.length?1===n.length?function(e,t,r){if(0===r)throw new Error("Cannot multiply two empty vectors");return o(e,t)}(e,t,r[0]):c(e,t):1===n.length?d(e,t):h(e,t)},"Matrix, Array":t.referTo("Matrix,Matrix",(e=>(t,n)=>e(t,r(n)))),"Array, Matrix":t.referToSelf((e=>(t,n)=>e(r(t,n.storage()),n))),"SparseMatrix, any":function(e,t){return a(e,t,i,!1)},"DenseMatrix, any":function(e,t){return l(e,t,i,!1)},"any, SparseMatrix":function(e,t){return a(t,e,i,!0)},"any, DenseMatrix":function(e,t){return l(t,e,i,!0)},"Array, any":function(e,t){return l(r(e),t,i,!1).valueOf()},"any, Array":function(e,t){return l(r(t),e,i,!0).valueOf()},"any, any":i,"any, any, ...any":t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),s=0;s<n.length;s++)i=e(i,n[s]);return i}))})})),BS="nthRoots",US=Mu(BS,["config","typed","divideScalar","Complex"],(e=>{var{typed:t,config:r,divideScalar:n,Complex:i}=e,s=[function(e){return new i(e,0)},function(e){return new i(0,e)},function(e){return new i(-e,0)},function(e){return new i(0,-e)}];function o(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!=0)throw new Error("Root must be an integer");if(0===e||0===e.abs())return[new i(0,0)];var r,n="number"==typeof e;(n||0===e.re||0===e.im)&&(r=n?2*+(e<0):0===e.im?2*+(e.re<0):2*+(e.im<0)+1);for(var o=e.arg(),a=e.abs(),l=[],u=Math.pow(a,1/t),c=0;c<t;c++){var d=(r+4*c)/t;d!==Math.round(d)?l.push(new i({r:u,phi:(o+2*Math.PI*c)/t})):l.push(s[d%4](u))}return l}return t(BS,{Complex:function(e){return o(e,2)},"Complex, number":o})})),$S=Mu("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=FE({typed:t,equalScalar:n}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:r,concat:s});return t("or",{"number, number":ix,"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0)))},u({SS:a,DS:o,Ss:l}))})),jS="partitionSelect",zS=Mu(jS,["typed","isNumeric","isNaN","compare"],(e=>{var{typed:t,isNumeric:r,isNaN:n,compare:i}=e,s=i,o=(e,t)=>-i(e,t);return t(jS,{"Array | Matrix, number":function(e,t){return a(e,t,s)},"Array | Matrix, number, string":function(e,t,r){if("asc"===r)return a(e,t,s);if("desc"===r)return a(e,t,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":a});function a(e,t,r){if(!Ku(t)||t<0)throw new Error("k must be a non-negative integer");if(Vl(e)){if(e.size().length>1)throw new Error("Only one dimensional matrices supported");return l(e.valueOf(),t,r)}if(Array.isArray(e))return l(e,t,r)}function l(e,t,i){if(t>=e.length)throw new Error("k out of bounds");for(var s=0;s<e.length;s++)if(r(e[s])&&n(e[s]))return e[s];for(var o=0,a=e.length-1;o<a;){for(var l=o,u=a,c=e[Math.floor(Math.random()*(a-o+1))+o];l<u;)if(i(e[l],c)>=0){var d=e[u];e[u]=e[l],e[l]=d,--u}else++l;i(e[l],c)>0&&--l,t<=l?a=l:o=l+1}return e[t]}})),qS=Mu("quantileSeq",["typed","add","multiply","partitionSelect","compare"],(e=>{var{typed:t,add:r,multiply:n,partitionSelect:i,compare:s}=e;function o(e,t,o){var l=zc(e),u=l.length;if(0===u)throw new Error("Cannot calculate quantile of an empty sequence");if(Bl(t)){var c=t*(u-1),d=c%1;if(0===d){var h=o?l[c]:i(l,c);return a(h),h}var f,p,m=Math.floor(c);if(o)f=l[m],p=l[m+1];else{p=i(l,m+1),f=l[m];for(var g=0;g<m;++g)s(l[g],f)>0&&(f=l[g])}return a(f),a(p),r(n(f,1-d),n(p,d))}var y=t.times(u-1);if(y.isInteger()){y=y.toNumber();var v=o?l[y]:i(l,y);return a(v),v}var b,x,w=y.floor(),E=y.minus(w),S=w.toNumber();if(o)b=l[S],x=l[S+1];else{x=i(l,S+1),b=l[S];for(var T=0;T<S;++T)s(l[T],b)>0&&(b=l[T])}a(b),a(x);var A=new E.constructor(1);return r(n(b,A.minus(E)),n(x,E))}var a=t({"number | BigNumber | Unit":function(e){return e}});return function(e,t,r){var n,i,s;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(Gl(e)){if("boolean"==typeof(r=r||!1)){if(i=e.valueOf(),Bl(t)){if(t<0)throw new Error("N/prob must be non-negative");if(t<=1)return o(i,t,r);if(t>1){if(!Ku(t))throw new Error("N must be a positive integer");var a=t+1;n=new Array(t);for(var l=0;l<t;)n[l]=o(i,++l/a,r);return n}}if(Ul(t)){var u=t.constructor;if(t.isNegative())throw new Error("N/prob must be non-negative");if(s=new u(1),t.lte(s))return new u(o(i,t,r));if(t.gt(s)){if(!t.isInteger())throw new Error("N must be a positive integer");var c=t.toNumber();if(c>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var d=new u(c+1);n=new Array(c);for(var h=0;h<c;)n[h]=new u(o(i,new u(++h).div(d),r));return n}}if(Gl(t)){var f=t.valueOf();n=new Array(f.length);for(var p=0;p<n.length;++p){var m=f[p];if(Bl(m)){if(m<0||m>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!Ul(m))throw new TypeError("Unexpected type of argument in function quantileSeq");if(s=new m.constructor(1),m.isNegative()||m.gt(s))throw new Error("Probability must be between 0 and 1, inclusive")}n[p]=o(i,m,r)}return n}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}})),HS="rightLogShift",VS=Mu(HS,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:s,concat:o}=e,a=hE({typed:t}),l=Jw({typed:t,equalScalar:n}),u=ME({typed:t,equalScalar:n}),c=pE({typed:t,DenseMatrix:s}),d=Qw({typed:t,equalScalar:n}),h=rE({typed:t}),f=iE({typed:t,matrix:r,concat:o}),p=OE({typed:t,matrix:r});return t(HS,{"number, number":Iv,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():d(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):h(r,t,e,!0)))},p,f({SS:u,DS:a,SD:l}))})),GS="smallerEq",WS=Mu(GS,["typed","config","matrix","DenseMatrix","concat"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:s}=e,o=Zw({typed:t}),a=Xw({typed:t,DenseMatrix:i}),l=eE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:n,concat:s}),c=sb({typed:t});return t(GS,KS({typed:t,config:r}),{"boolean, boolean":(e,t)=>e<=t,"BigNumber, BigNumber":function(e,t){return e.lte(t)||ib(e,t,r.epsilon)},"Fraction, Fraction":(e,t)=>1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,u({SS:a,DS:o,Ss:l}))})),KS=Mu(GS,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(GS,{"number, number":function(e,t){return e<=t||uc(e,t,r.epsilon)}})})),YS="subtract",JS=Mu(YS,["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,addScalar:i,unaryMinus:s,DenseMatrix:o,concat:a}=e,l=hE({typed:t}),u=Zw({typed:t}),c=FE({typed:t,equalScalar:n}),d=pE({typed:t,DenseMatrix:o}),h=eE({typed:t,DenseMatrix:o}),f=iE({typed:t,matrix:r,concat:a});return t(YS,{"number, number":(e,t)=>e-t,"Complex, Complex":(e,t)=>e.sub(t),"BigNumber, BigNumber":(e,t)=>e.minus(t),"Fraction, Fraction":(e,t)=>e.sub(t),"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(null===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=t.find(e,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))},f({SS:c,DS:l,SD:u,Ss:h,sS:d}))})),ZS=Mu("trace",["typed","matrix","add"],(e=>{var{typed:t,matrix:r,add:n}=e;return t("trace",{Array:function(e){return i(r(e))},SparseMatrix:function(e){var t=e._values,r=e._index,i=e._ptr,s=e._size,o=s[0],a=s[1];if(o===a){var l=0;if(t.length>0)for(var u=0;u<a;u++)for(var c=i[u],d=i[u+1],h=c;h<d;h++){var f=r[h];if(f===u){l=n(l,t[h]);break}if(f>u)break}return l}throw new RangeError("Matrix must be square (size: "+xc(s)+")")},DenseMatrix:i,any:Du});function i(e){var t=e._size,r=e._data;switch(t.length){case 1:if(1===t[0])return Du(r[0]);throw new RangeError("Matrix must be square (size: "+xc(t)+")");case 2:var i=t[0];if(i===t[1]){for(var s=0,o=0;o<i;o++)s=n(s,r[o][o]);return s}throw new RangeError("Matrix must be square (size: "+xc(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+xc(t)+")")}}}));function XS(e){var{DenseMatrix:t}=e;return function(e,r,n){var i=e.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+xc(i)+")");var s=i[0];if(s!==i[1])throw new RangeError("Matrix must be square (size: "+xc(i)+")");var o=[];if(Vl(r)){var a=r.size(),l=r._data;if(1===a.length){if(a[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var u=0;u<s;u++)o[u]=[l[u]];return new t({data:o,size:[s,1],datatype:r._datatype})}if(2===a.length){if(a[0]!==s||1!==a[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(Wl(r)){if(n){o=[];for(var c=0;c<s;c++)o[c]=[l[c][0]];return new t({data:o,size:[s,1],datatype:r._datatype})}return r}if(Kl(r)){for(var d=0;d<s;d++)o[d]=[0];for(var h=r._values,f=r._index,p=r._ptr,m=p[1],g=p[0];g<m;g++){o[f[g]][0]=h[g]}return new t({data:o,size:[s,1],datatype:r._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Hl(r)){var y=kc(r);if(1===y.length){if(y[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var v=0;v<s;v++)o[v]=[r[v]];return new t({data:o,size:[s,1]})}if(2===y.length){if(y[0]!==s||1!==y[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var b=0;b<s;b++)o[b]=[r[b][0]];return new t({data:o,size:[s,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var QS="usolve",eT=Mu(QS,["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtract:s,equalScalar:o,DenseMatrix:a}=e,l=XS({DenseMatrix:a});return t(QS,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],d=e._values,h=e._index,f=e._ptr,p=[],m=c-1;m>=0;m--){var g=r[m][0]||0;if(o(g,0))p[m]=[0];else{for(var y=0,v=[],b=[],x=f[m],w=f[m+1]-1;w>=x;w--){var E=h[w];E===m?y=d[w]:E<m&&(v.push(d[w]),b.push(E))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var S=n(g,y),T=0,A=b.length;T<A;T++){var D=b[T];r[D]=[s(r[D][0],i(S,v[T]))]}p[m]=[S]}}return new a({data:p,size:[u,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).valueOf()}});function u(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],d=[],h=e._data,f=c-1;f>=0;f--){var p=r[f][0]||0,m=void 0;if(o(p,0))m=0;else{var g=h[f][f];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=n(p,g);for(var y=f-1;y>=0;y--)r[y]=[s(r[y][0]||0,i(m,h[y][f]))]}d[f]=[m]}return new a({data:d,size:[u,1]})}})),tT="zpk2tf",rT=Mu(tT,["typed","add","multiply","Complex","number"],(e=>{var{typed:t,add:r,multiply:n,Complex:i,number:s}=e;return t(tT,{"Array,Array,number":function(e,t,r){return o(e,t,r)},"Array,Array":function(e,t){return o(e,t,1)},"Matrix,Matrix,number":function(e,t,r){return o(e.valueOf(),t.valueOf(),r)},"Matrix,Matrix":function(e,t){return o(e.valueOf(),t.valueOf(),1)}});function o(e,t,r){e.some((e=>"BigNumber"===e.type))&&(e=e.map((e=>s(e)))),t.some((e=>"BigNumber"===e.type))&&(t=t.map((e=>s(e))));for(var o=[i(1,0)],l=[i(1,0)],u=0;u<e.length;u++){var c=e[u];"number"==typeof c&&(c=i(c,0)),o=a(o,[i(1,0),i(-c.re,-c.im)])}for(var d=0;d<t.length;d++){var h=t[d];"number"==typeof h&&(h=i(h,0)),l=a(l,[i(1,0),i(-h.re,-h.im)])}for(var f=0;f<o.length;f++)o[f]=n(o[f],r);return[o,l]}function a(e,t){for(var s=[],o=0;o<e.length+t.length-1;o++){s[o]=i(0,0);for(var a=0;a<e.length;a++)o-a>=0&&o-a<t.length&&(s[o]=r(s[o],n(e[a],t[o-a])))}return s}})),nT=Mu("and",["typed","matrix","equalScalar","zeros","not","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,not:s,concat:o}=e,a=Jw({typed:t,equalScalar:n}),l=BE({typed:t,equalScalar:n}),u=Qw({typed:t,equalScalar:n}),c=rE({typed:t}),d=iE({typed:t,matrix:r,concat:o});return t("and",{"number, number":ox,"Complex, Complex":function(e,t){return!(0===e.re&&0===e.im||0===t.re&&0===t.im)},"BigNumber, BigNumber":function(e,t){return!(e.isZero()||t.isZero()||e.isNaN()||t.isNaN())},"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0))),"SparseMatrix, any":t.referToSelf((e=>(t,r)=>s(r)?i(t.size(),t.storage()):u(t,r,e,!1))),"DenseMatrix, any":t.referToSelf((e=>(t,r)=>s(r)?i(t.size(),t.storage()):c(t,r,e,!1))),"any, SparseMatrix":t.referToSelf((e=>(t,r)=>s(t)?i(t.size(),t.storage()):u(r,t,e,!0))),"any, DenseMatrix":t.referToSelf((e=>(t,r)=>s(t)?i(t.size(),t.storage()):c(r,t,e,!0))),"Array, any":t.referToSelf((e=>(t,n)=>e(r(t),n).valueOf())),"any, Array":t.referToSelf((e=>(t,n)=>e(t,r(n)).valueOf()))},d({SS:l,DS:a}))})),iT="bitOr",sT=Mu(iT,["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:s}=e,o=hE({typed:t}),a=fE({typed:t,equalScalar:n}),l=pE({typed:t,DenseMatrix:i}),u=iE({typed:t,matrix:r,concat:s});return t(iT,{"number, number":Ov,"BigNumber, BigNumber":Ev},u({SS:a,DS:o,Ss:l}))})),oT="ceil",aT=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],lT=Mu(oT,["typed","config","round"],(e=>{var{typed:t,config:r,round:n}=e;return t(oT,{number:function(e){return uc(e,n(e),r.epsilon)?n(e):Math.ceil(e)},"number, number":function(e,t){if(uc(e,n(e,t),r.epsilon))return n(e,t);var[i,s]="".concat(e,"e").split("e"),o=Math.ceil(Number("".concat(i,"e").concat(Number(s)+t)));return[i,s]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(s)-t))}})})),uT=Mu(oT,aT,(e=>{var{typed:t,config:r,round:n,matrix:i,equalScalar:s,zeros:o,DenseMatrix:a}=e,l=Qw({typed:t,equalScalar:s}),u=eE({typed:t,DenseMatrix:a}),c=rE({typed:t}),d=lT({typed:t,config:r,round:n});return t("ceil",{number:d.signatures.number,"number,number":d.signatures["number,number"],Complex:function(e){return e.ceil()},"Complex, number":function(e,t){return e.ceil(t)},"Complex, BigNumber":function(e,t){return e.ceil(t.toNumber())},BigNumber:function(e){return ib(e,n(e),r.epsilon)?n(e):e.ceil()},"BigNumber, BigNumber":function(e,t){return ib(e,n(e,t),r.epsilon)?n(e,t):e.toDecimalPlaces(t.toNumber(),Nm.ROUND_CEIL)},Fraction:function(e){return e.ceil()},"Fraction, number":function(e,t){return e.ceil(t)},"Fraction, BigNumber":function(e,t){return e.ceil(t.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,r)=>Gd(t,(t=>e(t,r)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>l(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>c(t,r,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(i(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>s(t,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),cT=r(63228),dT="compareNatural",hT=Mu(dT,["typed","compare"],(e=>{var{typed:t,compare:r}=e,n=r.signatures["boolean,boolean"];return t(dT,{"any, any":function e(t,o){var a,l=Tu(t),u=Tu(o);if(!("number"!==l&&"BigNumber"!==l&&"Fraction"!==l||"number"!==u&&"BigNumber"!==u&&"Fraction"!==u))return"0"!==(a=r(t,o)).toString()?a>0?1:-1:cT(l,u);var c=["Array","DenseMatrix","SparseMatrix"];if(c.includes(l)||c.includes(u))return 0!==(a=i(e,t,o))?a:cT(l,u);if(l!==u)return cT(l,u);if("Complex"===l)return function(e,t){if(e.re>t.re)return 1;if(e.re<t.re)return-1;if(e.im>t.im)return 1;if(e.im<t.im)return-1;return 0}(t,o);if("Unit"===l)return t.equalBase(o)?e(t.value,o.value):s(e,t.formatUnits(),o.formatUnits());if("boolean"===l)return n(t,o);if("string"===l)return cT(t,o);if("Object"===l)return function(e,t,r){var n=Object.keys(t),i=Object.keys(r);n.sort(cT),i.sort(cT);var o=s(e,n,i);if(0!==o)return o;for(var a=0;a<n.length;a++){var l=e(t[n[a]],r[i[a]]);if(0!==l)return l}return 0}(e,t,o);if("null"===l)return 0;if("undefined"===l)return 0;throw new TypeError('Unsupported type of value "'+l+'"')}});function i(e,t,r){return Kl(t)&&Kl(r)?s(e,t.toJSON().values,r.toJSON().values):Kl(t)?i(e,t.toArray(),r):Kl(r)?i(e,t,r.toArray()):Wl(t)?i(e,t.toJSON().data,r):Wl(r)?i(e,t,r.toJSON().data):Array.isArray(t)?Array.isArray(r)?s(e,t,r):i(e,t,[r]):i(e,[t],r)}function s(e,t,r){for(var n=0,i=Math.min(t.length,r.length);n<i;n++){var s=e(t[n],r[n]);if(0!==s)return s}return t.length>r.length?1:t.length<r.length?-1:0}}));var fT="composition",pT=Mu(fT,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(e=>{var{typed:t,addScalar:r,combinations:n,isPositive:i,isNegative:s,isInteger:o,larger:a}=e;return t(fT,{"number | BigNumber, number | BigNumber":function(e,t){if(!(o(e)&&i(e)&&o(t)&&i(t)))throw new TypeError("Positive integer value expected in function composition");if(a(t,e))throw new TypeError("k must be less than or equal to n in function composition");return n(r(e,-1),r(t,-1))}})})),mT="cross",gT=Mu(mT,["typed","matrix","subtract","multiply"],(e=>{var{typed:t,matrix:r,subtract:n,multiply:i}=e;return t(mT,{"Matrix, Matrix":function(e,t){return r(s(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return r(s(e.toArray(),t))},"Array, Matrix":function(e,t){return r(s(e,t.toArray()))},"Array, Array":s});function s(e,t){var r=Math.max(kc(e).length,kc(t).length);e=Bc(e),t=Bc(t);var s=kc(e),o=kc(t);if(1!==s.length||1!==o.length||3!==s[0]||3!==o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+s.join(", ")+"], B = ["+o.join(", ")+"])");var a=[n(i(e[1],t[2]),i(e[2],t[1])),n(i(e[2],t[0]),i(e[0],t[2])),n(i(e[0],t[1]),i(e[1],t[0]))];return r>1?[a]:a}})),yT=Mu("det",["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],(e=>{var{typed:t,matrix:r,subtract:n,multiply:i,divideScalar:s,isZero:o,unaryMinus:a}=e;return t("det",{any:function(e){return Du(e)},"Array | Matrix":function(e){var t;switch((t=Vl(e)?e.size():Array.isArray(e)?(e=r(e)).size():[]).length){case 0:return Du(e);case 1:if(1===t[0])return Du(e.valueOf()[0]);if(0===t[0])return 1;throw new RangeError("Matrix must be square (size: "+xc(t)+")");case 2:var l=t[0],u=t[1];if(l===u)return function(e,t,r){if(1===t)return Du(e[0][0]);if(2===t)return n(i(e[0][0],e[1][1]),i(e[1][0],e[0][1]));for(var l=!1,u=new Array(t).fill(0).map(((e,t)=>t)),c=0;c<t;c++){var d=u[c];if(o(e[d][c])){var h=void 0;for(h=c+1;h<t;h++)if(!o(e[u[h]][c])){d=u[h],u[h]=u[c],u[c]=d,l=!l;break}if(h===t)return e[d][c]}for(var f=e[d][c],p=0===c?1:e[u[c-1]][c-1],m=c+1;m<t;m++)for(var g=u[m],y=c+1;y<t;y++)e[g][y]=s(n(i(e[g][y],f),i(e[g][c],e[d][y])),p)}var v=e[u[t-1]][t-1];return l?a(v):v}(e.clone().valueOf(),l);if(0===u)return 1;throw new RangeError("Matrix must be square (size: "+xc(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+xc(t)+")")}}})})),vT="distance",bT=Mu(vT,["typed","addScalar","subtract","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(e=>{var{typed:t,addScalar:r,subtract:n,multiplyScalar:i,divideScalar:s,deepEqual:o,sqrt:a,abs:l}=e;return t(vT,{"Array, Array, Array":function(e,t,r){if(2===e.length&&2===t.length&&2===r.length){if(!c(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(r))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(o(t,r))throw new TypeError("LinePoint1 should not be same with LinePoint2");var s=n(r[1],t[1]),a=n(t[0],r[0]),l=n(i(r[0],t[1]),i(t[0],r[1]));return m(e[0],e[1],s,a,l)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,r){if(2===Object.keys(e).length&&2===Object.keys(t).length&&2===Object.keys(r).length){if(!c(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(r))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(o(p(t),p(r)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in e&&"pointY"in e&&"lineOnePtX"in t&&"lineOnePtY"in t&&"lineTwoPtX"in r&&"lineTwoPtY"in r){var s=n(r.lineTwoPtY,t.lineOnePtY),a=n(t.lineOnePtX,r.lineTwoPtX),l=n(i(r.lineTwoPtX,t.lineOnePtY),i(t.lineOnePtX,r.lineTwoPtY));return m(e.pointX,e.pointY,s,a,l)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2===e.length&&3===t.length){if(!c(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!d(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return m(e[0],e[1],t[0],t[1],t[2])}if(3===e.length&&6===t.length){if(!d(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!f(t))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(e.length===t.length&&e.length>0){if(!h(e))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!h(t))throw new TypeError("All values of an array should be numbers or BigNumbers");return y(e,t)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2===Object.keys(e).length&&3===Object.keys(t).length){if(!c(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"xCoeffLine"in t&&"yCoeffLine"in t&&"constant"in t)return m(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&6===Object.keys(t).length){if(!d(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!f(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"x0"in t&&"y0"in t&&"z0"in t&&"a"in t&&"b"in t&&"c"in t)return g(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2===Object.keys(e).length&&2===Object.keys(t).length){if(!c(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointTwoX"in t&&"pointTwoY"in t)return y([e.pointOneX,e.pointOneY],[t.pointTwoX,t.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&3===Object.keys(t).length){if(!d(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointOneZ"in e&&"pointTwoX"in t&&"pointTwoY"in t&&"pointTwoZ"in t)return y([e.pointOneX,e.pointOneY,e.pointOneZ],[t.pointTwoX,t.pointTwoY,t.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!function(e){if(2===e[0].length&&u(e[0][0])&&u(e[0][1])){if(e.some((e=>2!==e.length||!u(e[0])||!u(e[1]))))return!1}else{if(!(3===e[0].length&&u(e[0][0])&&u(e[0][1])&&u(e[0][2])))return!1;if(e.some((e=>3!==e.length||!u(e[0])||!u(e[1])||!u(e[2]))))return!1}return!0}(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(e){for(var t=[],r=[],n=[],i=0;i<e.length-1;i++)for(var s=i+1;s<e.length;s++)2===e[0].length?(r=[e[i][0],e[i][1]],n=[e[s][0],e[s][1]]):3===e[0].length&&(r=[e[i][0],e[i][1],e[i][2]],n=[e[s][0],e[s][1],e[s][2]]),t.push(y(r,n));return t}(e)}});function u(e){return"number"==typeof e||Ul(e)}function c(e){return e.constructor!==Array&&(e=p(e)),u(e[0])&&u(e[1])}function d(e){return e.constructor!==Array&&(e=p(e)),u(e[0])&&u(e[1])&&u(e[2])}function h(e){return Array.isArray(e)||(e=p(e)),e.every(u)}function f(e){return e.constructor!==Array&&(e=p(e)),u(e[0])&&u(e[1])&&u(e[2])&&u(e[3])&&u(e[4])&&u(e[5])}function p(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++)r.push(e[t[n]]);return r}function m(e,t,n,o,u){var c=l(r(r(i(n,e),i(o,t)),u)),d=a(r(i(n,n),i(o,o)));return s(c,d)}function g(e,t,o,l,u,c,d,h,f){var p=[n(i(n(u,t),f),i(n(c,o),h)),n(i(n(c,o),d),i(n(l,e),f)),n(i(n(l,e),h),i(n(u,t),d))];p=a(r(r(i(p[0],p[0]),i(p[1],p[1])),i(p[2],p[2])));var m=a(r(r(i(d,d),i(h,h)),i(f,f)));return s(p,m)}function y(e,t){for(var s=e.length,o=0,l=0,u=0;u<s;u++)l=n(e[u],t[u]),o=r(i(l,l),o);return a(o)}})),xT=Mu("matAlgo09xS0Sf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var s=e._values,o=e._index,a=e._ptr,l=e._size,u=e._datatype,c=n._values,d=n._index,h=n._ptr,f=n._size,p=n._datatype;if(l.length!==f.length)throw new Nc(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],y=l[1],v=r,b=0,x=i;"string"==typeof u&&u===p&&(m=u,v=t.find(r,[m,m]),b=t.convert(0,m),x=t.find(i,[m,m]));var w,E,S,T,A,D=s&&c?[]:void 0,N=[],C=[],k=D?[]:void 0,M=[];for(E=0;E<y;E++){C[E]=N.length;var O=E+1;if(k)for(T=h[E],A=h[E+1],S=T;S<A;S++)M[w=d[S]]=O,k[w]=c[S];for(T=a[E],A=a[E+1],S=T;S<A;S++)if(w=o[S],k){var _=M[w]===O?k[w]:b,L=x(s[S],_);v(L,b)||(N.push(w),D.push(L))}else N.push(w)}return C[y]=N.length,e.createSparseMatrix({values:D,index:N,ptr:C,size:[g,y],datatype:m})}})),wT="dotMultiply",ET=Mu(wT,["typed","matrix","equalScalar","multiplyScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,multiplyScalar:i,concat:s}=e,o=Jw({typed:t,equalScalar:n}),a=xT({typed:t,equalScalar:n}),l=Qw({typed:t,equalScalar:n}),u=iE({typed:t,matrix:r,concat:s});return t(wT,u({elop:i,SS:a,DS:o,Ss:l}))})),ST=Mu("FibonacciHeap",["smaller","larger"],(e=>{var{smaller:t,larger:r}=e,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function s(e,t,r){t.left.right=t.right,t.right.left=t.left,r.degree--,r.child===t&&(r.child=t.right),0===r.degree&&(r.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function o(e,t){var r=t.parent;r&&(t.mark?(s(e,t,r),o(r)):t.mark=!0)}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(e,r){var n={key:e,value:r,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,t(e,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var i=this._minimum,s=e.degree,o=e.child;s>0;){var l=o.right;o.left.right=o.right,o.right.left=o.left,o.left=i,o.right=i.right,i.right=o,o.right.left=o,o.parent=null,o=l,s--}return e.left.right=e.right,e.right.left=e.left,i=e===e.right?null:function(e,i){var s,o=Math.floor(Math.log(i)*n)+1,l=new Array(o),u=0,c=e;if(c)for(u++,c=c.right;c!==e;)u++,c=c.right;for(;u>0;){for(var d=c.degree,h=c.right;s=l[d];){if(r(c.key,s.key)){var f=s;s=c,c=f}a(s,c),l[d]=null,d++}l[d]=c,c=h,u--}e=null;for(var p=0;p<o;p++)(s=l[p])&&(e?(s.left.right=s.right,s.right.left=s.left,s.left=e,s.right=e.right,e.right=s,s.right.left=s,t(s.key,e.key)&&(e=s)):e=s);return e}(i=e.right,this._size),this._size--,this._minimum=i,e},i.prototype.remove=function(e){this._minimum=function(e,r,n){r.key=n;var i=r.parent;i&&t(r.key,i.key)&&(s(e,r,i),o(e,i));t(r.key,e.key)&&(e=r);return e}(this._minimum,e,-1),this.extractMinimum()};var a=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return i}),{isClass:!0}),TT="fix",AT=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],DT=Mu(TT,["typed","ceil","floor"],(e=>{var{typed:t,ceil:r,floor:n}=e;return t(TT,{number:function(e){return e>0?n(e):r(e)},"number, number":function(e,t){return e>0?n(e,t):r(e,t)}})})),NT=Mu(TT,AT,(e=>{var{typed:t,Complex:r,matrix:n,ceil:i,floor:s,equalScalar:o,zeros:a,DenseMatrix:l}=e,u=eE({typed:t,DenseMatrix:l}),c=rE({typed:t}),d=DT({typed:t,ceil:i,floor:s});return t("fix",{number:d.signatures.number,"number, number | BigNumber":d.signatures["number,number"],Complex:function(e){return new r(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},"Complex, number":function(e,t){return new r(e.re>0?s(e.re,t):i(e.re,t),e.im>0?s(e.im,t):i(e.im,t))},"Complex, BigNumber":function(e,t){var n=t.toNumber();return new r(e.re>0?s(e.re,n):i(e.re,n),e.im>0?s(e.im,n):i(e.im,n))},BigNumber:function(e){return e.isNegative()?i(e):s(e)},"BigNumber, number | BigNumber":function(e,t){return e.isNegative()?i(e,t):s(e,t)},Fraction:function(e){return e.s<0?e.ceil():e.floor()},"Fraction, number | BigNumber":function(e,t){return e.s<0?i(e,t):s(e,t)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e,!0))),"Array | Matrix, number | BigNumber":t.referToSelf((e=>(t,r)=>Gd(t,(t=>e(t,r)),!0))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(n(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>o(t,0)?a(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),CT="index",kT=Mu(CT,["typed","Index"],(e=>{var{typed:t,Index:r}=e;return t(CT,{"...number | string | BigNumber | Range | Array | Matrix":function(e){var t=e.map((function(e){return Ul(e)?e.toNumber():Array.isArray(e)||Vl(e)?e.map((function(e){return Ul(e)?e.toNumber():e})):e})),n=new r;return r.apply(n,t),n}})})),MT=Mu("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],(e=>{var{typed:t,config:r,abs:n,add:i,addScalar:s,matrix:o,multiply:a,multiplyScalar:l,divideScalar:u,subtract:c,smaller:d,equalScalar:h,flatten:f,isZero:p,isNumeric:m}=e;return t("intersect",{"Array, Array, Array":g,"Array, Array, Array, Array":y,"Matrix, Matrix, Matrix":function(e,t,r){var n=g(e.valueOf(),t.valueOf(),r.valueOf());return null===n?null:o(n)},"Matrix, Matrix, Matrix, Matrix":function(e,t,r,n){var i=y(e.valueOf(),t.valueOf(),r.valueOf(),n.valueOf());return null===i?null:o(i)}});function g(e,t,r){if(e=v(e),t=v(t),r=v(r),!x(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(e){return 4===e.length&&m(e[0])&&m(e[1])&&m(e[2])&&m(e[3])}(r))throw new TypeError("Array with 4 numbers expected as third argument");return function(e,t,r,n,i,o,a,d,h,f){var p=l(e,a),m=l(n,a),g=l(t,d),y=l(i,d),v=l(r,h),b=l(o,h),x=c(c(c(f,p),g),v),w=c(c(c(s(s(m,y),b),p),g),v),E=u(x,w),S=s(e,l(E,c(n,e))),T=s(t,l(E,c(i,t))),A=s(r,l(E,c(o,r)));return[S,T,A]}(e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2],r[3])}function y(e,t,o,f){if(e=v(e),t=v(t),o=v(o),f=v(f),2===e.length){if(!b(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!b(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!b(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!b(f))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(e,t,o,h){var f=e,m=o,g=c(f,t),y=c(m,h),v=c(l(g[0],y[1]),l(y[0],g[1]));if(p(v))return null;if(d(n(v),r.epsilon))return null;var b=l(y[0],f[1]),x=l(y[1],f[0]),w=l(y[0],m[1]),E=l(y[1],m[0]),S=u(s(c(c(b,x),w),E),v);return i(a(g,S),f)}(e,t,o,f)}if(3===e.length){if(!x(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!x(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!x(f))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(e,t,r,n,i,o,a,d,f,m,g,y){var v=w(e,a,m,a,t,d,g,d,r,f,y,f),b=w(m,a,n,e,g,d,i,t,y,f,o,r),x=w(e,a,n,e,t,d,i,t,r,f,o,r),E=w(m,a,m,a,g,d,g,d,y,f,y,f),S=w(n,e,n,e,i,t,i,t,o,r,o,r),T=c(l(v,b),l(x,E)),A=c(l(S,E),l(b,b));if(p(A))return null;var D=u(T,A),N=u(s(v,l(D,b)),E),C=s(e,l(D,c(n,e))),k=s(t,l(D,c(i,t))),M=s(r,l(D,c(o,r))),O=s(a,l(N,c(m,a))),_=s(d,l(N,c(g,d))),L=s(f,l(N,c(y,f)));return h(C,O)&&h(k,_)&&h(M,L)?[C,k,M]:null}(e[0],e[1],e[2],t[0],t[1],t[2],o[0],o[1],o[2],f[0],f[1],f[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function v(e){return 1===e.length?e[0]:e.length>1&&Array.isArray(e[0])&&e.every((e=>Array.isArray(e)&&1===e.length))?f(e):e}function b(e){return 2===e.length&&m(e[0])&&m(e[1])}function x(e){return 3===e.length&&m(e[0])&&m(e[1])&&m(e[2])}function w(e,t,r,n,i,o,a,u,d,h,f,p){var m=l(c(e,t),c(r,n)),g=l(c(i,o),c(a,u)),y=l(c(d,h),c(f,p));return s(s(m,g),y)}})),OT=Mu("lcm",["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,concat:i}=e,s=Jw({typed:t,equalScalar:n}),o=BE({typed:t,equalScalar:n}),a=Qw({typed:t,equalScalar:n}),l=iE({typed:t,matrix:r,concat:i}),u="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(u,", ").concat(u,", ...").concat(u)]=t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),s=0;s<n.length;s++)i=e(i,n[s]);return i})),t("lcm",{"number, number":Cy,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero())return e;if(t.isZero())return t;var r=e.times(t);for(;!t.isZero();){var n=t;t=e.mod(n),e=n}return r.div(e).abs()},"Fraction, Fraction":(e,t)=>e.lcm(t)},l({SS:o,DS:s,Ss:a}),c)})),_T="log1p",LT=Mu(_T,["typed","config","divideScalar","log","Complex"],(e=>{var{typed:t,config:r,divideScalar:n,log:i,Complex:s}=e;return t(_T,{number:function(e){return e>=-1||r.predictable?Xu(e):o(new s(e,0))},Complex:o,BigNumber:function(e){var t=e.plus(1);return!t.isNegative()||r.predictable?t.ln():o(new s(e.toNumber(),0))},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e))),"any, any":t.referToSelf((e=>(t,r)=>n(e(t),i(r))))});function o(e){var t=e.re+1;return new s(Math.log(Math.sqrt(t*t+e.im*e.im)),Math.atan2(e.im,t))}})),RT="lsolve",IT=Mu(RT,["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtract:s,equalScalar:o,DenseMatrix:a}=e,l=XS({DenseMatrix:a});return t(RT,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],d=e._values,h=e._index,f=e._ptr,p=[],m=0;m<c;m++){var g=r[m][0]||0;if(o(g,0))p[m]=[0];else{for(var y=0,v=[],b=[],x=f[m],w=f[m+1],E=x;E<w;E++){var S=h[E];S===m?y=d[E]:S>m&&(v.push(d[E]),b.push(S))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var T=n(g,y),A=0,D=b.length;A<D;A++){var N=b[A];r[N]=[s(r[N][0]||0,i(T,v[A]))]}p[m]=[T]}}return new a({data:p,size:[u,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).valueOf()}});function u(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],d=[],h=e._data,f=0;f<c;f++){var p=r[f][0]||0,m=void 0;if(o(p,0))m=0;else{var g=h[f][f];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=n(p,g);for(var y=f+1;y<u;y++)r[y]=[s(r[y][0]||0,i(m,h[y][f]))]}d[f]=[m]}return new a({data:d,size:[u,1]})}})),FT=Mu("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtract","complex"],(e=>{var{typed:t,matrix:r,zeros:n,identity:i,isZero:s,equal:o,sign:a,sqrt:l,conj:u,unaryMinus:c,addScalar:d,divideScalar:h,multiplyScalar:f,subtract:p,complex:m}=e;return Ll(t("qr",{DenseMatrix:function(e){return y(e)},SparseMatrix:function(e){return function(e){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(e){var t=y(r(e));return{Q:t.Q.valueOf(),R:t.R.valueOf()}}}),{_denseQRimpl:g});function g(e){var t,r,m,g=e._size[0],y=e._size[1],v=i([g],"dense"),b=v._data,x=e.clone(),w=x._data,E=n([g],"");for(m=0;m<Math.min(y,g);++m){var S=w[m][m],T=c(o(S,0)?1:a(S)),A=u(T),D=0;for(t=m;t<g;t++)D=d(D,f(w[t][m],u(w[t][m])));var N=f(T,l(D));if(!s(N)){var C=p(S,N);for(E[m]=1,t=m+1;t<g;t++)E[t]=h(w[t][m],C);var k=c(u(h(C,N))),M=void 0;for(r=m;r<y;r++){for(M=0,t=m;t<g;t++)M=d(M,f(u(E[t]),w[t][r]));for(M=f(M,k),t=m;t<g;t++)w[t][r]=f(p(w[t][r],f(E[t],M)),A)}for(t=0;t<g;t++){for(M=0,r=m;r<g;r++)M=d(M,f(b[t][r],E[r]));for(M=f(M,k),r=m;r<g;++r)b[t][r]=h(p(b[t][r],f(M,u(E[r]))),A)}}}return{Q:v,R:x,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function y(e){var t=g(e),r=t.R._data;if(e._data.length>0)for(var n="Complex"===r[0][0].type?m(0):0,i=0;i<r.length;++i)for(var s=0;s<i&&s<(r[0]||[]).length;++s)r[i][s]=n;return t}})),PT="setCartesian",BT=Mu(PT,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s,DenseMatrix:o}=e;return t(PT,{"Array | Matrix, Array | Matrix":function(e,t){var a=[];if(0!==n(r(e),new s(0))&&0!==n(r(t),new s(0))){var l=zc(Array.isArray(e)?e:e.toArray()).sort(i),u=zc(Array.isArray(t)?t:t.toArray()).sort(i);a=[];for(var c=0;c<l.length;c++)for(var d=0;d<u.length;d++)a.push([l[c],u[d]])}return Array.isArray(e)&&Array.isArray(t)?a:new o(a)}})})),UT="setDistinct",$T=Mu(UT,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s,DenseMatrix:o}=e;return t(UT,{"Array | Matrix":function(e){var t;if(0===n(r(e),new s(0)))t=[];else{var a=zc(Array.isArray(e)?e:e.toArray()).sort(i);(t=[]).push(a[0]);for(var l=1;l<a.length;l++)0!==i(a[l],a[l-1])&&t.push(a[l])}return Array.isArray(e)?t:new o(t)}})})),jT="setIsSubset",zT=Mu(jT,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s}=e;return t(jT,{"Array | Matrix, Array | Matrix":function(e,t){if(0===n(r(e),new s(0)))return!0;if(0===n(r(t),new s(0)))return!1;for(var o,a=Kc(zc(Array.isArray(e)?e:e.toArray()).sort(i)),l=Kc(zc(Array.isArray(t)?t:t.toArray()).sort(i)),u=0;u<a.length;u++){o=!1;for(var c=0;c<l.length;c++)if(0===i(a[u].value,l[c].value)&&a[u].identifier===l[c].identifier){o=!0;break}if(!1===o)return!1}return!0}})})),qT="setPowerset",HT=Mu(qT,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s}=e;return t(qT,{"Array | Matrix":function(e){if(0===n(r(e),new s(0)))return[];for(var t=zc(Array.isArray(e)?e:e.toArray()).sort(i),a=[],l=0;l.toString(2).length<=t.length;)a.push(o(t,l.toString(2).split("").reverse())),l++;return function(e){for(var t=[],r=e.length-1;r>0;r--)for(var n=0;n<r;n++)e[n].length>e[n+1].length&&(t=e[n],e[n]=e[n+1],e[n+1]=t);return e}(a)}});function o(e,t){for(var r=[],n=0;n<t.length;n++)"1"===t[n]&&r.push(e[n]);return r}}));function VT(e,t,r,n,i,s,o){var a=0;for(r[o]=e;a>=0;){var l=r[o+a],u=r[n+l];-1===u?(a--,s[t++]=l):(r[n+l]=r[i+u],r[o+ ++a]=u)}return t}function GT(e){return-e-2}var WT=Mu("csAmd",["add","multiply","transpose"],(e=>{var{add:t,multiply:r,transpose:n}=e;return function(e,o){if(!o||e<=0||e>3)return null;var a=o._size,l=a[0],u=a[1],c=0,d=Math.max(16,10*Math.sqrt(u)),h=function(e,i,s,o,a){var l=n(i);if(1===e&&o===s)return t(i,l);if(2===e){for(var u=l._index,c=l._ptr,d=0,h=0;h<s;h++){var f=c[h];if(c[h]=d,!(c[h+1]-f>a))for(var p=c[h+1];f<p;f++)u[d++]=u[f]}return c[s]=d,i=n(l),r(l,i)}return r(l,i)}(e,o,l,u,d=Math.min(u-2,d));!function(e,t,r){for(var n=e._values,i=e._index,s=e._ptr,o=e._size[1],a=0,l=0;l<o;l++){var u=s[l];for(s[l]=a;u<s[l+1];u++)t(i[u],l,n?n[u]:1,r)&&(i[a]=i[u],n&&(n[a]=n[u]),a++)}s[o]=a,i.splice(a,i.length-a),n&&n.splice(a,n.length-a)}(h,s,null);for(var f,p,m,g,y,v,b,x,w,E,S,T,A,D,N,C,k=h._index,M=h._ptr,O=M[u],_=[],L=[],R=u+1,I=2*(u+1),F=3*(u+1),P=4*(u+1),B=5*(u+1),U=6*(u+1),$=7*(u+1),j=_,z=function(e,t,r,n,s,o,a,l,u,c,d,h){for(var f=0;f<e;f++)r[n+f]=t[f+1]-t[f];r[n+e]=0;for(var p=0;p<=e;p++)r[s+p]=-1,o[p]=-1,r[a+p]=-1,r[l+p]=-1,r[u+p]=1,r[c+p]=1,r[d+p]=0,r[h+p]=r[n+p];var m=i(0,0,r,c,e);return r[d+e]=-2,t[e]=-1,r[c+e]=0,m}(u,M,L,0,F,j,I,$,R,U,P,B),q=function(e,t,r,n,i,s,o,a,l,u,c){for(var d=0,h=0;h<e;h++){var f=r[n+h];if(0===f)r[i+h]=-2,d++,t[h]=-1,r[s+h]=0;else if(f>o)r[a+h]=0,r[i+h]=-1,d++,t[h]=GT(e),r[a+e]++;else{var p=r[l+f];-1!==p&&(u[p]=h),r[c+h]=r[l+f],r[l+f]=h}}return d}(u,M,L,B,P,U,d,R,F,j,I),H=0;q<u;){for(m=-1;H<u&&-1===(m=L[F+H]);H++);-1!==L[I+m]&&(j[L[I+m]]=-1),L[F+H]=L[I+m];var V=L[P+m],G=L[R+m];q+=G;var W=0;L[R+m]=-G;var K=M[m],Y=0===V?K:O,J=Y;for(g=1;g<=V+1;g++){for(g>V?(v=m,b=K,x=L[0+m]-V):(b=M[v=k[K++]],x=L[0+v]),y=1;y<=x;y++)(w=L[R+(f=k[b++])])<=0||(W+=w,L[R+f]=-w,k[J++]=f,-1!==L[I+f]&&(j[L[I+f]]=j[f]),-1!==j[f]?L[I+j[f]]=L[I+f]:L[F+L[B+f]]=L[I+f]);v!==m&&(M[v]=GT(m),L[U+v]=0)}for(0!==V&&(O=J),L[B+m]=W,M[m]=Y,L[0+m]=J-Y,L[P+m]=-2,z=i(z,c,L,U,u),E=Y;E<J;E++)if(!((S=L[P+(f=k[E])])<=0)){var Z=z-(w=-L[R+f]);for(K=M[f],T=M[f]+S-1;K<=T;K++)L[U+(v=k[K])]>=z?L[U+v]-=w:0!==L[U+v]&&(L[U+v]=L[B+v]+Z)}for(E=Y;E<J;E++){for(A=(T=M[f=k[E]])+L[P+f]-1,D=T,N=0,C=0,K=T;K<=A;K++)if(0!==L[U+(v=k[K])]){var X=L[U+v]-z;X>0?(C+=X,k[D++]=v,N+=v):(M[v]=GT(m),L[U+v]=0)}L[P+f]=D-T+1;var Q=D,ee=T+L[0+f];for(K=A+1;K<ee;K++){var te=L[R+(p=k[K])];te<=0||(C+=te,k[D++]=p,N+=p)}0===C?(M[f]=GT(m),W-=w=-L[R+f],G+=w,q+=w,L[R+f]=0,L[P+f]=-1):(L[B+f]=Math.min(L[B+f],C),k[D]=k[Q],k[Q]=k[T],k[T]=m,L[0+f]=D-T+1,N=(N<0?-N:N)%u,L[I+f]=L[$+N],L[$+N]=f,j[f]=N)}for(L[B+m]=W,z=i(z+(c=Math.max(c,W)),c,L,U,u),E=Y;E<J;E++)if(!(L[R+(f=k[E])]>=0))for(f=L[$+(N=j[f])],L[$+N]=-1;-1!==f&&-1!==L[I+f];f=L[I+f],z++){for(x=L[0+f],S=L[P+f],K=M[f]+1;K<=M[f]+x-1;K++)L[U+k[K]]=z;var re=f;for(p=L[I+f];-1!==p;){var ne=L[0+p]===x&&L[P+p]===S;for(K=M[p]+1;ne&&K<=M[p]+x-1;K++)L[U+k[K]]!==z&&(ne=0);ne?(M[p]=GT(f),L[R+f]+=L[R+p],L[R+p]=0,L[P+p]=-1,p=L[I+p],L[I+re]=p):(re=p,p=L[I+p])}}for(K=Y,E=Y;E<J;E++)(w=-L[R+(f=k[E])])<=0||(L[R+f]=w,C=L[B+f]+W-w,-1!==L[F+(C=Math.min(C,u-q-w))]&&(j[L[F+C]]=f),L[I+f]=L[F+C],j[f]=-1,L[F+C]=f,H=Math.min(H,C),L[B+f]=C,k[K++]=f);L[R+m]=G,0==(L[0+m]=K-Y)&&(M[m]=-1,L[U+m]=0),0!==V&&(O=K)}for(f=0;f<u;f++)M[f]=GT(M[f]);for(p=0;p<=u;p++)L[F+p]=-1;for(p=u;p>=0;p--)L[R+p]>0||(L[I+p]=L[F+M[p]],L[F+M[p]]=p);for(v=u;v>=0;v--)L[R+v]<=0||-1!==M[v]&&(L[I+v]=L[F+M[v]],L[F+M[v]]=v);for(m=0,f=0;f<=u;f++)-1===M[f]&&(m=VT(f,m,L,F,I,_,U));return _.splice(_.length-1,1),_};function i(e,t,r,n,i){if(e<2||e+t<0){for(var s=0;s<i;s++)0!==r[n+s]&&(r[n+s]=1);e=2}return e}function s(e,t){return e!==t}}));function KT(e,t,r,n,i,s,o){var a,l,u,c=0;if(e<=t||r[n+t]<=r[i+e])return-1;r[i+e]=r[n+t];var d=r[s+e];if(r[s+e]=t,-1===d)c=1,u=e;else{for(c=2,u=d;u!==r[o+u];u=r[o+u]);for(a=d;a!==u;a=l)l=r[o+a],r[o+a]=u}return{jleaf:c,q:u}}var YT=Mu("csCounts",["transpose"],(e=>{var{transpose:t}=e;return function(e,r,n,i){if(!e||!r||!n)return null;var s,o,a,l,u,c,d,h=e._size,f=h[0],p=h[1],m=4*p+(i?p+f+1:0),g=[],y=p,v=2*p,b=3*p,x=4*p,w=5*p+1;for(a=0;a<m;a++)g[a]=-1;var E=[],S=t(e),T=S._index,A=S._ptr;for(a=0;a<p;a++)for(E[o=n[a]]=-1===g[b+o]?1:0;-1!==o&&-1===g[b+o];o=r[o])g[b+o]=a;if(i){for(a=0;a<p;a++)g[n[a]]=a;for(s=0;s<f;s++){for(a=p,c=A[s],d=A[s+1],u=c;u<d;u++)a=Math.min(a,g[T[u]]);g[w+s]=g[x+a],g[x+a]=s}}for(s=0;s<p;s++)g[0+s]=s;for(a=0;a<p;a++){for(-1!==r[o=n[a]]&&E[r[o]]--,l=i?g[x+a]:o;-1!==l;l=i?g[w+l]:-1)for(u=A[l];u<A[l+1];u++){var D=KT(s=T[u],o,g,b,y,v,0);D.jleaf>=1&&E[o]++,2===D.jleaf&&E[D.q]--}-1!==r[o]&&(g[0+o]=r[o])}for(o=0;o<p;o++)-1!==r[o]&&(E[r[o]]+=E[o]);return E}})),JT=Mu("csSqr",["add","multiply","transpose"],(e=>{var{add:t,multiply:r,transpose:n}=e,i=WT({add:t,multiply:r,transpose:n}),s=YT({transpose:n});return function(e,t,r){var n,o=t._ptr,a=t._size[1],l={};if(l.q=i(e,t),e&&!l.q)return null;if(r){var u=e?function(e,t,r,n){for(var i=e._values,s=e._index,o=e._ptr,a=e._size,l=e._datatype,u=a[0],c=a[1],d=n&&e._values?[]:null,h=[],f=[],p=0,m=0;m<c;m++){f[m]=p;for(var g=r?r[m]:m,y=o[g],v=o[g+1],b=y;b<v;b++){var x=t?t[s[b]]:s[b];h[p]=x,d&&(d[p]=i[b]),p++}}return f[c]=p,e.createSparseMatrix({values:d,index:h,ptr:f,size:[u,c],datatype:l})}(t,null,l.q,0):t;l.parent=function(e,t){if(!e)return null;var r,n,i=e._index,s=e._ptr,o=e._size,a=o[0],l=o[1],u=[],c=[],d=l;if(t)for(r=0;r<a;r++)c[d+r]=-1;for(var h=0;h<l;h++){u[h]=-1,c[0+h]=-1;for(var f=s[h],p=s[h+1],m=f;m<p;m++){var g=i[m];for(r=t?c[d+g]:g;-1!==r&&r<h;r=n)n=c[0+r],c[0+r]=h,-1===n&&(u[r]=h);t&&(c[d+g]=h)}}return u}(u,1);var c=function(e,t){if(!e)return null;var r,n=0,i=[],s=[],o=t,a=2*t;for(r=0;r<t;r++)s[0+r]=-1;for(r=t-1;r>=0;r--)-1!==e[r]&&(s[o+r]=s[0+e[r]],s[0+e[r]]=r);for(r=0;r<t;r++)-1===e[r]&&(n=VT(r,n,s,0,o,i,a));return i}(l.parent,a);if(l.cp=s(u,l.parent,c,1),u&&l.parent&&l.cp&&function(e,t){var r=e._ptr,n=e._index,i=e._size,s=i[0],o=i[1];t.pinv=[],t.leftmost=[];var a,l,u,c,d,h=t.parent,f=t.pinv,p=t.leftmost,m=[],g=0,y=s,v=s+o,b=s+2*o;for(l=0;l<o;l++)m[y+l]=-1,m[v+l]=-1,m[b+l]=0;for(a=0;a<s;a++)p[a]=-1;for(l=o-1;l>=0;l--)for(c=r[l],d=r[l+1],u=c;u<d;u++)p[n[u]]=l;for(a=s-1;a>=0;a--)f[a]=-1,-1!==(l=p[a])&&(0==m[b+l]++&&(m[v+l]=a),m[g+a]=m[y+l],m[y+l]=a);for(t.lnz=0,t.m2=s,l=0;l<o;l++)if(a=m[y+l],t.lnz++,a<0&&(a=t.m2++),f[a]=l,!(--b[l]<=0)){t.lnz+=m[b+l];var x=h[l];-1!==x&&(0===m[b+x]&&(m[v+x]=m[v+l]),m[g+m[v+l]]=m[y+x],m[y+x]=m[g+a],m[b+x]+=m[b+l])}for(a=0;a<s;a++)f[a]<0&&(f[a]=l++);return!0}(u,l))for(l.unz=0,n=0;n<a;n++)l.unz+=l.cp[n]}else l.unz=4*o[a]+a,l.lnz=l.unz;return l}}));function ZT(e,t){return e[t]<0}function XT(e,t){e[t]=GT(e[t])}function QT(e){return e<0?GT(e):e}function eA(e,t,r,n,i){var s,o,a,l=t._index,u=t._ptr,c=t._size[1],d=0;for(n[0]=e;d>=0;){e=n[d];var h=i?i[e]:e;ZT(u,e)||(XT(u,e),n[c+d]=h<0?0:QT(u[h]));var f=1;for(o=n[c+d],a=h<0?0:QT(u[h+1]);o<a;o++)if(!ZT(u,s=l[o])){n[c+d]=o,n[++d]=s,f=0;break}f&&(d--,n[--r]=e)}return r}var tA=Mu("csSpsolve",["divideScalar","multiply","subtract"],(e=>{var{divideScalar:t,multiply:r,subtract:n}=e;return function(e,i,s,o,a,l,u){var c,d,h,f,p=e._values,m=e._index,g=e._ptr,y=e._size[1],v=i._values,b=i._index,x=i._ptr,w=function(e,t,r,n,i){var s,o,a,l=e._ptr,u=e._size,c=t._index,d=t._ptr,h=u[1],f=h;for(o=d[r],a=d[r+1],s=o;s<a;s++){var p=c[s];ZT(l,p)||(f=eA(p,e,f,n,i))}for(s=f;s<h;s++)XT(l,n[s]);return f}(e,i,s,o,l);for(c=w;c<y;c++)a[o[c]]=0;for(d=x[s],h=x[s+1],c=d;c<h;c++)a[b[c]]=v[c];for(var E=w;E<y;E++){var S=o[E],T=l?l[S]:S;if(!(T<0))for(d=g[T],h=g[T+1],a[S]=t(a[S],p[u?d:h-1]),c=u?d+1:d,f=u?h:h-1;c<f;c++){var A=m[c];a[A]=n(a[A],r(p[c],a[S]))}}return w}})),rA=Mu("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(e=>{var{abs:t,divideScalar:r,multiply:n,subtract:i,larger:s,largerEq:o,SparseMatrix:a}=e,l=tA({divideScalar:r,multiply:n,subtract:i});return function(e,i,u){if(!e)return null;var c,d=e._size[1],h=100,f=100;i&&(c=i.q,h=i.lnz||h,f=i.unz||f);var p,m,g=[],y=[],v=[],b=new a({values:g,index:y,ptr:v,size:[d,d]}),x=[],w=[],E=[],S=new a({values:x,index:w,ptr:E,size:[d,d]}),T=[],A=[],D=[];for(p=0;p<d;p++)A[p]=0,T[p]=-1,v[p+1]=0;h=0,f=0;for(var N=0;N<d;N++){v[N]=h,E[N]=f;var C=c?c[N]:N,k=l(b,e,C,D,A,T,1),M=-1,O=-1;for(m=k;m<d;m++)if(T[p=D[m]]<0){var _=t(A[p]);s(_,O)&&(O=_,M=p)}else w[f]=T[p],x[f++]=A[p];if(-1===M||O<=0)return null;T[C]<0&&o(t(A[C]),n(O,u))&&(M=C);var L=A[M];for(w[f]=N,x[f++]=L,T[M]=N,y[h]=M,g[h++]=1,m=k;m<d;m++)T[p=D[m]]<0&&(y[h]=p,g[h++]=r(A[p],L)),A[p]=0}for(v[d]=h,E[d]=f,m=0;m<h;m++)y[m]=T[y[m]];return g.splice(h,g.length-h),y.splice(h,y.length-h),x.splice(f,x.length-f),w.splice(f,w.length-f),{L:b,U:S,pinv:T}}})),nA=Mu("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(e=>{var{typed:t,abs:r,add:n,multiply:i,transpose:s,divideScalar:o,subtract:a,larger:l,largerEq:u,SparseMatrix:c}=e,d=JT({add:n,multiply:i,transpose:s}),h=rA({abs:r,divideScalar:o,multiply:i,subtract:a,larger:l,largerEq:u,SparseMatrix:c});return t("slu",{"SparseMatrix, number, number":function(e,t,r){if(!Ku(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(r<0||r>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var n=d(t,e,!1),i=h(e,n,r);return{L:i.L,U:i.U,p:i.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})})),iA="sort",sA=Mu(iA,["typed","matrix","compare","compareNatural"],(e=>{var{typed:t,matrix:r,compare:n,compareNatural:i}=e,s=n,o=(e,t)=>-n(e,t);return t(iA,{Array:function(e){return l(e),e.sort(s)},Matrix:function(e){return u(e),r(e.toArray().sort(s),e.storage())},"Array, function":function(e,t){return l(e),e.sort(t)},"Matrix, function":function(e,t){return u(e),r(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return l(e),e.sort(a(t))},"Matrix, string":function(e,t){return u(e),r(e.toArray().sort(a(t)),e.storage())}});function a(e){if("asc"===e)return s;if("desc"===e)return o;if("natural"===e)return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(e){if(1!==kc(e).length)throw new Error("One dimensional array expected")}function u(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}})),oA="usolveAll",aA=Mu(oA,["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtract:s,equalScalar:o,DenseMatrix:a}=e,l=XS({DenseMatrix:a});return t(oA,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._size[0],c=e._size[1],d=e._values,h=e._index,f=e._ptr,p=c-1;p>=0;p--)for(var m=r.length,g=0;g<m;g++){for(var y=r[g],v=[],b=[],x=f[p],w=0,E=f[p+1]-1;E>=x;E--){var S=h[E];S===p?w=d[E]:S<p&&(v.push(d[E]),b.push(S))}if(o(w,0))if(o(y[p],0)){if(0===g){var T=[...y];T[p]=1;for(var A=0,D=b.length;A<D;A++){var N=b[A];T[N]=s(T[N],v[A])}r.push(T)}}else{if(0===g)return[];r.splice(g,1),g-=1,m-=1}else{y[p]=n(y[p],w);for(var C=0,k=b.length;C<k;C++){var M=b[C];y[M]=s(y[M],i(y[p],v[C]))}}}return r.map((e=>new a({data:e.map((e=>[e])),size:[u,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).map((e=>e.valueOf()))}});function u(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._data,c=e._size[0],d=e._size[1]-1;d>=0;d--)for(var h=r.length,f=0;f<h;f++){var p=r[f];if(o(u[d][d],0))if(o(p[d],0)){if(0===f){var m=[...p];m[d]=1;for(var g=d-1;g>=0;g--)m[g]=s(m[g],u[g][d]);r.push(m)}}else{if(0===f)return[];r.splice(f,1),f-=1,h-=1}else{p[d]=n(p[d],u[d][d]);for(var y=d-1;y>=0;y--)p[y]=s(p[y],i(p[d],u[y][d]))}}return r.map((e=>new a({data:e.map((e=>[e])),size:[c,1]})))}})),lA="atan2",uA=Mu(lA,["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,BigNumber:i,DenseMatrix:s,concat:o}=e,a=Jw({typed:t,equalScalar:n}),l=Zw({typed:t}),u=xT({typed:t,equalScalar:n}),c=Qw({typed:t,equalScalar:n}),d=eE({typed:t,DenseMatrix:s}),h=iE({typed:t,matrix:r,concat:o});return t(lA,{"number, number":Math.atan2,"BigNumber, BigNumber":(e,t)=>i.atan2(e,t)},h({scalar:"number | BigNumber",SS:u,DS:l,SD:a,Ss:c,sS:d}))})),cA="lsolveAll",dA=Mu(cA,["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtract:s,equalScalar:o,DenseMatrix:a}=e,l=XS({DenseMatrix:a});return t(cA,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._size[0],c=e._size[1],d=e._values,h=e._index,f=e._ptr,p=0;p<c;p++)for(var m=r.length,g=0;g<m;g++){for(var y=r[g],v=[],b=[],x=f[p],w=f[p+1],E=0,S=x;S<w;S++){var T=h[S];T===p?E=d[S]:T>p&&(v.push(d[S]),b.push(T))}if(o(E,0))if(o(y[p],0)){if(0===g){var A=[...y];A[p]=1;for(var D=0,N=b.length;D<N;D++){var C=b[D];A[C]=s(A[C],v[D])}r.push(A)}}else{if(0===g)return[];r.splice(g,1),g-=1,m-=1}else{y[p]=n(y[p],E);for(var k=0,M=b.length;k<M;k++){var O=b[k];y[O]=s(y[O],i(y[p],v[k]))}}}return r.map((e=>new a({data:e.map((e=>[e])),size:[u,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).map((e=>e.valueOf()))}});function u(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._data,c=e._size[0],d=e._size[1],h=0;h<d;h++)for(var f=r.length,p=0;p<f;p++){var m=r[p];if(o(u[h][h],0))if(o(m[h],0)){if(0===p){var g=[...m];g[h]=1;for(var y=h+1;y<d;y++)g[y]=s(g[y],u[y][h]);r.push(g)}}else{if(0===p)return[];r.splice(p,1),p-=1,f-=1}else{m[h]=n(m[h],u[h][h]);for(var v=h+1;v<d;v++)m[v]=s(m[v],i(m[h],u[v][h]))}}return r.map((e=>new a({data:e.map((e=>[e])),size:[c,1]})))}})),hA="setDifference",fA=Mu(hA,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s,DenseMatrix:o}=e;return t(hA,{"Array | Matrix, Array | Matrix":function(e,t){var a;if(0===n(r(e),new s(0)))a=[];else{if(0===n(r(t),new s(0)))return zc(e.toArray());var l,u=Kc(zc(Array.isArray(e)?e:e.toArray()).sort(i)),c=Kc(zc(Array.isArray(t)?t:t.toArray()).sort(i));a=[];for(var d=0;d<u.length;d++){l=!1;for(var h=0;h<c.length;h++)if(0===i(u[d].value,c[h].value)&&u[d].identifier===c[h].identifier){l=!0;break}l||a.push(u[d])}}return Array.isArray(e)&&Array.isArray(t)?Yc(a):new o(Yc(a))}})})),pA="setMultiplicity",mA=Mu(pA,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s}=e;return t(pA,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(e,t){if(0===n(r(t),new s(0)))return 0;for(var o=zc(Array.isArray(t)?t:t.toArray()),a=0,l=0;l<o.length;l++)0===i(o[l],e)&&a++;return a}})})),gA="setSymDifference",yA=Mu(gA,["typed","size","concat","subset","setDifference","Index"],(e=>{var{typed:t,size:r,concat:n,subset:i,setDifference:s,Index:o}=e;return t(gA,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(r(e),new o(0)))return zc(t);if(0===i(r(t),new o(0)))return zc(e);var a=zc(e),l=zc(t);return n(s(a,l),s(l,a))}})})),vA=Mu("Spa",["addScalar","equalScalar","FibonacciHeap"],(e=>{var{addScalar:t,equalScalar:r,FibonacciHeap:n}=e;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var r=this._heap.insert(e,t);this._values[e]=r}},i.prototype.get=function(e){var t=this._values[e];return t?t.value:0},i.prototype.accumulate=function(e,r){var n=this._values[e];n?n.value=t(n.value,r):(n=this._heap.insert(e,r),this._values[e]=n)},i.prototype.forEach=function(e,t,n){var i=this._heap,s=this._values,o=[],a=i.extractMinimum();for(a&&o.push(a);a&&a.key<=t;)a.key>=e&&(r(a.value,0)||n(a.key,a.value,this)),(a=i.extractMinimum())&&o.push(a);for(var l=0;l<o.length;l++){var u=o[l];s[(a=i.insert(u.key,u.value)).key]=a}},i.prototype.swap=function(e,t){var r=this._values[e],n=this._values[t];if(!r&&n)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(r&&!n)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(r&&n){var i=r.value;r.value=n.value,n.value=i}},i}),{isClass:!0}),bA=Mu("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(e=>{var{typed:t,matrix:r,divideScalar:n,addScalar:i,multiply:s,unaryMinus:o,det:a,identity:l,abs:u}=e;return t("inv",{"Array | Matrix":function(e){var t=Vl(e)?e.size():kc(e);switch(t.length){case 1:if(1===t[0])return Vl(e)?r([n(1,e.valueOf()[0])]):[n(1,e[0])];throw new RangeError("Matrix must be square (size: "+xc(t)+")");case 2:var i=t[0],s=t[1];if(i===s)return Vl(e)?r(c(e.valueOf(),i,s),e.storage()):c(e,i,s);throw new RangeError("Matrix must be square (size: "+xc(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+xc(t)+")")}},any:function(e){return n(1,e)}});function c(e,t,r){var c,d,h,f,p;if(1===t){if(0===(f=e[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,f)]]}if(2===t){var m=a(e);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[n(e[1][1],m),n(o(e[0][1]),m)],[n(o(e[1][0]),m),n(e[0][0],m)]]}var g=e.concat();for(c=0;c<t;c++)g[c]=g[c].concat();for(var y=l(t).valueOf(),v=0;v<r;v++){var b=u(g[v][v]),x=v;for(c=v+1;c<t;)u(g[c][v])>b&&(b=u(g[c][v]),x=c),c++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");(c=x)!==v&&(p=g[v],g[v]=g[c],g[c]=p,p=y[v],y[v]=y[c],y[c]=p);var w=g[v],E=y[v];for(c=0;c<t;c++){var S=g[c],T=y[c];if(c!==v){if(0!==S[v]){for(h=n(o(S[v]),w[v]),d=v;d<r;d++)S[d]=i(S[d],s(h,w[d]));for(d=0;d<r;d++)T[d]=i(T[d],s(h,E[d]))}}else{for(h=w[v],d=v;d<r;d++)S[d]=n(S[d],h);for(d=0;d<r;d++)T[d]=n(T[d],h)}}}return y}})),xA=Mu("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(e=>{var{typed:t,matrix:r,abs:n,addScalar:i,divideScalar:s,multiplyScalar:o,subtract:a,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:d,SparseMatrix:h,Spa:f}=e;return t("lup",{DenseMatrix:function(e){return p(e)},SparseMatrix:function(e){return m(e)},Array:function(e){var t=p(r(e));return{L:t.L.valueOf(),U:t.U.valueOf(),p:t.p}}});function p(e){var t,r,c,h=e._size[0],f=e._size[1],p=Math.min(h,f),m=Du(e._data),g=[],y=[h,p],v=[],b=[p,f],x=[];for(t=0;t<h;t++)x[t]=t;for(r=0;r<f;r++){if(r>0)for(t=0;t<h;t++){var w=Math.min(t,r),E=0;for(c=0;c<w;c++)E=i(E,o(m[t][c],m[c][r]));m[t][r]=a(m[t][r],E)}var S=r,T=0,A=0;for(t=r;t<h;t++){var D=m[t][r],N=n(D);l(N,T)&&(S=t,T=N,A=D)}if(r!==S&&(x[r]=[x[S],x[S]=x[r]][0],d._swapRows(r,S,m)),r<h)for(t=r+1;t<h;t++){var C=m[t][r];u(C,0)||(m[t][r]=s(m[t][r],A))}}for(r=0;r<f;r++)for(t=0;t<h;t++)0===r&&(t<f&&(v[t]=[]),g[t]=[]),t<r?(t<f&&(v[t][r]=m[t][r]),r<h&&(g[t][r]=0)):t!==r?(t<f&&(v[t][r]=0),r<h&&(g[t][r]=m[t][r])):(t<f&&(v[t][r]=m[t][r]),r<h&&(g[t][r]=1));var k=new d({data:g,size:y}),M=new d({data:v,size:b}),O=[];for(t=0,p=x.length;t<p;t++)O[x[t]]=t;return{L:k,U:M,p:O,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function m(e){var t,r,i,a=e._size[0],d=e._size[1],p=Math.min(a,d),m=e._values,g=e._index,y=e._ptr,v=[],b=[],x=[],w=[a,p],E=[],S=[],T=[],A=[p,d],D=[],N=[];for(t=0;t<a;t++)D[t]=t,N[t]=t;var C=function(){var e=new f;r<a&&(x.push(v.length),v.push(1),b.push(r)),T.push(E.length);var d=y[r],p=y[r+1];for(i=d;i<p;i++)t=g[i],e.set(D[t],m[i]);r>0&&e.forEach(0,r-1,(function(t,r){h._forEachRow(t,v,b,x,(function(n,i){n>t&&e.accumulate(n,c(o(i,r)))}))}));var C=r,k=e.get(r),M=n(k);e.forEach(r+1,a-1,(function(e,t){var r=n(t);l(r,M)&&(C=e,M=r,k=t)})),r!==C&&(h._swapRows(r,C,w[1],v,b,x),h._swapRows(r,C,A[1],E,S,T),e.swap(r,C),function(e,t){var r=N[e],n=N[t];D[r]=t,D[n]=e,N[e]=n,N[t]=r}(r,C)),e.forEach(0,a-1,(function(e,t){e<=r?(E.push(t),S.push(e)):(t=s(t,k),u(t,0)||(v.push(t),b.push(e)))}))};for(r=0;r<d;r++)C();return T.push(E.length),x.push(v.length),{L:new h({values:v,index:b,ptr:x,size:w}),U:new h({values:E,index:S,ptr:T,size:A}),p:D,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),wA="pinv",EA=Mu(wA,["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],(e=>{var{typed:t,matrix:r,inv:n,deepEqual:i,equal:s,dotDivide:o,dot:a,ctranspose:l,divideScalar:u,multiply:c,add:d,Complex:h}=e;return t(wA,{"Array | Matrix":function(e){var t=Vl(e)?e.size():kc(e);switch(t.length){case 1:return m(e)?l(e):1===t[0]?n(e):o(l(e),a(e,e));case 2:if(m(e))return l(e);var i=t[0],s=t[1];if(i===s)try{return n(e)}catch(e){if(!(e instanceof Error&&e.message.match(/Cannot calculate inverse, determinant is zero/)))throw e}return Vl(e)?r(f(e.valueOf(),i,s),e.storage()):f(e,i,s);default:throw new RangeError("Matrix must be two dimensional (size: "+xc(t)+")")}},any:function(e){return s(e,0)?Du(e):u(1,e)}});function f(e,t,r){var{C:i,F:s}=function(e,t,r){var n=function(e,t,r){for(var n=Du(e),i=0,s=0;s<t;s++){if(r<=i)return n;for(var a=s;p(n[a][i]);)if(t===++a&&(a=s,r===++i))return n;[n[a],n[s]]=[n[s],n[a]];for(var l=n[s][i],u=0;u<r;u++)n[s][u]=o(n[s][u],l);for(var h=0;h<t;h++)if(h!==s){l=n[h][i];for(var f=0;f<r;f++)n[h][f]=d(n[h][f],c(-1,c(l,n[s][f])))}i++}return n}(e,t,r),i=e.map(((e,r)=>e.filter(((e,r)=>r<t&&!p(a(n[r],n[r])))))),s=n.filter(((e,t)=>!p(a(n[t],n[t]))));return{C:i,F:s}}(e,t,r),u=c(n(c(l(i),i)),l(i)),h=c(l(s),n(c(s,l(s))));return c(h,u)}function p(e){return s(d(e,h(1,1)),d(0,h(1,1)))}function m(e){return i(d(e,h(1,1)),d(c(e,0),h(1,1)))}})),SA=Mu("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(e=>{var{typed:t,config:r,identity:n,multiply:i,matrix:s,inv:o,number:a,fraction:l,Complex:u}=e;return t("pow",{"number, number":c,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(e,t){return t.isInteger()||e>=0||r.predictable?e.pow(t):new u(e.toNumber(),0).pow(t.toNumber(),0)},"Fraction, Fraction":function(e,t){var n=e.pow(t);if(null!=n)return n;if(r.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(e.valueOf(),t.valueOf())},"Array, number":d,"Array, BigNumber":function(e,t){return d(e,t.toNumber())},"Matrix, number":h,"Matrix, BigNumber":function(e,t){return h(e,t.toNumber())},"Unit, number | BigNumber":function(e,t){return e.pow(t)}});function c(e,t){if(r.predictable&&!Ku(t)&&e<0)try{var n=l(t),i=a(n);if((t===i||Math.abs((t-i)/t)<1e-14)&&n.d%2==1)return(n.n%2==0?1:-1)*Math.pow(-e,t)}catch(e){}return r.predictable&&(e<-1&&t===1/0||e>-1&&e<0&&t===-1/0)?NaN:Ku(t)||e>=0||r.predictable?Fy(e,t):e*e<1&&t===1/0||e*e>1&&t===-1/0?0:new u(e,0).pow(t,0)}function d(e,t){if(!Ku(t))throw new TypeError("For A^b, b must be an integer (value is "+t+")");var r=kc(e);if(2!==r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(t<0)try{return d(o(e),-t)}catch(e){if("Cannot calculate inverse, determinant is zero"===e.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+t+")");throw e}for(var s=n(r[0]).valueOf(),a=e;t>=1;)1==(1&t)&&(s=i(a,s)),t>>=1,a=i(a,a);return s}function h(e,t){return s(d(e.valueOf(),t))}})),TA="setIntersect",AA=Mu(TA,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:s,DenseMatrix:o}=e;return t(TA,{"Array | Matrix, Array | Matrix":function(e,t){var a;if(0===n(r(e),new s(0))||0===n(r(t),new s(0)))a=[];else{var l=Kc(zc(Array.isArray(e)?e:e.toArray()).sort(i)),u=Kc(zc(Array.isArray(t)?t:t.toArray()).sort(i));a=[];for(var c=0;c<l.length;c++)for(var d=0;d<u.length;d++)if(0===i(l[c].value,u[d].value)&&l[c].identifier===u[d].identifier){a.push(l[c]);break}}return Array.isArray(e)&&Array.isArray(t)?Yc(a):new o(Yc(a))}})})),DA="setUnion",NA=Mu(DA,["typed","size","concat","subset","setIntersect","setSymDifference","Index"],(e=>{var{typed:t,size:r,concat:n,subset:i,setIntersect:s,setSymDifference:o,Index:a}=e;return t(DA,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(r(e),new a(0)))return zc(t);if(0===i(r(t),new a(0)))return zc(e);var l=zc(e),u=zc(t);return n(o(l,u),s(l,u))}})})),CA="sqrtm",kA=Mu(CA,["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],(e=>{var{typed:t,abs:r,add:n,multiply:i,map:s,sqrt:o,subtract:a,inv:l,size:u,max:c,identity:d}=e,h=1e-6;function f(e){var t,s=0,o=e,f=d(u(e));do{var p=o;if(o=i(.5,n(p,l(f))),f=i(.5,n(f,l(p))),(t=c(r(a(o,p))))>h&&++s>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(t>h);return o}return t(CA,{"Array | Matrix":function(e){var t=Vl(e)?e.size():kc(e);switch(t.length){case 1:if(1===t[0])return s(e,o);throw new RangeError("Matrix must be square (size: "+xc(t)+")");case 2:if(t[0]===t[1])return f(e);throw new RangeError("Matrix must be square (size: "+xc(t)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+xc(t)+")")}}})}));function MA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function OA(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?MA(Object(r),!0).forEach((function(t){Wu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MA(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _A=Mu("Unit",["?on","config","addScalar","subtract","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(e=>{var t,r,n,{on:i,config:s,addScalar:o,subtract:a,multiplyScalar:l,divideScalar:u,pow:c,abs:d,fix:h,round:f,equal:p,isNumeric:m,format:g,number:y,Complex:v,BigNumber:b,Fraction:x}=e,w=y;function E(e,t){if(!(this instanceof E))throw new Error("Constructor must be called with the new operator");if(null!=e&&!m(e)&&!$l(e))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===t)this.units=[],this.dimensions=L.map((e=>0));else if("string"==typeof t){var r=E.parse(t);this.units=r.units,this.dimensions=r.dimensions}else{if(!zl(t)||null!==t.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=t.fixPrefix,this.skipAutomaticSimplification=t.skipAutomaticSimplification,this.dimensions=t.dimensions.slice(0),this.units=t.units.map((e=>Ll({},e)))}this.value=this._normalize(e)}function S(){for(;" "===n||"\t"===n;)A()}function T(e){return e>="0"&&e<="9"}function A(){r++,n=t.charAt(r)}function D(e){r=e,n=t.charAt(r)}function N(){var e="",t=r;if("+"===n?A():"-"===n&&(e+=n,A()),!function(e){return e>="0"&&e<="9"||"."===e}(n))return D(t),null;if("."===n){if(e+=n,A(),!T(n))return D(t),null}else{for(;T(n);)e+=n,A();"."===n&&(e+=n,A())}for(;T(n);)e+=n,A();if("E"===n||"e"===n){var i="",s=r;if(i+=n,A(),"+"!==n&&"-"!==n||(i+=n,A()),!T(n))return D(s),e;for(e+=i;T(n);)e+=n,A()}return e}function C(){for(var e="";T(n)||E.isValidAlpha(n);)e+=n,A();var t=e.charAt(0);return E.isValidAlpha(t)?e:null}function k(e){return n===e?(A(),e):null}Object.defineProperty(E,"name",{value:"Unit"}),E.prototype.constructor=E,E.prototype.type="Unit",E.prototype.isUnit=!0,E.parse=function(e,i){if(i=i||{},r=-1,n="","string"!=typeof(t=e))throw new TypeError("Invalid argument in Unit.parse, string expected");var o=new E;o.units=[];var a=1,l=!1;A(),S();var u=N(),c=null;if(u){if("BigNumber"===s.number)c=new b(u);else if("Fraction"===s.number)try{c=new x(u)}catch(e){c=parseFloat(u)}else c=parseFloat(u);S(),k("*")?(a=1,l=!0):k("/")&&(a=-1,l=!0)}for(var d=[],h=1;;){for(S();"("===n;)d.push(a),h*=a,a=1,A(),S();var f=void 0;if(!n)break;var p=n;if(null===(f=C()))throw new SyntaxError('Unexpected "'+p+'" in "'+t+'" at index '+r.toString());var m=M(f);if(null===m)throw new SyntaxError('Unit "'+f+'" not found.');var g=a*h;if(S(),k("^")){S();var y=N();if(null===y)throw new SyntaxError('In "'+e+'", "^" must be followed by a floating-point number');g*=y}o.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var v=0;v<L.length;v++)o.dimensions[v]+=(m.unit.dimensions[v]||0)*g;for(S();")"===n;){if(0===d.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+r.toString());h/=d.pop(),A(),S()}if(l=!1,k("*")?(a=1,l=!0):k("/")?(a=-1,l=!0):a=1,m.unit.base){var w=m.unit.base.key;$.auto[w]={unit:m.unit,prefix:m.prefix}}}if(S(),n)throw new SyntaxError('Could not parse: "'+e+'"');if(l)throw new SyntaxError('Trailing characters: "'+e+'"');if(0!==d.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===o.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+e+'" contains no units');return o.value=void 0!==c?o._normalize(c):null,o},E.prototype.clone=function(){var e=new E;e.fixPrefix=this.fixPrefix,e.skipAutomaticSimplification=this.skipAutomaticSimplification,e.value=Du(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++)for(var r in e.units[t]={},this.units[t])ku(this.units[t],r)&&(e.units[t][r]=this.units[t][r]);return e},E.prototype.valueType=function(){return Tu(this.value)},E.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},E.prototype._normalize=function(e){if(null==e||0===this.units.length)return e;for(var t=e,r=E._getNumberConverter(Tu(e)),n=0;n<this.units.length;n++){var i=r(this.units[n].unit.value),s=r(this.units[n].prefix.value),o=r(this.units[n].power);t=l(t,c(l(i,s),o))}return t},E.prototype._denormalize=function(e,t){if(null==e||0===this.units.length)return e;for(var r=e,n=E._getNumberConverter(Tu(e)),i=0;i<this.units.length;i++){var s=n(this.units[i].unit.value),o=n(this.units[i].prefix.value),a=n(this.units[i].power);r=u(r,c(l(s,o),a))}return r};var M=_m((e=>{if(ku(P,e)){var t=P[e];return{unit:t,prefix:t.prefixes[""]}}for(var r in P)if(ku(P,r)&&bc(e,r)){var n=P[r],i=e.length-r.length,s=e.substring(0,i),o=ku(n.prefixes,s)?n.prefixes[s]:void 0;if(void 0!==o)return{unit:n,prefix:o}}return null}),{hasher:e=>e[0],limit:100});function O(e){return e.equalBase(R.NONE)&&null!==e.value&&!s.predictable?e.value:e}E.isValuelessUnit=function(e){return null!==M(e)},E.prototype.hasBase=function(e){if("string"==typeof e&&(e=R[e]),!e)return!1;for(var t=0;t<L.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},E.prototype.equalBase=function(e){for(var t=0;t<L.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},E.prototype.equals=function(e){return this.equalBase(e)&&p(this.value,e.value)},E.prototype.multiply=function(e){for(var t=this.clone(),r=zl(e)?e:new E(e),n=0;n<L.length;n++)t.dimensions[n]=(this.dimensions[n]||0)+(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var s=OA({},r.units[i]);t.units.push(s)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(1):this.value,a=null===r.value?r._normalize(1):r.value;t.value=l(o,a)}else t.value=null;return zl(e)&&(t.skipAutomaticSimplification=!1),O(t)},E.prototype.divideInto=function(e){return new E(e).divide(this)},E.prototype.divide=function(e){for(var t=this.clone(),r=zl(e)?e:new E(e),n=0;n<L.length;n++)t.dimensions[n]=(this.dimensions[n]||0)-(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var s=OA(OA({},r.units[i]),{},{power:-r.units[i].power});t.units.push(s)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(1):this.value,a=null===r.value?r._normalize(1):r.value;t.value=u(o,a)}else t.value=null;return zl(e)&&(t.skipAutomaticSimplification=!1),O(t)},E.prototype.pow=function(e){for(var t=this.clone(),r=0;r<L.length;r++)t.dimensions[r]=(this.dimensions[r]||0)*e;for(var n=0;n<t.units.length;n++)t.units[n].power*=e;return null!==t.value?t.value=c(t.value,e):t.value=null,t.skipAutomaticSimplification=!1,O(t)},E.prototype.abs=function(){var e=this.clone();if(null!==e.value)if(e._isDerived()||0===e.units[0].unit.offset)e.value=d(e.value);else{var t=e._numberConverter(),r=t(e.units[0].unit.value),n=t(e.units[0].unit.offset),i=l(r,n);e.value=a(d(o(e.value,i)),i)}for(var s in e.units)"VA"!==e.units[s].unit.name&&"VAR"!==e.units[s].unit.name||(e.units[s].unit=P.W);return e},E.prototype.to=function(e){var t,r=null===this.value?this._normalize(1):this.value;if("string"==typeof e)t=E.parse(e);else{if(!zl(e))throw new Error("String or Unit expected as parameter");t=e.clone()}if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||this.units[0].unit.offset===t.units[0].unit.offset)t.value=Du(r);else{var n=E._getNumberConverter(Tu(r)),i=this.units[0].unit.value,s=this.units[0].unit.offset,u=l(i,s),c=t.units[0].unit.value,d=t.units[0].unit.offset,h=l(c,d);t.value=o(r,n(a(u,h)))}return t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},E.prototype.toNumber=function(e){return w(this.toNumeric(e))},E.prototype.toNumeric=function(e){var t;return(t=e?this.to(e):this.clone())._isDerived()||0===t.units.length?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},E.prototype.toString=function(){return this.format()},E.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},E.fromJSON=function(e){var t=new E(e.value,e.unit);return t.fixPrefix=e.fixPrefix||!1,t},E.prototype.valueOf=E.prototype.toString,E.prototype.simplify=function(){var e,t,r=this.clone(),n=[];for(var i in j)if(ku(j,i)&&r.hasBase(R[i])){e=i;break}if("NONE"===e)r.units=[];else if(e&&ku(j,e)&&(t=j[e]),t)r.units=[{unit:t.unit,prefix:t.prefix,power:1}];else{for(var s=!1,o=0;o<L.length;o++){var a=L[o];Math.abs(r.dimensions[o]||0)>1e-12&&(ku(j,a)?n.push({unit:j[a].unit,prefix:j[a].prefix,power:r.dimensions[o]||0}):s=!0)}n.length<r.units.length&&!s&&(r.units=n)}return r},E.prototype.toSI=function(){for(var e=this.clone(),t=[],r=0;r<L.length;r++){var n=L[r];if(Math.abs(e.dimensions[r]||0)>1e-12){if(!ku($.si,n))throw new Error("Cannot express custom unit "+n+" in SI units");t.push({unit:$.si[n].unit,prefix:$.si[n].prefix,power:e.dimensions[r]||0})}}return e.units=t,e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e},E.prototype.formatUnits=function(){for(var e="",t="",r=0,n=0,i=0;i<this.units.length;i++)this.units[i].power>0?(r++,e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(e+="^"+this.units[i].power)):this.units[i].power<0&&n++;if(n>0)for(var s=0;s<this.units.length;s++)this.units[s].power<0&&(r>0?(t+=" "+this.units[s].prefix.name+this.units[s].unit.name,Math.abs(this.units[s].power+1)>1e-15&&(t+="^"+-this.units[s].power)):(t+=" "+this.units[s].prefix.name+this.units[s].unit.name,t+="^"+this.units[s].power));e=e.substr(1),t=t.substr(1),r>1&&n>0&&(e="("+e+")"),n>1&&r>0&&(t="("+t+")");var o=e;return r>0&&n>0&&(o+=" / "),o+=t},E.prototype.format=function(e){var t=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),r=!1;for(var n in void 0!==t.value&&null!==t.value&&$l(t.value)&&(r=Math.abs(t.value.re)<1e-14),t.units)ku(t.units,n)&&t.units[n].unit&&("VA"===t.units[n].unit.name&&r?t.units[n].unit=P.VAR:"VAR"!==t.units[n].unit.name||r||(t.units[n].unit=P.VA));1!==t.units.length||t.fixPrefix||Math.abs(t.units[0].power-Math.round(t.units[0].power))<1e-14&&(t.units[0].prefix=t._bestPrefix());var i=t._denormalize(t.value),s=null!==t.value?g(i,e||{}):"",o=t.formatUnits();return t.value&&$l(t.value)&&(s="("+s+")"),o.length>0&&s.length>0&&(s+=" "),s+=o},E.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var e=null!==this.value?d(this.value):0,t=d(this.units[0].unit.value),r=this.units[0].prefix;if(0===e)return r;var n=this.units[0].power,i=Math.log(e/Math.pow(r.value*t,n))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return r;i=Math.abs(i);var s=this.units[0].unit.prefixes;for(var o in s)if(ku(s,o)){var a=s[o];if(a.scientific){var l=Math.abs(Math.log(e/Math.pow(a.value*t,n))/Math.LN10-1.2);(l<i||l===i&&a.name.length<r.name.length)&&(r=a,i=l)}}return r},E.prototype.splitUnit=function(e){for(var t=this.clone(),r=[],n=0;n<e.length&&(t=t.to(e[n]),n!==e.length-1);n++){var i=t.toNumeric(),s=f(i),l=new E(p(s,i)?s:h(t.toNumeric()),e[n].toString());r.push(l),t=a(t,l)}for(var u=0,c=0;c<r.length;c++)u=o(u,r[c].value);return p(u,this.value)&&(t.value=0),r.push(t),r};var _={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};_.SHORTLONG=Ll({},_.SHORT,_.LONG),_.BINARY_SHORT=Ll({},_.BINARY_SHORT_SI,_.BINARY_SHORT_IEC),_.BINARY_LONG=Ll({},_.BINARY_LONG_SI,_.BINARY_LONG_IEC);var L=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],R={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var I in R)ku(R,I)&&(R[I].key=I);var F={name:"",base:{},value:1,offset:0,dimensions:L.map((e=>0))},P={meter:{name:"meter",base:R.LENGTH,prefixes:_.LONG,value:1,offset:0},inch:{name:"inch",base:R.LENGTH,prefixes:_.NONE,value:.0254,offset:0},foot:{name:"foot",base:R.LENGTH,prefixes:_.NONE,value:.3048,offset:0},yard:{name:"yard",base:R.LENGTH,prefixes:_.NONE,value:.9144,offset:0},mile:{name:"mile",base:R.LENGTH,prefixes:_.NONE,value:1609.344,offset:0},link:{name:"link",base:R.LENGTH,prefixes:_.NONE,value:.201168,offset:0},rod:{name:"rod",base:R.LENGTH,prefixes:_.NONE,value:5.0292,offset:0},chain:{name:"chain",base:R.LENGTH,prefixes:_.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:R.LENGTH,prefixes:_.NONE,value:1e-10,offset:0},m:{name:"m",base:R.LENGTH,prefixes:_.SHORT,value:1,offset:0},in:{name:"in",base:R.LENGTH,prefixes:_.NONE,value:.0254,offset:0},ft:{name:"ft",base:R.LENGTH,prefixes:_.NONE,value:.3048,offset:0},yd:{name:"yd",base:R.LENGTH,prefixes:_.NONE,value:.9144,offset:0},mi:{name:"mi",base:R.LENGTH,prefixes:_.NONE,value:1609.344,offset:0},li:{name:"li",base:R.LENGTH,prefixes:_.NONE,value:.201168,offset:0},rd:{name:"rd",base:R.LENGTH,prefixes:_.NONE,value:5.02921,offset:0},ch:{name:"ch",base:R.LENGTH,prefixes:_.NONE,value:20.1168,offset:0},mil:{name:"mil",base:R.LENGTH,prefixes:_.NONE,value:254e-7,offset:0},m2:{name:"m2",base:R.SURFACE,prefixes:_.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:R.SURFACE,prefixes:_.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:R.SURFACE,prefixes:_.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:R.SURFACE,prefixes:_.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:R.SURFACE,prefixes:_.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:R.SURFACE,prefixes:_.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:R.SURFACE,prefixes:_.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:R.SURFACE,prefixes:_.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:R.SURFACE,prefixes:_.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:R.SURFACE,prefixes:_.NONE,value:1e4,offset:0},m3:{name:"m3",base:R.VOLUME,prefixes:_.CUBIC,value:1,offset:0},L:{name:"L",base:R.VOLUME,prefixes:_.SHORT,value:.001,offset:0},l:{name:"l",base:R.VOLUME,prefixes:_.SHORT,value:.001,offset:0},litre:{name:"litre",base:R.VOLUME,prefixes:_.LONG,value:.001,offset:0},cuin:{name:"cuin",base:R.VOLUME,prefixes:_.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:R.VOLUME,prefixes:_.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:R.VOLUME,prefixes:_.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:R.VOLUME,prefixes:_.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:R.VOLUME,prefixes:_.NONE,value:15e-6,offset:0},drop:{name:"drop",base:R.VOLUME,prefixes:_.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:R.VOLUME,prefixes:_.NONE,value:5e-8,offset:0},minim:{name:"minim",base:R.VOLUME,prefixes:_.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:R.VOLUME,prefixes:_.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:R.VOLUME,prefixes:_.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:R.VOLUME,prefixes:_.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:R.VOLUME,prefixes:_.NONE,value:1e-6,offset:0},cup:{name:"cup",base:R.VOLUME,prefixes:_.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:R.VOLUME,prefixes:_.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:R.VOLUME,prefixes:_.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:R.VOLUME,prefixes:_.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:R.VOLUME,prefixes:_.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:R.VOLUME,prefixes:_.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:R.VOLUME,prefixes:_.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:R.VOLUME,prefixes:_.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:R.VOLUME,prefixes:_.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:R.VOLUME,prefixes:_.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:R.VOLUME,prefixes:_.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:R.VOLUME,prefixes:_.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:R.VOLUME,prefixes:_.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:R.VOLUME,prefixes:_.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:R.VOLUME,prefixes:_.NONE,value:.1173478,offset:0},obl:{name:"obl",base:R.VOLUME,prefixes:_.NONE,value:.1589873,offset:0},g:{name:"g",base:R.MASS,prefixes:_.SHORT,value:.001,offset:0},gram:{name:"gram",base:R.MASS,prefixes:_.LONG,value:.001,offset:0},ton:{name:"ton",base:R.MASS,prefixes:_.SHORT,value:907.18474,offset:0},t:{name:"t",base:R.MASS,prefixes:_.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:R.MASS,prefixes:_.LONG,value:1e3,offset:0},grain:{name:"grain",base:R.MASS,prefixes:_.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:R.MASS,prefixes:_.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:R.MASS,prefixes:_.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:R.MASS,prefixes:_.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:R.MASS,prefixes:_.NONE,value:45.359237,offset:0},stick:{name:"stick",base:R.MASS,prefixes:_.NONE,value:.115,offset:0},stone:{name:"stone",base:R.MASS,prefixes:_.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:R.MASS,prefixes:_.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:R.MASS,prefixes:_.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:R.MASS,prefixes:_.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:R.MASS,prefixes:_.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:R.MASS,prefixes:_.NONE,value:45.359237,offset:0},s:{name:"s",base:R.TIME,prefixes:_.SHORT,value:1,offset:0},min:{name:"min",base:R.TIME,prefixes:_.NONE,value:60,offset:0},h:{name:"h",base:R.TIME,prefixes:_.NONE,value:3600,offset:0},second:{name:"second",base:R.TIME,prefixes:_.LONG,value:1,offset:0},sec:{name:"sec",base:R.TIME,prefixes:_.LONG,value:1,offset:0},minute:{name:"minute",base:R.TIME,prefixes:_.NONE,value:60,offset:0},hour:{name:"hour",base:R.TIME,prefixes:_.NONE,value:3600,offset:0},day:{name:"day",base:R.TIME,prefixes:_.NONE,value:86400,offset:0},week:{name:"week",base:R.TIME,prefixes:_.NONE,value:604800,offset:0},month:{name:"month",base:R.TIME,prefixes:_.NONE,value:2629800,offset:0},year:{name:"year",base:R.TIME,prefixes:_.NONE,value:31557600,offset:0},decade:{name:"decade",base:R.TIME,prefixes:_.NONE,value:315576e3,offset:0},century:{name:"century",base:R.TIME,prefixes:_.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:R.TIME,prefixes:_.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:R.FREQUENCY,prefixes:_.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:R.FREQUENCY,prefixes:_.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:R.ANGLE,prefixes:_.SHORT,value:1,offset:0},radian:{name:"radian",base:R.ANGLE,prefixes:_.LONG,value:1,offset:0},deg:{name:"deg",base:R.ANGLE,prefixes:_.SHORT,value:null,offset:0},degree:{name:"degree",base:R.ANGLE,prefixes:_.LONG,value:null,offset:0},grad:{name:"grad",base:R.ANGLE,prefixes:_.SHORT,value:null,offset:0},gradian:{name:"gradian",base:R.ANGLE,prefixes:_.LONG,value:null,offset:0},cycle:{name:"cycle",base:R.ANGLE,prefixes:_.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:R.ANGLE,prefixes:_.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:R.ANGLE,prefixes:_.NONE,value:null,offset:0},A:{name:"A",base:R.CURRENT,prefixes:_.SHORT,value:1,offset:0},ampere:{name:"ampere",base:R.CURRENT,prefixes:_.LONG,value:1,offset:0},K:{name:"K",base:R.TEMPERATURE,prefixes:_.SHORT,value:1,offset:0},degC:{name:"degC",base:R.TEMPERATURE,prefixes:_.SHORT,value:1,offset:273.15},degF:{name:"degF",base:R.TEMPERATURE,prefixes:_.SHORT,value:new x(5,9),offset:459.67},degR:{name:"degR",base:R.TEMPERATURE,prefixes:_.SHORT,value:new x(5,9),offset:0},kelvin:{name:"kelvin",base:R.TEMPERATURE,prefixes:_.LONG,value:1,offset:0},celsius:{name:"celsius",base:R.TEMPERATURE,prefixes:_.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:R.TEMPERATURE,prefixes:_.LONG,value:new x(5,9),offset:459.67},rankine:{name:"rankine",base:R.TEMPERATURE,prefixes:_.LONG,value:new x(5,9),offset:0},mol:{name:"mol",base:R.AMOUNT_OF_SUBSTANCE,prefixes:_.SHORT,value:1,offset:0},mole:{name:"mole",base:R.AMOUNT_OF_SUBSTANCE,prefixes:_.LONG,value:1,offset:0},cd:{name:"cd",base:R.LUMINOUS_INTENSITY,prefixes:_.SHORT,value:1,offset:0},candela:{name:"candela",base:R.LUMINOUS_INTENSITY,prefixes:_.LONG,value:1,offset:0},N:{name:"N",base:R.FORCE,prefixes:_.SHORT,value:1,offset:0},newton:{name:"newton",base:R.FORCE,prefixes:_.LONG,value:1,offset:0},dyn:{name:"dyn",base:R.FORCE,prefixes:_.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:R.FORCE,prefixes:_.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:R.FORCE,prefixes:_.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:R.FORCE,prefixes:_.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:R.FORCE,prefixes:_.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:R.FORCE,prefixes:_.NONE,value:9.80665,offset:0},J:{name:"J",base:R.ENERGY,prefixes:_.SHORT,value:1,offset:0},joule:{name:"joule",base:R.ENERGY,prefixes:_.SHORT,value:1,offset:0},erg:{name:"erg",base:R.ENERGY,prefixes:_.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:R.ENERGY,prefixes:_.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:R.ENERGY,prefixes:_.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:R.ENERGY,prefixes:_.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:R.ENERGY,prefixes:_.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:R.POWER,prefixes:_.SHORT,value:1,offset:0},watt:{name:"watt",base:R.POWER,prefixes:_.LONG,value:1,offset:0},hp:{name:"hp",base:R.POWER,prefixes:_.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:R.POWER,prefixes:_.SHORT,value:v.I,offset:0},VA:{name:"VA",base:R.POWER,prefixes:_.SHORT,value:1,offset:0},Pa:{name:"Pa",base:R.PRESSURE,prefixes:_.SHORT,value:1,offset:0},psi:{name:"psi",base:R.PRESSURE,prefixes:_.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:R.PRESSURE,prefixes:_.NONE,value:101325,offset:0},bar:{name:"bar",base:R.PRESSURE,prefixes:_.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:R.PRESSURE,prefixes:_.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:R.PRESSURE,prefixes:_.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:R.PRESSURE,prefixes:_.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:R.PRESSURE,prefixes:_.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:R.ELECTRIC_CHARGE,prefixes:_.LONG,value:1,offset:0},C:{name:"C",base:R.ELECTRIC_CHARGE,prefixes:_.SHORT,value:1,offset:0},farad:{name:"farad",base:R.ELECTRIC_CAPACITANCE,prefixes:_.LONG,value:1,offset:0},F:{name:"F",base:R.ELECTRIC_CAPACITANCE,prefixes:_.SHORT,value:1,offset:0},volt:{name:"volt",base:R.ELECTRIC_POTENTIAL,prefixes:_.LONG,value:1,offset:0},V:{name:"V",base:R.ELECTRIC_POTENTIAL,prefixes:_.SHORT,value:1,offset:0},ohm:{name:"ohm",base:R.ELECTRIC_RESISTANCE,prefixes:_.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:R.ELECTRIC_INDUCTANCE,prefixes:_.LONG,value:1,offset:0},H:{name:"H",base:R.ELECTRIC_INDUCTANCE,prefixes:_.SHORT,value:1,offset:0},siemens:{name:"siemens",base:R.ELECTRIC_CONDUCTANCE,prefixes:_.LONG,value:1,offset:0},S:{name:"S",base:R.ELECTRIC_CONDUCTANCE,prefixes:_.SHORT,value:1,offset:0},weber:{name:"weber",base:R.MAGNETIC_FLUX,prefixes:_.LONG,value:1,offset:0},Wb:{name:"Wb",base:R.MAGNETIC_FLUX,prefixes:_.SHORT,value:1,offset:0},tesla:{name:"tesla",base:R.MAGNETIC_FLUX_DENSITY,prefixes:_.LONG,value:1,offset:0},T:{name:"T",base:R.MAGNETIC_FLUX_DENSITY,prefixes:_.SHORT,value:1,offset:0},b:{name:"b",base:R.BIT,prefixes:_.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:R.BIT,prefixes:_.BINARY_LONG,value:1,offset:0},B:{name:"B",base:R.BIT,prefixes:_.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:R.BIT,prefixes:_.BINARY_LONG,value:8,offset:0}},B={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function U(e){if("BigNumber"===e.number){var t=Fm(b);P.rad.value=new b(1),P.deg.value=t.div(180),P.grad.value=t.div(200),P.cycle.value=t.times(2),P.arcsec.value=t.div(648e3),P.arcmin.value=t.div(10800)}else P.rad.value=1,P.deg.value=Math.PI/180,P.grad.value=Math.PI/200,P.cycle.value=2*Math.PI,P.arcsec.value=Math.PI/648e3,P.arcmin.value=Math.PI/10800;P.radian.value=P.rad.value,P.degree.value=P.deg.value,P.gradian.value=P.grad.value}U(s),i&&i("config",(function(e,t){e.number!==t.number&&U(e)}));var $={si:{NONE:{unit:F,prefix:_.NONE[""]},LENGTH:{unit:P.m,prefix:_.SHORT[""]},MASS:{unit:P.g,prefix:_.SHORT.k},TIME:{unit:P.s,prefix:_.SHORT[""]},CURRENT:{unit:P.A,prefix:_.SHORT[""]},TEMPERATURE:{unit:P.K,prefix:_.SHORT[""]},LUMINOUS_INTENSITY:{unit:P.cd,prefix:_.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:P.mol,prefix:_.SHORT[""]},ANGLE:{unit:P.rad,prefix:_.SHORT[""]},BIT:{unit:P.bits,prefix:_.SHORT[""]},FORCE:{unit:P.N,prefix:_.SHORT[""]},ENERGY:{unit:P.J,prefix:_.SHORT[""]},POWER:{unit:P.W,prefix:_.SHORT[""]},PRESSURE:{unit:P.Pa,prefix:_.SHORT[""]},ELECTRIC_CHARGE:{unit:P.C,prefix:_.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:P.F,prefix:_.SHORT[""]},ELECTRIC_POTENTIAL:{unit:P.V,prefix:_.SHORT[""]},ELECTRIC_RESISTANCE:{unit:P.ohm,prefix:_.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:P.H,prefix:_.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:P.S,prefix:_.SHORT[""]},MAGNETIC_FLUX:{unit:P.Wb,prefix:_.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:P.T,prefix:_.SHORT[""]},FREQUENCY:{unit:P.Hz,prefix:_.SHORT[""]}}};$.cgs=JSON.parse(JSON.stringify($.si)),$.cgs.LENGTH={unit:P.m,prefix:_.SHORT.c},$.cgs.MASS={unit:P.g,prefix:_.SHORT[""]},$.cgs.FORCE={unit:P.dyn,prefix:_.SHORT[""]},$.cgs.ENERGY={unit:P.erg,prefix:_.NONE[""]},$.us=JSON.parse(JSON.stringify($.si)),$.us.LENGTH={unit:P.ft,prefix:_.NONE[""]},$.us.MASS={unit:P.lbm,prefix:_.NONE[""]},$.us.TEMPERATURE={unit:P.degF,prefix:_.NONE[""]},$.us.FORCE={unit:P.lbf,prefix:_.NONE[""]},$.us.ENERGY={unit:P.BTU,prefix:_.BTU[""]},$.us.POWER={unit:P.hp,prefix:_.NONE[""]},$.us.PRESSURE={unit:P.psi,prefix:_.NONE[""]},$.auto=JSON.parse(JSON.stringify($.si));var j=$.auto;for(var z in E.setUnitSystem=function(e){if(!ku($,e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys($).join(", "));j=$[e]},E.getUnitSystem=function(){for(var e in $)if(ku($,e)&&$[e]===j)return e},E.typeConverters={BigNumber:function(e){return null!=e&&e.isFraction?new b(e.n).div(e.d).times(e.s):new b(e+"")},Fraction:function(e){return new x(e)},Complex:function(e){return e},number:function(e){return null!=e&&e.isFraction?y(e):e}},E.prototype._numberConverter=function(){var e=E.typeConverters[this.valueType()];if(e)return e;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},E._getNumberConverter=function(e){if(!E.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return E.typeConverters[e]},P)if(ku(P,z)){var q=P[z];q.dimensions=q.base.dimensions}for(var H in B)if(ku(B,H)){var V=P[B[H]],G={};for(var W in V)ku(V,W)&&(G[W]=V[W]);G.name=H,P[H]=G}return E.isValidAlpha=function(e){return/^[a-zA-Z]$/.test(e)},E.createUnit=function(e,t){if("object"!=typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var r in e)if(ku(e,r)&&E.deleteUnit(r),e[r].aliases)for(var n=0;n<e[r].aliases.length;n++)E.deleteUnit(e[r].aliases[n]);var i;for(var s in e)ku(e,s)&&(i=E.createUnitSingle(s,e[s]));return i},E.createUnitSingle=function(e,t){if(null==t&&(t={}),"string"!=typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(ku(P,e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');!function(e){for(var t=0;t<e.length;t++){if(n=e.charAt(t),0===t&&!E.isValidAlpha(n))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!E.isValidAlpha(n)&&!T(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}(e);var r,i,s,o=null,a=[],l=0;if(t&&"Unit"===t.type)o=t.clone();else if("string"==typeof t)""!==t&&(r=t);else{if("object"!=typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');r=t.definition,i=t.prefixes,l=t.offset,s=t.baseName,t.aliases&&(a=t.aliases.valueOf())}if(a)for(var u=0;u<a.length;u++)if(ku(P,a[u]))throw new Error('Cannot create alias "'+a[u]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!o)try{o=E.parse(r,{allowNoUnits:!0})}catch(t){throw t.message='Could not create unit "'+e+'" from "'+r+'": '+t.message,t}else r&&"Unit"===r.type&&(o=r.clone());a=a||[],l=l||0,i=i&&i.toUpperCase&&_[i.toUpperCase()]||_.NONE;var c={};if(o){c={name:e,value:o.value,dimensions:o.dimensions.slice(0),prefixes:i,offset:l};var d=!1;for(var h in R)if(ku(R,h)){for(var f=!0,p=0;p<L.length;p++)if(Math.abs((c.dimensions[p]||0)-(R[h].dimensions[p]||0))>1e-12){f=!1;break}if(f){d=!0,c.base=R[h];break}}if(!d){s=s||e+"_STUFF";var m={dimensions:o.dimensions.slice(0)};m.key=s,R[s]=m,j[s]={unit:c,prefix:_.NONE[""]},c.base=R[s]}}else{if(s=s||e+"_STUFF",L.indexOf(s)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');for(var g in L.push(s),R)ku(R,g)&&(R[g].dimensions[L.length-1]=0);for(var y={dimensions:[]},v=0;v<L.length;v++)y.dimensions[v]=0;y.dimensions[L.length-1]=1,y.key=s,R[s]=y,c={name:e,value:1,dimensions:R[s].dimensions.slice(0),prefixes:i,offset:l,base:R[s]},j[s]={unit:c,prefix:_.NONE[""]}}E.UNITS[e]=c;for(var b=0;b<a.length;b++){var x=a[b],w={};for(var S in c)ku(c,S)&&(w[S]=c[S]);w.name=x,E.UNITS[x]=w}return delete M.cache,new E(null,e)},E.deleteUnit=function(e){delete E.UNITS[e]},E.PREFIXES=_,E.BASE_DIMENSIONS=L,E.BASE_UNITS=R,E.UNIT_SYSTEMS=$,E.UNITS=P,E}),{isClass:!0}),LA="createUnit",RA=Mu(LA,["typed","Unit"],(e=>{var{typed:t,Unit:r}=e;return t(LA,{"Object, Object":function(e,t){return r.createUnit(e,t)},Object:function(e){return r.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,t,n){var i={};return i[e]=t,r.createUnit(i,n)},"string, Unit | string | Object":function(e,t){var n={};return n[e]=t,r.createUnit(n,{})},string:function(e){var t={};return t[e]={},r.createUnit(t,{})}})})),IA="dotPow",FA=Mu(IA,["typed","equalScalar","matrix","pow","DenseMatrix","concat"],(e=>{var{typed:t,equalScalar:r,matrix:n,pow:i,DenseMatrix:s,concat:o}=e,a=Zw({typed:t}),l=Xw({typed:t,DenseMatrix:s}),u=Qw({typed:t,equalScalar:r}),c=eE({typed:t,DenseMatrix:s}),d=iE({typed:t,matrix:n,concat:o}),h={};for(var f in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,f)&&(f.includes("Matrix")||f.includes("Array")||(h[f]=i.signatures[f]));var p=t(h);return t(IA,d({elop:p,SS:l,DS:a,Ss:u,sS:c}))})),PA="expm",BA=Mu(PA,["typed","abs","add","identity","inv","multiply"],(e=>{var{typed:t,abs:r,add:n,identity:i,inv:s,multiply:o}=e;return t(PA,{Matrix:function(e){var t=e.size();if(2!==t.length||t[0]!==t[1])throw new RangeError("Matrix must be square (size: "+xc(t)+")");for(var l=t[0],u=function(e){for(var t=e.size()[0],n=0,i=0;i<t;i++){for(var s=0,o=0;o<t;o++)s+=r(e.get([i,o]));n=Math.max(s,n)}return n}(e),c=function(e,t){for(var r=30,n=0;n<r;n++)for(var i=0;i<=n;i++){var s=n-i;if(a(e,i,s)<t)return{q:i,j:s}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(u,1e-15),d=c.q,h=c.j,f=o(e,Math.pow(2,-h)),p=i(l),m=i(l),g=1,y=f,v=-1,b=1;b<=d;b++)b>1&&(y=o(y,f),v=-v),p=n(p,o(g=g*(d-b+1)/((2*d-b+1)*b),y)),m=n(m,o(g*v,y));for(var x=o(s(m),p),w=0;w<h;w++)x=o(x,x);return Kl(e)?e.createSparseMatrix(x):x}});function a(e,t,r){for(var n=1,i=2;i<=t;i++)n*=i;for(var s=n,o=t+1;o<=2*t;o++)s*=o;var a=s*(2*t+1);return 8*Math.pow(e/Math.pow(2,r),2*t)*n*n/(s*a)}})),UA=Mu("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],(e=>{var{typed:t,matrix:r,addScalar:n,multiplyScalar:i,divideScalar:s,exp:o,tau:a,i:l,dotDivide:u,conj:c,pow:d,ceil:h,log2:f}=e;return t("fft",{Array:p,Matrix:function(e){return e.create(p(e.toArray()))}});function p(e){var t=kc(e);return 1===t.length?g(e,t[0]):m(e.map((e=>p(e,t.slice(1)))),0)}function m(e,t){var r=kc(e);if(0!==t)return new Array(r[0]).fill(0).map(((r,n)=>m(e[n],t-1)));if(1===r.length)return g(e);function n(e){var t=kc(e);return new Array(t[1]).fill(0).map(((r,n)=>new Array(t[0]).fill(0).map(((t,r)=>e[r][n]))))}return n(m(n(e),1))}function g(e){var t=e.length;if(1===t)return[e[0]];if(t%2==0){for(var r=[...g(e.filter(((e,t)=>t%2==0))),...g(e.filter(((e,t)=>t%2==1)))],m=0;m<t/2;m++){var y=r[m],v=i(r[m+t/2],o(i(i(a,l),s(-m,t))));r[m]=n(y,v),r[m+t/2]=n(y,i(-1,v))}return r}return function(e){for(var t=e.length,r=o(s(i(-1,i(l,a)),t)),n=[],m=1-t;m<t;m++)n.push(d(r,s(d(m,2),2)));for(var y=d(2,h(f(t+t-1))),v=[...new Array(t).fill(0).map(((r,s)=>i(e[s],n[t-1+s]))),...new Array(y-t).fill(0)],b=[...new Array(t+t-1).fill(0).map(((e,t)=>s(1,n[t]))),...new Array(y-(t+t-1)).fill(0)],x=g(v),w=g(b),E=new Array(y).fill(0).map(((e,t)=>i(x[t],w[t]))),S=u(c(p(c(E))),y),T=[],A=t-1;A<t+t-1;A++)T.push(i(S[A],n[A]));return T}(e)}})),$A="gamma",jA=Mu($A,["typed","config","multiplyScalar","pow","BigNumber","Complex"],(e=>{var{typed:t,config:r,multiplyScalar:n,pow:i,BigNumber:s,Complex:o}=e;return t($A,{number:jb,Complex:function e(t){if(0===t.im)return jb(t.re);if(t.re<.5){var r=new o(1-t.re,-t.im),n=new o(Math.PI*t.re,Math.PI*t.im);return new o(Math.PI).div(n.sin()).div(e(r))}t=new o(t.re-1,t.im);for(var i=new o(qb[0],0),s=1;s<qb.length;++s){var a=new o(qb[s],0);i=i.add(a.div(t.add(s)))}var l=new o(t.re+zb+.5,t.im),u=Math.sqrt(2*Math.PI),c=l.pow(t.add(.5)),d=l.neg().exp();return i.mul(u).mul(c).mul(d)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new s(1/0):a(e.minus(1));if(!e.isFinite())return new s(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function a(e){if(e<8)return new s([1,1,2,6,24,120,720,5040][e]);var t=r.precision+(0|Math.log(e.toNumber())),n=s.clone({precision:t});if(e%2==1)return e.times(a(new s(e-1)));for(var i=e,o=new n(e),l=e.toNumber();i>2;)l+=i-=2,o=o.times(l);return new s(o.toPrecision(s.precision))}})),zA="ifft",qA=Mu(zA,["typed","fft","dotDivide","conj"],(e=>{var{typed:t,fft:r,dotDivide:n,conj:i}=e;return t(zA,{"Array | Matrix":function(e){var t=Vl(e)?e.size():kc(e);return n(i(r(i(e))),t.reduce(((e,t)=>e*t),1))}})})),HA=Mu("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],(e=>{var{typed:t,matrix:r,multiply:n,equalScalar:i,divideScalar:s,inv:o}=e,a=Qw({typed:t,equalScalar:i}),l=rE({typed:t});return t("divide",Nu({"Array | Matrix, Array | Matrix":function(e,t){return n(e,o(t))},"DenseMatrix, any":function(e,t){return l(e,t,s,!1)},"SparseMatrix, any":function(e,t){return a(e,t,s,!1)},"Array, any":function(e,t){return l(r(e),t,s,!1).valueOf()},"any, Array | Matrix":function(e,t){return n(e,o(t))}},s.signatures))})),VA="factorial",GA=Mu(VA,["typed","gamma"],(e=>{var{typed:t,gamma:r}=e;return t(VA,{number:function(e){if(e<0)throw new Error("Value must be non-negative");return r(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return r(e.plus(1))},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})}));function WA(e,t){var r,n=t.length,i=[];if(e)for(r=0;r<n;r++)i[e[r]]=t[r];else for(r=0;r<n;r++)i[r]=t[r];return i}var KA="lusolve",YA=Mu(KA,["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],(e=>{var{typed:t,matrix:r,lup:n,slu:i,usolve:s,lsolve:o,DenseMatrix:a}=e,l=XS({DenseMatrix:a});return t(KA,{"Array, Array | Matrix":function(e,t){e=r(e);var i=n(e);return c(i.L,i.U,i.p,null,t).valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var r=n(e);return c(r.L,r.U,r.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var r=n(e);return c(r.L,r.U,r.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,r,n){var s=i(e,r,n);return c(s.L,s.U,s.p,s.q,t)},"Object, Array | Matrix":function(e,t){return c(e.L,e.U,e.p,e.q,t)}});function u(e){if(Vl(e))return e;if(Hl(e))return r(e);throw new TypeError("Invalid Matrix LU decomposition")}function c(e,t,r,n,i){e=u(e),t=u(t),r&&((i=l(e,i,!0))._data=WA(r,i._data));var a=o(e,i),c=s(t,a);return n&&(c._data=WA(n,c._data)),c}})),JA="multinomial",ZA=Mu(JA,["typed","add","divide","multiply","factorial","isInteger","isPositive"],(e=>{var{typed:t,add:r,divide:n,multiply:i,factorial:s,isInteger:o,isPositive:a}=e;return t(JA,{"Array | Matrix":function(e){var t=0,l=1;return Vd(e,(function(e){if(!o(e)||!a(e))throw new TypeError("Positive integer value expected in function multinomial");t=r(t,e),l=i(l,s(e))})),n(s(t),l)}})})),XA="permutations",QA=Mu(XA,["typed","factorial"],(e=>{var{typed:t,factorial:r}=e;return t(XA,{"number | BigNumber":r,"number, number":function(e,t){if(!Ku(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!Ku(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");return zv(e-t+1,e)},"BigNumber, BigNumber":function(e,t){var r,n;if(!eD(e)||!eD(t))throw new TypeError("Positive integer value expected in function permutations");if(t.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(r=e.mul(0).add(1),n=e.minus(t).plus(1);n.lte(e);n=n.plus(1))r=r.times(n);return r}})}));function eD(e){return e.isInteger()&&e.gte(0)}var tD="polynomialRoot",rD=Mu(tD,["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],(e=>{var{typed:t,isZero:r,equalScalar:n,add:i,subtract:s,multiply:o,divide:a,sqrt:l,unaryMinus:u,cbrt:c,typeOf:d,im:h,re:f}=e;return t(tD,{"number|Complex, ...number|Complex":(e,t)=>{for(var p=[e,...t];p.length>0&&r(p[p.length-1]);)p.pop();if(p.length<2)throw new RangeError("Polynomial [".concat(e,", ").concat(t,"] must have a non-zero non-constant coefficient"));switch(p.length){case 2:return[u(a(p[0],p[1]))];case 3:var[m,g,y]=p,v=o(2,y),b=o(g,g),x=o(4,y,m);if(n(b,x))return[a(u(g),v)];var w=l(s(b,x));return[a(s(w,g),v),a(s(u(w),g),v)];case 4:var[E,S,T,A]=p,D=u(o(3,A)),N=o(T,T),C=o(3,A,S),k=i(o(2,T,T,T),o(27,A,A,E)),M=o(9,A,T,S);if(n(N,C)&&n(k,M))return[a(T,D)];var O,_=s(N,C),L=s(k,M),R=i(o(18,A,T,S,E),o(T,T,S,S)),I=i(o(4,T,T,T,E),o(4,A,S,S,S),o(27,A,A,E,E));if(n(R,I))return[a(s(o(4,A,T,S),i(o(9,A,A,E),o(T,T,T))),o(A,_)),a(s(o(9,A,E),o(T,S)),o(2,_))];O=n(N,C)?L:a(i(L,l(s(o(L,L),o(4,_,_,_)))),2);return c(O,!0).toArray().map((e=>a(i(T,e,a(_,e)),D))).map((e=>"Complex"===d(e)&&n(f(e),f(e)+h(e))?f(e):e));default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(p))}}})})),nD="setSize",iD=Mu(nD,["typed","compareNatural"],(e=>{var{typed:t,compareNatural:r}=e;return t(nD,{"Array | Matrix":function(e){return Array.isArray(e)?zc(e).length:zc(e.toArray()).length},"Array | Matrix, boolean":function(e,t){if(!1===t||0===e.length)return Array.isArray(e)?zc(e).length:zc(e.toArray()).length;for(var n=zc(Array.isArray(e)?e:e.toArray()).sort(r),i=1,s=1;s<n.length;s++)0!==r(n[s],n[s-1])&&i++;return i}})}));function sD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var oD=Mu("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:s,max:o,map:a,abs:l,isPositive:u,isNegative:c,larger:d,smaller:h,matrix:f,bignumber:p,unaryMinus:m}=e;function g(e){return function(t,f,g,y){if(!(2===f.length&&(f.every(x)||f.every(zl))))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var v=f[0],b=f[1],w=d(b,v),E=y.firstStep;if(void 0!==E&&!u(E))throw new Error('"firstStep" must be positive');var S=y.maxStep;if(void 0!==S&&!u(S))throw new Error('"maxStep" must be positive');var T=y.minStep;if(T&&c(T))throw new Error('"minStep" must be positive or zero');var A=[v,b,E,T,S].filter((e=>void 0!==e));if(!A.every(x)&&!A.every(zl))throw new Error('Inconsistent type of "t" dependant variables');for(var D=y.tol?y.tol:1e-4,N=y.minDelta?y.minDelta:.2,C=y.maxDelta?y.maxDelta:5,k=y.maxIter?y.maxIter:1e4,M=[v,b,...g,S,T].some(Ul),[O,_,L,R]=M?[p(e.a),p(e.c),p(e.b),p(e.bp)]:[e.a,e.c,e.b,e.bp],I=E?w?E:m(E):s(n(b,v),1),F=[v],P=[g],B=n(L,R),U=0,$=0,j=function(e){return e?h:d}(w),z=function(e){var t=e?d:h;return function(e,i,s){var o=r(e,s);return t(o,i)?n(i,e):s}}(w);j(F[U],b);){var q=[];I=z(F[U],b,I),q.push(t(F[U],P[U]));for(var H=1;H<_.length;++H)q.push(t(r(F[U],i(_[H],I)),r(P[U],i(I,O[H],q))));var V=o(l(a(i(B,q),(e=>zl(e)?e.value:e))));V<D&&D/V>1/4&&(F.push(r(F[U],I)),P.push(r(P[U],i(I,L,q))),U++);var G=.84*(D/V)**.2;if(h(G,N)?G=N:d(G,C)&&(G=C),G=M?p(G):G,I=i(I,G),S&&d(l(I),S)?I=w?S:m(S):T&&h(l(I),T)&&(I=w?T:m(T)),++$>k)throw new Error("Maximum number of iterations reached, try changing options")}return{t:F,y:P}}}function y(e,t,r,n){return g({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(e,t,r,n)}function v(e,t,r,n){return g({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(e,t,r,n)}function b(e,t,r,n){var i=n.method?n.method:"RK45",s={RK23:y,RK45:v};if(i.toUpperCase()in s){var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sD(Object(r),!0).forEach((function(t){Wu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n);return delete o.method,s[i.toUpperCase()](e,t,r,o)}var a=Object.keys(s).map((e=>'"'.concat(e,'"'))),l="".concat(a.slice(0,-1).join(", ")," and ").concat(a.slice(-1));throw new Error('Unavailable method "'.concat(i,'". Available methods are ').concat(l))}function x(e){return Ul(e)||Bl(e)}function w(e,t,r,n){var i=b(e,t.toArray(),r.toArray(),n);return{t:f(i.t),y:f(i.y)}}return t("solveODE",{"function, Array, Array, Object":b,"function, Matrix, Matrix, Object":w,"function, Array, Array":(e,t,r)=>b(e,t,r,{}),"function, Matrix, Matrix":(e,t,r)=>w(e,t,r,{}),"function, Array, number | BigNumber | Unit":(e,t,r)=>{var n=b(e,t,[r],{});return{t:n.t,y:n.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit":(e,t,r)=>{var n=b(e,t.toArray(),[r],{});return{t:f(n.t),y:f(n.y.map((e=>e[0])))}},"function, Array, number | BigNumber | Unit, Object":(e,t,r,n)=>{var i=b(e,t,[r],n);return{t:i.t,y:i.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit, Object":(e,t,r,n)=>{var i=b(e,t.toArray(),[r],n);return{t:f(i.t),y:f(i.y.map((e=>e[0])))}}})})),aD="stirlingS2",lD=Mu(aD,["typed","addScalar","subtract","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],(e=>{var{typed:t,addScalar:r,subtract:n,multiplyScalar:i,divideScalar:s,pow:o,factorial:a,combinations:l,isNegative:u,isInteger:c,number:d,bignumber:h,larger:f}=e,p=[],m=[];return t(aD,{"number | BigNumber, number | BigNumber":function(e,t){if(!c(e)||u(e)||!c(t)||u(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");var n=!(Bl(e)&&Bl(t)),s=n?m:p,o=n?h:d,a=d(e),l=d(t);if(s[a]&&s[a].length>l)return s[a][l];for(var g=0;g<=a;++g)if(s[g]||(s[g]=[o(0===g?1:0)]),0!==g)for(var y=s[g],v=s[g-1],b=y.length;b<=g&&b<=l;++b)y[b]=b===g?1:r(i(o(b),v[b]),v[b-1]);return s[a][l]}})})),uD="unit",cD=Mu(uD,["typed","Unit"],(e=>{var{typed:t,Unit:r}=e;return t(uD,{Unit:function(e){return e.clone()},string:function(e){return r.isValuelessUnit(e)?new r(null,e):r.parse(e,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(e,t){return new r(e,t)},"number | BigNumber | Fraction":function(e){return new r(e)},"Array | Matrix":t.referToSelf((e=>t=>Gd(t,e)))})})),dD="bellNumbers",hD=Mu(dD,["typed","addScalar","isNegative","isInteger","stirlingS2"],(e=>{var{typed:t,addScalar:r,isNegative:n,isInteger:i,stirlingS2:s}=e;return t(dD,{"number | BigNumber":function(e){if(!i(e)||n(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,o=0;o<=e;o++)t=r(t,s(e,o));return t}})}));function fD(e){var{addScalar:t,subtract:r,flatten:n,multiply:i,multiplyScalar:s,divideScalar:o,sqrt:a,abs:l,bignumber:u,diag:c,inv:d,qr:h,usolve:f,usolveAll:p,equal:m,complex:g,larger:y,smaller:v,matrixFromColumns:b,dot:x}=e;function w(e,n,i,o){var l=t(e,o),u=r(s(e,o),s(n,i)),c=s(l,.5),d=s(a(r(s(l,l),s(4,u))),.5);return[t(c,d),r(c,d)]}function E(e,t,n,i,s,o,a,c){var d="BigNumber"===c,h="Complex"===c,f=d?u(0):h?g(0):0,p=d?u(1):h?g(1):1;if(v(l(n),a))return[[p,f],[f,p]];if(y(l(r(s,o)),a))return[[r(s,i),r(o,i)],[n,n]];var m=r(e,s),b=r(t,s),x=r(n,s),w=r(i,s);return v(l(b),a)?[[m,p],[x,f]]:[[b,f],[w,p]]}function S(e,t){for(var r=0;r<e.length;r++)e[r].push(...Array(t-e[r].length).fill(0));for(var n=e.length;n<t;n++)e.push(Array(t).fill(0)),e[n][n]=1;return e}function T(e,t,r){for(var n=0;n<e.length;n++)if(r(e[n],t))return n;return-1}function A(e,t,r,n,i){for(var s,o="BigNumber"===i?u(1e3):1e3,a=0;s=D(t,r,i),s=f(e,s),!y(C(s),o);)if(++a>=5)return null;for(a=0;;){var l=f(e,s);if(v(C(N(s,[l])),n))break;if(++a>=10)return null;s=k(l)}return s}function D(e,t,r){var n="BigNumber"===r,i="Complex"===r,s=Array(e).fill(0).map((e=>2*Math.random()-1));return n&&(s=s.map((e=>u(e)))),i&&(s=s.map((e=>g(e)))),k(s=N(s,t),r)}function N(e,t){for(var n of t)e=r(e,i(o(x(n,e),x(n,n)),n));return e}function C(e){return l(a(x(e,e)))}function k(e,t){var r="Complex"===t,n="BigNumber"===t?u(1):r?g(1):1;return i(o(n,C(e)),e)}return function(e,a,f,x,D){void 0===D&&(D=!0);var N=function(e,r,n,i,a){var d,h="BigNumber"===i,f="Complex"===i,p=h?u(0):0,b=h?u(1):f?g(1):1,x=h?u(1):1,w=h?u(10):2,E=s(w,w);a&&(d=Array(r).fill(b));var S=!1;for(;!S;){S=!0;for(var T=0;T<r;T++){for(var A=p,D=p,N=0;N<r;N++)if(T!==N){var C=l(e[T][N]);A=t(A,C),D=t(D,C)}if(!m(A,0)&&!m(D,0)){for(var k=x,M=A,O=o(D,w),_=s(D,w);v(M,O);)M=s(M,E),k=s(k,w);for(;y(M,_);)M=o(M,E),k=o(k,w);if(v(o(t(M,D),k),s(t(A,D),.95))){S=!1;for(var L=o(1,k),R=0;R<r;R++)T!==R&&(e[T][R]=s(e[T][R],k),e[R][T]=s(e[R][T],L));a&&(d[T]=s(d[T],k))}}}}return c(d)}(e,a,0,x,D);!function(e,n,i,a,c,d){var h="BigNumber"===a,f="Complex"===a,p=h?u(0):f?g(0):0;h&&(i=u(i));for(var m=0;m<n-2;m++){for(var y=0,b=p,x=m+1;x<n;x++){var w=e[x][m];v(l(b),l(w))&&(b=w,y=x)}if(!v(l(b),i)){if(y!==m+1){var E=e[y];e[y]=e[m+1],e[m+1]=E;for(var S=0;S<n;S++){var T=e[S][y];e[S][y]=e[S][m+1],e[S][m+1]=T}if(c){var A=d[y];d[y]=d[m+1],d[m+1]=A}}for(var D=m+2;D<n;D++){var N=o(e[D][m],b);if(0!==N){for(var C=0;C<n;C++)e[D][C]=r(e[D][C],s(N,e[m+1][C]));for(var k=0;k<n;k++)e[k][m+1]=t(e[k][m+1],s(N,e[k][D]));if(c)for(var M=0;M<n;M++)d[D][M]=r(d[D][M],s(N,d[m+1][M]))}}}}}(e,a,f,x,D,N);var C,{values:k,C:M}=function(e,n,s,o,a){var d="BigNumber"===o,f="Complex"===o,p=d?u(1):f?g(1):1;d&&(s=u(s));var m=Du(e),y=[],b=n,x=[],T=a?c(Array(n).fill(p)):void 0,A=a?c(Array(b).fill(p)):void 0,D=0;for(;D<=100;){D+=1;for(var N=0,C=0;C<b;C++)m[C][C]=r(m[C][C],N);var{Q:k,R:M}=h(m);m=i(M,k);for(var O=0;O<b;O++)m[O][O]=t(m[O][O],N);if(a&&(A=i(A,k)),1===b||v(l(m[b-1][b-2]),s)){D=0,y.push(m[b-1][b-1]),a&&(x.unshift([[1]]),S(A,n),T=i(T,A),b>1&&(A=c(Array(b-1).fill(p)))),b-=1,m.pop();for(var _=0;_<b;_++)m[_].pop()}else if(2===b||v(l(m[b-2][b-3]),s)){D=0;var L=w(m[b-2][b-2],m[b-2][b-1],m[b-1][b-2],m[b-1][b-1]);y.push(...L),a&&(x.unshift(E(m[b-2][b-2],m[b-2][b-1],m[b-1][b-2],m[b-1][b-1],L[0],L[1],s,o)),S(A,n),T=i(T,A),b>2&&(A=c(Array(b-2).fill(p)))),b-=2,m.pop(),m.pop();for(var R=0;R<b;R++)m[R].pop(),m[R].pop()}if(0===b)break}if(y.sort(((e,t)=>+r(l(e),l(t)))),D>100){var I=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+y.join(", "));throw I.values=y,I.vectors=[],I}var F=a?i(T,function(e,t){for(var r=[],n=0;n<t;n++)r[n]=Array(t).fill(0);var i=0;for(var s of e){for(var o=s.length,a=0;a<o;a++)for(var l=0;l<o;l++)r[i+a][i+l]=s[a][l];i+=o}return r}(x,n)):void 0;return{values:y,C:F}}(e,a,f,x,D);return D&&(C=function(e,t,s,o,a,l,h){var f=d(s),y=i(f,e,s),v="BigNumber"===h,b="Complex"===h,x=v?u(0):b?g(0):0,w=v?u(1):b?g(1):1,E=[],S=[];for(var D of a){var N=T(E,D,m);-1===N?(E.push(D),S.push(1)):S[N]+=1}for(var C=[],k=E.length,M=Array(t).fill(x),O=c(Array(t).fill(w)),_=[],L=function(){var e=E[R],a=r(y,i(e,O)),u=p(a,M);for(u.shift();u.length<S[R];){var c=A(a,t,u,l,h);if(null==c){_.push(e);break}u.push(c)}var f=i(d(o),s);u=u.map((e=>i(f,e))),C.push(...u.map((e=>n(e))))},R=0;R<k;R++)L();if(0!==_.length){var I=new Error("Failed to find eigenvectors for the following eigenvalues: "+_.join(", "));throw I.values=a,I.vectors=C,I}return C}(e,a,M,N,k,f,x),C=b(...C)),{values:k,vectors:C}}}function pD(e){var{config:t,addScalar:r,subtract:n,abs:i,atan:s,cos:o,sin:a,multiplyScalar:l,inv:u,bignumber:c,multiply:d,add:h}=e;function f(e,r,n){var i=r-e;return Math.abs(i)<=t.epsilon?Math.PI/4:.5*Math.atan(2*n/(r-e))}function p(e,r,o){var a=n(r,e);return i(a)<=t.epsilon?c(-1).acos().div(4):l(.5,s(d(2,o,u(a))))}function m(e,t,r,n){for(var i=e.length,s=Math.cos(t),o=Math.sin(t),a=E(i,0),l=E(i,0),u=0;u<i;u++)a[u]=s*e[u][r]-o*e[u][n],l[u]=o*e[u][r]+s*e[u][n];for(var c=0;c<i;c++)e[c][r]=a[c],e[c][n]=l[c];return e}function g(e,t,i,s){for(var u=e.length,d=o(t),h=a(t),f=E(u,c(0)),p=E(u,c(0)),m=0;m<u;m++)f[m]=n(l(d,e[m][i]),l(h,e[m][s])),p[m]=r(l(h,e[m][i]),l(d,e[m][s]));for(var g=0;g<u;g++)e[g][i]=f[g],e[g][s]=p[g];return e}function y(e,t,i,s){for(var u=e.length,f=c(o(t)),p=c(a(t)),m=l(f,f),g=l(p,p),y=E(u,c(0)),v=E(u,c(0)),b=d(c(2),f,p,e[i][s]),x=r(n(l(m,e[i][i]),b),l(g,e[s][s])),w=h(l(g,e[i][i]),b,l(m,e[s][s])),S=0;S<u;S++)y[S]=n(l(f,e[i][S]),l(p,e[s][S])),v[S]=r(l(p,e[i][S]),l(f,e[s][S]));e[i][i]=x,e[s][s]=w,e[i][s]=c(0),e[s][i]=c(0);for(var T=0;T<u;T++)T!==i&&T!==s&&(e[i][T]=y[T],e[T][i]=y[T],e[s][T]=v[T],e[T][s]=v[T]);return e}function v(e,t,r,n){for(var i=e.length,s=Math.cos(t),o=Math.sin(t),a=s*s,l=o*o,u=E(i,0),c=E(i,0),d=a*e[r][r]-2*s*o*e[r][n]+l*e[n][n],h=l*e[r][r]+2*s*o*e[r][n]+a*e[n][n],f=0;f<i;f++)u[f]=s*e[r][f]-o*e[n][f],c[f]=o*e[r][f]+s*e[n][f];e[r][r]=d,e[n][n]=h,e[r][n]=0,e[n][r]=0;for(var p=0;p<i;p++)p!==r&&p!==n&&(e[r][p]=u[p],e[p][r]=u[p],e[n][p]=c[p],e[p][n]=c[p]);return e}function b(e){for(var t=e.length,r=0,n=[0,1],i=0;i<t;i++)for(var s=i+1;s<t;s++)Math.abs(r)<Math.abs(e[i][s])&&(r=Math.abs(e[i][s]),n=[i,s]);return[n,r]}function x(e){for(var t=e.length,r=0,n=[0,1],s=0;s<t;s++)for(var o=s+1;o<t;o++)i(r)<i(e[s][o])&&(r=i(e[s][o]),n=[s,o]);return[n,r]}function w(e,t){for(var r=e.length,n=Array(r),s=Array(r),o=0;o<r;o++)s[o]=Array(r);for(var a=0;a<r;a++){for(var l=0,u=e[0],c=0;c<e.length;c++)i(e[c])<i(u)&&(u=e[l=c]);n[a]=e.splice(l,1)[0];for(var d=0;d<r;d++)s[d][a]=t[d][l],t[d].splice(l,1)}return{values:n,vectors:s}}function E(e,t){for(var r=new Array(e),n=0;n<e;n++)r[n]=t;return r}return function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.epsilon,s=arguments.length>3?arguments[3]:void 0;if("number"===s)return function(e,t){for(var r,n=e.length,i=Math.abs(t/n),s=new Array(n),o=0;o<n;o++)s[o]=E(n,0),s[o][o]=1;var a=b(e);for(;Math.abs(a[1])>=Math.abs(i);){var l=a[0][0],u=a[0][1];e=v(e,r=f(e[l][l],e[u][u],e[l][u]),l,u),s=m(s,r,l,u),a=b(e)}for(var c=E(n,0),d=0;d<n;d++)c[d]=e[d][d];return w(Du(c),Du(s))}(e,n);if("BigNumber"===s)return function(e,t){for(var r,n=e.length,s=i(t/n),o=new Array(n),a=0;a<n;a++)o[a]=E(n,0),o[a][a]=1;var l=x(e);for(;i(l[1])>=i(s);){var u=l[0][0],c=l[0][1];e=y(e,r=p(e[u][u],e[c][c],e[u][c]),u,c),o=g(o,r,u,c),l=x(e)}for(var d=E(n,0),h=0;h<n;h++)d[h]=e[h][h];return w(Du(d),Du(o))}(e,n);throw TypeError("Unsupported data type: "+s)}}var mD=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],gD=Mu("eigs",mD,(e=>{var{config:t,typed:r,matrix:n,addScalar:i,subtract:s,equal:o,abs:a,atan:l,cos:u,sin:c,multiplyScalar:d,divideScalar:h,inv:f,bignumber:p,multiply:m,add:g,larger:y,column:v,flatten:b,number:x,complex:w,sqrt:E,diag:S,qr:T,usolve:A,usolveAll:D,im:N,re:C,smaller:k,matrixFromColumns:M,dot:O}=e,_=pD({config:t,addScalar:i,subtract:s,column:v,flatten:b,equal:o,abs:a,atan:l,cos:u,sin:c,multiplyScalar:d,inv:f,bignumber:p,complex:w,multiply:m,add:g}),L=fD({config:t,addScalar:i,subtract:s,multiply:m,multiplyScalar:d,flatten:b,divideScalar:h,sqrt:E,abs:a,bignumber:p,diag:S,qr:T,inv:f,usolve:A,usolveAll:D,equal:o,complex:w,larger:y,smaller:k,matrixFromColumns:M,dot:O});return r("eigs",{Array:function(e){return R(n(e))},"Array, number|BigNumber":function(e,t){return R(n(e),t)},Matrix:function(e){var{values:t,vectors:r}=R(e);return{values:n(t),vectors:n(r)}},"Matrix, number|BigNumber":function(e,t){var{values:r,vectors:i}=R(e,t);return{values:n(r),vectors:n(i)}}});function R(e,r){void 0===r&&(r=t.epsilon);var n=e.size();if(2!==n.length||n[0]!==n[1])throw new RangeError("Matrix must be square (size: "+xc(n)+")");var i=e.toArray(),o=n[0];if(function(e,t,r){for(var n=0;n<t;n++)for(var i=0;i<t;i++)if(y(p(a(N(e[n][i]))),r))return!1;return!0}(i,o,r)&&(function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)e[r][n]=C(e[r][n])}(i,o),function(e,t,r){for(var n=0;n<t;n++)for(var i=n;i<t;i++)if(y(p(a(s(e[n][i],e[i][n]))),r))return!1;return!0}(i,o,r))){var l=I(e,i,o);return _(i,o,r,l)}var u=I(e,i,o);return L(i,o,r,u)}function I(e,t,r){var n=e.datatype();if("number"===n||"BigNumber"===n||"Complex"===n)return n;for(var i=!1,s=!1,o=!1,a=0;a<r;a++)for(var l=0;l<r;l++){var u=t[a][l];if(Bl(u)||jl(u))i=!0;else if(Ul(u))s=!0;else{if(!$l(u))throw TypeError("Unsupported type in Matrix: "+Tu(u));o=!0}}if(s&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var c=0;c<r;c++)for(var d=0;d<r;d++)t[c][d]=w(t[c][d]);return"Complex"}if(s){for(var h=0;h<r;h++)for(var f=0;f<r;f++)t[h][f]=p(t[h][f]);return"BigNumber"}if(i){for(var m=0;m<r;m++)for(var g=0;g<r;g++)t[m][g]=x(t[m][g]);return"number"}throw TypeError("Matrix contains unsupported types only.")}})),yD="median",vD=["typed","add","divide","compare","partitionSelect"],bD=Mu(yD,vD,(e=>{var{typed:t,add:r,divide:n,compare:i,partitionSelect:s}=e;function o(e){try{var t=(e=zc(e.valueOf())).length;if(0===t)throw new Error("Cannot calculate median of an empty array");if(t%2==0){for(var r=t/2-1,n=s(e,r+1),o=e[r],u=0;u<r;++u)i(e[u],o)>0&&(o=e[u]);return l(o,n)}var c=s(e,(t-1)/2);return a(c)}catch(e){throw lf(e,"median")}}var a=t({"number | BigNumber | Complex | Unit":function(e){return e}}),l=t({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(e,t){return n(r(e,t),2)}});return t(yD,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(Hd(e))throw new TypeError("Scalar values expected in function median");return o(e)}})})),xD="kldivergence",wD=["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],ED=Mu(xD,wD,(e=>{var{typed:t,matrix:r,divide:n,sum:i,multiply:s,map:o,dotDivide:a,log:l,isNumeric:u}=e;return t(xD,{"Array, Array":function(e,t){return c(r(e),r(t))},"Matrix, Array":function(e,t){return c(e,r(t))},"Array, Matrix":function(e,t){return c(r(e),t)},"Matrix, Matrix":function(e,t){return c(e,t)}});function c(e,t){var r=t.size().length,c=e.size().length;if(r>1)throw new Error("first object must be one dimensional");if(c>1)throw new Error("second object must be one dimensional");if(r!==c)throw new Error("Length of two vectors must be equal");if(0===i(e))throw new Error("Sum of elements in first object must be non zero");if(0===i(t))throw new Error("Sum of elements in second object must be non zero");var d=n(e,i(e)),h=n(t,i(t)),f=i(s(d,o(a(d,h),(e=>l(e)))));return u(f)?f:Number.NaN}})),SD=["typed","abs","map","median","subtract"],TD=Mu("mad",SD,(e=>{var{typed:t,abs:r,map:n,median:i,subtract:s}=e;return t("mad",{"Array | Matrix":o,"...":function(e){return o(e)}});function o(e){if(0===(e=zc(e.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var t=i(e);return i(n(e,(function(e){return r(s(e,t))})))}catch(e){throw e instanceof TypeError&&-1!==e.message.indexOf("median")?new TypeError(e.message.replace("median","mad")):lf(e,"mad")}}})),AD="freqz",DD=["typed","add","multiply","Complex","divide","matrix"],ND=Mu(AD,DD,(e=>{var{typed:t,add:r,multiply:n,Complex:i,divide:s,matrix:o}=e;return t(AD,{"Array, Array":function(e,t){return a(e,t,l(512))},"Array, Array, Array":function(e,t,r){return a(e,t,r)},"Array, Array, number":function(e,t,r){if(r<0)throw new Error("w must be a positive number");return a(e,t,l(r))},"Matrix, Matrix":function(e,t){var r=l(512),{w:n,h:i}=a(e.valueOf(),t.valueOf(),r);return{w:o(n),h:o(i)}},"Matrix, Matrix, Matrix":function(e,t,r){var{h:n}=a(e.valueOf(),t.valueOf(),r.valueOf());return{h:o(n),w:o(r)}},"Matrix, Matrix, number":function(e,t,r){if(r<0)throw new Error("w must be a positive number");var n=l(r),{h:i}=a(e.valueOf(),t.valueOf(),n);return{h:o(i),w:o(n)}}});function a(e,t,o){for(var a=[],l=[],u=0;u<o.length;u++){for(var c=i(0,0),d=i(0,0),h=0;h<e.length;h++)c=r(c,n(e[h],i(Math.cos(-h*o[u]),Math.sin(-h*o[u]))));for(var f=0;f<t.length;f++)d=r(d,n(t[f],i(Math.cos(-f*o[u]),Math.sin(-f*o[u]))));a.push(c),l.push(d)}for(var p=[],m=0;m<a.length;m++)p.push(s(a[m],l[m]));return{h:p,w:o}}function l(e){for(var t=[],r=0;r<e;r++)t.push(r/e*Math.PI);return t}})),CD="norm",kD=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],MD=Mu(CD,kD,(e=>{var{typed:t,abs:r,add:n,pow:i,conj:s,sqrt:o,multiply:a,equalScalar:l,larger:u,smaller:c,matrix:d,ctranspose:h,eigs:f}=e;return t(CD,{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},boolean:function(e){return Math.abs(e)},Array:function(e){return g(d(e),2)},Matrix:function(e){return g(e,2)},"Array, number | BigNumber | string":function(e,t){return g(d(e),t)},"Matrix, number | BigNumber | string":function(e,t){return g(e,t)}});function p(e,t){if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=0;return e.forEach((function(e){var n=r(e);u(n,t)&&(t=n)}),!0),t}(e);if(t===Number.NEGATIVE_INFINITY||"-inf"===t)return function(e){var t;return e.forEach((function(e){var n=r(e);t&&!c(n,t)||(t=n)}),!0),t||0}(e);if("fro"===t)return g(e,2);if("number"==typeof t&&!isNaN(t)){if(!l(t,0)){var s=0;return e.forEach((function(e){s=n(i(r(e),t),s)}),!0),i(s,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function m(e,t){if(1===t)return function(e){var t=[],i=0;return e.forEach((function(e,s){var o=s[1],a=n(t[o]||0,r(e));u(a,i)&&(i=a),t[o]=a}),!0),i}(e);if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=[],i=0;return e.forEach((function(e,s){var o=s[0],a=n(t[o]||0,r(e));u(a,i)&&(i=a),t[o]=a}),!0),i}(e);if("fro"===t)return function(e){var t=0;return e.forEach((function(e,r){t=n(t,a(e,s(e)))})),r(o(t))}(e);if(2===t)return function(e){var t=e.size();if(t[0]!==t[1])throw new RangeError("Invalid matrix dimensions");var n=h(e),i=a(n,e),s=f(i).values.toArray(),l=s[s.length-1];return r(o(l))}(e);throw new Error("Unsupported parameter value "+t)}function g(e,t){var r=e.size();if(1===r.length)return p(e,t);if(2===r.length){if(r[0]&&r[1])return m(e,t);throw new RangeError("Invalid matrix dimensions")}}})),OD="rotationMatrix",_D=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],LD=Mu(OD,_D,(e=>{var{typed:t,config:r,multiplyScalar:n,addScalar:i,unaryMinus:s,norm:o,BigNumber:a,matrix:l,DenseMatrix:u,SparseMatrix:c,cos:d,sin:h}=e;return t(OD,{"":function(){return"Matrix"===r.matrix?l([]):[]},string:function(e){return l(e)},"number | BigNumber | Complex | Unit":function(e){return f(e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(e,t){return f(e,t)},"number | BigNumber | Complex | Unit, Array":function(e,t){var r=l(t);return p(r),y(e,r,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(e,t){p(t);var n=t.storage()||("Matrix"===r.matrix?"dense":void 0);return y(e,t,n)},"number | BigNumber | Complex | Unit, Array, string":function(e,t,r){var n=l(t);return p(n),y(e,n,r)},"number | BigNumber | Complex | Unit, Matrix, string":function(e,t,r){return p(t),y(e,t,r)}});function f(e,t){var r=Ul(e)?new a(-1):-1,i=d(e),s=h(e);return g([[i,n(r,s)],[s,i]],t)}function p(e){var t=e.size();if(t.length<1||3!==t[0])throw new RangeError("Vector must be of dimensions 1x3")}function m(e){return e.reduce(((e,t)=>n(e,t)))}function g(e,t){if(t){if("sparse"===t)return new c(e);if("dense"===t)return new u(e);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}return e}function y(e,t,r){var n=o(t);if(0===n)throw new RangeError("Rotation around zero vector");var l=Ul(e)?a:null,u=l?new l(1):1,c=l?new l(-1):-1,f=l?new l(t.get([0])/n):t.get([0])/n,p=l?new l(t.get([1])/n):t.get([1])/n,y=l?new l(t.get([2])/n):t.get([2])/n,v=d(e),b=i(u,s(v)),x=h(e);return g([[i(v,m([f,f,b])),i(m([f,p,b]),m([c,y,x])),i(m([f,y,b]),m([p,x]))],[i(m([f,p,b]),m([y,x])),i(v,m([p,p,b])),i(m([p,y,b]),m([c,f,x]))],[i(m([f,y,b]),m([c,p,x])),i(m([p,y,b]),m([f,x])),i(v,m([y,y,b]))]],r)}})),RD="schur",ID=["typed","matrix","identity","multiply","qr","norm","subtract"],FD=Mu(RD,ID,(e=>{var{typed:t,matrix:r,identity:n,multiply:i,qr:s,norm:o,subtract:a}=e;return t(RD,{Array:function(e){var t=l(r(e));return{U:t.U.valueOf(),T:t.T.valueOf()}},Matrix:function(e){return l(e)}});function l(e){var t,r=e.size()[0],l=e,u=n(r),c=0;do{t=l;var d=s(l),h=d.Q,f=d.R;if(l=i(f,h),u=i(u,h),c++>100)break}while(o(a(l,t))>1e-4);return{U:u,T:l}}})),PD="rotate",BD=["typed","multiply","rotationMatrix"],UD=Mu(PD,BD,(e=>{var{typed:t,multiply:r,rotationMatrix:n}=e;return t(PD,{"Array , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),r(n(t),e).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),r(n(t),e)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,s){return i(e,3),r(n(t,s),e)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,s){return i(e,3),r(n(t,s),e)}});function i(e,t){var r=Array.isArray(e)?kc(e):e.size();if(r.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(t));if(2===r.length&&1!==r[1])throw new RangeError("Vector must be of dimensions 1x".concat(t));if(r[0]!==t)throw new RangeError("Vector must be of dimensions 1x".concat(t))}})),$D="sylvester",jD=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],zD=Mu($D,jD,(e=>{var{typed:t,schur:r,matrixFromColumns:n,matrix:i,multiply:s,range:o,concat:a,transpose:l,index:u,subset:c,add:d,subtract:h,identity:f,lusolve:p,abs:m}=e;return t($D,{"Matrix, Matrix, Matrix":g,"Array, Matrix, Matrix":function(e,t,r){return g(i(e),t,r)},"Array, Array, Matrix":function(e,t,r){return g(i(e),i(t),r)},"Array, Matrix, Array":function(e,t,r){return g(i(e),t,i(r))},"Matrix, Array, Matrix":function(e,t,r){return g(e,i(t),r)},"Matrix, Array, Array":function(e,t,r){return g(e,i(t),i(r))},"Matrix, Matrix, Array":function(e,t,r){return g(e,t,i(r))},"Array, Array, Array":function(e,t,r){return g(i(e),i(t),i(r)).toArray()}});function g(e,t,g){for(var y=t.size()[0],v=e.size()[0],b=r(e),x=b.T,w=b.U,E=r(s(-1,t)),S=E.T,T=E.U,A=s(s(l(w),g),T),D=o(0,v),N=[],C=(e,t)=>a(e,t,1),k=(e,t)=>a(e,t,0),M=0;M<y;M++)if(M<y-1&&m(c(S,u(M+1,M)))>1e-5){for(var O=k(c(A,u(D,M)),c(A,u(D,M+1))),_=0;_<M;_++)O=d(O,k(s(N[_],c(S,u(_,M))),s(N[_],c(S,u(_,M+1)))));var L=s(f(v),s(-1,c(S,u(M,M)))),R=s(f(v),s(-1,c(S,u(M+1,M)))),I=s(f(v),s(-1,c(S,u(M,M+1)))),F=s(f(v),s(-1,c(S,u(M+1,M+1)))),P=k(C(d(x,L),R),C(I,d(x,F))),B=p(P,O);N[M]=B.subset(u(o(0,v),0)),N[M+1]=B.subset(u(o(v,2*v),0)),M++}else{for(var U=c(A,u(D,M)),$=0;$<M;$++)U=d(U,s(N[$],c(S,u($,M))));var j=c(S,u(M,M)),z=h(x,s(j,f(v)));N[M]=p(z,U)}var q=i(n(...N));return s(w,s(q,l(T)))}})),qD="lyap",HD=["typed","matrix","sylvester","multiply","transpose"],VD=Mu(qD,HD,(e=>{var{typed:t,matrix:r,sylvester:n,multiply:i,transpose:s}=e;return t(qD,{"Matrix, Matrix":function(e,t){return n(e,s(e),i(-1,t))},"Array, Matrix":function(e,t){return n(r(e),s(r(e)),i(-1,t))},"Matrix, Array":function(e,t){return n(e,s(r(e)),r(i(-1,t)))},"Array, Array":function(e,t){return n(r(e),s(r(e)),r(i(-1,t))).toArray()}})})),GD=Cm({config:Pl}),WD=Mm({}),KD=Ym({BigNumber:GD,config:Pl}),YD=qm({}),JD=Ag({BigNumber:GD,config:Pl}),ZD=sy({}),XD=ng({Complex:WD}),QD=Vm({BigNumber:GD,config:Pl}),eN=Xm({BigNumber:GD,config:Pl}),tN=eg({BigNumber:GD,config:Pl}),rN=oy({}),nN=Gm({BigNumber:GD,config:Pl}),iN=Hm({}),sN=Jm({BigNumber:GD,config:Pl}),oN=ay({}),aN=ly({}),lN=tg({BigNumber:GD,config:Pl}),uN=Hg({BigNumber:GD,config:Pl}),cN=Km({BigNumber:GD,config:Pl}),dN=zm({}),hN=ig({}),fN=uy({Matrix:rN}),pN=Rg({BigNumber:GD,config:Pl}),mN=Zm({BigNumber:GD,config:Pl}),gN=Wm({BigNumber:GD,config:Pl}),yN=cy({}),vN=rg({BigNumber:GD,config:Pl}),bN=hy({BigNumber:GD,Complex:WD,DenseMatrix:fN,Fraction:ZD}),xN=Uy({BigNumber:GD,config:Pl,typed:bN}),wN=Lg({BigNumber:GD,config:Pl}),EN=$y({typed:bN}),SN=zy({Complex:WD,config:Pl,typed:bN}),TN=av({BigNumber:GD,typed:bN}),AN=uv({BigNumber:GD,Complex:WD,config:Pl,typed:bN}),DN=dv({typed:bN}),NN=hv({typed:bN}),CN=pv({BigNumber:GD,Complex:WD,config:Pl,typed:bN}),kN=mv({typed:bN}),MN=gv({typed:bN}),ON=vv({Complex:WD,config:Pl,typed:bN}),_N=bv({BigNumber:GD,typed:bN}),LN=Pv({typed:bN}),RN=Uv({typed:bN}),IN=jv({typed:bN}),FN=Vv({typed:bN}),PN=Wv({Complex:WD,typed:bN}),BN=Yv({typed:bN}),UN=Zv({typed:bN}),$N=Qv({BigNumber:GD,typed:bN}),jN=tb({BigNumber:GD,typed:bN}),zN=nb({typed:bN}),qN=ab({config:Pl,typed:bN}),HN=lb({typed:bN}),VN=pb({typed:bN}),GN=gb({Complex:WD,typed:bN}),WN=yb({typed:bN}),KN=xb({typed:bN}),YN=Sb({typed:bN}),JN=Ab({typed:bN}),ZN=Db({format:YN,typed:bN}),XN=Nb({typed:bN}),QN=kb({typed:bN}),eC=Fb({typed:bN}),tC=Bb({typed:bN}),rC=$b({typed:bN}),nC=Qm({BigNumber:GD,config:Pl}),iC=Kb({Complex:WD,typed:bN}),sC=Jb({Complex:WD,config:Pl,typed:bN}),oC=Xb({Complex:WD,config:Pl,typed:bN}),aC=Qb({typed:bN}),lC=tx({typed:bN}),uC=ax({typed:bN}),cC=lx({typed:bN}),dC=ux({format:YN,typed:bN}),hC=px({config:Pl,typed:bN}),fC=gx({typed:bN}),pC=xx({config:Pl,typed:bN}),mC=wx({typed:bN}),gC=Ex({BigNumber:GD,typed:bN}),yC=Tx({BigNumber:GD,Fraction:ZD,complex:PN,typed:bN}),vC=Ax({typed:bN}),bC=Dx({Matrix:rN,equalScalar:qN,typed:bN}),xC=Cx({typed:bN}),wC=Mx({typed:bN}),EC=_x({typed:bN}),SC=Lx({typed:bN}),TC=Ix({typed:bN}),AC=Px({Complex:WD,config:Pl,typed:bN}),DC=Ux({BigNumber:GD,typed:bN}),NC=Wh({isInteger:QN,typed:bN}),CC=jx({BigNumber:GD,Complex:WD,config:Pl,typed:bN}),kC=zx({format:YN,typed:bN}),MC=Hx({typed:bN}),OC=Gx({typed:bN}),_C=Kx({BigNumber:GD,typed:bN}),LC=Jx({typed:bN}),RC=Xx({typed:bN}),IC=ew({config:Pl,typed:bN}),FC=rw({BigNumber:GD,typed:bN}),PC=iw({typed:bN}),BC=ow({SparseMatrix:bC,typed:bN}),UC=aw({Complex:WD,config:Pl,typed:bN}),$C=lw({typed:bN}),jC=cw({typed:bN}),zC=hw({BigNumber:GD,Complex:WD,config:Pl,typed:bN}),qC=fw({BigNumber:GD,typed:bN}),HC=pw({Fraction:ZD,typed:bN}),VC=gw({typed:bN}),GC=vw({DenseMatrix:fN,Matrix:rN,SparseMatrix:bC,typed:bN}),WC=xw({isZero:rC,matrix:GC,typed:bN}),KC=Ew({isNaN:LC,isNumeric:VC,typed:bN}),YC=Sw({bignumber:_N,fraction:HC,number:cC}),JC=Aw({config:Pl,multiplyScalar:lC,numeric:YC,typed:bN}),ZC=Nw({isInteger:QN,matrix:GC,typed:bN}),XC=kw({matrix:GC,config:Pl,typed:bN}),QC=Ow({matrix:GC,typed:bN}),ek=Zh({matrix:GC,typed:bN}),tk=Lw({matrix:GC,typed:bN}),rk=Iw({BigNumber:GD,config:Pl,matrix:GC,typed:bN}),nk=Pw({BigNumber:GD,config:Pl,matrix:GC,typed:bN}),ik=Uw({Complex:WD,config:Pl,typed:bN}),sk=jw({BigNumber:GD,Complex:WD,Fraction:ZD,config:Pl,isNegative:eC,matrix:GC,typed:bN,unaryMinus:jC}),ok=sf({isInteger:QN,matrix:GC,typed:bN}),ak=qw({prod:JC,size:XC,typed:bN}),lk=Vw({conj:BN,transpose:tk,typed:bN}),uk=Ww({DenseMatrix:fN,SparseMatrix:bC,matrix:GC,typed:bN}),ck=Yw({numeric:YC,typed:bN}),dk=oE({DenseMatrix:fN,concat:ok,divideScalar:ck,equalScalar:qN,matrix:GC,typed:bN}),hk=lE({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),fk=dE({matrix:GC,typed:bN}),pk=xE({BigNumber:GD,DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),mk=EE({isNumeric:VC,typed:bN}),gk=TE({BigNumber:GD,DenseMatrix:fN,SparseMatrix:bC,config:Pl,matrix:GC,typed:bN}),yk=DE({matrix:GC,multiplyScalar:lC,typed:bN}),vk=CE({DenseMatrix:fN,concat:ok,config:Pl,matrix:GC,typed:bN}),bk=LE({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN,zeros:nk}),xk=IE({flatten:fk,matrix:GC,size:XC,typed:bN}),wk=PE({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),Ek=$E({BigNumber:GD,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),Sk=jE({BigNumber:GD,config:Pl,matrix:GC,typed:bN}),Tk=zE({config:Pl,matrix:GC}),Ak=HE({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN,zeros:nk}),Dk=WE({BigNumber:GD,DenseMatrix:fN,equalScalar:qN,matrix:GC,typed:bN,zeros:nk}),Nk=YE({DenseMatrix:fN,concat:ok,config:Pl,matrix:GC,typed:bN}),Ck=ZE({concat:ok,matrix:GC,typed:bN}),kk=QE({DenseMatrix:fN,concat:ok,config:Pl,equalScalar:qN,matrix:GC,typed:bN}),Mk=tS({DenseMatrix:fN,concat:ok,matrix:GC,typed:bN}),Ok=rS({DenseMatrix:fN,SparseMatrix:bC,addScalar:DN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),_k=iS({concat:ok,equalScalar:qN,matrix:GC,typed:bN}),Lk=oS({DenseMatrix:fN,concat:ok,matrix:GC,typed:bN}),Rk=lS({addScalar:DN,combinations:FN,divideScalar:ck,isInteger:QN,isNegative:eC,multiplyScalar:lC,typed:bN}),Ik=cS({BigNumber:GD,DenseMatrix:fN,Fraction:ZD,concat:ok,config:Pl,equalScalar:qN,matrix:GC,typed:bN}),Fk=pS({concat:ok,matrix:GC,typed:bN}),Pk=bf({add:Ok,typed:bN,unaryPlus:xN}),Bk=gS({equal:hk,typed:bN}),Uk=yS({addScalar:DN,conj:BN,multiplyScalar:lC,size:XC,typed:bN}),$k=bS({compareText:Fk,isZero:rC,typed:bN}),jk=SS({DenseMatrix:fN,config:Pl,equalScalar:qN,matrix:GC,round:Dk,typed:bN,zeros:nk}),zk=AS({abs:EN,addScalar:DN,divideScalar:ck,isPositive:tC,multiplyScalar:lC,smaller:Nk,sqrt:UC,typed:bN}),qk=DS({DenseMatrix:fN,smaller:Nk}),Hk=NS({ImmutableDenseMatrix:qk}),Vk=kS({BigNumber:GD,add:Ok,config:Pl,equal:hk,isInteger:QN,mod:wk,smaller:Nk,typed:bN,xgcd:rk}),Gk=OS({DenseMatrix:fN,concat:ok,config:Pl,matrix:GC,typed:bN}),Wk=LS({Complex:WD,config:Pl,divideScalar:ck,typed:bN}),Kk=IS({flatten:fk,matrix:GC,size:XC,typed:bN}),Yk=gf({config:Pl,numeric:YC,smaller:Nk,typed:bN}),Jk=PS({addScalar:DN,dot:Uk,equalScalar:qN,matrix:GC,multiplyScalar:lC,typed:bN}),Zk=US({Complex:WD,config:Pl,divideScalar:ck,typed:bN}),Xk=$S({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),Qk=zS({compare:Ik,isNaN:LC,isNumeric:VC,typed:bN}),eM=qS({add:Ok,compare:Ik,multiply:Jk,partitionSelect:Qk,typed:bN}),tM=VS({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN,zeros:nk}),rM=WS({DenseMatrix:fN,concat:ok,config:Pl,matrix:GC,typed:bN}),nM=JS({DenseMatrix:fN,addScalar:DN,concat:ok,equalScalar:qN,matrix:GC,typed:bN,unaryMinus:jC}),iM=ZS({add:Ok,matrix:GC,typed:bN}),sM=eT({DenseMatrix:fN,divideScalar:ck,equalScalar:qN,matrix:GC,multiplyScalar:lC,subtract:nM,typed:bN}),oM=rT({Complex:WD,add:Ok,multiply:Jk,number:cC,typed:bN}),aM=nT({concat:ok,equalScalar:qN,matrix:GC,not:uC,typed:bN,zeros:nk}),lM=sT({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),uM=uT({DenseMatrix:fN,config:Pl,equalScalar:qN,matrix:GC,round:Dk,typed:bN,zeros:nk}),cM=hT({compare:Ik,typed:bN}),dM=pT({addScalar:DN,combinations:FN,isInteger:QN,isNegative:eC,isPositive:tC,larger:Gk,typed:bN}),hM=gT({matrix:GC,multiply:Jk,subtract:nM,typed:bN}),fM=yT({divideScalar:ck,isZero:rC,matrix:GC,multiply:Jk,subtract:nM,typed:bN,unaryMinus:jC}),pM=Sf({matrix:GC,number:cC,subtract:nM,typed:bN}),mM=bT({abs:EN,addScalar:DN,deepEqual:Bk,divideScalar:ck,multiplyScalar:lC,sqrt:UC,subtract:nM,typed:bN}),gM=ET({concat:ok,equalScalar:qN,matrix:GC,multiplyScalar:lC,typed:bN}),yM=ST({larger:Gk,smaller:Nk}),vM=NT({Complex:WD,DenseMatrix:fN,ceil:uM,equalScalar:qN,floor:jk,matrix:GC,typed:bN,zeros:nk}),bM=kT({Index:Hk,typed:bN}),xM=MT({abs:EN,add:Ok,addScalar:DN,config:Pl,divideScalar:ck,equalScalar:qN,flatten:fk,isNumeric:VC,isZero:rC,matrix:GC,multiply:Jk,multiplyScalar:lC,smaller:Nk,subtract:nM,typed:bN}),wM=OT({concat:ok,equalScalar:qN,matrix:GC,typed:bN}),EM=LT({Complex:WD,config:Pl,divideScalar:ck,log:Wk,typed:bN}),SM=IT({DenseMatrix:fN,divideScalar:ck,equalScalar:qN,matrix:GC,multiplyScalar:lC,subtract:nM,typed:bN}),TM=uf({config:Pl,larger:Gk,numeric:YC,typed:bN}),AM=FT({addScalar:DN,complex:PN,conj:BN,divideScalar:ck,equal:hk,identity:gk,isZero:rC,matrix:GC,multiplyScalar:lC,sign:yC,sqrt:UC,subtract:nM,typed:bN,unaryMinus:jC,zeros:nk}),DM=Cf({bignumber:_N,matrix:GC,add:Ok,config:Pl,isPositive:tC,larger:Gk,largerEq:vk,smaller:Nk,smallerEq:rM,typed:bN}),NM=Mf({Index:Hk,matrix:GC,range:DM,typed:bN}),CM=BT({DenseMatrix:fN,Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),kM=$T({DenseMatrix:fN,Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),MM=zT({Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),OM=HT({Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),_M=nA({SparseMatrix:bC,abs:EN,add:Ok,divideScalar:ck,larger:Gk,largerEq:vk,multiply:Jk,subtract:nM,transpose:tk,typed:bN}),LM=sA({compare:Ik,compareNatural:cM,matrix:GC,typed:bN}),RM=pf({add:Ok,config:Pl,numeric:YC,typed:bN}),IM=aA({DenseMatrix:fN,divideScalar:ck,equalScalar:qN,matrix:GC,multiplyScalar:lC,subtract:nM,typed:bN}),FM=uA({BigNumber:GD,DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,typed:bN}),PM=Lf({Index:Hk,matrix:GC,range:DM,typed:bN}),BM=dA({DenseMatrix:fN,divideScalar:ck,equalScalar:qN,matrix:GC,multiplyScalar:lC,subtract:nM,typed:bN}),UM=fA({DenseMatrix:fN,Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),$M=mA({Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),jM=yA({Index:Hk,concat:ok,setDifference:UM,size:XC,subset:ek,typed:bN}),zM=vA({FibonacciHeap:yM,addScalar:DN,equalScalar:qN}),qM=bA({abs:EN,addScalar:DN,det:fM,divideScalar:ck,identity:gk,matrix:GC,multiply:Jk,typed:bN,unaryMinus:jC}),HM=xA({DenseMatrix:fN,Spa:zM,SparseMatrix:bC,abs:EN,addScalar:DN,divideScalar:ck,equalScalar:qN,larger:Gk,matrix:GC,multiplyScalar:lC,subtract:nM,typed:bN,unaryMinus:jC}),VM=EA({Complex:WD,add:Ok,ctranspose:lk,deepEqual:Bk,divideScalar:ck,dot:Uk,dotDivide:dk,equal:hk,inv:qM,matrix:GC,multiply:Jk,typed:bN}),GM=SA({Complex:WD,config:Pl,fraction:HC,identity:gk,inv:qM,matrix:GC,multiply:Jk,number:cC,typed:bN}),WM=AA({DenseMatrix:fN,Index:Hk,compareNatural:cM,size:XC,subset:ek,typed:bN}),KM=NA({Index:Hk,concat:ok,setIntersect:WM,setSymDifference:jM,size:XC,subset:ek,typed:bN}),YM=kA({abs:EN,add:Ok,identity:gk,inv:qM,map:aC,max:TM,multiply:Jk,size:XC,sqrt:UC,subtract:nM,typed:bN}),JM=_A({BigNumber:GD,Complex:WD,Fraction:ZD,abs:EN,addScalar:DN,config:Pl,divideScalar:ck,equal:hk,fix:vM,format:YN,isNumeric:VC,multiplyScalar:lC,number:cC,pow:GM,round:Dk,subtract:nM}),ZM=hg({BigNumber:GD,Unit:JM,config:Pl}),XM=Wg({BigNumber:GD,Unit:JM,config:Pl}),QM=Ig({BigNumber:GD,Unit:JM,config:Pl}),eO=mg({BigNumber:GD,Unit:JM,config:Pl}),tO=Pg({BigNumber:GD,Unit:JM,config:Pl}),rO=gg({BigNumber:GD,Unit:JM,config:Pl}),nO=RA({Unit:JM,typed:bN}),iO=Cg({BigNumber:GD,Unit:JM,config:Pl}),sO=FA({DenseMatrix:fN,concat:ok,equalScalar:qN,matrix:GC,pow:GM,typed:bN}),oO=dg({BigNumber:GD,Unit:JM,config:Pl}),aO=pg({BigNumber:GD,Unit:JM,config:Pl}),lO=BA({abs:EN,add:Ok,identity:gk,inv:qM,multiply:Jk,typed:bN}),uO=Bg({BigNumber:GD,Unit:JM,config:Pl}),cO=UA({addScalar:DN,ceil:uM,conj:BN,divideScalar:ck,dotDivide:dk,exp:VN,i:XD,log2:oC,matrix:GC,multiplyScalar:lC,pow:GM,tau:cN,typed:bN}),dO=jA({BigNumber:GD,Complex:WD,config:Pl,multiplyScalar:lC,pow:GM,typed:bN}),hO=ag({BigNumber:GD,Unit:JM,config:Pl}),fO=Dg({BigNumber:GD,Unit:JM,config:Pl}),pO=qA({conj:BN,dotDivide:dk,fft:cO,typed:bN}),mO=xg({BigNumber:GD,Unit:JM,config:Pl}),gO=$g({BigNumber:GD,Unit:JM,config:Pl}),yO=cg({BigNumber:GD,Unit:JM,config:Pl}),vO=Kg({BigNumber:GD,Unit:JM,config:Pl}),bO=zg({BigNumber:GD,Unit:JM,config:Pl}),xO=kg({BigNumber:GD,Unit:JM,config:Pl}),wO=bg({BigNumber:GD,Unit:JM,config:Pl}),EO=ey({BigNumber:GD,Unit:JM,config:Pl}),SO=Zg({BigNumber:GD,Unit:JM,config:Pl}),TO=ty({BigNumber:GD,Unit:JM,config:Pl}),AO=Ng({BigNumber:GD,Unit:JM,config:Pl}),DO=ug({BigNumber:GD,Unit:JM,config:Pl}),NO=Og({BigNumber:GD,Unit:JM,config:Pl}),CO=Vg({BigNumber:GD,Unit:JM,config:Pl}),kO=og({BigNumber:GD,Unit:JM,config:Pl}),MO=Gg({BigNumber:GD,Unit:JM,config:Pl}),OO=_g({BigNumber:GD,Unit:JM,config:Pl}),_O=Fg({BigNumber:GD,Unit:JM,config:Pl}),LO=wg({BigNumber:GD,Unit:JM,config:Pl}),RO=fg({BigNumber:GD,Unit:JM,config:Pl}),IO=HA({divideScalar:ck,equalScalar:qN,inv:qM,matrix:GC,multiply:Jk,typed:bN}),FO=Sg({BigNumber:GD,Unit:JM,config:Pl}),PO=GA({gamma:dO,typed:bN}),BO=Ug({BigNumber:GD,Unit:JM,config:Pl}),UO=Jg({BigNumber:GD,Unit:JM,config:Pl}),$O=yg({BigNumber:GD,Unit:JM,config:Pl}),jO=YA({DenseMatrix:fN,lsolve:SM,lup:HM,matrix:GC,slu:_M,typed:bN,usolve:sM}),zO=vg({BigNumber:GD,Unit:JM,config:Pl}),qO=Yg({BigNumber:GD,Unit:JM,config:Pl}),HO=ZA({add:Ok,divide:IO,factorial:PO,isInteger:QN,isPositive:tC,multiply:Jk,typed:bN}),VO=QA({factorial:PO,typed:bN}),GO=Xg({BigNumber:GD,Unit:JM,config:Pl}),WO=rD({add:Ok,cbrt:sk,divide:IO,equalScalar:qN,im:XN,isZero:rC,multiply:Jk,re:mC,sqrt:UC,subtract:nM,typeOf:TC,typed:bN,unaryMinus:jC}),KO=iD({compareNatural:cM,typed:bN}),YO=oD({abs:EN,add:Ok,bignumber:_N,divide:IO,isNegative:eC,isPositive:tC,larger:Gk,map:aC,matrix:GC,max:TM,multiply:Jk,smaller:Nk,subtract:nM,typed:bN,unaryMinus:jC}),JO=lD({bignumber:_N,addScalar:DN,combinations:FN,divideScalar:ck,factorial:PO,isInteger:QN,isNegative:eC,larger:Gk,multiplyScalar:lC,number:cC,pow:GM,subtract:nM,typed:bN}),ZO=cD({Unit:JM,typed:bN}),XO=hD({addScalar:DN,isInteger:QN,isNegative:eC,stirlingS2:JO,typed:bN}),QO=gD({abs:EN,add:Ok,addScalar:DN,atan:MN,bignumber:_N,column:PM,complex:PN,config:Pl,cos:OC,diag:uk,divideScalar:ck,dot:Uk,equal:hk,flatten:fk,im:XN,inv:qM,larger:Gk,matrix:GC,matrixFromColumns:xk,multiply:Jk,multiplyScalar:lC,number:cC,qr:AM,re:mC,sin:vC,smaller:Nk,sqrt:UC,subtract:nM,typed:bN,usolve:sM,usolveAll:IM}),e_=Tg({BigNumber:GD,Unit:JM,config:Pl}),t_=jg({BigNumber:GD,Unit:JM,config:Pl}),r_=Ff({add:Ok,divide:IO,typed:bN}),n_=qg({BigNumber:GD,Unit:JM,config:Pl}),i_=lg({BigNumber:GD,Unit:JM,config:Pl}),s_=Mg({BigNumber:GD,Unit:JM,config:Pl}),o_=$f({add:Ok,apply:NC,divide:IO,isNaN:LC,multiply:Jk,subtract:nM,typed:bN}),a_=Eg({BigNumber:GD,Unit:JM,config:Pl}),l_=bD({add:Ok,compare:Ik,divide:IO,partitionSelect:Qk,typed:bN}),u_=ED({divide:IO,dotDivide:dk,isNumeric:VC,log:Wk,map:aC,matrix:GC,multiply:Jk,sum:RM,typed:bN}),c_=TD({abs:EN,map:aC,median:l_,subtract:nM,typed:bN}),d_=qf({map:aC,sqrt:UC,typed:bN,variance:o_}),h_=ND({Complex:WD,add:Ok,divide:IO,matrix:GC,multiply:Jk,typed:bN}),f_=MD({abs:EN,add:Ok,conj:BN,ctranspose:lk,eigs:QO,equalScalar:qN,larger:Gk,matrix:GC,multiply:Jk,pow:GM,smaller:Nk,sqrt:UC,typed:bN}),p_=LD({BigNumber:GD,DenseMatrix:fN,SparseMatrix:bC,addScalar:DN,config:Pl,cos:OC,matrix:GC,multiplyScalar:lC,norm:f_,sin:vC,typed:bN,unaryMinus:jC}),m_=Qg({BigNumber:GD,Unit:JM,config:Pl}),g_=FD({identity:gk,matrix:GC,multiply:Jk,norm:f_,qr:AM,subtract:nM,typed:bN}),y_=UD({multiply:Jk,rotationMatrix:p_,typed:bN}),v_=zD({abs:EN,add:Ok,concat:ok,identity:gk,index:bM,lusolve:jO,matrix:GC,matrixFromColumns:xk,multiply:Jk,range:DM,schur:g_,subset:ek,subtract:nM,transpose:tk,typed:bN}),b_=VD({matrix:GC,multiply:Jk,sylvester:v_,transpose:tk,typed:bN}),x_={},w_={},E_={},S_=Hu({mathWithTransform:w_}),T_=Dc({Node:S_}),A_=cd({Node:S_}),D_=hd({Node:S_}),N_=pd({Node:S_}),C_=gd({Node:S_}),k_=vd({Node:S_,ResultSet:aN}),M_=xd({Node:S_}),O_=Ed({Node:S_}),__=Td({Node:S_}),L_=Ad({classes:E_}),R_=Dd({math:x_,typed:bN}),I_=Cd({Node:S_,typed:bN}),F_=Md({Chain:R_,typed:bN}),P_=Rd({Node:S_,subset:ek}),B_=Fd({Node:S_,size:XC}),U_=Bd({matrix:GC,Node:S_,subset:ek}),$_=Ud({Unit:JM,Node:S_,math:x_}),j_=zd({Node:S_,SymbolNode:$_,math:x_}),z_=Zd({AccessorNode:P_,ArrayNode:C_,AssignmentNode:U_,BlockNode:k_,ConditionalNode:M_,ConstantNode:O_,FunctionAssignmentNode:I_,FunctionNode:j_,IndexNode:B_,ObjectNode:T_,OperatorNode:A_,ParenthesisNode:D_,RangeNode:__,RelationalNode:N_,SymbolNode:$_,config:Pl,numeric:YC,typed:bN}),q_=Xd({ConstantNode:O_,FunctionNode:j_,OperatorNode:A_,ParenthesisNode:D_,parse:z_,typed:bN}),H_=oh({bignumber:_N,fraction:HC,AccessorNode:P_,ArrayNode:C_,ConstantNode:O_,FunctionNode:j_,IndexNode:B_,ObjectNode:T_,OperatorNode:A_,SymbolNode:$_,config:Pl,mathWithTransform:w_,matrix:GC,typed:bN}),V_=uh({parse:z_,typed:bN}),G_=dh({parse:z_}),W_=ph({parse:z_,typed:bN}),K_=yh({AccessorNode:P_,ArrayNode:C_,ConstantNode:O_,FunctionNode:j_,IndexNode:B_,ObjectNode:T_,OperatorNode:A_,ParenthesisNode:D_,SymbolNode:$_,add:Ok,divide:IO,equal:hk,isZero:rC,multiply:Jk,parse:z_,pow:GM,subtract:nM,typed:bN}),Y_=xh({parse:z_,typed:bN}),J_=Ah({Help:G_,mathWithTransform:w_,typed:bN}),Z_=Dh({evaluate:Y_}),X_=kh({bignumber:_N,fraction:HC,AccessorNode:P_,ArrayNode:C_,ConstantNode:O_,FunctionNode:j_,IndexNode:B_,ObjectNode:T_,OperatorNode:A_,ParenthesisNode:D_,SymbolNode:$_,add:Ok,config:Pl,divide:IO,equal:hk,isZero:rC,mathWithTransform:w_,matrix:GC,multiply:Jk,parse:z_,pow:GM,resolve:q_,simplifyConstant:H_,simplifyCore:K_,subtract:nM,typed:bN}),Q_=Oh({OperatorNode:A_,parse:z_,simplify:X_,typed:bN}),eL=Lh({ConstantNode:O_,FunctionNode:j_,OperatorNode:A_,ParenthesisNode:D_,SymbolNode:$_,config:Pl,equal:hk,isZero:rC,numeric:YC,parse:z_,simplify:X_,typed:bN}),tL=Ih({Parser:Z_,typed:bN}),rL=Ph({bignumber:_N,fraction:HC,AccessorNode:P_,ArrayNode:C_,ConstantNode:O_,FunctionNode:j_,IndexNode:B_,ObjectNode:T_,OperatorNode:A_,ParenthesisNode:D_,SymbolNode:$_,add:Ok,config:Pl,divide:IO,equal:hk,isZero:rC,mathWithTransform:w_,matrix:GC,multiply:Jk,parse:z_,pow:GM,simplify:X_,simplifyConstant:H_,simplifyCore:K_,subtract:nM,typed:bN});Ll(x_,{e:KD,false:YD,fineStructure:JD,i:XD,Infinity:QD,LN10:eN,LOG10E:tN,NaN:nN,null:iN,phi:sN,SQRT1_2:lN,sackurTetrode:uN,tau:cN,true:dN,E:KD,version:hN,efimovFactor:pN,LN2:mN,pi:gN,replacer:yN,reviver:L_,SQRT2:vN,typed:bN,unaryPlus:xN,PI:gN,weakMixingAngle:wN,abs:EN,acos:SN,acot:TN,acsc:AN,addScalar:DN,arg:NN,asech:CN,asinh:kN,atan:MN,atanh:ON,bignumber:_N,bitNot:LN,boolean:RN,clone:IN,combinations:FN,complex:PN,conj:BN,cosh:UN,coth:$N,csc:jN,cube:zN,equalScalar:qN,erf:HN,exp:VN,expm1:GN,filter:WN,forEach:KN,format:YN,getMatrixDataType:JN,hex:ZN,im:XN,isInteger:QN,isNegative:eC,isPositive:tC,isZero:rC,LOG2E:nC,lgamma:iC,log10:sC,log2:oC,map:aC,multiplyScalar:lC,not:uC,number:cC,oct:dC,pickRandom:hC,print:fC,random:pC,re:mC,sec:gC,sign:yC,sin:vC,splitUnit:xC,square:wC,string:EC,tan:SC,typeOf:TC,acosh:AC,acsch:DC,apply:NC,asec:CC,bin:kC,chain:F_,combinationsWithRep:MC,cos:OC,csch:_C,isNaN:LC,isPrime:RC,randomInt:IC,sech:FC,sinh:PC,sparse:BC,sqrt:UC,tanh:$C,unaryMinus:jC,acoth:zC,cot:qC,fraction:HC,isNumeric:VC,matrix:GC,matrixFromFunction:WC,mode:KC,numeric:YC,prod:JC,reshape:ZC,size:XC,squeeze:QC,subset:ek,transpose:tk,xgcd:rk,zeros:nk,asin:ik,cbrt:sk,concat:ok,count:ak,ctranspose:lk,diag:uk,divideScalar:ck,dotDivide:dk,equal:hk,flatten:fk,gcd:pk,hasNumericValue:mk,identity:gk,kron:yk,largerEq:vk,leftShift:bk,matrixFromColumns:xk,mod:wk,nthRoot:Ek,ones:Sk,resize:Tk,rightArithShift:Ak,round:Dk,smaller:Nk,to:Ck,unequal:kk,xor:Mk,add:Ok,bitAnd:_k,bitXor:Lk,catalan:Rk,compare:Ik,compareText:Fk,cumsum:Pk,deepEqual:Bk,dot:Uk,equalText:$k,floor:jk,hypot:zk,invmod:Vk,larger:Gk,log:Wk,matrixFromRows:Kk,min:Yk,multiply:Jk,nthRoots:Zk,or:Xk,partitionSelect:Qk,quantileSeq:eM,rightLogShift:tM,smallerEq:rM,subtract:nM,trace:iM,usolve:sM,zpk2tf:oM,and:aM,bitOr:lM,ceil:uM,compareNatural:cM,composition:dM,cross:hM,det:fM,diff:pM,distance:mM,dotMultiply:gM,fix:vM,index:bM,intersect:xM,lcm:wM,log1p:EM,lsolve:SM,max:TM,qr:AM,range:DM,row:NM,setCartesian:CM,setDistinct:kM,setIsSubset:MM,setPowerset:OM,slu:_M,sort:LM,sum:RM,usolveAll:IM,atan2:FM,column:PM,lsolveAll:BM,setDifference:UM,setMultiplicity:$M,setSymDifference:jM,inv:qM,lup:HM,pinv:VM,pow:GM,setIntersect:WM,setUnion:KM,sqrtm:YM,vacuumImpedance:ZM,wienDisplacement:XM,atomicMass:QM,bohrMagneton:eO,boltzmann:tO,conductanceQuantum:rO,createUnit:nO,deuteronMass:iO,dotPow:sO,electricConstant:oO,elementaryCharge:aO,expm:lO,faraday:uO,fft:cO,gamma:dO,gravitationConstant:hO,hartreeEnergy:fO,ifft:pO,klitzing:mO,loschmidt:gO,magneticConstant:yO,molarMass:vO,molarPlanckConstant:bO,neutronMass:xO,nuclearMagneton:wO,planckCharge:EO,planckLength:SO,planckTemperature:TO,protonMass:AO,reducedPlanckConstant:DO,rydberg:NO,secondRadiation:CO,speedOfLight:kO,stefanBoltzmann:MO,thomsonCrossSection:OO,avogadro:_O,bohrRadius:LO,coulomb:RO,divide:IO,electronMass:FO,factorial:PO,firstRadiation:BO,gravity:UO,inverseConductanceQuantum:$O,lusolve:jO,magneticFluxQuantum:zO,molarMassC12:qO,multinomial:HO,parse:z_,permutations:VO,planckMass:GO,polynomialRoot:WO,resolve:q_,setSize:KO,simplifyConstant:H_,solveODE:YO,stirlingS2:JO,unit:ZO,bellNumbers:XO,compile:V_,eigs:QO,fermiCoupling:e_,gasConstant:t_,leafCount:W_,mean:r_,molarVolume:n_,planckConstant:i_,quantumOfCirculation:s_,simplifyCore:K_,variance:o_,classicalElectronRadius:a_,evaluate:Y_,help:J_,median:l_,simplify:X_,symbolicEqual:Q_,derivative:eL,kldivergence:u_,mad:c_,parser:tL,rationalize:rL,std:d_,freqz:h_,norm:f_,rotationMatrix:p_,planckTime:m_,schur:g_,rotate:y_,sylvester:v_,lyap:b_,config:Pl}),Ll(w_,x_,{filter:jh({typed:bN}),forEach:qh({typed:bN}),map:Hh({typed:bN}),apply:Yh({isInteger:QN,typed:bN}),subset:rf({matrix:GC,typed:bN}),concat:af({isInteger:QN,matrix:GC,typed:bN}),max:ff({config:Pl,larger:Gk,numeric:YC,typed:bN}),sum:mf({add:Ok,config:Pl,numeric:YC,typed:bN}),min:yf({config:Pl,numeric:YC,smaller:Nk,typed:bN}),cumsum:wf({add:Ok,typed:bN,unaryPlus:xN}),diff:Af({bignumber:_N,matrix:GC,number:cC,subtract:nM,typed:bN}),index:Df({Index:Hk}),range:kf({bignumber:_N,matrix:GC,add:Ok,config:Pl,isPositive:tC,larger:Gk,largerEq:vk,smaller:Nk,smallerEq:rM,typed:bN}),row:Of({Index:Hk,matrix:GC,range:DM,typed:bN}),column:Rf({Index:Hk,matrix:GC,range:DM,typed:bN}),mean:Pf({add:Ok,divide:IO,typed:bN}),variance:zf({add:Ok,apply:NC,divide:IO,isNaN:LC,multiply:Jk,subtract:nM,typed:bN}),std:Hf({map:aC,sqrt:UC,typed:bN,variance:o_})}),Ll(E_,{BigNumber:GD,Complex:WD,Fraction:ZD,Matrix:rN,Node:S_,ObjectNode:T_,OperatorNode:A_,ParenthesisNode:D_,Range:oN,RelationalNode:N_,ResultSet:aN,ArrayNode:C_,BlockNode:k_,ConditionalNode:M_,ConstantNode:O_,DenseMatrix:fN,RangeNode:__,Chain:R_,FunctionAssignmentNode:I_,SparseMatrix:bC,AccessorNode:P_,IndexNode:B_,AssignmentNode:U_,ImmutableDenseMatrix:qk,Index:Hk,FibonacciHeap:yM,Spa:zM,Unit:JM,SymbolNode:$_,FunctionNode:j_,Help:G_,Parser:Z_}),R_.createProxy(x_);var nL=function(){return nL=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},nL.apply(this,arguments)};function iL(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function sL(e){return Array.prototype.slice.call(e)}function oL(e,t){var r=Math.floor(e);return r===t||r+1===t?e:t}function aL(){return Date.now()}function lL(e,t,r){if(t="data-keen-slider-"+t,null===r)return e.removeAttribute(t);e.setAttribute(t,r||"")}function uL(e,t){return t=t||document,"function"==typeof e&&(e=e(t)),Array.isArray(e)?e:"string"==typeof e?sL(t.querySelectorAll(e)):e instanceof HTMLElement?[e]:e instanceof NodeList?sL(e):[]}function cL(e){e.raw&&(e=e.raw),e.cancelable&&!e.defaultPrevented&&e.preventDefault()}function dL(e){e.raw&&(e=e.raw),e.stopPropagation&&e.stopPropagation()}function hL(){var e=[];return{add:function(t,r,n,i){t.addListener?t.addListener(n):t.addEventListener(r,n,i),e.push([t,r,n,i])},input:function(e,t,r,n){this.add(e,t,function(e){return function(t){t.nativeEvent&&(t=t.nativeEvent);var r=t.changedTouches||[],n=t.targetTouches||[],i=t.detail&&t.detail.x?t.detail:null;return e({id:i?i.identifier?i.identifier:"i":n[0]?n[0]?n[0].identifier:"e":"d",idChanged:i?i.identifier?i.identifier:"i":r[0]?r[0]?r[0].identifier:"e":"d",raw:t,x:i&&i.x?i.x:n[0]?n[0].screenX:i?i.x:t.pageX,y:i&&i.y?i.y:n[0]?n[0].screenY:i?i.y:t.pageY})}}(r),n)},purge:function(){e.forEach((function(e){e[0].removeListener?e[0].removeListener(e[2]):e[0].removeEventListener(e[1],e[2],e[3])})),e=[]}}}function fL(e,t,r){return Math.min(Math.max(e,t),r)}function pL(e){return(e>0?1:0)-(e<0?1:0)||+e}function mL(e){var t=e.getBoundingClientRect();return{height:oL(t.height,e.offsetHeight),width:oL(t.width,e.offsetWidth)}}function gL(e,t,r,n){var i=e&&e[t];return null==i?r:n&&"function"==typeof i?i():i}function yL(e){return Math.round(1e6*e)/1e6}function vL(e){var t,r,n,i,s,o,a,l,u,c,d,h,f,p,m=1/0,g=[],y=null,v=0;function b(e){C(v+e)}function x(e){var t=w(v+e).abs;return T(t)?t:null}function w(e){var t=Math.floor(Math.abs(yL(e/r))),n=yL((e%r+r)%r);n===r&&(n=0);var i=pL(e),s=a.indexOf(iL([],a,!0).reduce((function(e,t){return Math.abs(t-n)<Math.abs(e-n)?t:e}))),l=s;return i<0&&t++,s===o&&(l=0,t+=i>0?1:-1),{abs:l+t*o*i,origin:s,rel:l}}function E(e,t,r){var n;if(t||!D())return S(e,r);if(!T(e))return null;var i=w(null!=r?r:v),s=i.abs,a=e-i.rel,l=s+a;n=S(l);var u=S(l-o*pL(a));return(null!==u&&Math.abs(u)<Math.abs(n)||null===n)&&(n=u),yL(n)}function S(e,t){if(null==t&&(t=yL(v)),!T(e)||null===e)return null;e=Math.round(e);var n=w(t),i=n.abs,s=n.rel,l=n.origin,u=N(e),c=(t%r+r)%r,d=a[l],h=Math.floor((e-(i-s))/o)*r;return yL(d-c-d+a[u]+h+(l===o?r:0))}function T(e){return A(e)===e}function A(e){return fL(e,u,c)}function D(){return i.loop}function N(e){return(e%o+o)%o}function C(t){var r;r=t-v,g.push({distance:r,timestamp:aL()}),g.length>6&&(g=g.slice(-6)),v=yL(t);var n=k().abs;if(n!==y){var i=null!==y;y=n,i&&e.emit("slideChanged")}}function k(a){var l=a?null:function(){if(o){var e=D(),t=e?(v%r+r)%r:v,a=(e?v%r:v)-s[0][2],l=0-(a<0&&e?r-Math.abs(a):a),m=0,g=w(v),y=g.abs,b=g.rel,x=s[b][2],E=s.map((function(t,n){var s=l+m;(s<0-t[0]||s>1)&&(s+=(Math.abs(s)>r-1&&e?r:0)*pL(-s));var a=n-b,u=pL(a),c=a+y;e&&(-1===u&&s>x&&(c+=o),1===u&&s<x&&(c-=o),null!==d&&c<d&&(s+=r),null!==h&&c>h&&(s-=r));var f=s+t[0]+t[1],p=Math.max(s>=0&&f<=1?1:f<0||s>1?0:s<0?Math.min(1,(t[0]+s)/t[0]):(1-s)/t[0],0);return m+=t[0]+t[1],{abs:c,distance:i.rtl?-1*s+1-t[0]:s,portion:p,size:t[0]}}));return y=A(y),b=N(y),{abs:A(y),length:n,max:p,maxIdx:c,min:f,minIdx:u,position:v,progress:e?t/r:v/n,rel:b,slides:E,slidesLength:r}}}();return t.details=l,e.emit("detailsChanged"),l}return t={absToRel:N,add:b,details:null,distToIdx:x,idxToDist:E,init:function(t){if(function(){if(i=e.options,s=(i.trackConfig||[]).map((function(e){return[gL(e,"size",1),gL(e,"spacing",0),gL(e,"origin",0)]})),o=s.length){r=yL(s.reduce((function(e,t){return e+t[0]+t[1]}),0));var t,u=o-1;n=yL(r+s[0][2]-s[u][0]-s[u][2]-s[u][1]),a=s.reduce((function(e,r){if(!e)return[0];var n=s[e.length-1],i=e[e.length-1]+(n[0]+n[2])+n[1];return i-=r[2],e[e.length-1]>i&&(i=e[e.length-1]),i=yL(i),e.push(i),(!t||t<i)&&(l=e.length-1),t=i,e}),null),0===n&&(l=0),a.push(yL(r))}}(),!o)return k(!0);var g;!function(){var t=e.options.range,r=e.options.loop;d=u=r?gL(r,"min",-1/0):0,h=c=r?gL(r,"max",m):l;var n=gL(t,"min",null),i=gL(t,"max",null);null!==n&&(u=n),null!==i&&(c=i),f=u===-1/0?u:e.track.idxToDist(u||0,!0,0),p=c===m?c:E(c,!0,0),null===i&&(h=c),gL(t,"align",!1)&&c!==m&&0===s[N(c)][2]&&(p-=1-s[N(c)][0],c=x(p-v)),f=yL(f),p=yL(p)}(),g=t,Number(g)===g?b(S(A(t))):k()},to:C,velocity:function(){var e=aL(),t=g.reduce((function(t,r){var n=r.distance,i=r.timestamp;return e-i>200||(pL(n)!==pL(t.distance)&&t.distance&&(t={distance:0,lastTimestamp:0,time:0}),t.time&&(t.distance+=n),t.lastTimestamp&&(t.time+=i-t.lastTimestamp),t.lastTimestamp=i),t}),{distance:0,lastTimestamp:0,time:0});return t.distance/t.time||0}}}function bL(e){var t,r,n,i,s,o,a,l;function u(e){return 2*e}function c(e){return fL(e,a,l)}function d(e){return 1-Math.pow(1-e,3)}function h(){return n?e.track.velocity():0}function f(e,t){void 0===t&&(t=1e3);var r=147e-9+(e=Math.abs(e))/t;return{dist:Math.pow(e,2)/r,dur:e/r}}function p(){var t=e.track.details;t&&(s=t.min,o=t.max,a=t.minIdx,l=t.maxIdx)}function m(){e.animator.stop()}e.on("updated",p),e.on("optionsChanged",p),e.on("created",p),e.on("dragStarted",(function(){n=!1,m(),t=r=e.track.details.abs})),e.on("dragChecked",(function(){n=!0})),e.on("dragEnded",(function(){var n=e.options.mode;"snap"===n&&function(){var n=e.track,i=e.track.details,a=i.position,l=pL(h());(a>o||a<s)&&(l=0);var u=t+l;0===i.slides[n.absToRel(u)].portion&&(u-=l),t!==r&&(u=r),pL(n.idxToDist(u,!0))!==l&&(u+=l),u=c(u);var d=n.idxToDist(u,!0);e.animator.start([{distance:d,duration:500,easing:function(e){return 1+--e*e*e*e*e}}])}(),"free"!==n&&"free-snap"!==n||function(){m();var t="free-snap"===e.options.mode,r=e.track,n=h();i=pL(n);var a=e.track.details,l=[];if(n||!t){var p=f(n),g=p.dist,y=p.dur;if(y=u(y),g*=i,t){var v=r.idxToDist(r.distToIdx(g),!0);v&&(g=v)}l.push({distance:g,duration:y,easing:d});var b=a.position,x=b+g;if(x<s||x>o){var w=x<s?s-b:o-b,E=0,S=n;if(pL(w)===i){var T=Math.min(Math.abs(w)/Math.abs(g),1),A=function(e){return 1-Math.pow(1-e,1/3)}(T)*y;l[0].earlyExit=A,S=n*(1-T)}else l[0].earlyExit=0,E+=w;var D=f(S,100),N=D.dist*i;e.options.rubberband&&(l.push({distance:N,duration:u(D.dur),easing:d}),l.push({distance:-N+E,duration:500,easing:d}))}e.animator.start(l)}else e.moveToIdx(c(a.abs),!0,{duration:500,easing:function(e){return 1+--e*e*e*e*e}})}()})),e.on("dragged",(function(){r=e.track.details.abs}))}function xL(e){var t,r,n,i,s,o,a,l,u,c,d,h,f,p,m,g,y,v,b=hL();function x(t){if(o&&l===t.id){var f=T(t);if(u){if(!S(t))return E(t);c=f,u=!1,e.emit("dragChecked")}if(g)return c=f;cL(t);var p=function(t){if(y===-1/0&&v===1/0)return t;var n=e.track.details,o=n.length,a=n.position,l=fL(t,y-a,v-a);if(0===o)return 0;if(!e.options.rubberband)return l;if(a<=v&&a>=y)return t;if(a<y&&r>0||a>v&&r<0)return t;var u=(a<y?a-y:a-v)/o,c=i*o,d=Math.abs(u*c),h=Math.max(0,1-d/s*2);return h*h*t}(a(c-f)/i*n);r=pL(p);var m=e.track.details.position;(m>y&&m<v||m===y&&r>0||m===v&&r<0)&&dL(t),d+=p,!h&&Math.abs(d*i)>5&&(h=!0),e.track.add(p),c=f,e.emit("dragged")}}function w(t){!o&&e.track.details&&e.track.details.length&&(d=0,o=!0,h=!1,u=!0,l=t.id,S(t),c=T(t),e.emit("dragStarted"))}function E(t){o&&l===t.idChanged&&(o=!1,e.emit("dragEnded"))}function S(e){var t=A(),r=t?e.y:e.x,n=t?e.x:e.y,i=void 0!==f&&void 0!==p&&Math.abs(p-n)<=Math.abs(f-r);return f=r,p=n,i}function T(e){return A()?e.y:e.x}function A(){return e.options.vertical}function D(){i=e.size,s=A()?window.innerHeight:window.innerWidth;var t=e.track.details;t&&(y=t.min,v=t.max)}function N(e){h&&(dL(e),cL(e))}function C(){if(b.purge(),e.options.drag&&!e.options.disabled){var r;r=e.options.dragSpeed||1,a="function"==typeof r?r:function(e){return e*r},n=e.options.rtl?-1:1,D(),t=e.container,function(){var e="data-keen-slider-clickable";uL("[".concat(e,"]:not([").concat(e,"=false])"),t).map((function(e){b.add(e,"dragstart",dL),b.add(e,"mousedown",dL),b.add(e,"touchstart",dL)}))}(),b.add(t,"dragstart",(function(e){cL(e)})),b.add(t,"click",N,{capture:!0}),b.input(t,"ksDragStart",w),b.input(t,"ksDrag",x),b.input(t,"ksDragEnd",E),b.input(t,"mousedown",w),b.input(t,"mousemove",x),b.input(t,"mouseleave",E),b.input(t,"mouseup",E),b.input(t,"touchstart",w,{passive:!0}),b.input(t,"touchmove",x,{passive:!1}),b.input(t,"touchend",E),b.input(t,"touchcancel",E),b.add(window,"wheel",(function(e){o&&cL(e)}));var i="data-keen-slider-scrollable";uL("[".concat(i,"]:not([").concat(i,"=false])"),e.container).map((function(e){return function(e){var t;b.input(e,"touchstart",(function(e){t=T(e),g=!0,m=!0}),{passive:!0}),b.input(e,"touchmove",(function(r){var n=A(),i=n?e.scrollHeight-e.clientHeight:e.scrollWidth-e.clientWidth,s=t-T(r),o=n?e.scrollTop:e.scrollLeft,a=n&&"scroll"===e.style.overflowY||!n&&"scroll"===e.style.overflowX;if(t=T(r),(s<0&&o>0||s>0&&o<i)&&m&&a)return g=!0;m=!1,cL(r),g=!1})),b.input(e,"touchend",(function(){g=!1}))}(e)}))}}e.on("updated",D),e.on("optionsChanged",C),e.on("created",C),e.on("destroyed",b.purge)}function wL(e){var t,r,n=null;function i(t,r,n){e.animator.active?o(t,r,n):requestAnimationFrame((function(){return o(t,r,n)}))}function s(){i(!1,!1,r)}function o(r,i,s){var o=0,a=e.size,c=e.track.details;if(c&&t){var d=c.slides;t.forEach((function(e,t){if(r)!n&&i&&l(e,null,s),u(e,null,s);else{if(!d[t])return;var c=d[t].size*a;!n&&i&&l(e,c,s),u(e,d[t].distance*a-o,s),o+=c}}))}}function a(t){return"performance"===e.options.renderMode?Math.round(t):t}function l(e,t,r){var n=r?"height":"width";null!==t&&(t=a(t)+"px"),e.style["min-"+n]=t,e.style["max-"+n]=t}function u(e,t,r){if(null!==t){t=a(t);var n=r?t:0;t="translate3d(".concat(r?0:t,"px, ").concat(n,"px, 0)")}e.style.transform=t,e.style["-webkit-transform"]=t}function c(){t&&(o(!0,!0,r),t=null),e.on("detailsChanged",s,!0)}function d(){i(!1,!0,r)}function h(){c(),r=e.options.vertical,e.options.disabled||"custom"===e.options.renderMode||(n="auto"===gL(e.options.slides,"perView",null),e.on("detailsChanged",s),(t=e.slides).length&&d())}e.on("created",h),e.on("optionsChanged",h),e.on("beforeOptionsChanged",(function(){c()})),e.on("updated",d),e.on("destroyed",c)}function EL(e,t){return function(r){var n,i,s,o,a,l=hL();function u(e){var t;lL(r.container,"reverse","rtl"!==(t=r.container,window.getComputedStyle(t,null).getPropertyValue("direction"))||e?null:""),lL(r.container,"v",r.options.vertical&&!e?"":null),lL(r.container,"disabled",r.options.disabled&&!e?"":null)}function c(){d()&&g()}function d(){var e=null;if(o.forEach((function(t){t.matches&&(e=t.__media)})),e===n)return!1;n||r.emit("beforeOptionsChanged"),n=e;var t=e?s.breakpoints[e]:s;return r.options=nL(nL({},s),t),u(),w(),E(),v(),!0}function h(e){var t=mL(e);return(r.options.vertical?t.height:t.width)/r.size||1}function f(){return r.options.trackConfig.length}function p(e){for(var a in n=!1,s=nL(nL({},t),e),l.purge(),i=r.size,o=[],s.breakpoints||[]){var u=window.matchMedia(a);u.__media=a,o.push(u),l.add(u,"change",c)}l.add(window,"orientationchange",x),l.add(window,"resize",b),d()}function m(e){r.animator.stop();var t=r.track.details;r.track.init(null!=e?e:t?t.abs:0)}function g(e){m(e),r.emit("optionsChanged")}function y(e,t){if(e)return p(e),void g(t);w(),E();var n=f();v(),f()!==n?g(t):m(t),r.emit("updated")}function v(){var e=r.options.slides;if("function"==typeof e)return r.options.trackConfig=e(r.size,r.slides);for(var t=r.slides,n=t.length,i="number"==typeof e?e:gL(e,"number",n,!0),s=[],o=gL(e,"perView",1,!0),a=gL(e,"spacing",0,!0)/r.size||0,l="auto"===o?a:a/o,u=gL(e,"origin","auto"),c=0,d=0;d<i;d++){var f="auto"===o?h(t[d]):1/o-a+l,p="center"===u?.5-f/2:"auto"===u?0:u;s.push({origin:p,size:f,spacing:a}),c+=f}if(c+=a*(i-1),"auto"===u&&!r.options.loop&&1!==o){var m=0;s.map((function(e){var t=c-m;return m+=e.size+a,t>=1||(e.origin=1-t-(c>1?0:1-c)),e}))}r.options.trackConfig=s}function b(){w();var e=r.size;r.options.disabled||e===i||(i=e,y())}function x(){b(),setTimeout(b,500),setTimeout(b,2e3)}function w(){var e=mL(r.container);r.size=(r.options.vertical?e.height:e.width)||1}function E(){r.slides=uL(r.options.selector,r.container)}r.container=(a=uL(e,document)).length?a[0]:null,r.destroy=function(){l.purge(),r.emit("destroyed"),u(!0)},r.prev=function(){r.moveToIdx(r.track.details.abs-1,!0)},r.next=function(){r.moveToIdx(r.track.details.abs+1,!0)},r.update=y,p(r.options)}}var SL=function(e,t,r){try{return function(e,t){var r,n={};return r={emit:function(e){n[e]&&n[e].forEach((function(e){e(r)}));var t=r.options&&r.options[e];t&&t(r)},moveToIdx:function(e,t,n){var i=r.track.idxToDist(e,t);if(i){var s=r.options.defaultAnimation;r.animator.start([{distance:i,duration:gL(n||s,"duration",500),easing:gL(n||s,"easing",(function(e){return 1+--e*e*e*e*e}))}])}},on:function(e,t,r){void 0===r&&(r=!1),n[e]||(n[e]=[]);var i=n[e].indexOf(t);i>-1?r&&delete n[e][i]:r||n[e].push(t)},options:e},function(){if(r.track=vL(r),r.animator=function(e){var t,r,n,i,s,o;function a(t){o||(o=t),l(!0);var s=t-o;s>n&&(s=n);var d=i[r];if(d[3]<s)return r++,a(t);var h=d[2],f=d[4],p=d[0],m=d[1]*(0,d[5])(0===f?1:(s-h)/f);if(m&&e.track.to(p+m),s<n)return c();o=null,l(!1),u(null),e.emit("animationEnded")}function l(e){t.active=e}function u(e){t.targetIdx=e}function c(){var e;e=a,s=window.requestAnimationFrame(e)}function d(){var t;t=s,window.cancelAnimationFrame(t),l(!1),u(null),o&&e.emit("animationStopped"),o=null}return t={active:!1,start:function(t){if(d(),e.track.details){var s=0,o=e.track.details.position;r=0,n=0,i=t.map((function(e){var t,r=Number(o),i=null!==(t=e.earlyExit)&&void 0!==t?t:e.duration,a=e.easing,l=e.distance*a(i/e.duration)||0;o+=l;var u=n;return n+=i,s+=l,[r,e.distance,u,n,e.duration,a]})),u(e.track.distToIdx(s)),c(),e.emit("animationStarted")}},stop:d,targetIdx:null}}(r),t)for(var e=0,n=t;e<n.length;e++)(0,n[e])(r);r.track.init(r.options.initial||0),r.emit("created")}(),r}(t,iL([EL(e,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),wL,xL,bL],r||[],!0))}catch(e){console.error(e)}};function TL(e,t,r){if(-1===e.indexOf(t))return r;const n=e[e.indexOf(t)+1];if(!n)return r;if("duration"===t){let e=n.match(/([0-9]+)ms/);if(e)return e[1]}if("min"===t){let e=n.match(/([0-9]+)px/);if(e)return e[1]}return n}var AL=function(e){function t(t,{modifiers:r}){let n=TL(r,"duration",250)/1e3,i=TL(r,"min",0),s=!r.includes("min");t._x_isShown||(t.style.height=`${i}px`),!t._x_isShown&&s&&(t.hidden=!0),t._x_isShown||(t.style.overflow="hidden");let o=(t,r)=>{let n=e.setStyles(t,r);return r.height?()=>{}:n},a={transitionProperty:"height",transitionDuration:`${n}s`,transitionTimingFunction:"cubic-bezier(0.4, 0.0, 0.2, 1)"};t._x_transition={in(r=(()=>{}),n=(()=>{})){s&&(t.hidden=!1),s&&(t.style.display=null);let o=t.getBoundingClientRect().height;t.style.height="auto";let l=t.getBoundingClientRect().height;o===l&&(o=i),e.transition(t,e.setStyles,{during:a,start:{height:o+"px"},end:{height:l+"px"}},(()=>t._x_isShown=!0),(()=>{t.getBoundingClientRect().height==l&&(t.style.overflow=null)}))},out(r=(()=>{}),n=(()=>{})){let l=t.getBoundingClientRect().height;e.transition(t,o,{during:a,start:{height:l+"px"},end:{height:i+"px"}},(()=>t.style.overflow="hidden"),(()=>{t._x_isShown=!1,t.style.height==`${i}px`&&s&&(t.style.display="none",t.hidden=!0)}))}}}e.directive("collapse",t),t.inline=(e,{modifiers:t})=>{t.includes("min")&&(e._x_doShow=()=>{},e._x_doHide=()=>{})}};window.Alpine=Cl,Cl.plugin(_l),Cl.plugin(AL),Cl.data("drawer",(function(){return{init:function(){document.body.classList.add("overflow-hidden")},destroy:function(){document.body.classList.remove("overflow-hidden"),this.$el.remove()}}})),Cl.data("drawer",(function(){return{init:function(){document.body.classList.add("overflow-hidden")},destroy:function(){document.body.classList.remove("overflow-hidden"),this.$el.remove()}}})),Cl.data("keenSliderData",(function(){return{tanggal:12,tanggals:[{date:11,day:"Sen"},{date:12,day:"Sel"},{date:13,day:"Rab"},{date:14,day:"Kam"},{date:15,day:"Jum"},{date:16,day:"Sab"},{date:17,day:"Min"},{date:18,day:"Sen"},{date:19,day:"Sel"}],dataEvents:[{date:12,title:"Materi Akuntansi",category:"Bidang AN BPKP",time:"08:00 - 16:00 WIB",status:"Belum mulai",noActivity:!1},{date:19,title:"Materi dan Latihan Jurnal Transaksi",category:"Bidang AN BPKP",time:"08:00 - 16:00 WIB",status:"Belum mulai",noActivity:!1},{date:0,title:"Tidak Ada Kegiatan",category:"BPKP",time:"Silahkan pilih tanggal lain",status:"",noActivity:!0}],events:[],current:1,slider:null,changeEvents:function(){var e=this,t=this.dataEvents.filter((function(t){return t.date==e.tanggal}));t.length>0?this.events=t:this.events=[{date:0,title:"Tidak Ada Kegiatan",category:"BPKP",time:"Silahkan pilih tanggal lain",status:"",noActivity:!0}]},init:function(){var e=this;this.changeEvents(),this.slider=new SL("#my-slider",{loop:!0,created:function(){console.log("created")},slideChanged:function(t){e.current=t.track.details.rel},slides:{perView:4,spacing:20,initial:this.current}},[])}}})),Cl.data("swiperData",(function(){return{swiper:null,runSwiper:function(){this.swiper=new Swiper("#swiperContainer",{loop:!0,centeredSlides:!0,autoplay:{delay:2500,disableOnInteraction:!1},breakpoints:{640:{slidesPerView:1,spaceBetween:0},768:{slidesPerView:1,spaceBetween:0},1024:{slidesPerView:2,spaceBetween:20}},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}}})),Cl.data("modal",(function(){return{closeModal:function(e){e.classList.add("closing"),e.addEventListener("animationend",(function(){return e.remove()}),{once:!0})}}})),Cl.data("videoPlaceholder",(function(){return{open:function(){document.querySelector("[video-placeholder]").classList.remove("hidden")},close:function(){var e;console.log("closing video player"),null===(e=window.player)||void 0===e||e.pause(),document.querySelector("[video-placeholder]").classList.add("hidden")}}})),Cl.data("videoAutoPlayNext",(function(){var e=arguments.length>1?arguments[1]:void 0;return{enabled:!!e&&(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),displayed:!1,timeRemaining:100,threshold:15,onTimeUpdate:function(e){if(this.enabled){var t=e.detail.player,r=t.currentTime,n=t.duration,i=F_(n).subtract(r).done();this.timeRemaining=Math.floor(i),this.displayed=this.timeRemaining<=this.threshold,0===this.timeRemaining&&this.onPlayNext()}},onPlayNext:function(){this.enabled&&window.up.visit(e+"?autoplay=1")},onCancel:function(){this.enabled=!1,this.displayed=!1}}})),Cl.data("copyToClipboard",(function(e){return{copyText:e,copyNotification:!1,copyToClipboard:function(){var e=this;navigator.clipboard.writeText(this.copyText),this.copyNotification=!0,setTimeout((function(){return e.copyNotification=!1}),3e3)}}})),Cl.data("comments",(function(){return{editId:null,createId:null,create:function(e){this.cancel(),this.createId=e},edit:function(e){this.cancel(),this.editId=e},cancel:function(){this.editId=null,this.createId=null}}})),Cl.data("turnstile",(function(){return{onRender:function(e){turnstile.render(this.$el,{sitekey:e,callback:function(e){}})}}})),window.countdown=function(e){var t=e.dateTime;return{target:t,interval:null,days:0,hours:0,minutes:0,seconds:0,init:function(){var e=this,r=qi.fromISO(t);this.interval=setInterval((function(){var t=r.diff(qi.now(),["milliseconds"]).milliseconds;e.days=Math.floor(t/864e5),e.hours=Math.floor(t%864e5/36e5),e.minutes=Math.floor(t%36e5/6e4),e.seconds=Math.floor(t%6e4/1e3),e.days||e.hours||e.minutes||e.seconds||clearInterval(e.interval)}),1e3)},destroy:function(){clearInterval(this.interval)}}},Cl.start();r(31014);function DL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var NL,CL,kL,ML,OL,_L={exports:{}};NL=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,CL=/^(?=([^\/?#]*))\1([^]*)$/,kL=/(?:\/|^)\.(?=\/)/g,ML=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,_L.exports=OL={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=OL.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=OL.normalizePath(n.path),OL.buildURLFromParts(n)}var i=OL.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=OL.normalizePath(i.path),OL.buildURLFromParts(i)):t;var s=OL.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var o=CL.exec(s.path);s.netLoc=o[1],s.path=o[2]}s.netLoc&&!s.path&&(s.path="/");var a={scheme:s.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(a.netLoc=s.netLoc,"/"!==i.path[0]))if(i.path){var l=s.path,u=l.substring(0,l.lastIndexOf("/")+1)+i.path;a.path=OL.normalizePath(u)}else a.path=s.path,i.params||(a.params=s.params,i.query||(a.query=s.query));return null===a.path&&(a.path=r.alwaysNormalize?OL.normalizePath(i.path):i.path),OL.buildURLFromParts(a)},parseURL:function(e){var t=NL.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(kL,"");e.length!==(e=e.replace(ML,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};var LL=_L.exports;function RL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function IL(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RL(Object(r),!0).forEach((function(t){FL(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RL(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function FL(e,t,r){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PL(){return PL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PL.apply(this,arguments)}const BL=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};let UL=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e}({}),$L=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),jL=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const zL=function(){},qL={trace:zL,debug:zL,log:zL,warn:zL,info:zL,error:zL};let HL=qL;function VL(e,...t){t.forEach((function(t){HL[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):zL}(t)}))}const GL=HL,WL=/^(\d+)x(\d+)$/,KL=/(.+?)=(".*?"|.*?)(?:,|$)/g;class YL{constructor(e){"string"==typeof e&&(e=YL.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const r=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)r[e]=parseInt(t.slice(2*e,2*e+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=WL.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const r={};for(KL.lastIndex=0;null!==(t=KL.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1));r[t[1].trim()]=e}return r}}function JL(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class ZL{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const r=t.attr;for(const t in r)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==r[t]){GL.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=PL(new YL({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);BL(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(BL(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&BL(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class XL{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var QL="audio",eR="video",tR="audiovideo";class rR{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[QL]:null,[eR]:null,[tR]:null},this.baseurl=e}setByteRange(e,t){const r=e.split("@",2),n=[];1===r.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=LL.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class nR extends rR{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new XL,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!BL(this.programDateTime))return null;const e=BL(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,r,n,i,s=!1){const{elementaryStreams:o}=this,a=o[e];a?(a.startPTS=Math.min(a.startPTS,t),a.endPTS=Math.max(a.endPTS,r),a.startDTS=Math.min(a.startDTS,n),a.endDTS=Math.max(a.endDTS,i)):o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:i,partial:s}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[QL]=null,e[eR]=null,e[tR]=null}}class iR extends rR{constructor(e,t,r,n,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new XL,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class sR{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&BL(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){return 1e3*(this.driftEnd-this.driftStart)/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function oR(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function aR(e){const t=e.split(":");let r=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),n=e[e.length-1].split(",");if(2===n.length){const t="base64"===n[0],i=n[1];t?(e.splice(-1,1),r=oR(i)):r=function(e){const t=lR(e).subarray(0,16),r=new Uint8Array(16);return r.set(t,16-t.length),r}(i)}}return r}function lR(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}var uR={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},cR="org.w3.clearkey",dR="com.apple.streamingkeydelivery",hR="com.microsoft.playready",fR="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function pR(e){switch(e){case dR:return uR.FAIRPLAY;case hR:return uR.PLAYREADY;case fR:return uR.WIDEVINE;case cR:return uR.CLEARKEY}}var mR="edef8ba979d64acea3c827dcd51d21ed";function gR(e){switch(e){case uR.FAIRPLAY:return dR;case uR.PLAYREADY:return hR;case uR.WIDEVINE:return fR;case uR.CLEARKEY:return cR}}function yR(e){const{drmSystems:t,widevineLicenseUrl:r}=e,n=t?[uR.FAIRPLAY,uR.WIDEVINE,uR.PLAYREADY,uR.CLEARKEY].filter((e=>!!t[e])):[];return!n[uR.WIDEVINE]&&r&&n.push(uR.WIDEVINE),n}const vR="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function bR(e,t,r){return Uint8Array.prototype.slice?e.slice(t,r):new Uint8Array(Array.prototype.slice.call(e,t,r))}const xR=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,wR=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,ER=(e,t)=>{const r=t;let n=0;for(;xR(e,t);){n+=10;n+=SR(e,t+6),wR(e,t+10)&&(n+=10),t+=n}if(n>0)return e.subarray(r,r+n)},SR=(e,t)=>{let r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3],r},TR=(e,t)=>xR(e,t)&&SR(e,t+6)+10<=e.length-t,AR=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,DR=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=SR(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},NR=e=>{let t=0;const r=[];for(;xR(e,t);){const n=SR(e,t+6);t+=10;const i=t+n;for(;t+8<i;){const n=DR(e.subarray(t)),i=CR(n);i&&r.push(i),t+=n.size+10}wR(e,t)&&(t+=10)}return r},CR=e=>"PRIV"===e.type?kR(e):"W"===e.type[0]?OR(e):MR(e),kR=e=>{if(e.size<2)return;const t=LR(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}},MR=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const r=LR(e.data.subarray(t),!0);t+=r.length+1;const n=LR(e.data.subarray(t));return{key:e.type,info:r,data:n}}const t=LR(e.data.subarray(1));return{key:e.type,data:t}},OR=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const r=LR(e.data.subarray(t),!0);t+=r.length+1;const n=LR(e.data.subarray(t));return{key:e.type,info:r,data:n}}const t=LR(e.data);return{key:e.type,data:t}},_R=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),r=1&t[3];let n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},LR=(e,t=!1)=>{const r=IR();if(r){const n=r.decode(e);if(t){const e=n.indexOf("\0");return-1!==e?n.substring(0,e):n}return n.replace(/\0/g,"")}const n=e.length;let i,s,o,a="",l=0;for(;l<n;){if(i=e[l++],0===i&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:s=e[l++],a+=String.fromCharCode((31&i)<<6|63&s);break;case 14:s=e[l++],o=e[l++],a+=String.fromCharCode((15&i)<<12|(63&s)<<6|(63&o)<<0)}}return a};let RR;function IR(){return RR||void 0===self.TextDecoder||(RR=new self.TextDecoder("utf-8")),RR}const FR=function(e){let t="";for(let r=0;r<e.length;r++){let n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t},PR=Math.pow(2,32)-1,BR=[].push,UR={video:1,audio:2,id3:3,text:4};function $R(e){return String.fromCharCode.apply(null,e)}function jR(e,t){const r=e[t]<<8|e[t+1];return r<0?65536+r:r}function zR(e,t){const r=qR(e,t);return r<0?4294967296+r:r}function qR(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function HR(e,t,r){e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function VR(e,t){const r=[];if(!t.length)return r;const n=e.byteLength;for(let i=0;i<n;){const s=zR(e,i),o=s>1?i+s:n;if($R(e.subarray(i+4,i+8))===t[0])if(1===t.length)r.push(e.subarray(i+8,o));else{const n=VR(e.subarray(i+8,o),t.slice(1));n.length&&BR.apply(r,n)}i=o}return r}function GR(e){const t=[],r=e[0];let n=8;const i=zR(e,n);n+=4;n+=0===r?8:16,n+=2;let s=e.length+0;const o=jR(e,n);n+=2;for(let r=0;r<o;r++){let r=n;const o=zR(e,r);r+=4;const a=2147483647&o;if(1===(2147483648&o)>>>31)return GL.warn("SIDX has hierarchical references (not supported)"),null;const l=zR(e,r);r+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/i,start:s,end:s+a-1}}),s+=a,r+=4,n=r}return{earliestPresentationTime:0,timescale:i,version:r,referencesCount:o,references:t}}function WR(e){const t=[],r=VR(e,["moov","trak"]);for(let e=0;e<r.length;e++){const n=r[e],i=VR(n,["tkhd"])[0];if(i){let e=i[0],r=0===e?12:20;const s=zR(i,r),o=VR(n,["mdia","mdhd"])[0];if(o){e=o[0],r=0===e?12:20;const i=zR(o,r),a=VR(n,["mdia","hdlr"])[0];if(a){const e=$R(a.subarray(8,12)),r={soun:QL,vide:eR}[e];if(r){const e=VR(n,["mdia","minf","stbl","stsd"])[0];let o;e&&(o=$R(e.subarray(12,16))),t[s]={timescale:i,type:r},t[r]={timescale:i,id:s,codec:o}}}}}}return VR(e,["moov","mvex","trex"]).forEach((e=>{const r=zR(e,4),n=t[r];n&&(n.default={duration:zR(e,12),flags:zR(e,20)})})),t}function KR(e){const t=VR(e,["schm"])[0];if(t){const r=$R(t.subarray(4,8));if("cbcs"===r||"cenc"===r)return VR(e,["schi","tenc"])[0]}return GL.error("[eme] missing 'schm' box"),null}function YR(e){const t=zR(e,0);let r=8;1&t&&(r+=4),4&t&&(r+=4);let n=0;const i=zR(e,4);for(let s=0;s<i;s++){if(256&t){n+=zR(e,r),r+=4}512&t&&(r+=4),1024&t&&(r+=4),2048&t&&(r+=4)}return n}function JR(e,t){const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function ZR(e,t){const r=[],n=t.samples,i=t.timescale,s=t.id;let o=!1;return VR(n,["moof"]).map((a=>{const l=a.byteOffset-8;VR(a,["traf"]).map((a=>{const u=VR(a,["tfdt"]).map((e=>{const t=e[0];let r=zR(e,4);return 1===t&&(r*=Math.pow(2,32),r+=zR(e,8)),r/i}))[0];return void 0!==u&&(e=u),VR(a,["tfhd"]).map((u=>{const c=zR(u,4),d=16777215&zR(u,0);let h=0;const f=0!=(16&d);let p=0;const m=0!=(32&d);let g=8;c===s&&(0!=(1&d)&&(g+=8),0!=(2&d)&&(g+=4),0!=(8&d)&&(h=zR(u,g),g+=4),f&&(p=zR(u,g),g+=4),m&&(g+=4),"video"===t.type&&(o=function(e){if(!e)return!1;const t=e.indexOf("."),r=t<0?e:e.substring(0,t);return"hvc1"===r||"hev1"===r||"dvh1"===r||"dvhe"===r}(t.codec)),VR(a,["trun"]).map((s=>{const a=s[0],u=16777215&zR(s,0),c=0!=(1&u);let d=0;const f=0!=(4&u),m=0!=(256&u);let g=0;const y=0!=(512&u);let v=0;const b=0!=(1024&u),x=0!=(2048&u);let w=0;const E=zR(s,4);let S=8;c&&(d=zR(s,S),S+=4),f&&(S+=4);let T=d+l;for(let l=0;l<E;l++){if(m?(g=zR(s,S),S+=4):g=h,y?(v=zR(s,S),S+=4):v=p,b&&(S+=4),x&&(w=0===a?zR(s,S):qR(s,S),S+=4),t.type===eR){let t=0;for(;t<v;){const s=zR(n,T);if(T+=4,XR(o,n[T])){QR(n.subarray(T,T+s),o?2:1,e+w/i,r)}T+=s,t+=s+4}}e+=g/i}})))}))}))})),r}function XR(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6===(31&t)}function QR(e,t,r,n){const i=eI(e);let s=0;s+=t;let o=0,a=0,l=!1,u=0;for(;s<i.length;){o=0;do{if(s>=i.length)break;u=i[s++],o+=u}while(255===u);a=0;do{if(s>=i.length)break;u=i[s++],a+=u}while(255===u);const e=i.length-s;if(!l&&4===o&&s<i.length){l=!0;if(181===i[s++]){const e=jR(i,s);if(s+=2,49===e){const e=zR(i,s);if(s+=4,1195456820===e){const e=i[s++];if(3===e){const t=i[s++],a=64&t,l=a?2+3*(31&t):0,u=new Uint8Array(l);if(a){u[0]=t;for(let e=1;e<l;e++)u[e]=i[s++]}n.push({type:e,payloadType:o,pts:r,bytes:u})}}}}}else if(5===o&&a<e){if(l=!0,a>16){const e=[];for(let t=0;t<16;t++){const r=i[s++].toString(16);e.push(1==r.length?"0"+r:r),3!==t&&5!==t&&7!==t&&9!==t||e.push("-")}const t=a-16,l=new Uint8Array(t);for(let e=0;e<t;e++)l[e]=i[s++];n.push({payloadType:o,pts:r,uuid:e.join(""),userData:LR(l),userDataBytes:l})}}else if(a<e)s+=a;else if(a>e)break}}function eI(e){const t=e.byteLength,r=[];let n=1;for(;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;const i=t-r.length,s=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),s[n]=e[o];return s}function tI(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");let n,i,s;if(t){n=1,i=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const r=t[e];if(16!==r.byteLength)throw new RangeError("Invalid key");i.set(r,16*e)}}else n=0,i=new Uint8Array;n>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(o.buffer).setUint32(0,r.byteLength,!1),function(e,...t){const r=t.length;let n=8,i=r;for(;i--;)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}([112,115,115,104],new Uint8Array([n,0,0,0]),e,s,i,o,r||new Uint8Array)}let rI={};class nI{static clearKeyUriToKeyIdMap(){rI={}}constructor(e,t,r,n=[1],i=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=i,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case dR:case fR:case hR:case cR:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||GL.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(e);return new nI(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=aR(this.uri);if(t)switch(this.keyFormat){case fR:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case hR:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=tI(e,null,t);const r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),n=String.fromCharCode.apply(null,Array.from(r)),i=n.substring(n.indexOf("<"),n.length),s=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(s){const e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute("VALUE");if(e){const t=oR(e).subarray(0,16);!function(e){const t=function(e,t,r){const n=e[t];e[t]=e[r],e[r]=n};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=rI[this.uri];if(!e){const t=Object.keys(rI).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);new DataView(e.buffer,12,4).setUint32(0,t),rI[this.uri]=e}this.keyId=e}return this}}const iI=/\{\$([a-zA-Z0-9-_]+)\}/g;function sI(e){return iI.test(e)}function oI(e,t,r){if(null!==e.variableList||e.hasVariableRefs)for(let n=r.length;n--;){const i=r[n],s=t[i];s&&(t[i]=aI(e,s))}}function aI(e,t){if(null!==e.variableList||e.hasVariableRefs){const r=e.variableList;return t.replace(iI,(t=>{const n=t.substring(2,t.length-1),i=null==r?void 0:r[n];return void 0===i?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),t):i}))}return t}function lI(e,t,r){let n,i,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){n=t.QUERYPARAM;try{const e=new self.URL(r).searchParams;if(!e.has(n))throw new Error(`"${n}" does not match any query parameter in URI: "${r}"`);i=e.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else n=t.NAME,i=t.VALUE;n in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):s[n]=i||""}function uI(e,t,r){const n=t.IMPORT;if(r&&n in r){let t=e.variableList;t||(e.variableList=t={}),t[n]=r[n]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function cI(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const dI={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},hI=cI();function fI(e,t){var r;return null!=(r=null==hI?void 0:hI.isTypeSupported(`${t||"video"}/mp4;codecs="${e}"`))&&r}const pI=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,mI=/#EXT-X-MEDIA:(.*)/g,gI=/^#EXT(?:INF|-X-TARGETDURATION):/m,yI=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),vI=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class bI{static findGroup(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.id===t)return n}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let e=t.shift()+".";return e+=parseInt(t.shift()).toString(16),e+=("000"+parseInt(t.shift()).toString(16)).slice(-4),e}return e}static resolve(e,t){return LL.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return gI.test(e)}static parseMasterPlaylist(e,t){const r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:sI(e)},n=[];let i;for(pI.lastIndex=0;null!=(i=pI.exec(e));)if(i[1]){var s;const e=new YL(i[1]);oI(r,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const o=aI(r,i[2]),a={attrs:e,bitrate:e.decimalInteger("AVERAGE-BANDWIDTH")||e.decimalInteger("BANDWIDTH"),name:e.NAME,url:bI.resolve(o,t)},l=e.decimalResolution("RESOLUTION");l&&(a.width=l.width,a.height=l.height),EI((e.CODECS||"").split(/[ ,]+/).filter((e=>e)),a),a.videoCodec&&-1!==a.videoCodec.indexOf("avc1")&&(a.videoCodec=bI.convertAVC1ToAVCOTI(a.videoCodec)),null!=(s=a.unknownCodecs)&&s.length||n.push(a),r.levels.push(a)}else if(i[3]){const e=i[3],n=i[4];switch(e){case"SESSION-DATA":{const e=new YL(n);oI(r,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[t]=e);break}case"SESSION-KEY":{const e=xI(n,t,r);e.encrypted&&e.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(e)):GL.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":{const e=new YL(n);oI(r,e,["NAME","VALUE","QUERYPARAM"]),lI(r,e,t)}break;case"CONTENT-STEERING":{const e=new YL(n);oI(r,e,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:bI.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=wI(n)}}const o=n.length>0&&n.length<r.levels.length;return r.levels=o?n:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,r){let n;const i={},s=r.levels,o={AUDIO:s.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:s.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let a=0;for(mI.lastIndex=0;null!==(n=mI.exec(e));){const e=new YL(n[1]),s=e.TYPE;if(s){const n=o[s],l=i[s]||[];i[s]=l,oI(r,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u={attrs:e,bitrate:0,id:a++,groupId:e["GROUP-ID"]||"",instreamId:e["INSTREAM-ID"],name:e.NAME||e.LANGUAGE||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:e.LANGUAGE,url:e.URI?bI.resolve(e.URI,t):""};if(null!=n&&n.length){const e=bI.findGroup(n,u.groupId)||n[0];SI(u,e,"audioCodec"),SI(u,e,"textCodec")}l.push(u)}}return i}static parseLevelPlaylist(e,t,r,n,i,s){const o=new sR(t),a=o.fragments;let l,u,c,d=null,h=0,f=0,p=0,m=0,g=null,y=new nR(n,t),v=-1,b=!1;for(yI.lastIndex=0,o.m3u8=e,o.hasVariableRefs=sI(e);null!==(l=yI.exec(e));){b&&(b=!1,y=new nR(n,t),y.start=p,y.sn=h,y.cc=m,y.level=r,d&&(y.initSegment=d,y.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null));const e=l[1];if(e){y.duration=parseFloat(e);const t=(" "+l[2]).slice(1);y.title=t||null,y.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(BL(y.duration)){y.start=p,c&&DI(y,c,o),y.sn=h,y.level=r,y.cc=m,y.urlId=i,a.push(y);const e=(" "+l[3]).slice(1);y.relurl=aI(o,e),TI(y,g),g=y,p+=y.duration,h++,f=0,b=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);g?y.setByteRange(e,g):y.setByteRange(e)}else if(l[5])y.rawProgramDateTime=(" "+l[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===v&&(v=a.length);else{if(l=l[0].match(vI),!l){GL.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&void 0===l[u];u++);const e=(" "+l[u]).slice(1),i=(" "+l[u+1]).slice(1),p=l[u+2]?(" "+l[u+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":o.type=i.toUpperCase();break;case"MEDIA-SEQUENCE":h=o.startSN=parseInt(i);break;case"SKIP":{const e=new YL(i);oI(o,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(BL(t)){o.skippedSegments=t;for(let e=t;e--;)a.unshift(null);h+=t}const r=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");r&&(o.recentlyRemovedDateranges=r.split("\t"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(i),1);break;case"VERSION":o.version=parseInt(i);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(i||p)&&y.tagList.push(p?[i,p]:[i]);break;case"DISCONTINUITY":m++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([e]);break;case"BITRATE":y.tagList.push([e,i]);break;case"DATERANGE":{const e=new YL(i);oI(o,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),oI(o,e,e.clientAttrs);const t=new ZL(e,o.dateRanges[e.ID]);t.isValid||o.skippedSegments?o.dateRanges[t.id]=t:GL.warn(`Ignoring invalid DATERANGE tag: "${i}"`),y.tagList.push(["EXT-X-DATERANGE",i]);break}case"DEFINE":{const e=new YL(i);oI(o,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?uI(o,e,s):lI(o,e,t)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(i);break;case"KEY":{const e=xI(i,t,o);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=PL({},c)),c[e.keyFormat]=e}else GL.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${i}"`);break}case"START":o.startTimeOffset=wI(i);break;case"MAP":{const e=new YL(i);if(oI(o,e,["BYTERANGE","URI"]),y.duration){const i=new nR(n,t);AI(i,e,r,c),d=i,y.initSegment=d,d.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=d.rawProgramDateTime)}else AI(y,e,r,c),d=y,b=!0;break}case"SERVER-CONTROL":{const e=new YL(i);o.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),o.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new YL(i);o.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=o.partList;e||(e=o.partList=[]);const r=f>0?e[e.length-1]:void 0,n=f++,s=new YL(i);oI(o,s,["BYTERANGE","URI"]);const a=new iR(s,y,t,n,r);e.push(a),y.duration+=a.duration;break}case"PRELOAD-HINT":{const e=new YL(i);oI(o,e,["URI"]),o.preloadHint=e;break}case"RENDITION-REPORT":{const e=new YL(i);oI(o,e,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(e);break}default:GL.warn(`line parsed but not handled: ${l}`)}}}g&&!g.relurl?(a.pop(),p-=g.duration,o.partList&&(o.fragmentHint=g)):o.partList&&(TI(y,g),y.cc=m,o.fragmentHint=y,c&&DI(y,c,o));const x=a.length,w=a[0],E=a[x-1];if(p+=o.skippedSegments*o.targetduration,p>0&&x&&E){o.averagetargetduration=p/x;const e=E.sn;o.endSN="initSegment"!==e?e:0,o.live||(E.endList=!0),w&&(o.startCC=w.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(p+=o.fragmentHint.duration),o.totalduration=p,o.endCC=m,v>0&&function(e,t){let r=e[t];for(let n=t;n--;){const t=e[n];if(!t)return;t.programDateTime=r.programDateTime-1e3*t.duration,r=t}}(a,v),o}}function xI(e,t,r){var n,i;const s=new YL(e);oI(r,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=null!=(n=s.METHOD)?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=null!=(i=s.KEYFORMAT)?i:"identity";a&&s.IV&&!l&&GL.error(`Invalid IV: ${s.IV}`);const d=a?bI.resolve(a,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new nI(o,d,c,h,l)}function wI(e){const t=new YL(e).decimalFloatingPoint("TIME-OFFSET");return BL(t)?t:null}function EI(e,t){["video","audio","text"].forEach((r=>{const n=e.filter((e=>function(e,t){const r=dI[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)));if(n.length){const i=n.filter((e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)));t[`${r}Codec`]=i.length>0?i[0]:n[0],e=e.filter((e=>-1===n.indexOf(e)))}})),t.unknownCodecs=e}function SI(e,t,r){const n=t[r];n&&(e[r]=n)}function TI(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),BL(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function AI(e,t,r,n){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",n&&(e.levelkeys=n),e.initSegment=null}function DI(e,t,r){e.levelkeys=t;const{encryptedFragments:n}=r;n.length&&n[n.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||n.push(e)}var NI="manifest",CI="level",kI="audioTrack",MI="subtitleTrack",OI="main",_I="audio",LI="subtitle";function RI(e){const{type:t}=e;switch(t){case kI:return _I;case MI:return LI;default:return OI}}function II(e,t){let r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}class FI{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.LEVEL_LOADING,this.onLevelLoading,this),e.on(UL.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(UL.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.LEVEL_LOADING,this.onLevelLoading,this),e.off(UL.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(UL.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,n=t.loader,i=new(r||n)(t);return this.loaders[e.type]=i,i}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:NI,url:r,deliveryDirectives:null})}onLevelLoading(e,t){const{id:r,level:n,url:i,deliveryDirectives:s}=t;this.load({id:r,level:n,responseType:"text",type:CI,url:i,deliveryDirectives:s})}onAudioTrackLoading(e,t){const{id:r,groupId:n,url:i,deliveryDirectives:s}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:kI,url:i,deliveryDirectives:s})}onSubtitleTrackLoading(e,t){const{id:r,groupId:n,url:i,deliveryDirectives:s}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:MI,url:i,deliveryDirectives:s})}load(e){var t;const r=this.hls.config;let n,i=this.getInternalLoader(e);if(i){const t=i.context;if(t&&t.url===e.url)return void GL.trace("[playlist-loader]: playlist request ongoing");GL.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}if(n=e.type===NI?r.manifestLoadPolicy.default:PL({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let t;if(e.type===CI&&null!==e.level?t=this.hls.levels[e.level].details:e.type===kI&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===MI&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,r=t.targetduration;if(e&&r){const t=1e3*Math.max(3*e,.8*r);n=PL({},n,{maxTimeToFirstByteMs:Math.min(t,n.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,n.maxTimeToFirstByteMs)})}}}const s=n.errorRetry||n.timeoutRetry||{},o={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},a={onSuccess:(e,t,r,n)=>{const i=this.getInternalLoader(r);this.resetInternalLoader(r.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),bI.isMediaPlaylist(s)?this.handleTrackOrLevelPlaylist(e,t,r,n||null,i):this.handleMasterPlaylist(e,t,r,n)):this.handleManifestParsingError(e,r,new Error("no EXTM3U delimiter"),n||null,t)},onError:(e,t,r,n)=>{this.handleNetworkError(t,r,!1,e,n)},onTimeout:(e,t,r)=>{this.handleNetworkError(t,r,!0,void 0,e)}};i.load(e,o,a)}handleMasterPlaylist(e,t,r,n){const i=this.hls,s=e.data,o=II(e,r),a=bI.parseMasterPlaylist(s,o);if(a.playlistParsingError)return void this.handleManifestParsingError(e,r,a.playlistParsingError,n,t);const{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f}=a;this.variableList=f;const{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=bI.parseMasterPlaylistMedia(s,o,a);if(p.length){p.some((e=>!e.url))||!u[0].audioCodec||u[0].attrs.AUDIO||(GL.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new YL({}),bitrate:0,url:""}))}i.trigger(UL.MANIFEST_LOADED,{levels:u,audioTracks:p,subtitles:m,captions:g,contentSteering:l,url:o,stats:t,networkDetails:n,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f})}handleTrackOrLevelPlaylist(e,t,r,n,i){const s=this.hls,{id:o,level:a,type:l}=r,u=II(e,r),c=BL(o)?o:0,d=BL(a)?a:c,h=RI(r),f=bI.parseLevelPlaylist(e.data,u,d,h,c,this.variableList);if(l===NI){const e={attrs:new YL({}),bitrate:0,details:f,name:"",url:u};s.trigger(UL.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=f,this.handlePlaylistLoaded(f,e,t,r,n,i)}handleManifestParsingError(e,t,r,n,i){this.hls.trigger(UL.ERROR,{type:$L.NETWORK_ERROR,details:jL.MANIFEST_PARSING_ERROR,fatal:t.type===NI,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:i})}handleNetworkError(e,t,r=!1,n,i){let s=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===CI?s+=`: ${e.level} id: ${e.id}`:e.type!==kI&&e.type!==MI||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(s);GL.warn(`[playlist-loader]: ${s}`);let a=jL.UNKNOWN,l=!1;const u=this.getInternalLoader(e);switch(e.type){case NI:a=r?jL.MANIFEST_LOAD_TIMEOUT:jL.MANIFEST_LOAD_ERROR,l=!0;break;case CI:a=r?jL.LEVEL_LOAD_TIMEOUT:jL.LEVEL_LOAD_ERROR,l=!1;break;case kI:a=r?jL.AUDIO_TRACK_LOAD_TIMEOUT:jL.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case MI:a=r?jL.SUBTITLE_TRACK_LOAD_TIMEOUT:jL.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);const c={type:$L.NETWORK_ERROR,details:a,fatal:l,url:e.url,loader:u,context:e,error:o,networkDetails:t,stats:i};if(n){const r=(null==t?void 0:t.url)||e.url;c.response=IL({url:r,data:void 0},n)}this.hls.trigger(UL.ERROR,c)}handlePlaylistLoaded(e,t,r,n,i,s){const o=this.hls,{type:a,level:l,id:u,groupId:c,deliveryDirectives:d}=n,h=II(t,n),f=RI(n),p="number"==typeof n.level&&f===OI?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void o.trigger(UL.ERROR,{type:$L.NETWORK_ERROR,details:jL.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:n,level:p,parent:f,networkDetails:i,stats:r})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m)o.trigger(UL.ERROR,{type:$L.NETWORK_ERROR,details:jL.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:n,level:p,parent:f,networkDetails:i,stats:r});else switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),a){case NI:case CI:o.trigger(UL.LEVEL_LOADED,{details:e,level:p||0,id:u||0,stats:r,networkDetails:i,deliveryDirectives:d});break;case kI:o.trigger(UL.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:i,deliveryDirectives:d});break;case MI:o.trigger(UL.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:i,deliveryDirectives:d})}}}function PI(e,t){let r;try{r=new Event("addtrack")}catch(e){r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function BI(e,t){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(r){GL.debug(`[texttrack-utils]: ${r}`);try{const r=new self.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,e.addCue(r)}catch(e){GL.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===r&&(e.mode=r)}function UI(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function $I(e,t,r,n){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0){const i=function(e,t,r){const n=[],i=function(e,t){if(t<e[0].startTime)return 0;const r=e.length-1;if(t>e[r].endTime)return-1;let n=0,i=r;for(;n<=i;){const s=Math.floor((i+n)/2);if(t<e[s].startTime)i=s-1;else{if(!(t>e[s].startTime&&n<r))return s;n=s+1}}return e[n].startTime-t<t-e[i].startTime?n:i}(e,t);if(i>-1)for(let s=i,o=e.length;s<o;s++){const i=e[s];if(i.startTime>=t&&i.endTime<=r)n.push(i);else if(i.startTime>r)return n}return n}(e.cues,t,r);for(let t=0;t<i.length;t++)n&&!n(i[t])||e.removeCue(i[t])}"disabled"===i&&(e.mode=i)}var jI="org.id3",zI="com.apple.quicktime.HLS",qI="https://aomedia.org/emsg/ID3";function HI(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const VI=(()=>{const e=HI();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function GI(e,t){return e.getTime()/1e3-t}class WI{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(UL.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(UL.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(UI(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if("metadata"===r.kind&&"id3"===r.label)return PI(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:n}}}=this;if(!r&&!n)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=HI();for(let e=0;e<i.length;e++){const t=i[e].type;if(t===qI&&!r||!n)continue;const o=NR(i[e].data);if(o){const r=i[e].pts;let n=r+i[e].duration;n>VI&&(n=VI);n-r<=0&&(n=r+.25);for(let e=0;e<o.length;e++){const i=o[e];if(!AR(i)){this.updateId3CueEnds(r,t);const e=new s(r,n,"");e.value=i,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var r;const n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(let r=n.length;r--;){const i=n[r];i.type===t&&i.startTime<e&&i.endTime===VI&&(i.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:n}){const{id3Track:i,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:a}}=s;if(i&&(o||a)){let e;e="audio"===n?e=>e.type===jI&&a:"video"===n?e=>e.type===qI&&o:e=>e.type===jI&&a||e.type===qI&&o,$I(i,t,r,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:r,id3Track:n}=this,{dateRanges:i}=t,s=Object.keys(i);if(n){const e=Object.keys(r).filter((e=>!s.includes(e)));for(let t=e.length;t--;){const i=e[t];Object.keys(r[i].cues).forEach((e=>{n.removeCue(r[i].cues[e])})),delete r[i]}}const o=t.fragments[t.fragments.length-1];if(0===s.length||!BL(null==o?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=o.programDateTime/1e3-o.start,l=HI();for(let e=0;e<s.length;e++){const t=s[e],n=i[t],o=r[t],d=(null==o?void 0:o.cues)||{};let h=(null==o?void 0:o.durationKnown)||!1;const f=GI(n.startDate,a);let p=VI;const m=n.endDate;if(m)p=GI(m,a),h=!0;else if(n.endOnNext&&!h){const e=s.reduce(((e,t)=>{const r=i[t];return r.class===n.class&&r.id!==t&&r.startDate>n.startDate&&e.push(r),e}),[]).sort(((e,t)=>e.startDate.getTime()-t.startDate.getTime()))[0];e&&(p=GI(e.startDate,a),h=!0)}const g=Object.keys(n.attr);for(let e=0;e<g.length;e++){const r=g[e];if("ID"===(c=r)||"CLASS"===c||"START-DATE"===c||"DURATION"===c||"END-DATE"===c||"END-ON-NEXT"===c)continue;let i=d[r];if(i)h&&!o.durationKnown&&(i.endTime=p);else{let e=n.attr[r];i=new l(f,p,""),JL(r)&&(u=e,e=Uint8Array.from(u.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),i.value={key:r,data:e},i.type=zI,i.id=t,this.id3Track.addCue(i),d[r]=i}}r[t]={cues:d,dateRange:n,durationKnown:h}}var u,c}}class KI{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:r,targetduration:n}=e,{liveSyncDuration:i,liveSyncDurationCount:s,lowLatencyMode:o}=this.config,a=this.hls.userConfig;let l=o&&r||t;(a.liveSyncDuration||a.liveSyncDurationCount||0===l)&&(l=void 0!==i?i:s*n);const u=n;return l+Math.min(1*this.stallCount,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(null===e||null===t||null===r)return null;const n=r.edge,i=e-t-this.edgeStalled,s=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(s,i),o)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(UL.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(UL.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(UL.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(UL.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var r;t.details===jL.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(r=this.levelDetails)&&r.live&&GL.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const r=this.computeLatency();if(null===r)return;this._latency=r;const{lowLatencyMode:n,maxLiveSyncPlaybackRate:i}=this.config;if(!n||1===i)return;const s=this.targetLatency;if(null===s)return;const o=r-s,a=o<Math.min(this.maxLatency,s+t.targetduration);if(t.live&&a&&o>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,i)),r=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,r))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const YI=["NONE","TYPE-0","TYPE-1",null];var JI="",ZI="YES",XI="v2";class QI{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class eF{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>e)).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function tF(e,t){const r=t.startPTS;if(BL(r)){let n,i=0;t.sn>e.sn?(i=r-e.start,n=e):(i=e.start-r,n=t),n.duration!==i&&(n.duration=i)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function rF(e,t,r,n,i,s){n-r<=0&&(GL.warn("Fragment should have a positive duration",t),n=r+t.duration,s=i+t.duration);let o=r,a=n;const l=t.startPTS,u=t.endPTS;if(BL(l)){const e=Math.abs(l-r);BL(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,o=Math.max(r,l),r=Math.min(r,l),i=Math.min(i,t.startDTS),a=Math.min(n,u),n=Math.max(n,u),s=Math.max(s,t.endDTS)}const c=r-t.start;0!==t.start&&(t.start=r),t.duration=n-t.start,t.startPTS=r,t.maxStartPTS=o,t.startDTS=i,t.endPTS=n,t.minEndPTS=a,t.endDTS=s;const d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;let h;const f=d-e.startSN,p=e.fragments;for(p[f]=t,h=f;h>0;h--)tF(p[h],p[h-1]);for(h=f;h<p.length-1;h++)tF(p[h],p[h+1]);return e.fragmentHint&&tF(p[p.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,c}function nF(e,t){let r=null;const n=e.fragments;for(let e=n.length-1;e>=0;e--){const t=n[e].initSegment;if(t){r=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let i,s=0;if(function(e,t,r){const n=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(n?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,a=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=i;e<=s;e++){const i=l[o+e];let s=a[e];n&&!s&&e<n&&(s=t.fragments[e]=i),i&&s&&r(i,s)}}(e,t,((e,n)=>{e.relurl&&(s=e.cc-n.cc),BL(e.startPTS)&&BL(e.endPTS)&&(n.start=n.startPTS=e.startPTS,n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.duration=e.endPTS-e.startPTS,n.duration&&(i=n),t.PTSKnown=t.alignedSliding=!0),n.elementaryStreams=e.elementaryStreams,n.loader=e.loader,n.stats=e.stats,n.urlId=e.urlId,e.initSegment&&(n.initSegment=e.initSegment,r=e.initSegment)})),r){(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((e=>{var t;e.initSegment&&e.initSegment.relurl!==(null==(t=r)?void 0:t.relurl)||(e.initSegment=r)}))}if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((e=>!e)),t.deltaUpdateFailed){GL.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,r){const n=PL({},e);r&&r.forEach((e=>{delete n[e]}));return Object.keys(t).forEach((e=>{const r=new ZL(t[e].attr,n[e]);r.isValid?n[e]=r:GL.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),n}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const o=t.fragments;if(s){GL.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<o.length;e++)o[e].cc+=s}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,r){if(e&&t){let n=0;for(let i=0,s=e.length;i<=s;i++){const s=e[i],o=t[i+n];s&&o&&s.index===o.index&&s.fragment.sn===o.fragment.sn?r(s,o):n--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),i?rF(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):iF(e,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const a=t.advancedDateTime;if(t.advanced&&a){const e=t.edge;t.driftStart||(t.driftStartTime=a,t.driftStart=e),t.driftEndTime=a,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function iF(e,t){const r=t.startSN+t.skippedSegments-e.startSN,n=e.fragments;r<0||r>=n.length||sF(t,n[r].start)}function sF(e,t){if(t){const r=e.fragments;for(let n=e.skippedSegments;n<r.length;n++)r[n].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function oF(e,t,r){var n;return null!=e&&e.details?aF(null==(n=e.details)?void 0:n.partList,t,r):null}function aF(e,t,r){if(e)for(let n=e.length;n--;){const i=e[n];if(i.index===r&&i.fragment.sn===t)return i}return null}function lF(e){switch(e.details){case jL.FRAG_LOAD_TIMEOUT:case jL.KEY_LOAD_TIMEOUT:case jL.LEVEL_LOAD_TIMEOUT:case jL.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function uF(e,t){const r=lF(t);return e.default[(r?"timeout":"error")+"Retry"]}function cF(e,t){const r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function dF(e){return IL(IL({},e),{errorRetry:null,timeoutRetry:null})}function hF(e,t,r,n){return!!e&&t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(n)||!!r)}const fF={search:function(e,t){let r=0,n=e.length-1,i=null,s=null;for(;r<=n;){i=(r+n)/2|0,s=e[i];const o=t(s);if(o>0)r=i+1;else{if(!(o<0))return s;n=i-1}}return null}};function pF(e,t,r=0,n=0){let i=null;if(e?i=t[e.sn-t[0].sn+1]||null:0===r&&0===t[0].start&&(i=t[0]),i&&0===mF(r,n,i))return i;const s=fF.search(t,mF.bind(null,r,n));return!s||s===e&&i?i:s}function mF(e=0,t=0,r){if(r.start<=e&&r.start+r.duration>e)return 0;const n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function gF(e,t,r){const n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}var yF=0,vF=2,bF=5,xF=0,wF=1,EF=2;function SF(e,t,r){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;const n=e.details;if(t.details===jL.FRAG_GAP&&n&&t.frag){const e=t.frag.start,r=pF(null,n.fragments,e);if(r&&!r.gap)return!0}if(r&&e.errors.length<r.errors.length){const r=e.errors[e.errors.length-1];if(n&&r.frag&&t.frag&&Math.abs(r.frag.start-t.frag.start)>3*n.targetduration)return!0}return!1}class TF{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=GL.log.bind(GL,`${t}:`),this.warn=GL.warn.bind(GL,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const r=null==t?void 0:t.renditionReports;if(r){let n=-1;for(let i=0;i<r.length;i++){const s=r[i];let o;try{o=new self.URL(s.URI,t.url).href}catch(e){GL.warn(`Could not construct new URL for Rendition Report: ${e}`),o=s.URI||""}if(o===e){n=i;break}o===e.substring(0,o.length)&&(n=i)}if(-1!==n){const e=r[n],i=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let s=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);s>=0&&e>t.partTarget&&(s+=1)}return new QI(i,s>=0?s:void 0,JI)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,r){const{details:n,stats:i}=t,s=self.performance.now(),o=i.loading.first?Math.max(0,s-i.loading.first):0;if(n.advancedDateTime=Date.now()-o,n.live||null!=r&&r.live){if(n.reloaded(r),r&&this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),r&&n.fragments.length>0&&nF(r,n),!this.canLoad||!n.live)return;let o,a,l;if(n.canBlockReload&&n.endSN&&n.advanced){const e=this.hls.config.lowLatencyMode,i=n.lastPartSn,s=n.endSN,u=n.lastPartIndex,c=i===s;-1!==u?(a=c?s+1:i,l=c?e?0:u:u+1):a=s+1;const d=n.age,h=d+n.ageHeader;let f=Math.min(h-n.partTarget,1.5*n.targetduration);if(f>0){if(r&&f>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${f} with playlist age: ${n.age}`),f=0;else{const e=Math.floor(f/n.targetduration);if(a+=e,void 0!==l){l+=Math.round(f%n.targetduration/n.partTarget)}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${f} skip sn ${e} to part ${l}`)}n.tuneInGoal=f}if(o=this.getDeliveryDirectives(n,t.deliveryDirectives,a,l),e||!c)return void this.loadPlaylist(o)}else(n.canBlockReload||n.canSkipUntil)&&(o=this.getDeliveryDirectives(n,t.deliveryDirectives,a,l));const u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=function(e,t=1/0){let r=1e3*e.targetduration;if(e.updated){const n=e.fragments,i=4;if(n.length&&r*i>t){const e=1e3*n[n.length-1].duration;e<r&&(r=e)}}else r/=2;return Math.round(r)}(n,1e3*(n.edge-c));n.updated&&s>this.requestScheduled+d&&(this.requestScheduled=i.loading.start),void 0!==a&&n.canBlockReload?this.requestScheduled=i.loading.first+d-(1e3*n.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+d<s?this.requestScheduled=s:this.requestScheduled-s<=0&&(this.requestScheduled+=d);let h=this.requestScheduled-s;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(o)),h)}else this.clearTimer()}getDeliveryDirectives(e,t,r,n){let i=function(e,t){const{canSkipUntil:r,canSkipDateRanges:n,endSN:i}=e;return r&&(void 0!==t?t-i:0)<r?n?XI:ZI:JI}(e,r);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,i=JI),new QI(r,n,i)}checkRetry(e){const t=e.details,r=lF(e),n=e.errorAction,{action:i,retryCount:s=0,retryConfig:o}=n||{},a=!!n&&!!o&&(i===bF||!n.resolved&&i===vF);if(a){var l;if(this.requestScheduled=-1,s>=o.maxNumRetry)return!1;if(r&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=cF(o,s);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${s+1}/${o.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,n.resolved=!0}return a}}let AF;class DF extends TF{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.on(UL.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(UL.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(UL.FRAG_LOADED,this.onFragLoaded,this),e.on(UL.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.off(UL.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(UL.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(UL.FRAG_LOADED,this.onFragLoaded,this),e.off(UL.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=[],n={};let i;t.levels.forEach((e=>{var t;const s=e.attrs;-1!==(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))&&(AF||(AF=/chrome|firefox/i.test(navigator.userAgent)),AF&&(e.audioCodec=void 0));const{AUDIO:o,CODECS:a,"FRAME-RATE":l,"PATHWAY-ID":u,RESOLUTION:c,SUBTITLES:d}=s,h=`${`${u||"."}-`}${e.bitrate}-${c}-${l}-${a}`;i=n[h],i?i.addFallback(e):(i=new eF(e),n[h]=i,r.push(i)),NF(i,"audio",o),NF(i,"text",d)})),this.filterAndSortMediaOptions(r,t)}filterAndSortMediaOptions(e,t){let r=[],n=[],i=!1,s=!1,o=!1,a=e.filter((({audioCodec:e,videoCodec:t,width:r,height:n,unknownCodecs:a})=>(i||(i=!(!r||!n)),s||(s=!!t),o||(o=!!e),!(null!=a&&a.length)&&(!e||fI(e,"audio"))&&(!t||fI(t,"video")))));if((i||s)&&o&&(a=a.filter((({videoCodec:e,width:t,height:r})=>!!e||!(!t||!r)))),0===a.length)return void Promise.resolve().then((()=>{if(this.hls){const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));t.audioTracks&&(r=t.audioTracks.filter((e=>!e.audioCodec||fI(e.audioCodec,"audio"))),CF(r)),t.subtitles&&(n=t.subtitles,CF(n));const l=a.slice(0);a.sort(((e,t)=>e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):i&&e.height!==t.height?e.height-t.height:0));let u=l[0];if(this.steering&&(a=this.steering.filterParsedLevels(a),a.length!==l.length))for(let e=0;e<l.length;e++)if(l[e].pathwayId===a[0].pathwayId){u=l[e];break}this._levels=a;for(let e=0;e<a.length;e++)if(a[e]===u){this._firstLevel=e,this.log(`manifest loaded, ${a.length} level(s) found, first bitrate: ${u.bitrate}`);break}const c=o&&!s,d={levels:a,audioTracks:r,subtitleTracks:n,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:s,altAudio:!c&&r.some((e=>!!e.url))};this.hls.trigger(UL.MANIFEST_PARSED,d),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const r=new Error("invalid level idx"),n=e<0;if(this.hls.trigger(UL.ERROR,{type:$L.OTHER_ERROR,details:jL.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,n=this.currentLevel,i=n?n.attrs["PATHWAY-ID"]:void 0,s=t[e],o=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,r===e&&s.details&&n&&i===o)return;this.log(`Switching to level ${e}${o?" with Pathway "+o:""} from level ${r}${i?" with Pathway "+i:""}`);const a=PL({},s,{level:e,maxBitrate:s.maxBitrate,attrs:s.attrs,uri:s.uri,urlId:s.urlId});delete a._attrs,delete a._urlId,this.hls.trigger(UL.LEVEL_SWITCHING,a);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==n?void 0:n.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===CI&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===OI){const e=this._levels[t.level];void 0!==e&&(e.loadError=0)}}onLevelLoaded(e,t){var r;const{level:n,details:i}=t,s=this._levels[n];var o;if(!s)return this.warn(`Invalid level index ${n}`),void(null!=(o=t.deliveryDirectives)&&o.skip&&(i.deltaUpdateFailed=!0));n===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0),this.playlistLoaded(n,t,s.details)):null!=(r=t.deliveryDirectives)&&r.skip&&(i.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const r=this.currentLevel;if(!r)return;const n=this.hls.audioTracks[t.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==n){let e=-1;for(let t=0;t<r.audioGroupIds.length;t++)if(r.audioGroupIds[t]===n){e=t;break}-1!==e&&e!==r.urlId&&(r.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,r=this.currentLevel;if(r&&this.shouldLoadPlaylist(r)){const n=r.urlId;let i=r.uri;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const s=r.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} URI ${n+1}/${r.url.length} ${i}`),this.clearTimer(),this.hls.trigger(UL.LEVEL_LOADING,{url:i,level:t,id:n,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const r=(e,r)=>r!==t,n=this._levels.filter(((n,i)=>i!==e||(n.url.length>1&&void 0!==t?(n.url=n.url.filter(r),n.audioGroupIds&&(n.audioGroupIds=n.audioGroupIds.filter(r)),n.textGroupIds&&(n.textGroupIds=n.textGroupIds.filter(r)),n.urlId=0,!0):(this.steering&&this.steering.removeLevel(n),!1))));this.hls.trigger(UL.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){t.forEach(((e,t)=>{const{details:r}=e;null!=r&&r.fragments&&r.fragments.forEach((e=>{e.level=t}))})),this._levels=t}}function NF(e,t,r){r&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=r):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=r))}function CF(e){const t={};e.forEach((e=>{const r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}var kF="NOT_LOADED",MF="APPENDING",OF="PARTIAL",_F="OK";class LF{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(UL.BUFFER_APPENDED,this.onBufferAppended,this),e.on(UL.FRAG_BUFFERED,this.onFragBuffered,this),e.on(UL.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.BUFFER_APPENDED,this.onBufferAppended,this),e.off(UL.FRAG_BUFFERED,this.onFragBuffered,this),e.off(UL.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let t=r.length;t--;){const n=r[t];if(!n)break;const i=n.end;if(n.start<=e&&null!==i&&e<=i)return n}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:r}=this,n=Object.keys(r);for(let i=n.length;i--;){const s=r[n[i]];if((null==s?void 0:s.body.type)===t&&s.buffered){const t=s.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,r,n){this.timeRanges&&(this.timeRanges[e]=t);const i=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((n=>{const s=this.fragments[n];if(!s)return;if(i>=s.body.sn)return;if(!s.buffered&&!s.loaded)return void(s.body.type===r&&this.removeFragment(s.body));const o=s.range[e];o&&o.time.some((e=>{const r=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&this.removeFragment(s.body),r}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:r,part:n}=e;if(!t||"initSegment"===r.sn)return;const i=IF(r),s=this.fragments[i];if(!s||s.buffered&&r.gap)return;const o=!r.relurl;if(Object.keys(t).forEach((e=>{const i=r.elementaryStreams[e];if(!i)return;const a=t[e],l=o||!0===i.partial;s.range[e]=this.getBufferedTimes(r,n,l,a)})),s.loaded=null,Object.keys(s.range).length){s.buffered=!0;(s.body.endList=r.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),RF(s)||this.removeParts(r.sn-1,r.type)}else this.removeFragment(s.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const r=IF(e);let n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(e,t,r,n){const i={time:[],partial:r},s=e.start,o=e.end,a=e.minEndPTS||o,l=e.maxStartPTS||s;for(let e=0;e<n.length;e++){const t=n.start(e)-this.bufferPadding,r=n.end(e)+this.bufferPadding;if(l>=t&&a<=r){i.time.push({startPTS:Math.max(s,n.start(e)),endPTS:Math.min(o,n.end(e))});break}if(s<r&&o>t)i.partial=!0,i.time.push({startPTS:Math.max(s,n.start(e)),endPTS:Math.min(o,n.end(e))});else if(o<=t)break}return i}getPartialFragment(e){let t,r,n,i=null,s=0;const{bufferPadding:o,fragments:a}=this;return Object.keys(a).forEach((l=>{const u=a[l];u&&RF(u)&&(r=u.body.start-o,n=u.body.end+o,e>=r&&e<=n&&(t=Math.min(e-r,n-e),s<=t&&(i=u.body,s=t)))})),i}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||RF(t))}getState(e){const t=IF(e),r=this.fragments[t];return r?r.buffered?RF(r)?OF:_F:MF:kF}isTimeBuffered(e,t,r){let n,i;for(let s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,i=r.end(s)+this.bufferPadding,e>=n&&t<=i)return!0;if(t<=n)return!1}return!1}onFragLoaded(e,t){const{frag:r,part:n}=t;if("initSegment"===r.sn||r.bitrateTest)return;const i=n?null:t,s=IF(r);this.fragments[s]={body:r,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:n,timeRanges:i}=t;if("initSegment"===r.sn)return;const s=r.type;if(n){let e=this.activePartLists[s];e||(this.activePartLists[s]=e=[]),e.push(n)}this.timeRanges=i,Object.keys(i).forEach((e=>{const t=i[e];this.detectEvictedFragments(e,t,s,n)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=IF(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,r,n,i){n&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const o=this.fragments[s];if(!o)return;const a=o.body;a.type!==r||n&&!a.gap||a.start<t&&a.end>e&&(o.buffered||i)&&this.removeFragment(a)}))}removeFragment(e){const t=IF(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const t=e.sn;this.activePartLists[e.type]=r.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function RF(e){var t,r,n;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(r=e.range.audio)?void 0:r.partial)||(null==(n=e.range.audiovideo)?void 0:n.partial))}function IF(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}const FF=Math.pow(2,17);class PF{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new $F({type:$L.NETWORK_ERROR,details:jL.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(r?"part list":"url")),networkDetails:null}));this.abort();const n=this.config,i=n.fLoader,s=n.loader;return new Promise(((o,a)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void a(UF(e));e.gap=!1}const l=this.loader=e.loader=i?new i(n):new s(n),u=BF(e),c=dF(n.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:FF};e.stats=l.stats,l.load(u,d,{onSuccess:(t,r,n,i)=>{this.resetLoader(e,l);let s=t.data;n.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),o({frag:e,part:null,payload:s,networkDetails:i})},onError:(t,n,i,s)=>{this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:IL({url:r,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:i,stats:s}))},onAbort:(t,r,n)=>{this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:n,stats:t}))},onTimeout:(t,r,n)=>{this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:n,stats:t}))},onProgress:(r,n,i,s)=>{t&&t({frag:e,part:null,payload:i,networkDetails:s})}})}))}loadPart(e,t,r){this.abort();const n=this.config,i=n.fLoader,s=n.loader;return new Promise(((o,a)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void a(UF(e,t));const l=this.loader=e.loader=i?new i(n):new s(n),u=BF(e,t),c=dF(n.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:FF};t.stats=l.stats,l.load(u,d,{onSuccess:(n,i,s,a)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const u={frag:e,part:t,payload:n.data,networkDetails:a};r(u),o(u)},onError:(r,n,i,s)=>{this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:IL({url:u.url,data:void 0},r),error:new Error(`HTTP Error ${r.code} ${r.text}`),networkDetails:i,stats:s}))},onAbort:(r,n,i)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:i,stats:r}))},onTimeout:(r,n,i)=>{this.resetLoader(e,l),a(new $F({type:$L.NETWORK_ERROR,details:jL.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:i,stats:r}))}})}))}updateStatsFromPart(e,t){const r=e.stats,n=t.stats,i=n.total;if(r.loaded+=n.loaded,i){const n=Math.round(e.duration/t.duration),s=Math.min(Math.round(r.loaded/i),n),o=(n-s)*Math.round(r.loaded/s);r.total=r.loaded+o}else r.total=Math.max(r.loaded,r.total);const s=r.loading,o=n.loading;s.start?s.first+=o.first-o.start:(s.start=o.start,s.first=o.first),s.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function BF(e,t=null){const r=t||e,n={frag:e,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},i=r.byteRangeStartOffset,s=r.byteRangeEndOffset;if(BL(i)&&BL(s)){var o;let t=i,r=s;if("initSegment"===e.sn&&"AES-128"===(null==(o=e.decryptdata)?void 0:o.method)){const e=s-i;e%16&&(r=s+(16-e%16)),0!==i&&(n.resetIV=!0,t=i-16)}n.rangeStart=t,n.rangeEnd=r}return n}function UF(e,t){const r=new Error(`GAP ${e.gap?"tag":"attribute"} found`),n={type:$L.MEDIA_ERROR,details:jL.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(n.part=t),(t||e).stats.aborted=!0,new $F(n)}class $F extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class jF{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[t].loader;if(r){if(e&&e!==r.context.frag.type)return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=jL.KEY_LOAD_ERROR,r,n,i){return new $F({type:$L.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:n})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:r,cc:n}=e;for(let e=0;e<t.length;e++){const i=t[e];if(n<=i.cc&&("initSegment"===r||"initSegment"===i.sn||r<i.sn)){this.emeController.selectKeySystemFormat(i).then((e=>{i.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var r,n;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const r=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,jL.KEY_LOAD_ERROR,r))}const s=i.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,jL.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let o=this.keyUriToKeyInfo[s];if(null!=(r=o)&&r.decryptdata.key)return i.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});var a;if(null!=(n=o)&&n.keyLoadPromise)switch(null==(a=o.mediaKeySessionContext)?void 0:a.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then((t=>(i.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:o})))}switch(o=this.keyUriToKeyInfo[s]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,jL.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(r);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,r)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,n=new(0,r.loader)(r);return t.keyLoader=e.loader=n,e.keyLoadPromise=new Promise(((i,s)=>{const o={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},a=r.keyLoadPolicy.default,l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,r,n)=>{const{frag:o,keyInfo:a,url:l}=r;if(!o.decryptdata||a!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(o,jL.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),n));a.decryptdata.key=o.decryptdata.key=new Uint8Array(e.data),o.keyLoader=null,a.loader=null,i({frag:o,keyInfo:a})},onError:(e,r,n,i)=>{this.resetLoader(r),s(this.createKeyLoadError(t,jL.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),n,IL({url:o.url,data:void 0},e)))},onTimeout:(e,r,n)=>{this.resetLoader(r),s(this.createKeyLoadError(t,jL.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),n))},onAbort:(e,r,n)=>{this.resetLoader(r),s(this.createKeyLoadError(t,jL.INTERNAL_ABORTED,new Error("key loading aborted"),n))}};n.load(o,l,u)}))}resetLoader(e){const{frag:t,keyInfo:r,url:n}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],i&&i.destroy()}}class zF{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const qF={length:0,start:()=>0,end:()=>0};class HF{static isBuffered(e,t){try{if(e){const r=HF.getBuffered(e);for(let e=0;e<r.length;e++)if(t>=r.start(e)&&t<=r.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,r){try{if(e){const n=HF.getBuffered(e),i=[];let s;for(s=0;s<n.length;s++)i.push({start:n.start(s),end:n.end(s)});return this.bufferedInfo(i,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.sort((function(e,t){const r=e.start-t.start;return r||t.end-e.end}));let n=[];if(r)for(let t=0;t<e.length;t++){const i=n.length;if(i){const s=n[i-1].end;e[t].start-s<r?e[t].end>s&&(n[i-1].end=e[t].end):n.push(e[t])}else n.push(e[t])}else n=e;let i,s=0,o=t,a=t;for(let e=0;e<n.length;e++){const l=n[e].start,u=n[e].end;if(t+r>=l&&t<u)o=l,a=u,s=a-t;else if(t+r<l){i=l;break}}return{len:s,start:o||0,end:a||0,nextStart:i}}static getBuffered(e){try{return e.buffered}catch(e){return GL.log("failed to get media.buffered",e),qF}}}class VF{constructor(e,t,r,n=0,i=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=i,this.partial=s}}function GF(e,t){let r=null;for(let n=0,i=e.length;n<i;n++){const i=e[n];if(i&&i.cc===t){r=i;break}}return r}function WF(e,t){if(e){const r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function KF(e,t){const r=t.fragments;for(let t=0,n=r.length;t<n;t++)WF(r[t],e);t.fragmentHint&&WF(t.fragmentHint,e),t.alignedSliding=!0}function YF(e,t,r){t&&(!function(e,t,r){if(function(e,t,r){return!(!t.details||!(r.endCC>r.startCC||e&&e.cc<r.startCC))}(e,r,t)){const e=function(e,t,r=0){const n=e.fragments,i=t.fragments;if(!i.length||!n.length)return void GL.log("No fragments to align");const s=GF(n,i[0].cc);if(s&&(!s||s.startPTS))return s;GL.log("No frag in previous level to align on")}(r.details,t);e&&BL(e.start)&&(GL.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),KF(e.start,t))}}(e,r,t),!r.alignedSliding&&t.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;const r=t.fragments[0].programDateTime,n=e.fragments[0].programDateTime,i=(n-r)/1e3+t.fragments[0].start;i&&BL(i)&&(GL.log(`Adjusting PTS using programDateTime delta ${n-r}ms, sliding:${i.toFixed(3)} ${e.url} `),KF(i,e))}(r,t.details),r.alignedSliding||!t.details||r.skippedSegments||iF(t.details,r))}function JF(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const r=e.fragments,n=t.fragments;if(!r.length||!n.length)return;const i=n[Math.round(n.length/2)-1],s=GF(r,i.cc)||r[Math.round(r.length/2)-1],o=i.programDateTime,a=s.programDateTime;if(null===o||null===a)return;KF((a-o)/1e3-(s.start-i.start),e)}class ZF{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class XF{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class QF{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let e=0;e<4;e++)r[e]=t.getUint32(4*e);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],s=r[2],o=r[3],a=this.invSubMix,l=a[0],u=a[1],c=a[2],d=a[3],h=new Uint32Array(256);let f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let r=p^p<<1^p<<2^p<<3^p<<4;r=r>>>8^255&r^99,e[f]=r,t[r]=f;const a=h[f],m=h[a],g=h[m];let y=257*h[r]^16843008*r;n[f]=y<<24|y>>>8,i[f]=y<<16|y>>>16,s[f]=y<<8|y>>>24,o[f]=y,y=16843009*g^65537*m^257*a^16843008*f,l[r]=y<<24|y>>>8,u[r]=y<<16|y>>>16,c[r]=y<<8|y>>>24,d[r]=y,f?(f=a^h[h[h[g^a]]],p^=h[h[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,n=0;for(;n<t.length&&r;)r=t[n]===this.key[n],n++;if(r)return;this.key=t;const i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const s=this.ksRows=4*(i+6+1);let o,a;const l=this.keySchedule=new Uint32Array(s),u=this.invKeySchedule=new Uint32Array(s),c=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],m=h[2],g=h[3];let y,v;for(o=0;o<s;o++)o<i?y=l[o]=t[o]:(v=y,o%i==0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v],v^=d[o/i|0]<<24):i>6&&o%i==4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v]),l[o]=y=(l[o-i]^v)>>>0);for(a=0;a<s;a++)o=s-a,v=3&a?l[o]:l[o-4],u[a]=a<4||o<=4?v:f[c[v>>>24]]^p[c[v>>>16&255]]^m[c[v>>>8&255]]^g[c[255&v]],u[a]=u[a]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,r){const n=this.keySize+6,i=this.invKeySchedule,s=this.invSBox,o=this.invSubMix,a=o[0],l=o[1],u=o[2],c=o[3],d=this.uint8ArrayToUint32Array_(r);let h=d[0],f=d[1],p=d[2],m=d[3];const g=new Int32Array(e),y=new Int32Array(g.length);let v,b,x,w,E,S,T,A,D,N,C,k,M,O;const _=this.networkToHostOrderSwap;for(;t<g.length;){for(D=_(g[t]),N=_(g[t+1]),C=_(g[t+2]),k=_(g[t+3]),E=D^i[0],S=k^i[1],T=C^i[2],A=N^i[3],M=4,O=1;O<n;O++)v=a[E>>>24]^l[S>>16&255]^u[T>>8&255]^c[255&A]^i[M],b=a[S>>>24]^l[T>>16&255]^u[A>>8&255]^c[255&E]^i[M+1],x=a[T>>>24]^l[A>>16&255]^u[E>>8&255]^c[255&S]^i[M+2],w=a[A>>>24]^l[E>>16&255]^u[S>>8&255]^c[255&T]^i[M+3],E=v,S=b,T=x,A=w,M+=4;v=s[E>>>24]<<24^s[S>>16&255]<<16^s[T>>8&255]<<8^s[255&A]^i[M],b=s[S>>>24]<<24^s[T>>16&255]<<16^s[A>>8&255]<<8^s[255&E]^i[M+1],x=s[T>>>24]<<24^s[A>>16&255]<<16^s[E>>8&255]<<8^s[255&S]^i[M+2],w=s[A>>>24]<<24^s[E>>16&255]<<16^s[S>>8&255]<<8^s[255&T]^i[M+3],y[t]=_(v^h),y[t+1]=_(w^f),y[t+2]=_(x^p),y[t+3]=_(b^m),h=D,f=N,p=C,m=k,t+=4}return y.buffer}}class eP{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,r=t&&new DataView(e.buffer).getUint8(t-1);return r?bR(e,0,t-r):e}(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r){return this.useSoftware?new Promise(((n,i)=>{this.softwareDecrypt(new Uint8Array(e),t,r);const s=this.flush();s?n(s.buffer):i(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r)}softwareDecrypt(e,t,r){const{currentIV:n,currentResult:i,remainderData:s}=this;this.logOnce("JS AES decrypt"),s&&(e=JR(s,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;n&&(r=n);let a=this.softwareDecrypter;a||(a=this.softwareDecrypter=new QF),a.expandKey(t);const l=i;return this.currentResult=a.decrypt(o.buffer,0,r),this.currentIV=bR(o,-16).buffer,l||null}webCryptoDecrypt(e,t,r){const n=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new XF(n,t)),this.fastAesKey.expandKey().then((t=>{if(!n)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new ZF(n,new Uint8Array(r)).decrypt(e.buffer,t)})).catch((n=>(GL.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${n.name}: ${n.message}`),this.onWebCryptoError(e,t,r))))}onWebCryptoError(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);const n=this.flush();if(n)return n.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%16;return r!==e.length&&(t=bR(e,0,r),this.remainderData=bR(e,r)),t}logOnce(e){this.logEnabled&&(GL.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const tP=function(e){let t="";const r=e.length;for(let n=0;n<r;n++)t+=`[${e.start(n).toFixed(3)}-${e.end(n).toFixed(3)}]`;return t},rP="STOPPED",nP="IDLE",iP="KEY_LOADING",sP="FRAG_LOADING",oP="FRAG_LOADING_WAITING_RETRY",aP="WAITING_TRACK",lP="PARSING",uP="PARSED",cP="ENDED",dP="ERROR",hP="WAITING_INIT_PTS",fP="WAITING_LEVEL";class pP extends zF{constructor(e,t,r,n,i){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=rP,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=i,this.logPrefix=n,this.log=GL.log.bind(GL,`${n}:`),this.warn=GL.warn.bind(GL,`${n}:`),this.hls=e,this.fragmentLoader=new PF(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new eP(e.config),e.on(UL.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=rP}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const r=t.partList;if(null!=r&&r.length){const e=r[r.length-1];return HF.isBuffered(this.media,e.start+e.duration/2)}const n=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(n)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);const n=this.config;this.levels&&n.autoStartLoad&&this.state===rP&&this.startLoad(n.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:r,mediaBuffer:n,state:i}=this,s=r?r.currentTime:0,o=HF.bufferInfo(n||r,s,e.maxBufferHole);if(this.log(`media seeking to ${BL(s)?s.toFixed(3):s}, state: ${i}`),this.state===cP)this.resetLoadingState();else if(t){const r=e.maxFragLookUpTolerance,n=t.start-r,i=t.start+t.duration+r;if(!o.len||i<o.start||n>o.end){const e=s>i;(s<n||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),this.lastCurrentTime=s),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=rP,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){this._doFragLoad(e,t,r,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const r=this.state;this.fragContextChanged(e)?(r===sP||!this.fragCurrent&&r===lP)&&(this.fragmentTracker.removeFragment(e),this.state=nP):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(UL.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==rP&&this.state!==dP&&(this.warn(t),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===MF){const t=e.type,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=Math.max(e.duration,n?n.len:this.config.maxBufferLength);this.reduceMaxBufferLength(i)&&r.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===OF&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:r};this.hls.trigger(UL.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:r}=this,{payload:n}=t,i=e.decryptdata;if(n&&n.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch((t=>{throw r.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((n=>{const i=self.performance.now();return r.trigger(UL.FRAG_DECRYPTED,{frag:e,payload:n,stats:{tstart:s,tdecrypt:i}}),t.payload=n,t}))}return t})).then((r=>{const{fragCurrent:n,hls:i,levels:s}=this;if(!s)throw new Error("init load aborted, missing levels");const o=e.stats;this.state=nP,t.fragmentError=0,e.data=new Uint8Array(r.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),r.frag===n&&i.trigger(UL.FRAG_BUFFERED,{stats:o,frag:n,part:null,id:e.type}),this.tick()})).catch((t=>{this.state!==rP&&this.state!==dP&&(this.warn(t),this.resetFragmentLoading(e))}))}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var r,n,i,s;const o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===OI?"level":"track"} ${e.level} (frag:[${(null!=(r=e.startPTS)?r:NaN).toFixed(3)}-${(null!=(n=e.endPTS)?n:NaN).toFixed(3)}] > buffer:${o?tP(HF.getBuffered(o)):"(detached)"})`),this.state=nP,o&&(!this.loadedmetadata&&e.type==OI&&o.buffered.length&&(null==(i=this.fragCurrent)?void 0:i.sn)===(null==(s=this.fragPrevious)?void 0:s.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:n,partsLoaded:i}=e,s=!i||0===i.length||i.some((e=>!e)),o=new VF(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!s);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,n){var i;const s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let o=null;if(!e.encrypted||null!=(i=e.decryptdata)&&i.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=iP,this.fragCurrent=e,o=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(UL.KEY_LOADED,e),this.state===iP&&(this.state=nP),e})),this.hls.trigger(UL.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const i=s.partList;if(i&&n){r>e.end&&s.fragmentHint&&(e=s.fragmentHint);const a=this.getNextPart(i,e,r);if(a>-1){const l=i[a];let u;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${s.startSN}-${s.endSN}] parts [0-${a}-${i.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=sP,u=o?o.then((r=>!r||this.fragContextChanged(r.frag)?null:this.doFragPartsLoad(e,l,t,n))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,n).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(UL.FRAG_LOADING,{frag:e,part:l,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!e.url||this.loadedEndOfParts(i,r))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${s?"of ["+s.startSN+"-"+s.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),BL(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=sP;const a=this.config.progressive;let l;return l=a&&o?o.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,n))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,a?n:void 0),o]).then((([e])=>(!a&&e&&n&&n(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(UL.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,r,n){return new Promise(((i,s)=>{var o;const a=[],l=null==(o=r.details)?void 0:o.partList,u=t=>{this.fragmentLoader.loadPart(e,t,n).then((n=>{a[t.index]=n;const s=n.part;this.hls.trigger(UL.FRAG_LOADED,n);const o=oF(r,e.sn,t.index+1)||aF(l,e.sn,t.index+1);if(!o)return i({frag:e,part:s,partsLoaded:a});u(o)})).catch(s)};u(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===jL.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(UL.ERROR,t)}else this.hls.trigger(UL.ERROR,{type:$L.OTHER_ERROR,details:jL.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==lP)return void(this.fragCurrent||this.state===rP||this.state===dP||(this.state=nP));const{frag:r,part:n,level:i}=t,s=self.performance.now();r.stats.parsing.end=s,n&&(n.stats.parsing.end=s),this.updateLevelTiming(r,n,i,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:n,sn:i,part:s}=e;if(null==t||!t[n])return this.warn(`Levels object was unset while buffering fragment ${i} of level ${n}. The current chunk will not be buffered.`),null;const o=t[n],a=s>-1?oF(o,i,s):null,l=a?a.fragment:function(e,t,r){if(null==e||!e.details)return null;const n=e.details;let i=n.fragments[t-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===t?i:t<n.startSN&&r&&r.sn===t?r:null)}(o,i,r);return l?(r&&r!==l&&(l.stats=r.stats),{frag:l,part:a,level:o}):null}bufferFragmentData(e,t,r,n,i){var s;if(!e||this.state!==lP)return;const{data1:o,data2:a}=e;let l=o;if(o&&a&&(l=JR(o,a)),null==(s=l)||!s.length)return;const u={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:l};if(this.hls.trigger(UL.BUFFER_APPENDING,u),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!HF.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const r=t.currentTime,n=HF.bufferInfo(t,r,0),i=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),o=Math.max(Math.min(e.start-s,n.end-s),r+s);e.start-o>s&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const r=this.getLoadPosition();return BL(r)?this.getFwdBufferInfoAtPos(e,r,t):null}getFwdBufferInfoAtPos(e,t,r){const{config:{maxBufferHole:n}}=this,i=HF.bufferInfo(e,t,n);if(0===i.len&&void 0!==i.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,r);if(s&&i.nextStart<s.end)return HF.bufferInfo(e,t,Math.max(i.nextStart,n))}return i}getMaxBufferLength(e){const{config:t}=this;let r;return r=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=OI){const r=this.fragmentTracker.getAppendedFrag(e,OI);return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,n=r.length;if(!n)return null;const{config:i}=this,s=r[0].start;let o;if(t.live){const s=i.initialLiveManifestSize;if(n<s)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${s})`),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(o=this.getInitialLiveFragment(t,r),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=s&&(o=r[0]);if(!o){const r=i.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,r,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===_F||r===OF&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,n,i){const s=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(null===o)return o;if(e=o,s&&e&&!e.gap&&r.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n);if(null!==t&&r.len+t.len>=i)return this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,r){let n=-1,i=!1,s=!0;for(let o=0,a=e.length;o<a;o++){const a=e[o];if(s=s&&!a.independent,n>-1&&r<a.start)break;const l=a.loaded;l?n=-1:(i||a.independent||s)&&a.fragment===t&&(n=o),i=l}return n}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e,t){const r=this.fragPrevious;let n=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),n=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!BL(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(let n=0;n<e.length;++n){const i=e[n];if(gF(t,r,i))return i}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const s=t[i-e.startSN];r.cc===s.cc&&(n=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=function(e,t){return fF.search(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,r.cc),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(n=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,r){const{config:n}=this;let{fragPrevious:i}=this,{fragments:s,endSN:o}=r;const{fragmentHint:a}=r,l=n.maxFragLookUpTolerance,u=r.partList,c=!!(n.lowLatencyMode&&null!=u&&u.length&&a);let d;if(c&&a&&!this.bitrateTest&&(s=s.concat(a),o=a.sn),e<t){d=pF(i,s,e,e>t-l?0:l)}else d=s[s.length-1];if(d){const e=d.sn-r.startSN,t=this.fragmentTracker.getState(d);if((t===_F||t===OF&&d.gap)&&(i=d),i&&d.sn===i.sn&&(!c||u[0].fragment.sn>d.sn)){if(i&&d.level===i.level){const t=s[e+1];d=d.sn<o&&this.fragmentTracker.getState(t)!==_F?t:null}}}return d}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const n=this.hls.liveSyncPosition,i=r.currentTime,s=e.fragments[0].start,o=e.edge,a=i>=s-t.maxFragLookUpTolerance&&i<=o;if(null!==n&&r.duration>n&&(i<n||!a)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!a&&r.readyState<4||i<o-s)&&(this.loadedmetadata||(this.nextLoadPosition=n),r.readyState&&(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${n.toFixed(3)}`),r.currentTime=n))}}alignPlaylists(e,t){const{levels:r,levelLastLoaded:n,fragPrevious:i}=this,s=null!==n?r[n]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const a=e.fragments[0].start,l=!t,u=e.alignedSliding&&BL(a);if(l||!u&&!a){YF(i,s,e);const r=e.fragments[0].start;return this.log(`Live playlist sliding: ${r.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${i?i.sn:"na"} fragments: ${o}`),r}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let r=this.startPosition;if(r<t&&(r=-1),-1===r||-1===this.lastCurrentTime){const n=null!==this.startTimeOffset,i=n?this.startTimeOffset:e.startTimeOffset;null!==i&&BL(i)?(r=t+i,i<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Start time offset ${i} found in ${n?"multivariant":"media"} playlist, adjust startPosition to ${r}`),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===oP)||(this.state=nP)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;var n;if(this.fragContextChanged(r))return void this.warn(`Frag load error must match current frag to retry ${r.url} > ${null==(n=this.fragCurrent)?void 0:n.url}`);const i=t.details===jL.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(r,!0);const s=t.errorAction,{action:o,retryCount:a=0,retryConfig:l}=s||{};if(s&&o===bF&&l){var u;this.resetStartWhenNotLoaded(null!=(u=this.levelLastLoaded)?u:r.level);const n=cF(l,a);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${a+1}/${l.maxNumRetry} in ${n}ms`),s.resolved=!0,this.retryDate=self.performance.now()+n,this.state=oP}else l&&s?(this.resetFragmentErrors(e),a<l.maxNumRetry?i||(s.resolved=!0):GL.warn(`${t.details} reached or exceeded max retry (${a})`)):(null==s?void 0:s.action)===vF?this.state=fP:this.state=dP;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===lP||this.state===uP){const t=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,t),n=r&&r.len>.5;n&&this.reduceMaxBufferLength(r.len);const i=!n;return i&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),i}return!1}resetFragmentErrors(e){e===_I&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==rP&&(this.state=nP)}afterBufferFlushed(e,t,r){if(!e)return;const n=HF.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===cP&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=nP}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,n){var i;const s=r.details;if(!s)return void this.warn("level.details undefined");if(Object.keys(e.elementaryStreams).reduce(((t,i)=>{const o=e.elementaryStreams[i];if(o){const a=o.endPTS-o.startPTS;if(a<=0)return this.warn(`Could not parse fragment ${e.sn} ${i} duration reliably (${a})`),t||!1;const l=n?0:rF(s,e,o.startPTS,o.endPTS,o.startDTS,o.endDTS);return this.hls.trigger(UL.LEVEL_PTS_UPDATED,{details:s,level:r,drift:l,type:i,frag:e,start:o.startPTS,end:o.endPTS}),!0}return t}),!1))r.fragmentError=0;else if(null===(null==(i=this.transmuxer)?void 0:i.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===r.fragmentError&&(r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=uP,this.hls.trigger(UL.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,r,n;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(r=this.levelLastLoaded)?r:null==(n=this.fragCurrent)?void 0:n.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function mP(){return self.SourceBuffer||self.WebKitSourceBuffer}function gP(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class yP{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=JR(this.cachedData,e),this.cachedData=null);let r,n=ER(e,0),i=n?n.length:0;const s=this._audioTrack,o=this._id3Track,a=n?(e=>{const t=NR(e);for(let e=0;e<t.length;e++){const r=t[e];if(AR(r))return _R(r)}})(n):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&BL(a))&&(this.basePTS=vP(a,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:jI,duration:Number.POSITIVE_INFINITY});i<l;){if(this.canParse(e,i)){const t=this.appendFrame(s,e,i);t?(this.frameIndex++,this.lastPTS=t.sample.pts,i+=t.length,r=i):i=l}else TR(e,i)?(n=ER(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:jI,duration:Number.POSITIVE_INFINITY}),i+=n.length,r=i):i++;if(i===l&&r!==l){const t=bR(e,r);this.cachedData?this.cachedData=JR(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:gP(),id3Track:o,textTrack:gP()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:gP(),id3Track:this._id3Track,textTrack:gP()}}destroy(){}}const vP=(e,t,r)=>{if(BL(e))return 90*e;return 9e4*t+(r?9e4*r.baseTime/r.timescale:0)};function bP(e,t){return 255===e[t]&&240==(246&e[t+1])}function xP(e,t){return 1&e[t+1]?7:9}function wP(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function EP(e,t){return t+1<e.length&&bP(e,t)}function SP(e,t){if(EP(e,t)){const r=xP(e,t);if(t+r>=e.length)return!1;const n=wP(e,t);if(n<=r)return!1;const i=t+n;return i===e.length||EP(e,i)}return!1}function TP(e,t,r,n,i){if(!e.samplerate){const s=function(e,t,r,n){let i,s,o,a;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=1+((192&t[r+2])>>>6);const d=(60&t[r+2])>>>2;if(!(d>c.length-1))return o=(1&t[r+2])<<2,o|=(192&t[r+3])>>>6,GL.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,a=new Array(4),s=d-3):(i=2,a=new Array(2),s=d):-1!==l.indexOf("android")?(i=2,a=new Array(2),s=d):(i=5,a=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&d>=6?s=d-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(d>=6&&1===o||/vivaldi/i.test(l))||!n&&1===o)&&(i=2,a=new Array(2)),s=d)),a[0]=i<<3,a[0]|=(14&d)>>1,a[1]|=(1&d)<<7,a[1]|=o<<3,5===i&&(a[1]|=(14&s)>>1,a[2]=(1&s)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:c[d],channelCount:o,codec:"mp4a.40."+i,manifestCodec:u};e.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${d}`})}(t,r,n,i);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,GL.log(`parsed codec:${e.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function AP(e){return 9216e4/e}function DP(e,t,r,n,i){const s=n+i*AP(e.samplerate),o=function(e,t){const r=xP(e,t);if(t+r<=e.length){const n=wP(e,t)-r;if(n>0)return{headerLength:r,frameLength:n}}}(t,r);let a;if(o){const{frameLength:n,headerLength:i}=o,l=i+n,u=Math.max(0,r+l-t.length);u?(a=new Uint8Array(l-i),a.set(t.subarray(r+i,t.length),0)):a=t.subarray(r+i,r+l);const c={unit:a,pts:s};return u||e.samples.push(c),{sample:c,length:l,missing:u}}const l=t.length-r;a=new Uint8Array(l),a.set(t.subarray(r,t.length),0);return{sample:{unit:a,pts:s},length:l,missing:-1}}const NP=/\/emsg[-/]ID3/i;let CP=null;const kP=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],MP=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],OP=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],_P=[0,1,1,4];function LP(e,t,r,n,i){if(r+24>t.length)return;const s=RP(t,r);if(s&&r+s.frameLength<=t.length){const o=n+i*(9e4*s.samplesPerFrame/s.sampleRate),a={unit:t.subarray(r,r+s.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(a),{sample:a,length:s.frameLength,missing:0}}}function RP(e,t){const r=e[t+1]>>3&3,n=e[t+1]>>1&3,i=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==r&&0!==i&&15!==i&&3!==s){const o=e[t+2]>>1&1,a=e[t+3]>>6,l=1e3*kP[14*(3===r?3-n:3===n?3:4)+i-1],u=MP[3*(3===r?0:2===r?1:2)+s],c=3===a?1:2,d=OP[r][n],h=_P[n],f=8*d*h,p=Math.floor(d*l/u+o)*h;if(null===CP){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);CP=e?parseInt(e[1]):0}return!!CP&&CP<=87&&2===n&&l>=224e3&&0===a&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:p,samplesPerFrame:f}}}function IP(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function FP(e,t){return t+1<e.length&&IP(e,t)}function PP(e,t){if(t+1<e.length&&IP(e,t)){const r=4,n=RP(e,t);let i=r;null!=n&&n.frameLength&&(i=n.frameLength);const s=t+i;return s===e.length||FP(e,s)}return!1}class BP{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&GL.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,r=8,n=8;for(let i=0;i<e;i++)0!==n&&(t=this.readEG(),n=(r+t+256)%256),r=0===n?r:n}readSPS(){let e,t,r,n=0,i=0,s=0,o=0;const a=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),h=this.skipEG.bind(this),f=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);a();const m=a();if(l(5),d(3),a(),f(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const e=u();if(3===e&&d(1),f(),f(),d(1),c())for(t=3!==e?8:12,r=0;r<t;r++)c()&&p(r<6?16:64)}f();const g=u();if(0===g)u();else if(1===g)for(d(1),h(),h(),e=u(),r=0;r<e;r++)h();f(),d(1);const y=u(),v=u(),b=l(1);0===b&&d(1),d(1),c()&&(n=u(),i=u(),s=u(),o=u());let x=[1,1];if(c()&&c()){switch(a()){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:x=[a()<<8|a(),a()<<8|a()]}}return{width:Math.ceil(16*(y+1)-2*n-2*i),height:(2-b)*(v+1)*16-(b?2:4)*(s+o),pixelRatio:x}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class UP{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new eP(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,r){const n=e[t].unit;if(n.length<=16)return;const i=n.subarray(16,n.length-n.length%16),s=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(s).then((i=>{const s=new Uint8Array(i);n.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}))}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t);let n=0;for(let t=32;t<e.length-16;t+=160,n+=16)r.set(e.subarray(t,t+16),n);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let n=0;for(let t=32;t<e.length-16;t+=160,n+=16)e.set(r.subarray(n,n+16),t);return e}decryptAvcSample(e,t,r,n,i){const s=eI(i.data),o=this.getAvcEncryptedData(s);this.decryptBuffer(o.buffer).then((o=>{i.data=this.getAvcDecryptedUnit(s,o),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,n)}))}decryptAvcSamples(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void n();const i=e[t].units;for(;!(r>=i.length);r++){const s=i[r];if(!(s.data.length<=48||1!==s.type&&5!==s.type||(this.decryptAvcSample(e,t,r,n,s),this.decrypter.isSync())))return}}}}const $P=188;class jP{constructor(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=r}static probe(e){const t=jP.syncOffset(e);return t>0&&GL.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let r=Math.min(940,e.length-$P)+1,n=0;for(;n<r;){let i=!1,s=-1,o=0;for(let a=n;a<t;a+=$P){if(71!==e[a]){if(o)return-1;break}if(o++,-1===s&&(s=a,0!==s&&(r=Math.min(s+18612,e.length-$P)+1)),i||(i=0===qP(e,a)),i&&o>1&&(0===s&&o>2||a+$P>r))return s}n++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:UR[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=jP.createTrack("video"),this._audioTrack=jP.createTrack("audio",n),this._id3Track=jP.createTrack("id3"),this._txtTrack=jP.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r,this._duration=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,r=!1,n=!1){let i;r||(this.sampleAes=null);const s=this._avcTrack,o=this._audioTrack,a=this._id3Track,l=this._txtTrack;let u=s.pid,c=s.pesData,d=o.pid,h=a.pid,f=o.pesData,p=a.pesData,m=null,g=this.pmtParsed,y=this._pmtId,v=e.length;if(this.remainderData&&(v=(e=JR(this.remainderData,e)).length,this.remainderData=null),v<$P&&!n)return this.remainderData=e,{audioTrack:o,videoTrack:s,id3Track:a,textTrack:l};const b=Math.max(0,jP.syncOffset(e));v-=(v-b)%$P,v<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,v,e.buffer.byteLength-v));let x=0;for(let t=b;t<v;t+=$P)if(71===e[t]){const n=!!(64&e[t+1]),v=qP(e,t);let x;if((48&e[t+3])>>4>1){if(x=t+5+e[t+4],x===t+$P)continue}else x=t+4;switch(v){case u:n&&(c&&(i=GP(c))&&this.parseAVCPES(s,l,i,!1),c={data:[],size:0}),c&&(c.data.push(e.subarray(x,t+$P)),c.size+=t+$P-x);break;case d:if(n){if(f&&(i=GP(f)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,i);break;case"mp3":this.parseMPEGPES(o,i)}f={data:[],size:0}}f&&(f.data.push(e.subarray(x,t+$P)),f.size+=t+$P-x);break;case h:n&&(p&&(i=GP(p))&&this.parseID3PES(a,i),p={data:[],size:0}),p&&(p.data.push(e.subarray(x,t+$P)),p.size+=t+$P-x);break;case 0:n&&(x+=e[x]+1),y=this._pmtId=HP(e,x);break;case y:{n&&(x+=e[x]+1);const i=VP(e,x,this.typeSupported,r);u=i.avc,u>0&&(s.pid=u),d=i.audio,d>0&&(o.pid=d,o.segmentCodec=i.segmentCodec),h=i.id3,h>0&&(a.pid=h),null===m||g||(GL.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${b} to parse all TS packets.`),m=null,t=b-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=v}}else x++;if(x>0){const e=new Error(`Found ${x} TS packet/s that do not start with 0x47`);this.observer.emit(UL.ERROR,UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}s.pesData=c,o.pesData=f,a.pesData=p;const w={audioTrack:o,videoTrack:s,id3Track:a,textTrack:l};return n&&this.extractRemainingSamples(w),w}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:n,textTrack:i}=e,s=r.pesData,o=t.pesData,a=n.pesData;let l;if(s&&(l=GP(s))?(this.parseAVCPES(r,i,l,!0),r.pesData=null):r.pesData=s,o&&(l=GP(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l)}t.pesData=null}else null!=o&&o.size&&GL.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;a&&(l=GP(a))?(this.parseID3PES(n,l),n.pesData=null):n.pesData=a}demuxSampleAes(e,t,r){const n=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new UP(this.observer,this.config,t);return this.decrypt(n,i)}decrypt(e,t){return new Promise((r=>{const{audioTrack:n,videoTrack:i}=e;n.samples&&"aac"===n.segmentCodec?t.decryptAacSamples(n.samples,0,(()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,(()=>{r(e)})):r(e)})):i.samples&&t.decryptAvcSamples(i.samples,0,0,(()=>{r(e)}))}))}destroy(){this._duration=0}parseAVCPES(e,t,r,n){const i=this.parseAVCNALu(e,r.data);let s,o=this.avcSample,a=!1;r.data=null,o&&i.length&&!e.audFound&&(WP(o,e),o=this.avcSample=zP(!1,r.pts,r.dts,"")),i.forEach((n=>{var i;switch(n.type){case 1:{let t=!1;s=!0;const i=n.data;if(a&&i.length>4){const e=new BP(i).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;if(t)null!=(l=o)&&l.frame&&!o.key&&(WP(o,e),o=this.avcSample=null);o||(o=this.avcSample=zP(!0,r.pts,r.dts,"")),o.frame=!0,o.key=t;break}case 5:s=!0,null!=(i=o)&&i.frame&&!o.key&&(WP(o,e),o=this.avcSample=null),o||(o=this.avcSample=zP(!0,r.pts,r.dts,"")),o.key=!0,o.frame=!0;break;case 6:s=!0,QR(n.data,1,r.pts,t.samples);break;case 7:if(s=!0,a=!0,!e.sps){const t=n.data,r=new BP(t).readSPS();e.width=r.width,e.height=r.height,e.pixelRatio=r.pixelRatio,e.sps=[t],e.duration=this._duration;const i=t.subarray(1,4);let s="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),s+=t}e.codec=s}break;case 8:s=!0,e.pps||(e.pps=[n.data]);break;case 9:s=!1,e.audFound=!0,o&&WP(o,e),o=this.avcSample=zP(!1,r.pts,r.dts,"");break;case 12:s=!0;break;default:s=!1,o&&(o.debug+="unknown NAL "+n.type+" ")}if(o&&s){o.units.push(n)}})),n&&o&&(WP(o,e),this.avcSample=null)}getLastNalUnit(e){var t;let r,n=this.avcSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(t=n)&&t.units){const e=n.units;r=e[e.length-1]}return r}parseAVCNALu(e,t){const r=t.byteLength;let n=e.naluState||0;const i=n,s=[];let o,a,l,u=0,c=-1,d=0;for(-1===n&&(c=0,d=31&t[0],n=0,u=1);u<r;)if(o=t[u++],n)if(1!==n)if(o)if(1===o){if(c>=0){const e={data:t.subarray(c,u-n-1),type:d};s.push(e)}else{const r=this.getLastNalUnit(e.samples);if(r&&(i&&u<=4-i&&r.state&&(r.data=r.data.subarray(0,r.data.byteLength-i)),a=u-n-1,a>0)){const e=new Uint8Array(r.data.byteLength+a);e.set(r.data,0),e.set(t.subarray(0,a),r.data.byteLength),r.data=e,r.state=0}}u<r?(l=31&t[u],c=u,d=l,n=0):n=-1}else n=0;else n=3;else n=o?0:2;else n=o?0:1;if(c>=0&&n>=0){const e={data:t.subarray(c,r),type:d,state:n};s.push(e)}if(0===s.length){const r=this.getLastNalUnit(e.samples);if(r){const e=new Uint8Array(r.data.byteLength+t.byteLength);e.set(r.data,0),e.set(t,r.data.byteLength),r.data=e}}return e.naluState=n,s}parseAACPES(e,t){let r=0;const n=this.aacOverFlow;let i,s,o,a=t.data;if(n){this.aacOverFlow=null;const t=n.missing,i=n.sample.unit.byteLength;if(-1===t){const e=new Uint8Array(i+a.byteLength);e.set(n.sample.unit,0),e.set(a,i),a=e}else{const s=i-t;n.sample.unit.set(a.subarray(0,t),s),e.samples.push(n.sample),r=n.missing}}for(i=r,s=a.length;i<s-1&&!EP(a,i);i++);if(i!==r){let e;const t=i<s-1;e=t?`AAC PES did not start with ADTS header,offset:${i}`:"No ADTS header found in AAC PES";const r=new Error(e);if(GL.warn(`parsing error: ${e}`),this.observer.emit(UL.ERROR,UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:r,reason:e}),!t)return}if(TP(e,this.observer,a,i,this.audioCodec),void 0!==t.pts)o=t.pts;else{if(!n)return void GL.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=AP(e.samplerate);o=n.sample.pts+t}}let l,u=0;for(;i<s;){if(l=DP(e,a,i,o,u),i+=l.length,l.missing){this.aacOverFlow=l;break}for(u++;i<s-1&&!EP(a,i);i++);}}parseMPEGPES(e,t){const r=t.data,n=r.length;let i=0,s=0;const o=t.pts;if(void 0!==o)for(;s<n;)if(FP(r,s)){const t=LP(e,r,s,o,i);if(!t)break;s+=t.length,i++}else s++;else GL.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void GL.warn("[tsdemuxer]: ID3 PES unknown PTS");const r=PL({},t,{type:this._avcTrack?qI:jI,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function zP(e,t,r,n){return{key:e,frame:!1,pts:t,dts:r,units:[],debug:n,length:0}}function qP(e,t){return((31&e[t+1])<<8)+e[t+2]}function HP(e,t){return(31&e[t+10])<<8|e[t+11]}function VP(e,t,r,n){const i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<s;){const s=qP(e,t);switch(e[t]){case 207:if(!n){GL.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=s);break;case 21:-1===i.id3&&(i.id3=s);break;case 219:if(!n){GL.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=s);break;case 3:case 4:!0!==r.mpeg&&!0!==r.mp3?GL.log("MPEG audio found, not supported in this browser"):-1===i.audio&&(i.audio=s,i.segmentCodec="mp3");break;case 36:GL.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return i}function GP(e){let t,r,n,i,s,o=0;const a=e.data;if(!e||0===e.size)return null;for(;a[0].length<19&&a.length>1;){const e=new Uint8Array(a[0].length+a[1].length);e.set(a[0]),e.set(a[1],a[0].length),a[0]=e,a.splice(1,1)}t=a[0];if(1===(t[0]<<16)+(t[1]<<8)+t[2]){if(r=(t[4]<<8)+t[5],r&&r>e.size-6)return null;const l=t[7];192&l&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,i-s>54e5&&(GL.warn(`${Math.round((i-s)/9e4)}s delta between PTS and DTS, align them`),i=s)):s=i),n=t[8];let u=n+9;if(e.size<=u)return null;e.size-=u;const c=new Uint8Array(e.size);for(let e=0,r=a.length;e<r;e++){t=a[e];let r=t.byteLength;if(u){if(u>r){u-=r;continue}t=t.subarray(u),r-=u,u=0}c.set(t,o),o+=r}return r&&(r-=n+3),{data:c,pts:i,dts:s,len:r}}return null}function WP(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const r=t.samples,n=r.length;if(!n)return void t.dropped++;{const t=r[n-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&GL.log(e.pts+"/"+e.dts+":"+e.debug)}class KP{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const YP=Math.pow(2,32)-1;class JP{static init(){let e;for(e in JP.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},JP.types)JP.types.hasOwnProperty(e)&&(JP.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);JP.HDLR_TYPES={video:t,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);JP.STTS=JP.STSC=JP.STCO=i,JP.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),JP.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),JP.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),JP.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),a=new Uint8Array([0,0,0,1]);JP.FTYP=JP.box(JP.types.ftyp,s,a,s,o),JP.DINF=JP.box(JP.types.dinf,JP.box(JP.types.dref,n))}static box(e,...t){let r=8,n=t.length;const i=n;for(;n--;)r+=t[n].byteLength;const s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=255&r,s.set(e,4),n=0,r=8;n<i;n++)s.set(t[n],r),r+=t[n].byteLength;return s}static hdlr(e){return JP.box(JP.types.hdlr,JP.HDLR_TYPES[e])}static mdat(e){return JP.box(JP.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(YP+1)),n=Math.floor(t%(YP+1));return JP.box(JP.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(e){return JP.box(JP.types.mdia,JP.mdhd(e.timescale,e.duration),JP.hdlr(e.type),JP.minf(e))}static mfhd(e){return JP.box(JP.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?JP.box(JP.types.minf,JP.box(JP.types.smhd,JP.SMHD),JP.DINF,JP.stbl(e)):JP.box(JP.types.minf,JP.box(JP.types.vmhd,JP.VMHD),JP.DINF,JP.stbl(e))}static moof(e,t,r){return JP.box(JP.types.moof,JP.mfhd(e),JP.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=JP.trak(e[t]);return JP.box.apply(null,[JP.types.moov,JP.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(JP.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=JP.trex(e[t]);return JP.box.apply(null,[JP.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(YP+1)),n=Math.floor(t%(YP+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return JP.box(JP.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let n,i;for(n=0;n<t.length;n++)i=t[n].flags,r[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return JP.box(JP.types.sdtp,r)}static stbl(e){return JP.box(JP.types.stbl,JP.stsd(e),JP.box(JP.types.stts,JP.STTS),JP.box(JP.types.stsc,JP.STSC),JP.box(JP.types.stsz,JP.STSZ),JP.box(JP.types.stco,JP.STCO))}static avc1(e){let t,r,n,i=[],s=[];for(t=0;t<e.sps.length;t++)r=e.sps[t],n=r.byteLength,i.push(n>>>8&255),i.push(255&n),i=i.concat(Array.prototype.slice.call(r));for(t=0;t<e.pps.length;t++)r=e.pps[t],n=r.byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(r));const o=JP.box(JP.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(s))),a=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return JP.box(JP.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>8&255,255&a,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,JP.box(JP.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),JP.box(JP.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return JP.box(JP.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),JP.box(JP.types.esds,JP.esds(e)))}static mp3(e){const t=e.samplerate;return JP.box(JP.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?JP.box(JP.types.stsd,JP.STSD,JP.mp3(e)):JP.box(JP.types.stsd,JP.STSD,JP.mp4a(e)):JP.box(JP.types.stsd,JP.STSD,JP.avc1(e))}static tkhd(e){const t=e.id,r=e.duration*e.timescale,n=e.width,i=e.height,s=Math.floor(r/(YP+1)),o=Math.floor(r%(YP+1));return JP.box(JP.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}static traf(e,t){const r=JP.sdtp(e),n=e.id,i=Math.floor(t/(YP+1)),s=Math.floor(t%(YP+1));return JP.box(JP.types.traf,JP.box(JP.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),JP.box(JP.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s])),JP.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,JP.box(JP.types.trak,JP.tkhd(e),JP.mdia(e))}static trex(e){const t=e.id;return JP.box(JP.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],n=r.length,i=12+16*n,s=new Uint8Array(i);let o,a,l,u,c,d;for(t+=8+i,s.set(["video"===e.type?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),o=0;o<n;o++)a=r[o],l=a.duration,u=a.size,c=a.flags,d=a.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*o);return JP.box(JP.types.trun,s)}static initSegment(e){JP.types||JP.init();const t=JP.moov(e),r=new Uint8Array(JP.FTYP.byteLength+t.byteLength);return r.set(JP.FTYP),r.set(t,JP.FTYP.byteLength),r}}JP.types=void 0,JP.HDLR_TYPES=void 0,JP.STTS=void 0,JP.STSC=void 0,JP.STCO=void 0,JP.STSZ=void 0,JP.VMHD=void 0,JP.SMHD=void 0,JP.STSD=void 0,JP.FTYP=void 0,JP.DINF=void 0;const ZP=9e4;function XP(e,t,r=1,n=!1){const i=e*t*r;return n?Math.round(i):i}function QP(e,t=!1){return XP(e,1e3,1/ZP,t)}let eB,tB=null,rB=null;class nB{constructor(e,t,r,n=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===tB){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);tB=e?parseInt(e[1]):0}if(null===rB){const e=navigator.userAgent.match(/Safari\/(\d+)/i);rB=e?parseInt(e[1]):0}}destroy(){}resetTimeStamp(e){GL.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){GL.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){GL.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const r=e.reduce(((e,r)=>{const n=r.pts-e;return n<-4294967296?(t=!0,iB(e,r.pts)):n>0?e:r.pts}),e[0].pts);return t&&GL.debug("PTS rollover detected"),r}remux(e,t,r,n,i,s,o,a){let l,u,c,d,h,f,p=i,m=i;const g=e.pid>-1,y=t.pid>-1,v=t.samples.length,b=e.samples.length>0,x=o&&v>0||v>1;if((!g||b)&&(!y||x)||this.ISGenerated||o){this.ISGenerated||(c=this.generateIS(e,t,i,s));const r=this.isVideoContiguous;let n,o=-1;if(x&&(o=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!r&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,o>0){GL.warn(`[mp4-remuxer]: Dropped ${o} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(o),t.dropped+=o,m+=(t.samples[0].pts-e)/t.inputTimeScale,n=m}else-1===o&&(GL.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),f=!1);if(this.ISGenerated){if(b&&x){const r=this.getVideoStartPts(t.samples),n=(iB(e.samples[0].pts,r)-r)/t.inputTimeScale;p+=Math.max(0,n),m+=Math.max(0,-n)}if(b){if(e.samplerate||(GL.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i,s)),u=this.remuxAudio(e,p,this.isAudioContiguous,s,y||x||a===_I?m:void 0),x){const n=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(GL.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,i,s)),l=this.remuxVideo(t,m,r,n)}}else x&&(l=this.remuxVideo(t,m,r,0));l&&(l.firstKeyFrame=o,l.independent=-1!==o,l.firstKeyFramePTS=n)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(h=sB(r,i,this._initPTS,this._initDTS)),n.samples.length&&(d=oB(n,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:f,text:d,id3:h}}generateIS(e,t,r,n){const i=e.samples,s=t.samples,o=this.typeSupported,a={},l=this._initPTS;let u,c,d,h=!l||n,f="audio/mp4";if(h&&(u=c=1/0),e.config&&i.length){if(e.timescale=e.samplerate,"mp3"===e.segmentCodec)o.mpeg?(f="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");a.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&o.mpeg?new Uint8Array(0):JP.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(d=e.inputTimeScale,l&&d===l.timescale?h=!1:u=c=i[0].pts-Math.round(d*r))}if(t.sps&&t.pps&&s.length&&(t.timescale=t.inputTimeScale,a.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:JP.initSegment([t]),metadata:{width:t.width,height:t.height}},h))if(d=t.inputTimeScale,l&&d===l.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=Math.round(d*r);c=Math.min(c,iB(s[0].dts,e)-t),u=Math.min(u,e-t)}if(Object.keys(a).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:u,timescale:d},this._initDTS={baseTime:c,timescale:d}):u=d=void 0,{tracks:a,initPTS:u,timescale:d}}remuxVideo(e,t,r,n){const i=e.inputTimeScale,s=e.samples,o=[],a=s.length,l=this._initPTS;let u,c,d=this.nextAvcDts,h=8,f=this.videoSampleDuration,p=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=!1;if(!r||null===d){d=t*i-(s[0].pts-iB(s[0].dts,s[0].pts))}const y=l.baseTime*i/l.timescale;for(let e=0;e<a;e++){const t=s[e];t.pts=iB(t.pts-y,d),t.dts=iB(t.dts-y,d),t.dts<s[e>0?e-1:e].dts&&(g=!0)}g&&s.sort((function(e,t){const r=e.dts-t.dts,n=e.pts-t.pts;return r||n})),u=s[0].dts,c=s[s.length-1].dts;const v=c-u,b=v?Math.round(v/(a-1)):f||e.inputTimeScale/30;if(r){const e=u-d,t=e>b,r=e<-1;if((t||r)&&(t?GL.warn(`AVC: ${QP(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):GL.warn(`AVC: ${QP(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!r||d>=s[0].pts)){u=d;const t=s[0].pts-e;s[0].dts=u,s[0].pts=t,GL.log(`Video: First PTS/DTS adjusted: ${QP(t,!0)}/${QP(u,!0)}, delta: ${QP(e,!0)} ms`)}}u=Math.max(0,u);let x=0,w=0;for(let e=0;e<a;e++){const t=s[e],r=t.units,n=r.length;let i=0;for(let e=0;e<n;e++)i+=r[e].data.length;w+=i,x+=n,t.length=i,t.dts=Math.max(t.dts,u),p=Math.min(t.pts,p),m=Math.max(t.pts,m)}c=s[a-1].dts;const E=w+4*x+8;let S;try{S=new Uint8Array(E)}catch(e){return void this.observer.emit(UL.ERROR,UL.ERROR,{type:$L.MUX_ERROR,details:jL.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:E,reason:`fail allocating video mdat ${E}`})}const T=new DataView(S.buffer);T.setUint32(0,E),S.set(JP.types.mdat,4);let A=!1,D=Number.POSITIVE_INFINITY,N=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let e=0;e<a;e++){const t=s[e],r=t.units;let l,u=0;for(let e=0,t=r.length;e<t;e++){const t=r[e],n=t.data,i=t.data.byteLength;T.setUint32(h,i),h+=4,S.set(n,h),h+=i,u+=4+i}if(e<a-1)f=s[e+1].dts-t.dts,l=s[e+1].pts-t.pts;else{const r=this.config,o=e>0?t.dts-s[e-1].dts:b;if(l=e>0?t.pts-s[e-1].pts:b,r.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(r.maxBufferHole*i),s=(n?p+n*i:this.nextAudioPts)-t.pts;s>e?(f=s-o,f<0?f=o:A=!0,GL.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=o}else f=o}const c=Math.round(t.pts-t.dts);D=Math.min(D,f),C=Math.max(C,f),N=Math.min(N,l),k=Math.max(k,l),o.push(new aB(t.key,f,u,c))}if(o.length)if(tB){if(tB<70){const e=o[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(rB&&k-N<C-D&&b/C<.025&&0===o[0].cts){GL.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,r=o.length;t<r;t++){const n=e+o[t].duration,i=e+o[t].cts;if(t<r-1){const e=n+o[t+1].cts;o[t].duration=e-i}else o[t].duration=t?o[t-1].duration:b;o[t].cts=0,e=n}}f=A||!f?b:f,this.nextAvcDts=d=c+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const M={data1:JP.moof(e.sequenceNumber++,u,PL({},e,{samples:o})),data2:S,startPTS:p/i,endPTS:(m+f)/i,startDTS:u/i,endDTS:d/i,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,M}remuxAudio(e,t,r,n,i){const s=e.inputTimeScale,o=s/(e.samplerate?e.samplerate:s),a="aac"===e.segmentCodec?1024:1152,l=a*o,u=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==i;let f=e.samples,p=c?0:8,m=this.nextAudioPts||-1;const g=t*s,y=u.baseTime*s/u.timescale;if(this.isAudioContiguous=r=r||f.length&&m>0&&(n&&Math.abs(g-m)<9e3||Math.abs(iB(f[0].pts-y,g)-m)<20*l),f.forEach((function(e){e.pts=iB(e.pts-y,g)})),!r||m<0){if(f=f.filter((e=>e.pts>=0)),!f.length)return;m=0===i?0:n&&!h?Math.max(0,g):f[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let r=0,n=m;r<f.length;r++){const i=f[r],o=i.pts,a=o-n,u=Math.abs(1e3*a/s);if(a<=-t*l&&h)0===r&&(GL.warn(`Audio frame @ ${(o/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*a/s)} ms.`),this.nextAudioPts=m=n=o);else if(a>=t*l&&u<1e4&&h){let t=Math.round(a/l);n=o-t*l,n<0&&(t--,n+=l),0===r&&(this.nextAudioPts=m=n),GL.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(n/s).toFixed(3)}s due to ${Math.round(1e3*a/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(n,0);let s=KP.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);s||(GL.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=i.unit.subarray()),f.splice(r,0,{unit:s,pts:t}),n+=l,r++}}i.pts=n,n+=l}}let v,b=null,x=null,w=0,E=f.length;for(;E--;)w+=f[E].unit.byteLength;for(let t=0,n=f.length;t<n;t++){const n=f[t],i=n.unit;let s=n.pts;if(null!==x){d[t-1].duration=Math.round((s-x)/o)}else{if(r&&"aac"===e.segmentCodec&&(s=m),b=s,!(w>0))return;w+=p;try{v=new Uint8Array(w)}catch(e){return void this.observer.emit(UL.ERROR,UL.ERROR,{type:$L.MUX_ERROR,details:jL.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:w,reason:`fail allocating audio mdat ${w}`})}if(!c){new DataView(v.buffer).setUint32(0,w),v.set(JP.types.mdat,4)}}v.set(i,p);const l=i.byteLength;p+=l,d.push(new aB(!0,a,l,0)),x=s}const S=d.length;if(!S)return;const T=d[d.length-1];this.nextAudioPts=m=x+o*T.duration;const A=c?new Uint8Array(0):JP.moof(e.sequenceNumber++,b/o,PL({},e,{samples:d}));e.samples=[];const D=b/s,N=m/s,C={data1:A,data2:v,startPTS:D,endPTS:N,startDTS:D,endDTS:N,type:"audio",hasAudio:!0,hasVideo:!1,nb:S};return this.isAudioContiguous=!0,C}remuxEmptyAudio(e,t,r,n){const i=e.inputTimeScale,s=i/(e.samplerate?e.samplerate:i),o=this.nextAudioPts,a=this._initDTS,l=9e4*a.baseTime/a.timescale,u=(null!==o?o:n.startDTS*i)+l,c=n.endDTS*i+l,d=1024*s,h=Math.ceil((c-u)/d),f=KP.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(GL.warn("[mp4-remuxer]: remux empty Audio"),!f)return void GL.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const p=[];for(let e=0;e<h;e++){const t=u+e*d;p.push({unit:f,pts:t,dts:t})}return e.samples=p,this.remuxAudio(e,t,r,!1)}}function iB(e,t){let r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function sB(e,t,r,n){const i=e.samples.length;if(!i)return;const s=e.inputTimeScale;for(let o=0;o<i;o++){const i=e.samples[o];i.pts=iB(i.pts-r.baseTime*s/r.timescale,t*s)/s,i.dts=iB(i.dts-n.baseTime*s/n.timescale,t*s)/s}const o=e.samples;return e.samples=[],{samples:o}}function oB(e,t,r){const n=e.samples.length;if(!n)return;const i=e.inputTimeScale;for(let s=0;s<n;s++){const n=e.samples[s];n.pts=iB(n.pts-r.baseTime*i/r.timescale,t*i)/i}e.samples.sort(((e,t)=>e.pts-t.pts));const s=e.samples;return e.samples=[],{samples:s}}class aB{constructor(e,t,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=n,this.flags=new lB(e)}}class lB{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function uB(e,t){const r=null==e?void 0:e.codec;return r&&r.length>4?r:"hvc1"===r||"hev1"===r?"hvc1.1.6.L120.90":"av01"===r?"av01.0.04M.08":"avc1"===r||t===eR?"avc1.42e01e":"mp4a.40.5"}try{eB=self.performance.now.bind(self.performance)}catch(e){GL.debug("Unable to use Performance API on this environment"),eB="undefined"!=typeof self&&self.Date.now}const cB=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,n){const i=this.videoTrack=gP("video",1),s=this.audioTrack=gP("audio",1),o=this.txtTrack=gP("text",1);if(this.id3Track=gP("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const a=WR(e);if(a.video){const{id:e,timescale:t,codec:r}=a.video;i.id=e,i.timescale=o.timescale=t,i.codec=r}if(a.audio){const{id:e,timescale:t,codec:r}=a.audio;s.id=e,s.timescale=t,s.codec=r}o.id=UR.text,i.sampleDuration=0,i.duration=s.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return VR(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let r=e;const n=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=JR(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},r=VR(e,["moof"]);if(!r)return t;if(r.length<2)return t.remainder=e,t;const n=r[r.length-1];return t.valid=bR(e,0,n.byteOffset-8),t.remainder=bR(e,n.byteOffset-8),t}(r);this.remainderData=t.remainder,n.samples=t.valid||new Uint8Array}else n.samples=r;const s=this.extractID3Track(n,t);return i.samples=ZR(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return r.samples=ZR(e,t),{videoTrack:t,audioTrack:gP(),id3Track:n,textTrack:gP()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const n=VR(e.samples,["emsg"]);n&&n.forEach((e=>{const n=function(e){const t=e[0];let r="",n="",i=0,s=0,o=0,a=0,l=0,u=0;if(0===t){for(;"\0"!==$R(e.subarray(u,u+1));)r+=$R(e.subarray(u,u+1)),u+=1;for(r+=$R(e.subarray(u,u+1)),u+=1;"\0"!==$R(e.subarray(u,u+1));)n+=$R(e.subarray(u,u+1)),u+=1;n+=$R(e.subarray(u,u+1)),u+=1,i=zR(e,12),s=zR(e,16),a=zR(e,20),l=zR(e,24),u=28}else if(1===t){u+=4,i=zR(e,u),u+=4;const t=zR(e,u);u+=4;const s=zR(e,u);for(u+=4,o=2**32*t+s,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,GL.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=zR(e,u),u+=4,l=zR(e,u),u+=4;"\0"!==$R(e.subarray(u,u+1));)r+=$R(e.subarray(u,u+1)),u+=1;for(r+=$R(e.subarray(u,u+1)),u+=1;"\0"!==$R(e.subarray(u,u+1));)n+=$R(e.subarray(u,u+1)),u+=1;n+=$R(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(NP.test(n.schemeIdUri)){const e=BL(n.presentationTime)?n.presentationTime/n.timeScale:t+n.presentationTimeDelta/n.timeScale;let i=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);const s=n.payload;r.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:qI,duration:i})}}))}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(function(e,t){if(!e||!t)return e;const r=t.keyId;r&&t.isCommonEncryption&&VR(e,["moov","trak"]).forEach((e=>{const t=VR(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let n=VR(t,["enca"]);const i=n.length>0;i||(n=VR(t,["encv"])),n.forEach((e=>{VR(i?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=KR(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(GL.log(`[eme] Patching keyId in 'enc${i?"a":"v"}>sinf>>tenc' box: ${FR(e)} -> ${FR(r)}`),t.set(r,8))}}))}))}));return e}(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const n=this.initData=WR(e);t||(t=uB(n.audio,QL)),r||(r=uB(n.video,eR));const i={};n.audio&&n.video?i.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:n.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?i.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:GL.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i}remux(e,t,r,n,i,s){var o,a;let{initPTS:l,lastEndTime:u}=this;const c={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};BL(u)||(u=this.lastEndTime=i||0);const d=t.samples;if(null==d||!d.length)return c;const h={initPTS:void 0,timescale:1};let f=this.initData;if(null!=(o=f)&&o.length||(this.generateInitSegment(d),f=this.initData),null==(a=f)||!a.length)return GL.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(e,t){let r=0,n=0,i=0;const s=VR(e,["moof","traf"]);for(let e=0;e<s.length;e++){const o=s[e],a=VR(o,["tfhd"])[0],l=t[zR(a,4)];if(!l)continue;const u=l.default,c=zR(a,0)|(null==u?void 0:u.flags);let d=null==u?void 0:u.duration;8&c&&(d=zR(a,2&c?12:8));const h=l.timescale||9e4,f=VR(o,["trun"]);for(let e=0;e<f.length;e++)r=YR(f[e]),!r&&d&&(r=d*zR(f[e],4)),l.type===eR?n+=r/h:l.type===QL&&(i+=r/h)}if(0===n&&0===i){let t=0;const r=VR(e,["sidx"]);for(let e=0;e<r.length;e++){const n=GR(r[e]);null!=n&&n.references&&(t+=n.references.reduce(((e,t)=>e+t.info.duration||0),0))}return t}return n||i}(d,f),m=function(e,t){return VR(t,["moof","traf"]).reduce(((t,r)=>{const n=VR(r,["tfdt"])[0],i=n[0],s=VR(r,["tfhd"]).reduce(((t,r)=>{const s=zR(r,4),o=e[s];if(o){let e=zR(n,4);if(1===i){if(e===PR)return GL.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=PR+1,e+=zR(n,8)}const r=e/(o.timescale||9e4);if(isFinite(r)&&(null===t||r<t))return r}return t}),null);return null!==s&&isFinite(s)&&(null===t||s<t)?s:t}),null)}(f,d),g=null===m?i:m;(function(e,t,r,n){if(null===e)return!0;const i=Math.max(n,1),s=t-e.baseTime/e.timescale;return Math.abs(s-r)>i}(l,g,i,p)||h.timescale!==l.timescale&&s)&&(h.initPTS=g-i,l&&1===l.timescale&&GL.warn("Adjusting initPTS by "+(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});const y=e?g-l.baseTime/l.timescale:u,v=y+p;!function(e,t,r){VR(t,["moof","traf"]).forEach((t=>{VR(t,["tfhd"]).forEach((n=>{const i=zR(n,4),s=e[i];if(!s)return;const o=s.timescale||9e4;VR(t,["tfdt"]).forEach((e=>{const t=e[0];let n=zR(e,4);if(0===t)n-=r*o,n=Math.max(n,0),HR(e,4,n);else{n*=Math.pow(2,32),n+=zR(e,8),n-=r*o,n=Math.max(n,0);const t=Math.floor(n/(PR+1)),i=Math.floor(n%(PR+1));HR(e,4,t),HR(e,8,i)}}))}))}))}(f,d,l.baseTime/l.timescale),p>0?this.lastEndTime=v:(GL.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!f.audio,x=!!f.video;let w="";b&&(w+="audio"),x&&(w+="video");const E={data1:d,startPTS:y,startDTS:y,endPTS:v,endDTS:v,type:w,hasAudio:b,hasVideo:x,nb:1,dropped:0};return c.audio="audio"===E.type?E:void 0,c.video="audio"!==E.type?E:void 0,c.initSegment=h,c.id3=sB(r,i,l,l),n.samples.length&&(c.text=oB(n,i,l)),c}}},{demux:jP,remux:nB},{demux:class extends yP{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(ER(e,0)||[]).length;for(let r=e.length;t<r;t++)if(SP(e,t))return GL.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&bP(e,t)&&wP(e,t)<=e.length-t}(e,t)}appendFrame(e,t,r){TP(e,this.observer,t,r,e.manifestCodec);const n=DP(e,t,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n}},remux:nB},{demux:class extends yP{resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(ER(e,0)||[]).length;for(let r=e.length;t<r;t++)if(PP(e,t))return GL.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return IP(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,r){if(null!==this.basePTS)return LP(e,t,r,this.basePTS,this.frameIndex)}},remux:nB}];class dB{constructor(e,t,r,n,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n,this.id=i}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,n){const i=r.transmuxing;i.executeStart=eB();let s=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:a}=this;n&&(this.currentTransmuxState=n);const{contiguous:l,discontinuity:u,trackSwitch:c,accurateTimeOffset:d,timeOffset:h,initSegmentChange:f}=n||o,{audioCodec:p,videoCodec:m,defaultInitPts:g,duration:y,initSegmentData:v}=a,b=function(e,t){let r=null;e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(r=t);return r}(s,t);if(b&&"AES-128"===b.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer).then((e=>{const t=this.push(e,null,r);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(s,b.key.buffer,b.iv.buffer);if(r.part>-1&&(t=e.flush()),!t)return i.executeEnd=eB(),hB(r);s=new Uint8Array(t)}}const x=this.needsProbing(u,c);if(x){const e=this.configureTransmuxer(s);if(e)return GL.warn(`[transmuxer] ${e.message}`),this.observer.emit(UL.ERROR,UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),i.executeEnd=eB(),hB(r)}(u||c||f||x)&&this.resetInitSegment(v,p,m,y,t),(u||f||x)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const w=this.transmux(s,b,h,d,r),E=this.currentTransmuxState;return E.contiguous=!0,E.discontinuity=!1,E.trackSwitch=!1,i.executeEnd=eB(),w}flush(e){const t=e.transmuxing;t.executeStart=eB();const{decrypter:r,currentTransmuxState:n,decryptionPromise:i}=this;if(i)return i.then((()=>this.flush(e)));const s=[],{timeOffset:o}=n;if(r){const t=r.flush();t&&s.push(this.push(t,null,e))}const{demuxer:a,remuxer:l}=this;if(!a||!l)return t.executeEnd=eB(),[hB(e)];const u=a.flush(o);return fB(u)?u.then((t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,u,e),s)}flushRemux(e,t,r){const{audioTrack:n,videoTrack:i,id3Track:s,textTrack:o}=t,{accurateTimeOffset:a,timeOffset:l}=this.currentTransmuxState;GL.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${r.part>-1?" p: "+r.part:""} of level ${r.level}`);const u=this.remuxer.remux(n,i,s,o,l,a,!0,this.id);e.push({remuxResult:u,chunkMeta:r}),r.transmuxing.executeEnd=eB()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,n,i){const{demuxer:s,remuxer:o}=this;s&&o&&(s.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,n,i){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,n,i):this.transmuxUnencrypted(e,r,n,i),s}transmuxUnencrypted(e,t,r,n){const{audioTrack:i,videoTrack:s,id3Track:o,textTrack:a}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,s,o,a,t,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,r,n,i){return this.demuxer.demuxSampleAes(e,t,r).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,n,!1,this.id),chunkMeta:i})))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:n,vendor:i}=this;let s;for(let t=0,r=cB.length;t<r;t++)if(cB[t].demux.probe(e)){s=cB[t];break}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,a=this.remuxer,l=s.remux,u=s.demux;a&&a instanceof l||(this.remuxer=new l(r,t,n,i)),o&&o instanceof u||(this.demuxer=new u(r,t,n),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new eP(this.config)),e}}const hB=e=>({remuxResult:{},chunkMeta:e});function fB(e){return"then"in e&&e.then instanceof Function}class pB{constructor(e,t,r,n,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=i||null}}class mB{constructor(e,t,r,n,i,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=i,this.initSegmentChange=s}}var gB={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var l,u,c=this._events[a],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,s),!0;case 6:return c.fn.call(c.context,t,n,i,s,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var l=0,u=[],c=a.length;l<c;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&u.push(a[l]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(gB);var yB=DL(gB.exports);const vB=cI()||{isTypeSupported:()=>!1};class bB{constructor(e,t,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const s=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===UL.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new yB,this.observer.on(UL.FRAG_DECRYPTED,s),this.observer.on(UL.ERROR,s);const o={mp4:vB.isTypeSupported("video/mp4"),mpeg:vB.isTypeSupported("audio/mpeg"),mp3:vB.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){if(i.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{i.workerPath?(GL.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(i.workerPath)):(GL.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const r=new Error(`${e.message}  (${e.filename}:${e.lineno})`);i.enableWorker=!1,GL.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(UL.ERROR,{type:$L.OTHER_ERROR,details:jL.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:r})},e.postMessage({cmd:"init",typeSupported:o,vendor:a,id:t,config:JSON.stringify(i)})}catch(e){GL.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new dB(this.observer,o,i,a,t)}return}}this.transmuxer=new dB(this.observer,o,i,a,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,r,n,i,s,o,a,l,u){var c,d;l.transmuxing.start=self.performance.now();const{transmuxer:h}=this,f=s?s.start:i.start,p=i.decryptdata,m=this.frag,g=!(m&&i.cc===m.cc),y=!(m&&l.level===m.level),v=m?l.sn-m.sn:-1,b=this.part?l.part-this.part.index:-1,x=0===v&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),w=!y&&(1===v||0===v&&(1===b||x&&b<=0)),E=self.performance.now();(y||v||0===i.stats.parsing.start)&&(i.stats.parsing.start=E),!s||!b&&w||(s.stats.parsing.start=E);const S=!(m&&(null==(c=i.initSegment)?void 0:c.url)===(null==(d=m.initSegment)?void 0:d.url)),T=new mB(g,w,a,y,f,S);if(!w||g||S){GL.log(`[transmuxer-interface, ${i.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${g}\n        trackSwitch: ${y}\n        contiguous: ${w}\n        accurateTimeOffset: ${a}\n        timeOffset: ${f}\n        initSegmentChange: ${S}`);const e=new pB(r,n,t,o,u);this.configureTransmuxer(e)}if(this.frag=i,this.part=s,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:l,state:T},e instanceof ArrayBuffer?[e]:[]);else if(h){const t=h.push(e,p,l,T);fB(t)?(h.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let r=t.flush(e);fB(r)||t.async?(fB(r)||(r=Promise.resolve(r)),r.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(r,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data,r=this.hls;switch(t.event){case"init":{var n;const e=null==(n=this.workerContext)?void 0:n.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":GL[t.data.logType]&&GL[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class xB{constructor(e,t,r,n){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:r,media:n,stalled:i}=this;if(null===n)return;const{currentTime:s,seeking:o}=n,a=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,s!==e){if(this.moved=!0,null!==i){if(this.stallReported){const e=self.performance.now()-i;GL.warn(`playback not stuck anymore @${s}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||a)return void(this.stalled=null);if(n.paused&&!o||n.ended||0===n.playbackRate||!HF.getBuffered(n).length)return;const u=HF.bufferInfo(n,s,0),c=u.len>0,d=u.nextStart||0;if(!c&&!d)return;if(o){const e=u.len>2,r=!d||t&&t.start<=s||d-s>2&&!this.fragmentTracker.getPartialFragment(s);if(e||r)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var h;const e=Math.max(d,u.start||0)-s,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,r=(null==t||null==(h=t.details)?void 0:h.live)?2*t.details.targetduration:2,n=this.fragmentTracker.getPartialFragment(s);if(e>0&&(e<=r||n))return void this._trySkipBufferHole(n)}const f=self.performance.now();if(null===i)return void(this.stalled=f);const p=f-i;if(!o&&p>=250&&(this._reportStall(u),!this.media))return;const m=HF.bufferInfo(n,s,r.maxBufferHole);this._tryFixBufferStall(m,p)}_tryFixBufferStall(e,t){const{config:r,fragmentTracker:n,media:i}=this;if(null===i)return;const s=i.currentTime,o=n.getPartialFragment(s);if(o){if(this._trySkipBufferHole(o)||!this.media)return}(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-s<r.maxBufferHole)&&t>1e3*r.highBufferWatchdogPeriod&&(GL.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:r,stallReported:n}=this;if(!n&&r){this.stallReported=!0;const n=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(e)})`);GL.warn(n.message),t.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:r,media:n}=this;if(null===n)return 0;const i=n.currentTime,s=HF.bufferInfo(n,i,0),o=i<s.start?s.start:s.nextStart;if(o){const a=s.len<=t.maxBufferHole,l=s.len>0&&s.len<1&&n.readyState<3,u=o-i;if(u>0&&(a||l)){if(u>t.maxBufferHole){const{fragmentTracker:t}=this;let r=!1;if(0===i){const e=t.getAppendedFrag(0,OI);e&&o<e.end&&(r=!0)}if(!r){const r=e||t.getAppendedFrag(i,OI);if(r){let e=!1,n=r.end;for(;n<o;){const r=t.getPartialFragment(n);if(!r){e=!0;break}n+=r.duration}if(e)return 0}}}const s=Math.max(o+.05,i+.1);if(GL.warn(`skipping hole, adjusting currentTime from ${i} to ${s}`),this.moved=!0,this.stalled=null,n.currentTime=s,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${i} to ${s}`);r.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return s}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:r,nudgeRetry:n}=this;if(null===r)return;const i=r.currentTime;if(this.nudgeRetry++,n<e.nudgeMaxRetry){const s=i+(n+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${i} to ${s}`);GL.warn(o.message),r.currentTime=s,t.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const r=new Error(`Playhead still not moving while enough data buffered @${i} after ${e.nudgeMaxRetry} nudges`);GL.error(r.message),t.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_STALLED_ERROR,error:r,fatal:!0})}}}class wB extends pP{constructor(e,t,r){super(e,t,r,"[stream-controller]",OI),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.LEVEL_LOADING,this.onLevelLoading,this),e.on(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.on(UL.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(UL.ERROR,this.onError,this),e.on(UL.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(UL.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(UL.BUFFER_CREATED,this.onBufferCreated,this),e.on(UL.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(UL.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(UL.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.off(UL.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(UL.ERROR,this.onError,this),e.off(UL.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(UL.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(UL.BUFFER_CREATED,this.onBufferCreated,this),e.off(UL.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(UL.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(UL.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:r}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=r.startLevel;-1===e&&(r.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=r.nextAutoLevel),this.level=r.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=nP,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=rP}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case fP:{var e;const{levels:t,level:r}=this,n=null==t||null==(e=t[r])?void 0:e.details;if(n&&(!n.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(n))break;this.state=nP;break}if(this.hls.nextLoadLevel!==this.level){this.state=nP;break}break}case oP:{var t;const e=self.performance.now(),r=this.retryDate;(!r||e>=r||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=nP)}}this.state===nP&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:n}=this,{config:i,nextLoadLevel:s}=e;if(null===t||!n&&(this.startFragRequested||!i.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;if(null==r||!r[s])return;const o=r[s],a=this.getMainFwdBufferInfo();if(null===a)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(UL.BUFFER_EOS,e),void(this.state=cP)}e.loadLevel!==s&&-1===e.manualLevel&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=o.details;if(!u||this.state===fP||u.live&&this.levelLastLoaded!==s)return this.level=s,void(this.state=fP);const c=a.len,d=this.getMaxBufferLength(o.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:a.end;let f=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==_F){var p;const e=(null!=(p=this.backtrackFragment)?p:f).sn-u.startSN,t=u.fragments[e-1];t&&f.cc===t.cc&&(f=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,h)){if(!f.gap){const e=this.audioOnly&&!this.altAudio?QL:eR,t=(e===eR?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,OI)}f=this.getNextFragmentLoopLoading(f,u,a,OI,d)}f&&(!f.initSegment||f.initSegment.data||this.bitrateTest||(f=f.initSegment),this.loadFragment(f,o,h))}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);this.fragCurrent=e,n===kF||n===OF?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,r)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,OI)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let r;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const i=this.getLevelDetails();if(null!=i&&i.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*i.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],n=this.fragLastKbps;r=n&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*n)+1:0}else r=0;const s=this.getBufferedFrag(t.currentTime+r);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,r=e.duration,n=Math.max(s.end,t+Math.min(Math.max(r-this.config.maxFragLookUpTolerance,.5*r),.75*r));this.flushMainBuffer(n,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case iP:case sP:case oP:case lP:case uP:this.state=nP}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new xB(this.config,r,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;BL(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const r=this.getMainFwdBufferInfo();null!==r&&0!==r.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${r?r.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(UL.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let r,n=!1,i=!1;t.levels.forEach((e=>{r=e.audioCodec,r&&(-1!==r.indexOf("mp4a.40.2")&&(n=!0),-1!==r.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=n&&i&&!function(){var e;const t=mP();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==nP)return;const n=r[t.level];(!n.details||n.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(n.details))&&(this.state=fP)}onLevelLoaded(e,t){var r;const{levels:n}=this,i=t.level,s=t.details,o=s.totalduration;if(!n)return void this.warn(`Levels were reset while loading level ${i}`);this.log(`Level ${i} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""}, cc [${s.startCC}, ${s.endCC}] duration:${o}`);const a=n[i],l=this.fragCurrent;!l||this.state!==sP&&this.state!==oP||l.level===t.level&&l.urlId===a.urlId||!l.loader||this.abortCurrentFrag();let u=0;if(s.live||null!=(r=a.details)&&r.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;u=this.alignPlaylists(s,a.details)}if(a.details=s,this.levelLastLoaded=i,this.hls.trigger(UL.LEVEL_UPDATED,{details:s,level:i}),this.state===fP){if(this.waitForCdnTuneIn(s))return;this.state=nP}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:n,payload:i}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);const o=s[r.level],a=o.details;if(!a)return this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),void this.fragmentTracker.removeFragment(r);const l=o.videoCodec,u=a.PTSKnown||!a.live,c=null==(t=r.initSegment)?void 0:t.data,d=this._getAudioCodec(o),h=this.transmuxer=this.transmuxer||new bB(this.hls,OI,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=n?n.index:-1,p=-1!==f,m=new VF(r.level,r.sn,r.stats.chunkCount,i.byteLength,f,p),g=this.initPTS[r.cc];h.push(i,c,d,l,r,n,a.totalduration,u,m,g)}onAudioTrackSwitching(e,t){const r=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;r&&(e.trigger(UL.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(UL.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=t.id,n=!!this.hls.audioTracks[r].url;if(n){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=n,this.tick()}onBufferCreated(e,t){const r=t.tracks;let n,i,s=!1;for(const e in r){const t=r[e];if("main"===t.id){if(i=e,n=t,"video"===e){const t=r[e];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&n?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:n}=t;if(r&&r.type!==OI)return;if(this.fragContextChanged(r))return this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===uP&&(this.state=nP));const i=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}onError(e,t){var r;if(t.fatal)this.state=dP;else switch(t.details){case jL.FRAG_GAP:case jL.FRAG_PARSING_ERROR:case jL.FRAG_DECRYPT_ERROR:case jL.FRAG_LOAD_ERROR:case jL.FRAG_LOAD_TIMEOUT:case jL.KEY_LOAD_ERROR:case jL.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(OI,t);break;case jL.LEVEL_LOAD_ERROR:case jL.LEVEL_LOAD_TIMEOUT:case jL.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==fP||(null==(r=t.context)?void 0:r.type)!==CI||(this.state=nP);break;case jL.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case jL.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!HF.getBuffered(e).length){const e=this.state!==nP?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=nP,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==QL||this.audioOnly&&!this.altAudio){const e=(t===eR?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,OI)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log(`could not seek to ${r}, already seeking at ${t}`);const n=HF.getBuffered(e),i=(n.length?n.start(0):0)-r;i>0&&(i<this.config.maxBufferHole||i<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${i} to match buffer start`),r+=i,this.startPosition=r),this.log(`seek to target start position ${r} from current time ${t}`),e.currentTime=r}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((r=>{const{hls:n}=this;if(!r||this.fragContextChanged(e))return;t.fragmentError=0,this.state=nP,this.startFragRequested=!1,this.bitrateTest=!1;const i=e.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),n.trigger(UL.FRAG_LOADED,r),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const r="main",{hls:n}=this,{remuxResult:i,chunkMeta:s}=e,o=this.getCurrentContext(s);if(!o)return void this.resetWhenMissingContext(s);const{frag:a,part:l,level:u}=o,{video:c,text:d,id3:h,initSegment:f}=i,{details:p}=u,m=this.altAudio?void 0:i.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state=lP,f){if(null!=f&&f.tracks){const e=a.initSegment||a;this._bufferInitSegment(u,f.tracks,e,s),n.trigger(UL.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:r,tracks:f.tracks})}const e=f.initPTS,t=f.timescale;BL(e)&&(this.initPTS[a.cc]={baseTime:e,timescale:t},n.trigger(UL.INIT_PTS_FOUND,{frag:a,id:r,initPTS:e,timescale:t}))}if(c&&p&&"initSegment"!==a.sn){const e=p.fragments[a.sn-1-p.startSN],t=a.sn===p.startSN,r=!e||a.cc>e.cc;if(!1!==i.independent){const{startPTS:e,endPTS:n,startDTS:i,endDTS:o}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:n,startDTS:i,endDTS:o};else if(c.firstKeyFrame&&c.independent&&1===s.id&&!r&&(this.couldBacktrack=!0),c.dropped&&c.independent){const i=this.getMainFwdBufferInfo(),s=(i?i.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&s<l-this.config.maxBufferHole&&!r)return void this.backtrack(a);r&&(a.gap=!0),a.setElementaryStreamInfo(c.type,a.start,n,a.start,o,!0)}a.setElementaryStreamInfo(c.type,e,n,i,o),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(c,a,l,s,t||r)}else{if(!t&&!r)return void this.backtrack(a);a.gap=!0}}if(m){const{startPTS:e,endPTS:t,startDTS:r,endDTS:n}=m;l&&(l.elementaryStreams[QL]={startPTS:e,endPTS:t,startDTS:r,endDTS:n}),a.setElementaryStreamInfo(QL,e,t,r,n),this.bufferFragmentData(m,a,l,s)}if(p&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:r,frag:a,details:p,samples:h.samples};n.trigger(UL.FRAG_PARSING_METADATA,e)}if(p&&d){const e={id:r,frag:a,details:p,samples:d.samples};n.trigger(UL.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,r,n){if(this.state!==lP)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:i,video:s,audiovideo:o}=t;if(i){let t=e.audioCodec;const r=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==i.metadata.channelCount&&-1===r.indexOf("firefox")&&(t="mp4a.40.5")),-1!==r.indexOf("android")&&"audio/mpeg"!==i.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),i.levelCodec=t,i.id="main",this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${i.codec}]`)}s&&(s.levelCodec=e.videoCodec,s.id="main",this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${s.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${o.codec}]`),this.hls.trigger(UL.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const i=t[e].initSegment;null!=i&&i.byteLength&&this.hls.trigger(UL.BUFFER_APPENDING,{type:e,data:i,frag:r,part:null,chunkMeta:n,parent:r.type})})),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,OI)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=nP}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const r=e.currentTime;if(HF.isBuffered(e,r)?t=this.getAppendedFrag(r):HF.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,r=t.level;e&&t.sn===e.sn&&e.level===r&&t.urlId===e.urlId||(this.fragPlaying=t,this.hls.trigger(UL.FRAG_CHANGED,{frag:t}),e&&e.level===r||this.hls.trigger(UL.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,r=this.currentFrag;if(r&&BL(t)&&BL(r.programDateTime)){const e=r.programDateTime+1e3*(t-r.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class EB{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class SB{constructor(e,t,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EB(e),this.fast_=new EB(t),this.defaultTTFB_=n,this.ttfb_=new EB(e)}update(e,t){const{slow_:r,fast_:n,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new EB(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new EB(t,n.getEstimate(),n.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new EB(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){const r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class TB{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;return e.length?(r=1===e.length?e[0]:function(e,t){const r=new Uint8Array(t);let n=0;for(let t=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(e,t),this.reset(),r):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function AB(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!DB(e[r].attrs,t[r].attrs))return!1;return!0}function DB(e,t){const r=e["STABLE-RENDITION-ID"];return r?r===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((r=>e[r]!==t[r]))}class NB{constructor(e){this.buffered=void 0;const t=(t,r,n)=>{if((r>>>=0)>n-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${n})`);return e[r][t]};this.buffered={get length(){return e.length},end:r=>t("end",r,e.length),start:r=>t("start",r,e.length)}}}function CB(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||t.push(e[r])}return t}class kB{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const r=this.queues[t];r.push(e),1===r.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const r=new Promise((e=>{t=e})),n={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(n,e),r}executeNext(e){const{buffers:t,queues:r}=this,n=t[e],i=r[e];if(i.length){const t=i[0];try{t.execute()}catch(r){GL.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(r),null!=n&&n.updating||(i.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const MB=cI(),OB=/([ha]vc.)(?:\.[^.,]+)+/;const _B={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},LB=function(e){let t=e;return _B.hasOwnProperty(e)&&(t=_B[e]),String.fromCharCode(t)},RB=15,IB=100,FB={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},PB={17:2,18:4,21:6,22:8,23:10,19:13,20:15},BB={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},UB={25:2,26:4,29:6,30:8,31:10,27:13,28:15},$B=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class jB{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r="function"==typeof t?t():t;GL.log(`${this.time} [${e}] ${r}`)}}}const zB=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class qB{constructor(e,t,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class HB{constructor(e,t,r,n,i,s){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new qB(t,r,n,i,s)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class VB{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<IB;e++)this.chars.push(new HB);this.logger=e,this.pos=0,this.currPenState=new qB}equals(e){let t=!0;for(let r=0;r<IB;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t}copy(e){for(let t=0;t<IB;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<IB;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>IB&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=IB)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=LB(e);this.pos>=IB?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<IB;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<IB;r++){const n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);this.chars[this.pos].setPenState(this.currPenState)}}class GB{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<RB;t++)this.rows.push(new VB(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<RB;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let r=0;r<RB;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<RB;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<RB;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<RB;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){const n=r.rows[e].cueStartTime,i=this.logger.time;if(n&&null!==i&&n<i)for(let n=0;n<this.nrRollUpRows;n++)this.rows[t-this.nrRollUpRows+n+1].copy(r.rows[e+n])}}this.currRow=t;const r=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,n=Math.max(t-1,0);r.setCursor(e.indent),e.color=r.chars[n].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",n=-1;for(let r=0;r<RB;r++){const i=this.rows[r].getTextString();i&&(n=r+1,e?t.push("Row "+n+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r}getTextAndFormat(){return this.rows}}class WB{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new GB(r),this.nonDisplayedMemory=new GB(r),this.lastOutputScreen=new GB(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class KB{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const n=new jB;this.channels=[null,new WB(e,t,n),new WB(e+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let r,n,i,s=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(n=127&t[e],i=127&t[e+1],0!==n||0!==i){if(this.logger.log(3,"["+zB([t[e],t[e+1]])+"] -> ("+zB([n,i])+")"),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(s=this.parseChars(n,i),s)){const e=this.currentChannel;if(e&&e>0){this.channels[e].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,"Couldn't parse cleaned data "+zB([n,i])+" orig: "+zB([t[e],t[e+1]]))}}parseCmd(e,t){const{cmdHistory:r}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(JB(e,t,r))return YB(null,null,r),this.logger.log(3,"Repeated command ("+zB([e,t])+") is dropped"),!0;const n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),YB(e,t,r),this.currentChannel=n,!0}parseMidrow(e,t){let r=0;if((17===e||25===e)&&t>=32&&t<=47){if(r=17===e?1:2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(3,"MIDROW ("+zB([e,t])+")"),!0)}return!1}parsePAC(e,t){let r;const n=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(JB(e,t,n))return YB(null,null,n),!0;const i=e<=23?1:2;r=t>=64&&t<=95?1===i?FB[e]:BB[e]:1===i?PB[e]:UB[e];const s=this.channels[i];return!!s&&(s.setPAC(this.interpretPAC(r,t)),YB(e,t,n),this.currentChannel=i,!0)}interpretPAC(e,t){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n}parseChars(e,t){let r,n=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let e;e=17===i?t+80:18===i?t+112:t+144,this.logger.log(2,"Special char '"+LB(e)+"' in channel "+r),n=[e]}else e>=32&&e<=127&&(n=0===t?[e]:[e,t]);if(n){const r=zB(n);this.logger.log(3,"Char codes =  "+r.join(",")),YB(e,t,this.cmdHistory)}return n}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;let r;const n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=$B[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));const i=e<=23?1:2;return this.channels[i].setBkgData(n),YB(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function YB(e,t,r){r.a=e,r.b=t}function JB(e,t,r){return r.a===e&&r.b===t}class ZB{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var XB=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const r=t.toLowerCase();return!!~e.indexOf(r)&&r}function n(e){return r(t,e)}function i(e,...t){let r=1;for(;r<arguments.length;r++){const t=arguments[r];for(const r in t)e[r]=t[r]}return e}function s(t,s,o){const a=this,l={enumerable:!0};a.hasBeenReset=!1;let u="",c=!1,d=t,h=s,f=o,p=null,m="",g=!0,y="auto",v="start",b=50,x="middle",w=50,E="middle";Object.defineProperty(a,"id",i({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(a,"pauseOnExit",i({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(a,"startTime",i({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",i({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",i({},l,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",i({},l,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",i({},l,{get:function(){return m},set:function(t){const n=function(t){return r(e,t)}(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");m=n,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",i({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",i({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",i({},l,{get:function(){return v},set:function(e){const t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",i({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",i({},l,{get:function(){return x},set:function(e){const t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");x=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",i({},l,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",i({},l,{get:function(){return E},set:function(e){const t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),a.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class QB{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function eU(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(n||0)}const r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}class tU{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function rU(e,t,r,n){const i=n?e.split(n):[e];for(const e in i){if("string"!=typeof i[e])continue;const n=i[e].split(r);if(2!==n.length)continue;t(n[0],n[1])}}const nU=new XB(0,0,""),iU="middle"===nU.align?"middle":"center";function sU(e,t,r){const n=e;function i(){const t=eU(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=i(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.slice(3),s(),t.endTime=i(),s(),function(e,t){const n=new tU;rU(e,(function(e,t){let i;switch(e){case"region":for(let i=r.length-1;i>=0;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),n.integer(e,i[0]),n.percent(e,i[0])&&n.set("snapToLines",!1),n.alt(e,i[0],["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",iU,"end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",iU,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",iU,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");let i=n.get("line","auto");"auto"===i&&-1===nU.line&&(i=-1),t.line=i,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",iU);let s=n.get("position","auto");"auto"===s&&50===nU.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function oU(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class aU{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new QB,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function r(){let e=t.buffer,r=0;for(e=oU(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;const n=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=r();const n=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let n=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(n?n=!1:e=r(),t.state){case"HEADER":/:/.test(e)?rU(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new XB(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{sU(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const r=-1!==e.indexOf("--\x3e");if(!e||r&&(n=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const lU=/\r\n|\n\r|\n|\r/g,uU=function(e,t,r=0){return e.slice(r,r+t.length)===t},cU=function(e){let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()};function dU(e,t,r){return cU(e.toString())+cU(t.toString())+cU(r)}function hU(e,t,r,n,i,s,o){const a=new aU,l=LR(new Uint8Array(e)).trim().replace(lU,"\n").split("\n"),u=[],c=t?function(e,t=1){return XP(e,ZP,1/t)}(t.baseTime,t.timescale):0;let d,h="00:00.000",f=0,p=0,m=!0;a.oncue=function(e){const s=r[n];let o=r.ccOffset;const a=(f-c)/9e4;if(null!=s&&s.new&&(void 0!==p?o=r.ccOffset=s.start:function(e,t,r){let n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;null!=(s=i)&&s.new;){var s;e.ccOffset+=n.start-i.start,n.new=!1,n=i,i=e[n.prevCC]}e.presentationOffset=r}(r,n,a)),a){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));o=a-r.presentationOffset}const l=e.endTime-e.startTime,h=iB(9e4*(e.startTime+o-p),9e4*i)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=dU(e.startTime,e.endTime,m)),e.endTime>0&&u.push(e)},a.onparsingerror=function(e){d=e},a.onflush=function(){d?o(d):s(u)},l.forEach((e=>{if(m){if(uU(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((e=>{uU(e,"LOCAL:")?h=e.slice(6):uU(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))}));try{p=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(BL(t)&&BL(r)&&BL(n)&&BL(i)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=6e4*n,t+=36e5*i,t}(h)/1e3}catch(e){d=e}return}""===e&&(m=!1)}a.parse(e+"\n")})),a.flush()}const fU="stpp.ttml.im1t",pU=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mU=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,gU={left:"start",center:"center",right:"end",start:"start",end:"end"};function yU(e,t,r,n){const i=VR(new Uint8Array(e),["mdat"]);if(0===i.length)return void n(new Error("Could not parse IMSC1 mdat"));const s=i.map((e=>LR(e))),o=function(e,t,r=1,n=!1){return XP(e,t,1/r,n)}(t.baseTime,1,t.timescale);try{s.forEach((e=>r(function(e,t){const r=new DOMParser,n=r.parseFromString(e,"text/xml"),i=n.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce(((e,t)=>(e[t]=i.getAttribute(`ttp:${t}`)||s[t],e)),{}),a="preserve"!==i.getAttribute("xml:space"),l=bU(vU(i,"styling","style")),u=bU(vU(i,"layout","region")),c=vU(i,"body","[begin]");return[].map.call(c,(e=>{const r=xU(e,a);if(!r||!e.hasAttribute("begin"))return null;const n=SU(e.getAttribute("begin"),o),i=SU(e.getAttribute("dur"),o);let s=SU(e.getAttribute("end"),o);if(null===n)throw EU(e);if(null===s){if(null===i)throw EU(e);s=n+i}const c=new XB(n-t,s-t,r);c.id=dU(c.startTime,c.endTime,c.text);const d=function(e,t,r){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;o&&r.hasOwnProperty(o)&&(i=r[o]);return s.reduce(((r,s)=>{const o=wU(t,n,s)||wU(e,n,s)||wU(i,n,s);return o&&(r[s]=o),r}),{})}(u[e.getAttribute("region")],l[e.getAttribute("style")],l),{textAlign:h}=d;if(h){const e=gU[h];e&&(c.lineAlign=e),c.align=h}return PL(c,d),c})).filter((e=>null!==e))}(e,o))))}catch(e){n(e)}}function vU(e,t,r){const n=e.getElementsByTagName(t)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function bU(e){return e.reduce(((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function xU(e,t){return[].slice.call(e.childNodes).reduce(((e,r,n)=>{var i;return"br"===r.nodeName&&n?e+"\n":null!=(i=r.childNodes)&&i.length?xU(r,t):t?e+r.textContent.trim().replace(/\s+/g," "):e+r.textContent}),"")}function wU(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function EU(e){return new Error(`Could not parse ttml timestamp ${e}`)}function SU(e,t){if(!e)return null;let r=eU(e);return null===r&&(pU.test(e)?r=function(e,t){const r=pU.exec(e),n=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/t.frameRate}(e,t):mU.test(e)&&(r=function(e,t){const r=mU.exec(e),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/t.frameRate;case"t":return n/t.tickRate}return n}(e,t))),r}function TU(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}class AU{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(UL.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.BUFFER_CODECS,this.onBufferCodecs,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(UL.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.BUFFER_CODECS,this.onBufferCodecs,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter(((t,r)=>this.isLevelAllowed(t)&&r<=e));return this.clientRect=null,AU.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,r){if(null==e||!e.length)return-1;let n=e.length-1;for(let o=0;o<e.length;o+=1){const a=e[o];if((a.width>=t||a.height>=r)&&(i=a,!(s=e[o+1])||i.width!==s.width||i.height!==s.height)){n=o;break}}var i,s;return n}}const DU="[eme]";class NU{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=NU.CDMCleanupPromise?[NU.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=GL.debug.bind(GL,DU),this.log=GL.log.bind(GL,DU),this.warn=GL.warn.bind(GL,DU),this.error=GL.error.bind(GL,DU),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(UL.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(UL.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(UL.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(UL.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===uR.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(e,t,r)=>!!e&&r.indexOf(e)===t,n=t.map((e=>e.audioCodec)).filter(r),i=t.map((e=>e.videoCodec)).filter(r);return n.length+i.length===0&&i.push("avc1.42e01e"),new Promise(((t,r)=>{const s=e=>{const o=e.shift();this.getMediaKeysPromise(o,n,i).then((e=>t({keySystem:o,mediaKeys:e}))).catch((t=>{e.length?s(e):r(t instanceof CU?t:new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if("function"!=typeof r){let e=`Configured requestMediaKeySystemAccess is not a function ${r}`;return null===vR&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return r(e,t)}getMediaKeysPromise(e,t,r){const n=function(e,t,r,n){let i;switch(e){case uR.FAIRPLAY:i=["cenc","sinf"];break;case uR.WIDEVINE:case uR.PLAYREADY:i=["cenc"];break;case uR.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,r,n){return[{initDataTypes:e,persistentState:n.persistentState||"not-allowed",distinctiveIdentifier:n.distinctiveIdentifier||"not-allowed",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}))),videoCapabilities:r.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null})))}]}(i,t,r,n)}(e,t,r,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e];let s=null==i?void 0:i.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(n)}`),s=this.requestMediaKeySystemAccess(e,n);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),s.then((r=>{this.log(`Access for key-system "${r.keySystem}" obtained`);const n=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=r.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),n.then((r=>r?this.setMediaKeysServerCertificate(t,e,r):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return s.then((()=>i.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${FR(e.keyId||[])}`);const n=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,i,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return FR(e.keyId)}updateKeySession(e,t){var r;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${FR((null==(r=e.decryptdata)?void 0:r.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),n.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,r)=>{const n=yR(this.config),i=e.map(pR).filter((e=>!!e&&-1!==n.indexOf(e)));return this.getKeySystemSelectionPromise(i).then((({keySystem:e})=>{const n=gR(e);n?t(n):r(new Error(`Unable to find format for key-system "${e}"`))})).catch(r)}))}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),n=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let i=this.keyIdToKeySessionPromise[r];return i||(i=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(t).then((({keySystem:r,mediaKeys:i})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(r,i).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:r,mediaKeys:i,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))))),i.catch((e=>this.handleError(e)))),i}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof CU?this.hls.trigger(UL.ERROR,e.data):this.hls.trigger(UL.ERROR,{type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const t=pR(e.keyFormat),r=t?[t]:yR(this.config);return this.attemptKeySystemAccess(r)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=yR(this.config)),0===e.length)throw new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:r}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),null===r)return;let n,i;if("sinf"===t&&this.config.drmSystems[uR.FAIRPLAY]){const e=$R(new Uint8Array(r));try{const t=oR(JSON.parse(e).sinf),r=KR(new Uint8Array(t));if(!r)return;n=r.subarray(8,24),i=uR.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},r=new DataView(e),n=r.getUint32(0);if(e.byteLength!==n&&n>44)return null;if(1886614376!==r.getUint32(4))return null;if(t.version=r.getUint32(8)>>>24,t.version>1)return null;t.systemId=FR(new Uint8Array(e,12,16));const i=r.getUint32(28);if(0===t.version){if(n-32<i)return null;t.data=new Uint8Array(e,32,i)}else if(1===t.version){t.kids=[];for(let r=0;r<i;r++)t.kids.push(new Uint8Array(e,32+16*r,16))}return t}(r);if(null===e)return;0===e.version&&e.systemId===mR&&e.data&&(n=e.data.subarray(8,24)),i=function(e){if(e===mR)return uR.WIDEVINE}(e.systemId)}if(!i||!n)return;const s=FR(n),{keyIdToKeySessionPromise:o,mediaKeySessions:a}=this;let l=o[s];for(let e=0;e<a.length;e++){const i=a[e],u=i.decryptdata;if(u.pssh||!u.keyId)continue;const c=FR(u.keyId);if(s===c||-1!==u.uri.replace(/-/g,"").indexOf(s)){l=o[c],delete o[c],u.pssh=new Uint8Array(r),u.keyId=n,l=o[s]=l.then((()=>this.generateRequestWithPreferredKeySession(i,t,r,"encrypted-event-key-match")));break}}l||(l=o[s]=this.getKeySystemSelectionPromise([i]).then((({keySystem:e,mediaKeys:i})=>{var o;this.throwIfDestroyed();const a=new nI("ISO-23001-7",s,null!=(o=gR(e))?o:"");return a.pssh=new Uint8Array(r),a.keyId=n,this.attemptSetMediaKeys(e,i).then((()=>{this.throwIfDestroyed();const n=this.createMediaKeySessionContext({decryptdata:a,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(n,t,r,"encrypted-event-no-match")}))}))),l.catch((e=>this.handleError(e)))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(r).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(n),n.then((()=>{this.log(`Media-keys set for "${e}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===r.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,r,n){var i,s;const o=null==(i=this.config.drmSystems)||null==(s=i[e.keySystem])?void 0:s.generateRequest;if(o)try{const n=o.call(this.hls,t,r,e);if(!n)throw new Error("Invalid response from configured generateRequest filter");t=n.initDataType,r=e.decryptdata.pssh=n.initData?new Uint8Array(n.initData):null}catch(e){var a;if(this.warn(e.message),null!=(a=this.hls)&&a.config.debug)throw e}if(null===r)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${l} (init data type: ${t} length: ${r?r.byteLength:null})`);const u=new yB;e.mediaKeysSession.onmessage=t=>{const r=e.mediaKeysSession;if(!r)return void u.emit("error",new Error("invalid state"));const{messageType:n,message:i}=t;this.log(`"${n}" message event for session "${r.sessionId}" message size: ${i.byteLength}`),"license-request"===n||"license-renewal"===n?this.renewLicense(e,i).catch((e=>{this.handleError(e),u.emit("error",e)})):"license-release"===n?e.keySystem===uR.FAIRPLAY&&(this.updateKeySession(e,lR("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${n}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void u.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const r=e.keyStatus;u.emit("keyStatus",r),"expired"===r&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};const c=new Promise(((e,t)=>{u.on("error",t),u.on("keyStatus",(r=>{r.startsWith("usable")?e():"output-restricted"===r?t(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===r?t(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${r}"`)):"expired"===r?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${r}"`)}))}));return e.mediaKeysSession.generateRequest(t,r).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>c)).catch((t=>{throw u.removeAllListeners(),this.removeSession(e),t})).then((()=>(u.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,r)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${FR("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${FR(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,r=new(0,t.loader)(t),n=this.getServerCertificateUrl(e);return n?(this.log(`Fetching serverCertificate for "${e}"`),new Promise(((i,s)=>{const o={responseType:"arraybuffer",url:n},a=t.certLoadPolicy.default,l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,r,n)=>{i(e.data)},onError:(t,r,i,a)=>{s(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:IL({url:o.url,data:void 0},t)},`"${e}" certificate request failed (${n}). Status: ${t.code} (${t.text})`))},onTimeout:(t,r,i)=>{s(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:o.url,data:void 0}},`"${e}" certificate request timed out (${n})`))},onAbort:(e,t,r)=>{s(new Error("aborted"))}};r.load(o,l,u)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise(((n,i)=>{e.setServerCertificate(r).then((i=>{this.log(`setServerCertificate ${i?"success":"not supported by CDM"} (${null==r?void 0:r.byteLength}) on "${t}"`),n(e)})).catch((e=>{i(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}setupLicenseXHR(e,t,r,n){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then((()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,n)})).catch((s=>{if(!r.decryptdata)throw s;return e.open("POST",t,!0),i.call(this.hls,e,t,r,n)})).then((r=>{e.readyState||e.open("POST",t,!0);return{xhr:e,licenseChallenge:r||n}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise(((n,i)=>{const s=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${s}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(4===o.readyState)if(200===o.status){this._requestLicenseFailureCount=0;let t=o.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const r=this.config.licenseResponseCallback;if(r)try{t=r.call(this.hls,o,s,e)}catch(e){this.error(e)}n(t)}else{const a=r.errorRetry,l=a?a.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||o.status>=400&&o.status<500)i(new CU({type:$L.KEY_SYSTEM_ERROR,details:jL.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:s,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${s}). Status: ${o.status} (${o.statusText})`));else{const r=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${r} attempts left`),this.requestLicense(e,t).then(n,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,s,e,t).then((({xhr:e,licenseChallenge:t})=>{e.send(t)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},nI.clearKeyUriToKeyIdMap();const r=t.length;NU.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)})))).then((()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);return n>-1&&this.mediaKeySessions.splice(n,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}}NU.CDMCleanupPromise=void 0;class CU extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var kU="m",MU="a",OU="v",_U="av",LU="i",RU="tt";class IU{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:kU,su:!this.initialized})}catch(e){GL.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const t=e.frag,r=this.hls.levels[t.level],n=this.getObjectType(t),i={d:1e3*t.duration,ot:n};n!==OU&&n!==MU&&n!=_U||(i.br=r.bitrate/1e3,i.tb=this.getTopBandwidth(n)/1e3,i.bl=this.getBufferLength(n)),this.apply(e,i)}catch(e){GL.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;null!=r&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||IU.uuid(),this.cid=r.contentId,this.useHeaders=!0===r.useHeaders,this.registerListeners())}registerListeners(){const e=this.hls;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHED,this.onMediaDetached,this),e.on(UL.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHED,this.onMediaDetached,this),e.off(UL.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,n;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=t.tracks.video)?void 0:n.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){PL(t,this.createData());const r=t.ot===LU||t.ot===OU||t.ot===_U;if(this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const r=IU.toHeaders(t);if(!Object.keys(r).length)return;e.headers||(e.headers={}),PL(e.headers,r)}else{const r=IU.toQuery(t);if(!r)return;e.url=IU.appendQueryToUri(e.url,r)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?RU:"initSegment"===e.sn?LU:"audio"===t?MU:"main"===t?this.hls.audioTracks.length?OU:_U:void 0}getTopBandwidth(e){let t,r=0;const n=this.hls;if(e===MU)t=n.audioTracks;else{const e=n.maxAutoLevel,r=e>-1?e+1:n.levels.length;t=n.levels.slice(0,r)}for(const e of t)e.bitrate>r&&(r=e.bitrate);return r>0?r:NaN}getBufferLength(e){const t=this.hls.media,r=e===MU?this.audioBuffer:this.videoBuffer;if(!r||!t)return NaN;return 1e3*HF.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new r(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,r,n){t(e),this.loader.load(e,r,n)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new r(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,r,n){t(e),this.loader.load(e,r,n)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],r=e=>!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e,n=e=>Math.round(e),i=e=>100*n(e/100),s={br:n,d:n,bl:i,dl:i,mtp:i,nor:e=>encodeURIComponent(e),rtp:i,tb:n},o=Object.keys(e||{}).sort();for(const n of o){let i=e[n];if(!r(i))continue;if("v"===n&&1===i)continue;if("pr"==n&&1===i)continue;const o=s[n];o&&(i=o(i));const a=typeof i;let l;l="ot"===n||"sf"===n||"st"===n?`${n}=${i}`:"boolean"===a?n:"number"===a?`${n}=${i}`:`${n}=${JSON.stringify(i)}`,t.push(l)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),r={},n=["Object","Request","Session","Status"],i=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const r of t){i[null!=s[r]?s[r]:1][r]=e[r]}for(let e=0;e<i.length;e++){const t=IU.serialize(i[e]);t&&(r[`CMCD-${n[e]}`]=t)}return r}static toQuery(e){return`CMCD=${encodeURIComponent(IU.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const r=e.includes("?")?"&":"?";return`${e}${r}${t}`}}function FU(e,t,r,n){e&&Object.keys(t).forEach((i=>{const s=e.filter((e=>e.groupId===i)).map((e=>{const s=PL({},e);return s.details=void 0,s.attrs=new YL(s.attrs),s.url=s.attrs.URI=PU(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),s.groupId=s.attrs["GROUP-ID"]=t[i],s.attrs["PATHWAY-ID"]=n,s}));e.push(...s)}))}function PU(e,t,r,n){const{HOST:i,PARAMS:s,[r]:o}=n;let a;t&&(a=null==o?void 0:o[t],a&&(e=a));const l=new self.URL(e);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach((e=>{e&&l.searchParams.set(e,s[e])})),l.href}const BU=/^age:\s*[\d.]+\s*$/im;class UU{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new XL,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then((()=>{if(!this.stats.aborted)return i(r,t.url)})).catch((e=>(r.open("GET",t.url,!0),i(r,t.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(r,t,e)})).catch((e=>{this.callbacks.onError({code:r.status,text:e.message},t,r,n)})):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const n=this.context.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:s}=r.loadPolicy;if(n)for(const t in n)e.setRequestHeader(t,n[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&BL(i)?i:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const n=t.readyState,i=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const n=t.status,s="text"!==t.responseType;if(n>=200&&n<300&&(s&&t.response||null!==t.responseText)){r.loading.end=Math.max(self.performance.now(),r.loading.first);const i=s?t.response:t.responseText,o="arraybuffer"===t.responseType?i.byteLength:i.length;if(r.loaded=r.total=o,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first),!this.callbacks)return;const a=this.callbacks.onProgress;if(a&&a(r,e,i,t),!this.callbacks)return;const l={url:t.responseURL,data:i,code:n};this.callbacks.onSuccess(l,r,e,t)}else{const s=i.loadPolicy.errorRetry;hF(s,r.retry,!1,n)?this.retry(s):(GL.error(`${n} while loading ${e.url}`),this.callbacks.onError({code:n,text:t.statusText},e,t,r))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(hF(t,this.stats.retry,!0))this.retry(t);else{GL.warn(`timeout while loading ${this.context.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=cF(e,r.retry),r.retry++,GL.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&BU.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const $U=/(\d+)-(\d+)\/(\d+)/;class jU{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||zU,this.controller=new self.AbortController,this.stats=new XL}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const i=function(e,t){const r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(PL({},e.headers))};e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return r}(e,this.controller.signal),s=r.onProgress,o="arraybuffer"===e.responseType,a=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=l&&BL(l)?l:u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),r.onTimeout(n,e,this.response)}),t.timeout),self.fetch(this.request).then((i=>{this.response=this.loader=i;const a=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),r.onTimeout(n,e,this.response)}),u-(a-n.loading.start)),!i.ok){const{status:e,statusText:t}=i;throw new qU(t||"fetch, bad network response",e,i)}return n.loading.first=a,n.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=$U.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(BL(e))return e}const r=e.get("Content-Length");if(r)return parseInt(r)}(i.headers)||n.total,s&&BL(t.highWaterMark)?this.loadProgressively(i,n,e,t.highWaterMark,s):o?i.arrayBuffer():"json"===e.responseType?i.json():i.text()})).then((i=>{const{response:o}=this;self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=i[a];l&&(n.loaded=n.total=l);const u={url:o.url,data:i,code:o.status};s&&!BL(t.highWaterMark)&&s(n,e,i,o),r.onSuccess(u,n,e,o)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),n.aborted)return;const i=t&&t.code||0,s=t?t.message:null;r.onError({code:i,text:s},e,t?t.details:null,n)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,n=0,i){const s=new TB,o=e.body.getReader(),a=()=>o.read().then((o=>{if(o.done)return s.dataLength&&i(t,r,s.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=o.value,u=l.length;return t.loaded+=u,u<n||s.dataLength?(s.push(l),s.dataLength>=n&&i(t,r,s.flush(),e)):i(t,r,l,e),a()})).catch((()=>Promise.reject()));return a()}}function zU(e,t){return new self.Request(e.url,t)}class qU extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const HU=/\s/,VU={newCue(e,t,r,n){const i=[];let s,o,a,l,u;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],a=!0,l=0,u="",!s.isEmpty()){var d;for(let e=0;e<s.chars.length;e++)HU.test(s.chars[e].uchar)&&a?l++:(u+=s.chars[e].uchar,a=!1);s.cueStartTime=t,t===r&&(r+=1e-4),l>=16?l--:l++;const n=oU(u.trim()),f=dU(t,r,n);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||(o=new c(t,r,n),o.id=f,o.line=h+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*l/32)),i.push(o))}return e&&i.length&&(i.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),i.forEach((t=>BI(e,t)))),i}},GU=IL(IL({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:UU,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new SB(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(UL.FRAG_LOADING,this.onFragLoading,this),e.on(UL.FRAG_LOADED,this.onFragLoaded,this),e.on(UL.FRAG_BUFFERED,this.onFragBuffered,this),e.on(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(UL.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(UL.FRAG_LOADING,this.onFragLoading,this),e.off(UL.FRAG_LOADED,this.onFragLoaded,this),e.off(UL.FRAG_BUFFERED,this.onFragBuffered,this),e.off(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(UL.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var r;const n=t.frag;this.ignoreFragment(n)||(this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,r,n){return e+r/t+(n?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const r=this.hls.config,{total:n,bwEstimate:i}=t.stats;BL(n)&&BL(i)&&(this.lastLevelLoadSec=8*n/i),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{autoLevelEnabled:n,media:i}=r;if(!e||!i)return;const s=performance.now(),o=t?t.stats:e.stats,a=t?t.duration:e.duration,l=s-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!n||i.paused||!i.playbackRate||!i.readyState)return;const u=r.mainForwardBufferInfo;if(null===u)return;const c=this.bwEstimator.getEstimateTTFB(),d=Math.abs(i.playbackRate);if(l<=Math.max(c,a/(2*d)*1e3))return;const h=u.len/d;if(h>=2*a/d)return;const f=o.loading.first?o.loading.first-o.loading.start:-1,p=o.loaded&&f>-1,m=this.bwEstimator.getEstimate(),{levels:g,minAutoLevel:y}=r,v=g[e.level],b=o.total||Math.max(o.loaded,Math.round(a*v.maxBitrate/8));let x=l-f;x<1&&p&&(x=Math.min(l,8*o.loaded/m));const w=p?1e3*o.loaded/x:0,E=w?(b-o.loaded)/w:8*b/m+c/1e3;if(E<=h)return;const S=w?8*w:m;let T,A=Number.POSITIVE_INFINITY;for(T=e.level-1;T>y;T--){const e=g[T].maxBitrate;if(A=this.getTimeToLoadFrag(c/1e3,S,a*e,!g[T].details),A<h)break}A>=E||A>10*a||(r.nextLoadLevel=T,p?this.bwEstimator.sample(l-Math.min(c,f),o.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),GL.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${h.toFixed(3)} s\n      Estimated load time for current fragment: ${E.toFixed(3)} s\n      Estimated load time for down switch fragment: ${A.toFixed(3)} s\n      TTFB estimate: ${f}\n      Current BW estimate: ${BL(m)?(m/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${T}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(UL.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:r}){const n=r?r.stats:t.stats;if(t.type===OI&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const e=r?r.duration:t.duration,i=this.hls.levels[t.level],s=(i.loaded?i.loaded.bytes:0)+n.loaded,o=(i.loaded?i.loaded.duration:0)+e;i.loaded={bytes:s,duration:o},i.realBitrate=Math.round(8*s/o)}if(t.bitrateTest){const e={stats:n,frag:t,part:r,id:t.type};this.onFragBuffered(UL.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:r,part:n}=t,i=null!=n&&n.stats.loaded?n.stats:r.stats;if(i.aborted)return;if(this.ignoreFragment(r))return;const s=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==OI||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;let r=this.getNextABRAutoLevel();if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,r)&&t[e].loadError<=t[r].loadError)return e}return-1!==e&&(r=Math.min(e,r)),r}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{maxAutoLevel:n,config:i,minAutoLevel:s,media:o}=r,a=t?t.duration:e?e.duration:0,l=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,c=r.mainForwardBufferInfo,d=(c?c.len:0)/l;let h=this.findBestLevel(u,s,n,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(h>=0)return h;GL.trace(`[abr] ${d?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let f=a?Math.min(a,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,m=i.abrBandWidthUpFactor;if(!d){const e=this.bitrateTestDelay;if(e){f=(a?Math.min(a,i.maxLoadingDelay):i.maxLoadingDelay)-e,GL.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),p=m=1}}return h=this.findBestLevel(u,s,n,d+f,p,m),Math.max(h,0)}findBestLevel(e,t,r,n,i,s){var o;const{fragCurrent:a,partCurrent:l,lastLoadedFragLevel:u}=this,{levels:c}=this.hls,d=c[u],h=!(null==d||null==(o=d.details)||!o.live),f=null==d?void 0:d.codecSet,p=l?l.duration:a?a.duration:0,m=this.bwEstimator.getEstimateTTFB()/1e3;let g=t,y=-1;for(let o=r;o>=t;o--){const t=c[o];if(!t||f&&t.codecSet!==f){t&&(g=Math.min(o,g),y=Math.max(o,y));continue}-1!==y&&GL.trace(`[abr] Skipped level(s) ${g}-${y} with CODECS:"${c[y].attrs.CODECS}"; not compatible with "${d.attrs.CODECS}"`);const r=t.details,a=(l?null==r?void 0:r.partTarget:null==r?void 0:r.averagetargetduration)||p;let v;v=o<=u?i*e:s*e;const b=c[o].maxBitrate,x=this.getTimeToLoadFrag(m,v,b*a,void 0===r);if(GL.trace(`[abr] level:${o} adjustedbw-bitrate:${Math.round(v-b)} avgDuration:${a.toFixed(1)} maxFetchDuration:${n.toFixed(1)} fetchDuration:${x.toFixed(1)}`),v>b&&(0===x||!BL(x)||h&&!this.bitrateTestDelay||x<n))return o}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;GL.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(UL.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{GL.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{GL.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:e,_objectUrl:t}=this;e&&e.src!==t&&GL.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.BUFFER_RESET,this.onBufferReset,this),e.on(UL.BUFFER_APPENDING,this.onBufferAppending,this),e.on(UL.BUFFER_CODECS,this.onBufferCodecs,this),e.on(UL.BUFFER_EOS,this.onBufferEos,this),e.on(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(UL.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(UL.FRAG_PARSED,this.onFragParsed,this),e.on(UL.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.BUFFER_RESET,this.onBufferReset,this),e.off(UL.BUFFER_APPENDING,this.onBufferAppending,this),e.off(UL.BUFFER_CODECS,this.onBufferCodecs,this),e.off(UL.BUFFER_EOS,this.onBufferEos,this),e.off(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(UL.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(UL.FRAG_PARSED,this.onFragParsed,this),e.off(UL.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new kB(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,GL.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const r=this.media=t.media;if(r&&MB){const e=this.mediaSource=new MB;e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(e),this._objectUrl=r.src,r.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:r}=this;if(t){if(GL.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){GL.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),e.src===r?(e.removeAttribute("src"),e.load()):GL.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(UL.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){GL.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}})),this._initSourceBuffer()}onBufferCodecs(e,t){const r=this.getSourceBufferTypes().length;Object.keys(t).forEach((e=>{if(r){const r=this.tracks[e];if(r&&"function"==typeof r.buffer.changeType){const{id:n,codec:i,levelCodec:s,container:o,metadata:a}=t[e],l=(r.levelCodec||r.codec).replace(OB,"$1"),u=(s||i).replace(OB,"$1");if(l!==u){const t=`${o};codecs=${s||i}`;this.appendChangeType(e,t),GL.log(`[buffer-controller]: switching codec ${l} to ${u}`),this.tracks[e]={buffer:r.buffer,codec:i,container:o,levelCodec:s,metadata:a,id:n}}}}else this.pendingTracks[e]=t[e]})),r||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:r}=this,n={execute:()=>{const n=this.sourceBuffer[e];n&&(GL.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),n.changeType(t)),r.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{GL.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}};r.append(n,e)}onBufferAppending(e,t){const{hls:r,operationQueue:n,tracks:i}=this,{data:s,type:o,frag:a,part:l,chunkMeta:u}=t,c=u.buffering[o],d=self.performance.now();c.start=d;const h=a.stats.buffering,f=l?l.stats.buffering:null;0===h.start&&(h.start=d),f&&0===f.start&&(f.start=d);const p=i.audio;let m=!1;"audio"===o&&"audio/mpeg"===(null==p?void 0:p.container)&&(m=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const g=a.start,y={execute:()=>{if(c.executeStart=self.performance.now(),m){const e=this.sourceBuffer[o];if(e){const t=g-e.timestampOffset;Math.abs(t)>=.1&&(GL.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${a.sn})`),e.timestampOffset=g)}}this.appendExecutor(s,o)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===h.first&&(h.first=e),f&&0===f.first&&(f.first=e);const{sourceBuffer:t}=this,r={};for(const e in t)r[e]=HF.getBuffered(t[e]);this.appendError=0,this.hls.trigger(UL.BUFFER_APPENDED,{type:o,frag:a,part:l,chunkMeta:u,parent:a.type,timeRanges:r})},onError:e=>{GL.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,e);const t={type:$L.MEDIA_ERROR,parent:a.type,details:jL.BUFFER_APPEND_ERROR,frag:a,part:l,chunkMeta:u,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=jL.BUFFER_FULL_ERROR:(this.appendError++,t.details=jL.BUFFER_APPEND_ERROR,this.appendError>r.config.appendErrorMaxRetry&&(GL.error(`[buffer-controller]: Failed ${r.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),r.trigger(UL.ERROR,t)}};n.append(y,o)}onBufferFlushing(e,t){const{operationQueue:r}=this,n=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(UL.BUFFER_FLUSHED,{type:e})},onError:t=>{GL.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?r.append(n(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{r.append(n(e),e)}))}onFragParsed(e,t){const{frag:r,part:n}=t,i=[],s=n?n.elementaryStreams:r.elementaryStreams;s[tR]?i.push("audiovideo"):(s[QL]&&i.push("audio"),s[eR]&&i.push("video"));0===i.length&&GL.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers((()=>{const e=self.performance.now();r.stats.buffering.end=e,n&&(n.stats.buffering.end=e);const t=n?n.stats:r.stats;this.hls.trigger(UL.FRAG_BUFFERED,{frag:r,part:n,stats:t,id:r.type})}),i)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,r)=>{const n=this.sourceBuffer[r];return!n||t.type&&t.type!==r||(n.ending=!0,n.ended||(n.ended=!0,GL.log(`[buffer-controller]: ${r} sourceBuffer now EOS`))),e&&!(n&&!n.ended)}),!0)&&(GL.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(GL.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&GL.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:r,sourceBuffer:n}=this;if(!r||null===t)return;const i=this.getSourceBufferTypes();if(!i.length)return;const s=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!BL(s)||s<0)return;const o=r.currentTime,a=t.levelTargetDuration,l=Math.max(s,a),u=Math.floor(o/a)*a-l;i.forEach((r=>{const i=n[r];if(i){const n=HF.getBuffered(i);if(n.length>0&&u>n.start(0)){if(e.trigger(UL.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live)e.trigger(UL.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u});else if(i.ended&&n.end(n.length-1)-o<2*a)return void GL.info(`[buffer-controller]: Cannot flush ${r} back buffer while SourceBuffer is in ended state`);e.trigger(UL.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:r})}}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:r,mediaSource:n}=this,i=e.fragments[0].start+e.totalduration,s=r.duration,o=BL(n.duration)?n.duration:0;e.live&&t.config.liveDurationInfinity?(GL.log("[buffer-controller]: Media Source duration is set to Infinity"),n.duration=1/0,this.updateSeekableRange(e)):(i>o&&i>s||!BL(s))&&(GL.log(`[buffer-controller]: Updating Media Source duration to ${i.toFixed(3)}`),n.duration=i)}updateSeekableRange(e){const t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&null!=t&&t.setLiveSeekableRange){const n=Math.max(0,r[0].start),i=Math.max(n,n+e.totalduration);t.setLiveSeekableRange(n,i)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:r}=this,n=Object.keys(r).length;if(n&&!e||2===n){this.createSourceBuffers(r),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(UL.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const n in e)if(!t[n]){const i=e[n];if(!i)throw Error(`source buffer exists for track ${n}, however track does not`);const s=i.levelCodec||i.codec,o=`${i.container};codecs=${s}`;GL.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{const e=t[n]=r.addSourceBuffer(o),a=n;this.addBufferListener(a,"updatestart",this._onSBUpdateStart),this.addBufferListener(a,"updateend",this._onSBUpdateEnd),this.addBufferListener(a,"error",this._onSBUpdateError),this.tracks[n]={buffer:e,codec:s,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id}}catch(e){GL.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:o})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const r=new Error(`${e} SourceBuffer error`);GL.error(`[buffer-controller]: ${r}`,t),this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.BUFFER_APPENDING_ERROR,error:r,fatal:!1});const n=this.operationQueue.current(e);n&&n.onError(t)}removeExecutor(e,t,r){const{media:n,mediaSource:i,operationQueue:s,sourceBuffer:o}=this,a=o[e];if(!n||!i||!a)return GL.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void s.shiftAndExecuteNext(e);const l=BL(n.duration)?n.duration:1/0,u=BL(i.duration)?i.duration:1/0,c=Math.max(0,t),d=Math.min(r,l,u);d>c&&!a.ending?(a.ended=!1,GL.log(`[buffer-controller]: Removing [${c},${d}] from the ${e} SourceBuffer`),a.remove(c,d)):s.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:r,sourceBuffer:n}=this,i=n[t];if(!i)return GL.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void r.shiftAndExecuteNext(t);i.ended=!1,i.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return GL.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:r}=this,n=t.map((e=>r.appendBlocker(e)));Promise.all(n).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||r.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,r){const n=this.sourceBuffer[e];if(!n)return;const i=r.bind(this,e);this.listeners[e].push({event:t,listener:i}),n.addEventListener(t,i)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}},capLevelController:AU,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=GL.log.bind(GL,"[info]:"),this.warn=GL.warn.bind(GL,"[warning]:"),this.error=GL.error.bind(GL,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(UL.ERROR,this.onError,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(UL.ERROR,this.onError,this),e.off(UL.ERROR,this.onErrorOut,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(null==e?void 0:e.type)===OI?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r,n;if(t.fatal)return;const i=this.hls,s=t.context;switch(t.details){case jL.FRAG_LOAD_ERROR:case jL.FRAG_LOAD_TIMEOUT:case jL.KEY_LOAD_ERROR:case jL.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case jL.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction={action:yF,flags:xF});case jL.FRAG_GAP:case jL.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=vF);case jL.LEVEL_EMPTY_ERROR:case jL.LEVEL_PARSING_ERROR:{var o,a;const e=t.parent===OI?t.level:i.loadLevel;t.details===jL.LEVEL_EMPTY_ERROR&&null!=(o=t.context)&&null!=(a=o.levelDetails)&&a.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case jL.LEVEL_LOAD_ERROR:case jL.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==s?void 0:s.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level)));case jL.AUDIO_TRACK_LOAD_ERROR:case jL.AUDIO_TRACK_LOAD_TIMEOUT:case jL.SUBTITLE_LOAD_ERROR:case jL.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const e=i.levels[i.loadLevel];if(e&&(s.type===kI&&s.groupId===e.audioGroupId||s.type===MI&&s.groupId===e.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=vF,void(t.errorAction.flags=wF)}return;case jL.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=i.levels[i.loadLevel],r=null==e?void 0:e.attrs["HDCP-LEVEL"];r&&(t.errorAction={action:vF,flags:EF,hdcpLevel:r})}return;case jL.BUFFER_ADD_CODEC_ERROR:case jL.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(n=t.level)?n:i.loadLevel));case jL.INTERNAL_EXCEPTION:case jL.BUFFER_APPENDING_ERROR:case jL.BUFFER_APPEND_ERROR:case jL.BUFFER_FULL_ERROR:case jL.LEVEL_SWITCH_ERROR:case jL.BUFFER_STALLED_ERROR:case jL.BUFFER_SEEK_OVER_HOLE:case jL.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:yF,flags:xF})}if(t.type===$L.KEY_SYSTEM_ERROR){const e=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,e))}}getPlaylistRetryOrSwitchAction(e,t){var r;const n=uF(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++,s=null==(r=e.response)?void 0:r.code;if(hF(n,i,lF(e),s))return{action:bF,flags:xF,retryConfig:n,retryCount:i};const o=this.getLevelSwitchAction(e,t);return n&&(o.retryConfig=n,o.retryCount=i),o}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:s}=t.config,o=uF(e.details.startsWith("key")?s:i,e),a=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(n){var l;e.details!==jL.FRAG_GAP&&n.fragmentError++;const t=null==(l=e.response)?void 0:l.code;if(hF(o,a,lF(e),t))return{action:bF,flags:xF,retryConfig:o,retryCount:a}}const u=this.getLevelSwitchAction(e,r);return o&&(u.retryConfig=o,u.retryCount=a),u}getLevelSwitchAction(e,t){const r=this.hls;null==t&&(t=r.loadLevel);const n=this.hls.levels[t];if(n&&(n.loadError++,r.autoLevelEnabled)){var i,s;let t=-1;const{levels:o,loadLevel:a,minAutoLevel:l,maxAutoLevel:u}=r,c=null==(i=e.frag)?void 0:i.type,{type:d,groupId:h}=null!=(s=e.context)?s:{};for(let r=o.length;r--;){const i=(r+a)%o.length;if(i!==a&&i>=l&&i<=u&&0===o[i].loadError){const r=o[i];if(e.details===jL.FRAG_GAP&&e.frag){const t=o[i].details;if(t){const r=pF(e.frag,t.fragments,e.frag.start);if(null!=r&&r.gap)continue}}else{if(d===kI&&h===r.audioGroupId||d===MI&&h===r.textGroupId)continue;if(c===_I&&n.audioGroupId===r.audioGroupId||c===LI&&n.textGroupId===r.textGroupId)continue}t=i;break}}if(t>-1&&r.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:vF,flags:xF,nextAutoLevel:t}}return{action:vF,flags:wF}}onErrorOut(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case yF:break;case vF:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===jL.FRAG_GAP||(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:n,hdcpLevel:i,nextAutoLevel:s}=r;switch(n){case xF:this.switchLevel(e,s);break;case wF:r.resolved||(r.resolved=this.redundantFailover(e));break;case EF:i&&(t.maxHdcpLevel=YI[YI.indexOf(i)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}r.resolved||this.switchLevel(e,s)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:r}=this,n=e.parent===OI?e.level:t.loadLevel,i=t.levels[n],s=i.url.length,o=e.frag?e.frag.urlId:i.urlId;i.urlId!==o||e.frag&&!i.details||this.penalizeRendition(i,e);for(let a=1;a<s;a++){const l=(o+a)%s,u=r[l];if(!u||SF(u,e,r[o]))return this.warn(`Switching to Redundant Stream ${l+1}/${s}: "${i.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach((e=>{e.urlId=l})),t.nextLoadLevel=n,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:r}=this,n=r[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};n.lastErrorPerfMs=performance.now(),n.errors.push(t),n.details=e.details,r[e.urlId]=n}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(UL.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(UL.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,r){const n=performance.now();if(t){if(this.lastTime){const e=n-this.lastTime,i=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*i/e,a=this.hls;if(a.trigger(UL.FPS_DROP,{currentDropped:i,currentDecoded:s,totalDroppedFrames:r}),o>0&&i>a.config.fpsDroppedMonitoringThreshold*s){let e=a.currentLevel;GL.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===a.autoLevelCapping||a.autoLevelCapping>=e)&&(e-=1,a.trigger(UL.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:a.currentLevel}),a.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:vR,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:VU,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends pP{constructor(e,t,r){super(e,t,r,"[subtitle-stream-controller]",LI),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.on(UL.ERROR,this.onError,this),e.on(UL.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(UL.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(UL.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(UL.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(UL.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.off(UL.ERROR,this.onError,this),e.off(UL.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(UL.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(UL.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(UL.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(UL.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=nP,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:n}=t;if(this.fragPrevious=r,this.state=nP,!n)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let s;const o=r.start;for(let e=0;e<i.length;e++)if(o>=i[e].start&&o<=i[e].end){s=i[e];break}const a=r.start+r.duration;s?s.end=a:(s={start:o,end:a},i.push(s)),this.fragmentTracker.fragBuffered(r)}onBufferFlushing(e,t){const{startOffset:r,endOffset:n}=t;if(0===r&&n!==Number.POSITIVE_INFINITY){const e=n-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let r=0;r<t.length;)if(t[r].end<=e)t.shift();else{if(!(t[r].start<e))break;t[r].start=e,r++}})),this.fragmentTracker.removeFragmentsInRange(r,e,LI)}}onFragBuffered(e,t){var r;this.loadedmetadata||t.frag.type!==OI||null!=(r=this.media)&&r.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const r=t.frag;(null==r?void 0:r.type)===LI&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==rP&&(this.state=nP))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){AB(this.levels,t)?this.levels=t.map((e=>new eF(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new eF(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,LI),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const r=this.levels[this.currentTrackId];null!=r&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var r;const{details:n,id:i}=t,{currentTrackId:s,levels:o}=this;if(!o.length)return;const a=o[s];if(i>=o.length||i!==s||!a)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(n.live||null!=(r=a.details)&&r.live){const e=this.mainDetails;if(n.deltaUpdateFailed||!e)return;const t=e.fragments[0];a.details?(l=this.alignPlaylists(n,a.details),0===l&&t&&(l=t.start,sF(n,l))):n.hasProgramDateTime&&e.hasProgramDateTime?(JF(n,e),l=n.fragments[0].start):t&&(l=t.start,sF(n,l))}if(a.details=n,this.levelLastLoaded=i,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(a.details,l),this.tick(),n.live&&!this.fragCurrent&&this.media&&this.state===nP){pF(null,n.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),a.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,n=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&n&&n.key&&n.iv&&"AES-128"===n.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer).catch((e=>{throw i.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((r=>{const n=performance.now();i.trigger(UL.FRAG_DECRYPTED,{frag:t,payload:r,stats:{tstart:e,tdecrypt:n}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=nP}))}}doTick(){if(this.media){if(this.state===nP){const{currentTrackId:e,levels:t}=this,r=t[e];if(!t.length||!r||!r.details)return;const{config:n}=this,i=this.getLoadPosition(),s=HF.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,n.maxBufferHole),{end:o,len:a}=s,l=this.getFwdBufferInfo(this.media,OI),u=r.details;if(a>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;const c=u.fragments,d=c.length,h=u.edge;let f=null;const p=this.fragPrevious;if(o<h){const e=n.maxFragLookUpTolerance,t=o>h-e?0:e;f=pF(p,c,Math.max(c[0].start,o),t),!f&&p&&p.start<c[0].start&&(f=c[0])}else f=c[d-1];if(!f)return;if(f=this.mapToInitFragWhenRequired(f),"initSegment"!==f.sn){const e=c[f.sn-u.startSN-1];e&&e.cc===f.cc&&this.fragmentTracker.getState(e)===kF&&(f=e)}this.fragmentTracker.getState(f)===kF&&this.loadFragment(f,r,o)}}else this.state=nP}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,r){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,r))}get mediaBufferTimeRanges(){return new NB(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends TF{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.LEVEL_LOADING,this.onLevelLoading,this),e.on(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(UL.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(UL.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.LEVEL_LOADING,this.onLevelLoading,this),e.off(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(UL.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(UL.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);CB(this.media.textTracks).forEach((e=>{UI(e)})),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,details:n}=t,{trackId:i}=this,s=this.tracksInGroup[i];if(!s)return void this.warn(`Invalid subtitle track id ${r}`);const o=s.details;s.details=t.details,this.log(`subtitle track ${r} loaded [${n.startSN}-${n.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const r=t.textGroupIds[t.urlId],n=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==r){const e=this.tracks.filter((e=>!r||e.groupId===r));this.tracksInGroup=e;const t=this.findTrackId(null==n?void 0:n.name)||this.findTrackId();this.groupId=r||null;const i={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${r}" group-id`),this.hls.trigger(UL.SUBTITLE_TRACKS_UPDATED,i),-1!==t&&this.setSubtitleTrack(t,n)}else this.shouldReloadPlaylist(n)&&this.setSubtitleTrack(this.trackId,n)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if((!this.selectDefaultTrack||n.default)&&(!e||e===n.name))return n.id}return-1}onError(e,t){!t.fatal&&t.context&&t.context.type===MI&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,n=t.groupId;let i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${r}`),this.hls.trigger(UL.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:n,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:r}=this;if(!t)return;const n=CB(t.textTracks),i=n.filter((e=>e.groupId===this.groupId));if(-1===e)[].slice.call(n).forEach((e=>{e.mode="disabled"}));else{const e=i[r];e&&(e.mode="disabled")}const s=i[e];s&&(s.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var r;const n=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(r=n[e])&&r.details)||e<-1||e>=n.length)return;this.clearTimer();const i=n[e];if(this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:"")),this.trackId=e,i){const{id:e,groupId:r="",name:n,type:s,url:o}=i;this.hls.trigger(UL.SUBTITLE_TRACK_SWITCH,{id:e,groupId:r,name:n,type:s,url:o});const a=this.switchParams(i.url,null==t?void 0:t.details);this.loadPlaylist(a)}else this.hls.trigger(UL.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=CB(this.media.textTracks);for(let r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const e=new ZB(this,"textTrack1"),t=new ZB(this,"textTrack2"),r=new ZB(this,"textTrack3"),n=new ZB(this,"textTrack4");this.cea608Parser1=new KB(1,e,t),this.cea608Parser2=new KB(3,r,n)}e.on(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(UL.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(UL.FRAG_LOADING,this.onFragLoading,this),e.on(UL.FRAG_LOADED,this.onFragLoaded,this),e.on(UL.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(UL.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(UL.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(UL.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(UL.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(UL.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(UL.FRAG_LOADING,this.onFragLoading,this),e.off(UL.FRAG_LOADED,this.onFragLoaded,this),e.off(UL.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(UL.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(UL.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(UL.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(UL.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,r,n,i){let s=!1;for(let e=i.length;e--;){const n=i[e],c=(o=n[0],a=n[1],l=t,u=r,Math.min(a,u)-Math.max(o,l));if(c>=0&&(n[0]=Math.min(n[0],t),n[1]=Math.max(n[1],r),s=!0,c/(r-t)>.5))return}var o,a,l,u;if(s||i.push([t,r]),this.config.renderTextTracksNatively){const i=this.captionsTracks[e];this.Cues.newCue(i,t,r,n)}else{const i=this.Cues.newCue(null,t,r,n);this.hls.trigger(UL.CUES_PARSED,{type:"captions",cues:i,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:i}){const{unparsedVttFrags:s}=this;"main"===r&&(this.initPTS[t.cc]={baseTime:n,timescale:i}),s.length&&(this.unparsedVttFrags=[],s.forEach((e=>{this.onFragLoaded(UL.FRAG_LOADED,e)})))}getExistingTrack(e){const{media:t}=this;if(t)for(let r=0;r<t.textTracks.length;r++){const n=t.textTracks[r];if(n[e])return n}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:n}=this,{label:i,languageCode:s}=t[e],o=this.getExistingTrack(e);if(o)r[e]=o,UI(r[e]),PI(r[e],n);else{const t=this.createTextTrack("captions",i,s);t&&(t[e]=!0,r[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(UL.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,r){const n=this.media;if(n)return n.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{UI(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)UI(t[e])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],n=r.some((e=>e.textCodec===fU));if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(AB(this.tracks,r))return void(this.tracks=r);if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const e=this.media?this.media.textTracks:null;this.tracks.forEach(((t,r)=>{let n;if(e&&r<e.length){let r=null;for(let n=0;n<e.length;n++)if(TU(e[n],t)){r=e[n];break}r&&(n=r)}if(n)UI(n);else{const e=this._captionsOrSubtitlesFromCharacteristics(t);n=this.createTextTrack(e,t.name,t.lang),n&&(n.mode="disabled")}n&&(n.groupId=t.groupId,this.textTracks.push(n))}))}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(UL.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),r=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&r)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const r=`textTrack${t[1]}`,n=this.captionsProperties[r];n&&(n.label=e.name,e.lang&&(n.languageCode=e.lang),n.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:r,cea608Parser2:n,lastSn:i,lastPartIndex:s}=this;if(this.enabled&&r&&n&&t.frag.type===OI){var o,a;const e=t.frag.sn,l=null!=(o=null==t||null==(a=t.part)?void 0:a.index)?o:-1;e===i+1||e===i&&l===s+1||(r.reset(),n.reset()),this.lastSn=e,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:r,payload:n}=t;if(r.type===LI)if(n.byteLength){const e=r.decryptdata,i="stats"in t;if(null==e||!e.encrypted||i){const e=this.tracks[r.level],i=this.vttCCs;i[r.cc]||(i[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),e&&e.textCodec===fU?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(UL.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;yU(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),r.trigger(UL.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{GL.log(`Failed to parse IMSC1: ${t}`),r.trigger(UL.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:r,payload:n}=e,{initPTS:i,unparsedVttFrags:s}=this,o=i.length-1;if(!i[r.cc]&&-1===o)return void s.push(e);const a=this.hls;hU(null!=(t=r.initSegment)&&t.data?JR(r.initSegment.data,new Uint8Array(n)):n,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,(e=>{this._appendCues(e,r.level),a.trigger(UL.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})}),(t=>{const i="Missing initPTS for VTT MPEGTS"===t.message;i?s.push(e):this._fallbackToIMSC1(r,n),GL.log(`Failed to parse VTT cue: ${t}`),i&&o>r.cc||a.trigger(UL.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:t})}))}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||yU(t,this.initPTS[e.cc],(()=>{r.textCodec=fU,this._parseIMSC1(e,t)}),(()=>{r.textCodec="wvtt"}))}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||"disabled"===r.mode)return;e.forEach((e=>BI(r,e)))}else{const n=this.tracks[t];if(!n)return;const i=n.default?"default":"subtitles"+t;r.trigger(UL.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===LI&&this.onFragLoaded(UL.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:r,cea608Parser2:n}=this;if(!this.enabled||!r||!n)return;const{frag:i,samples:s}=t;if(i.type!==OI||"NONE"!==this.closedCaptionsForLevel(i))for(let e=0;e<s.length;e++){const t=s[e].bytes;if(t){const i=this.extractCea608Data(t);r.addData(s[e].pts,i[0]),n.addData(s[e].pts,i[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:n,type:i}){const{media:s}=this;if(s&&!(s.currentTime<r)){if(!i||"video"===i){const{captionsTracks:e}=this;Object.keys(e).forEach((n=>$I(e[n],t,r)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==n){const{textTracks:e}=this;Object.keys(e).forEach((r=>$I(e[r],t,n)))}}}extractCea608Data(e){const t=[[],[]],r=31&e[0];let n=2;for(let i=0;i<r;i++){const r=e[n++],i=127&e[n++],s=127&e[n++];if(0===i&&0===s)continue;if(0!=(4&r)){const e=3&r;0!==e&&1!==e||(t[e].push(i),t[e].push(s))}}return t}},audioStreamController:class extends pP{constructor(e,t,r){super(e,t,r,"[audio-stream-controller]",_I),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.on(UL.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(UL.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(UL.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(UL.ERROR,this.onError,this),e.on(UL.BUFFER_RESET,this.onBufferReset,this),e.on(UL.BUFFER_CREATED,this.onBufferCreated,this),e.on(UL.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(UL.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(UL.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(UL.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(UL.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.LEVEL_LOADED,this.onLevelLoaded,this),e.off(UL.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(UL.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(UL.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(UL.ERROR,this.onError,this),e.off(UL.BUFFER_RESET,this.onBufferReset,this),e.off(UL.BUFFER_CREATED,this.onBufferCreated,this),e.off(UL.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(UL.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(UL.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:i}){if("main"===r){const e=t.cc;this.initPTS[t.cc]={baseTime:n,timescale:i},this.log(`InitPTS for cc: ${e} found from main: ${n}`),this.videoTrackCC=e,this.state===hP&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=rP);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=nP):(this.loadedmetadata=!1,this.state=aP),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case nP:this.doTickIdle();break;case aP:{var e;const{levels:t,trackId:r}=this,n=null==t||null==(e=t[r])?void 0:e.details;if(n){if(this.waitForCdnTuneIn(n))break;this.state=hP}break}case oP:{var t;const e=performance.now(),r=this.retryDate;(!r||e>=r||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=nP);break}case hP:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:n,complete:i}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=sP;const e={frag:t,part:r,payload:n.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),i&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),r=HF.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);mF(r.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${r.end} is needed`),this.clearWaitingFragment())}}else this.state=nP}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=nP)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:r,trackId:n}=this,i=e.config;if(null==t||!t[n])return;if(!r&&(this.startFragRequested||!i.startFragPrefetch))return;const s=t[n],o=s.details;if(!o||o.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(o))return void(this.state=aP);const a=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&a&&(this.bufferFlushed=!1,this.afterBufferFlushed(a,QL,_I));const l=this.getFwdBufferInfo(a,_I);if(null===l)return;const{bufferedTrack:u,switchingTrack:c}=this;if(!c&&this._streamEnded(l,o))return e.trigger(UL.BUFFER_EOS,{type:"audio"}),void(this.state=cP);const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,OI),h=l.len,f=this.getMaxBufferLength(null==d?void 0:d.len);if(h>=f&&!c)return;const p=o.fragments[0].start;let m=l.end;if(c&&r){const e=this.getLoadPosition();u&&c.attrs!==u.attrs&&(m=e),o.PTSKnown&&e<p&&(l.end>p||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=p+.05)}let g=this.getNextFragment(m,o),y=!1;if(g&&this.isLoopLoading(g,m)&&(y=!!g.gap,g=this.getNextFragmentLoopLoading(g,o,l,OI,f)),!g)return void(this.bufferFlushed=!0);const v=d&&g.start>d.end+o.targetduration;if(v||(null==d||!d.len)&&l.len){const e=this.getAppendedFrag(g.start,OI);if(null===e)return;if(y||(y=!!e.gap||!!v&&0===d.len),v&&!y||y&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(g,s,m)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new eF(e)))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=nP):(this.switchingTrack=null,this.bufferedTrack=t,this.state=rP),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(UL.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var r;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:n}=this,{details:i,id:s}=t;if(!n)return void this.warn(`Audio tracks were reset while loading level ${s}`);this.log(`Track ${s} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const o=n[s];let a=0;if(i.live||null!=(r=o.details)&&r.live){this.checkLiveUpdate(i);const e=this.mainDetails;if(i.deltaUpdateFailed||!e)return;!o.details&&i.hasProgramDateTime&&e.hasProgramDateTime?(JF(i,e),a=i.fragments[0].start):a=this.alignPlaylists(i,o.details)}o.details=i,this.levelLastLoaded=s,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(o.details,a),this.state!==aP||this.waitForCdnTuneIn(i)||(this.state=nP),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:n,payload:i}=e,{config:s,trackId:o,levels:a}=this;if(!a)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);const l=a[o];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);const c=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new bB(this.hls,_I,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[r.cc],f=null==(t=r.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=n?n.index:-1,s=-1!==t,o=new VF(r.level,r.sn,r.stats.chunkCount,i.byteLength,t,s);d.push(i,f,c,"",r,n,u.totalduration,e,o,h)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${u.startSN} ,${u.endSN}],track ${o}`);const{cache:e}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new TB,complete:!1};e.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=hP}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:r,part:n}=t;if(r.type===_I)if(this.fragContextChanged(r))this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==r.sn){this.fragPrevious=r;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(UL.AUDIO_TRACK_SWITCHED,IL({},e)))}this.fragBufferedComplete(r,n)}else if(!this.loadedmetadata&&r.type===OI){const e=this.videoBuffer||this.media;if(e){HF.getBuffered(e).length&&(this.loadedmetadata=!0)}}}onError(e,t){var r;if(t.fatal)this.state=dP;else switch(t.details){case jL.FRAG_GAP:case jL.FRAG_PARSING_ERROR:case jL.FRAG_DECRYPT_ERROR:case jL.FRAG_LOAD_ERROR:case jL.FRAG_LOAD_TIMEOUT:case jL.KEY_LOAD_ERROR:case jL.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_I,t);break;case jL.AUDIO_TRACK_LOAD_ERROR:case jL.AUDIO_TRACK_LOAD_TIMEOUT:case jL.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==aP||(null==(r=t.context)?void 0:r.type)!==kI||(this.state=nP);break;case jL.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case jL.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===QL&&(this.bufferFlushed=!0,this.state===cP&&(this.state=nP))}_handleTransmuxComplete(e){var t;const r="audio",{hls:n}=this,{remuxResult:i,chunkMeta:s}=e,o=this.getCurrentContext(s);if(!o)return void this.resetWhenMissingContext(s);const{frag:a,part:l,level:u}=o,{details:c}=u,{audio:d,text:h,id3:f,initSegment:p}=i;if(!this.fragContextChanged(a)&&c){if(this.state=lP,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const e=a.initSegment||a;this._bufferInitSegment(p.tracks,e,s),n.trigger(UL.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:r,tracks:p.tracks})}if(d){const{startPTS:e,endPTS:t,startDTS:r,endDTS:n}=d;l&&(l.elementaryStreams[QL]={startPTS:e,endPTS:t,startDTS:r,endDTS:n}),a.setElementaryStreamInfo(QL,e,t,r,n),this.bufferFragmentData(d,a,l,s)}if(null!=f&&null!=(t=f.samples)&&t.length){const e=PL({id:r,frag:a,details:c},f);n.trigger(UL.FRAG_PARSING_METADATA,e)}if(h){const e=PL({id:r,frag:a,details:c},h);n.trigger(UL.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(a)}_bufferInitSegment(e,t,r){if(this.state!==lP)return;e.video&&delete e.video;const n=e.audio;if(!n)return;n.levelCodec=n.codec,n.id="audio",this.log(`Init audio buffer, container:${n.container}, codecs[parsed]=[${n.codec}]`),this.hls.trigger(UL.BUFFER_CODECS,e);const i=n.initSegment;if(null!=i&&i.byteLength){const e={type:"audio",frag:t,part:null,chunkMeta:r,parent:t.type,data:i};this.hls.trigger(UL.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);var i;(this.fragCurrent=e,this.switchingTrack||n===kF||n===OF)?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(i=t.details)&&i.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=hP):(this.startFragRequested=!0,super.loadFragment(e,t,r)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:r,bufferedTrack:n}=this,i=null==n?void 0:n.attrs,s=e.attrs;r&&i&&(i.CHANNELS!==s.CHANNELS||i.NAME!==s.NAME||i.LANGUAGE!==s.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(UL.AUDIO_TRACK_SWITCHED,IL({},e))}},audioTrackController:class extends TF{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.LEVEL_LOADING,this.onLevelLoading,this),e.on(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(UL.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(UL.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.LEVEL_LOADING,this.onLevelLoading,this),e.off(UL.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(UL.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(UL.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:n,details:i}=t,s=this.tracksInGroup[r];if(!s||s.groupId!==n)return void this.warn(`Track with id:${r} and group:${n} not found in active group ${s.groupId}`);const o=s.details;s.details=t.details,this.log(`audio-track ${r} "${s.name}" lang:${s.lang} group:${n} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r||null;const e=this.tracks.filter((e=>!r||e.groupId===r));this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;const t={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group:${r}`),this.hls.trigger(UL.AUDIO_TRACKS_UPDATED,t),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&t.context.type===kI&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const r=this.currentTrack;t[this.trackId];const n=t[e],{groupId:i,name:s}=n;if(this.log(`Switching to audio-track ${e} "${s}" lang:${n.lang} group:${i}`),this.trackId=e,this.currentTrack=n,this.selectDefaultTrack=!1,this.hls.trigger(UL.AUDIO_TRACK_SWITCHING,IL({},n)),n.details&&!n.details.live)return;const o=this.switchParams(n.url,null==r?void 0:r.details);this.loadPlaylist(o)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const t=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(UL.ERROR,{type:$L.MEDIA_ERROR,details:jL.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(!this.selectDefaultTrack||n.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===n.attrs["STABLE-RENDITION-ID"])return n.id;if(e.name===n.name&&e.lang===n.lang)return n.id}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,n=t.groupId;let i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${r} "${t.name}" lang:${t.lang} group:${n}`),this.clearTimer(),this.hls.trigger(UL.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:n,deliveryDirectives:e||null})}}},emeController:NU,cmcdController:IU,contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=GL.log.bind(GL,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.on(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.on(UL.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(UL.MANIFEST_LOADING,this.onManifestLoading,this),e.off(UL.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(UL.MANIFEST_PARSED,this.onManifestParsed,this),e.off(UL.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((null==r?void 0:r.action)===vF&&r.flags===wF){let e=this.pathwayPriority;const t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),e&&e.length>1&&(this.updatePathwayPriority(e),r.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((e=>{n-r[e]>3e5&&delete r[e]}));for(let n=0;n<e.length;n++){const i=e[n];if(r[i])continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,o=this.hls.levels[s];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,this.hls.trigger(UL.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];o&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}clonePathways(e){const t=this.levels;if(!t)return;const r={},n={};e.forEach((e=>{const{ID:i,"BASE-ID":s,"URI-REPLACEMENT":o}=e;if(t.some((e=>e.pathwayId===i)))return;const a=this.getLevelsForPathway(s).map((e=>{const t=PL({},e);t.details=void 0,t.url=PU(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",o);const s=new YL(e.attrs);s["PATHWAY-ID"]=i;const a=s.AUDIO&&`${s.AUDIO}_clone_${i}`,l=s.SUBTITLES&&`${s.SUBTITLES}_clone_${i}`;a&&(r[s.AUDIO]=a,s.AUDIO=a),l&&(n[s.SUBTITLES]=l,s.SUBTITLES=l),t.attrs=s;const u=new eF(t);return NF(u,"audio",a),NF(u,"text",l),u}));t.push(...a),FU(this.audioTracks,r,o,i),FU(this.subtitleTracks,n,o,i)}))}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;let n;this.loader&&this.loader.destroy(),this.loader=new r(t);try{n=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==n.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+e)}const i={responseType:"json",url:n.href},s=t.steeringManifestLoadPolicy.default,o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(e,t,r,i)=>{this.log(`Loaded steering manifest: "${n}"`);const s=e.data;if(1!==s.VERSION)return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":o,"PATHWAY-CLONES":a,"PATHWAY-PRIORITY":l}=s;if(o)try{this.uri=new self.URL(o,n).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${o}`)}this.scheduleRefresh(this.uri||r.url),a&&this.clonePathways(a),l&&this.updatePathwayPriority(l)},onError:(e,t,r,n)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let i=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,i);else{const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(i=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,r)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(i,a,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((()=>{this.loadSteeringManifest(e)}),t)}}});function WU(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(WU):Object.keys(e).reduce(((t,r)=>(t[r]=WU(e[r]),t)),{}):e}function KU(e){const t=e.loader;if(t!==jU&&t!==UU)GL.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1})()&&(e.loader=jU,e.progressive=!0,e.enableSoftwareAES=!0,GL.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class YU{static get version(){return"1.4.12"}static isSupported(){return function(){const e=cI();if(!e)return!1;const t=mP(),r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!n}()}static get Events(){return UL}static get ErrorTypes(){return $L}static get ErrorDetails(){return jL}static get DefaultConfig(){return YU.defaultConfig?YU.defaultConfig:GU}static set DefaultConfig(e){YU.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new yB,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function(e,t){if(self.console&&!0===e||"object"==typeof e){VL(e,"debug","log","info","warn","error");try{HL.log(`Debug logs enabled for "${t}" in hls.js version 1.4.12`)}catch(e){HL=qL}}else HL=qL}(e.debug||!1,"Hls instance");const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=WU(e),n=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const i=`${"level"===e?"playlist":e}LoadPolicy`,s=void 0===t[i],o=[];n.forEach((n=>{const a=`${e}Loading${n}`,l=t[a];if(void 0!==l&&s){o.push(a);const e=r[i].default;switch(t[i]={default:e},n){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&GL.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${i}": ${JSON.stringify(t[i])}`)})),IL(IL({},r),t)}(YU.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&KU(t);const{abrController:r,bufferController:n,capLevelController:i,errorController:s,fpsController:o}=t,a=new s(this),l=this.abrController=new r(this),u=this.bufferController=new n(this),c=this.capLevelController=new i(this),d=new o(this),h=new FI(this),f=new WI(this),p=t.contentSteeringController,m=p?new p(this):null,g=this.levelController=new DF(this,m),y=new LF(this),v=new jF(this.config),b=this.streamController=new wB(this,y,v);c.setStreamController(b),d.setStreamController(b);const x=[h,g,b];m&&x.splice(1,0,m),this.networkControllers=x;const w=[l,u,c,d,f,y];this.audioTrackController=this.createController(t.audioTrackController,x);const E=t.audioStreamController;E&&x.push(new E(this,y,v)),this.subtitleTrackController=this.createController(t.subtitleTrackController,x);const S=t.subtitleStreamController;S&&x.push(new S(this,y,v)),this.createController(t.timelineController,w),v.emeController=this.emeController=this.createController(t.emeController,w),this.cmcdController=this.createController(t.cmcdController,w),this.latencyController=this.createController(KI,w),this.coreComponents=w,x.push(a);const T=a.onErrorOut;"function"==typeof T&&this.on(UL.ERROR,T,a)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,n){this._emitter.off(e,t,r,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){GL.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(UL.ERROR,{type:$L.OTHER_ERROR,details:jL.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){GL.log("destroy"),this.trigger(UL.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){GL.log("attachMedia"),this._media=e,this.trigger(UL.MEDIA_ATTACHING,{media:e})}detachMedia(){GL.log("detachMedia"),this.trigger(UL.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,r=this.url,n=this.url=LL.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});GL.log(`loadSource:${n}`),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(UL.MANIFEST_LOADING,{url:e})}startLoad(e=-1){GL.log(`startLoad(${e})`),this.networkControllers.forEach((t=>{t.startLoad(e)}))}stopLoad(){GL.log("stopLoad"),this.networkControllers.forEach((e=>{e.stopLoad()}))}swapAudioCodec(){GL.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){GL.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){GL.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){GL.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){GL.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){GL.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){GL.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(GL.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){YI.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let n;if(n=-1===t&&e&&e.length?e.length-1:t,r)for(let t=n;t--;){const n=e[t].attrs["HDCP-LEVEL"];if(n&&n<=r)return t}return n}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}YU.defaultConfig=void 0;var JU=r(21443),ZU=r.n(JU);function XU(e){return XU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XU(e)}function QU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function e$(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?QU(Object(r),!0).forEach((function(t){t$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QU(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function t$(e,t,r){return(t=l$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r$(e){return function(e){if(Array.isArray(e))return n$(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n$(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n$(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i$(){i$=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var s=t&&t.prototype instanceof h?t:h,o=Object.create(s.prototype),a=new A(i||[]);return n(o,"_invoke",{value:w(e,r,a)}),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(D([])));y&&y!==t&&r.call(y,s)&&(m=y);var v=p.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(n,s,o,a){var l=c(e[n],e,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==XU(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,o,a)}),(function(e){i("throw",e,o,a)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return i("throw",e,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return s=s?s.then(n,n):n()}})}function w(e,t,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return{value:void 0,done:!0}}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=E(o,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}throw new TypeError(XU(e)+" is not iterable")}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new x(u(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=D,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function s$(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function o$(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){s$(s,n,i,o,a,"next",e)}function a(e){s$(s,n,i,o,a,"throw",e)}o(void 0)}))}}function a$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l$(n.key),n)}}function l$(e){var t=function(e,t){if("object"!==XU(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==XU(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===XU(t)?t:String(t)}function u$(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function c$(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var d$,h$=!1,f$=null,p$=null,m$=!1,g$=new WeakSet,y$=new WeakSet,v$=new WeakSet,b$=new WeakSet,x$=new WeakSet,w$=new WeakSet,E$=new WeakSet,S$=function(){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.el,i=void 0===n?"ytEmbed":n,s=r.autoEmbed,o=void 0===s||s,a=r.videoId,l=r.httpMethod,u=void 0===l?"post":l,c=r.httpUrl,d=r.httpPayload,h=void 0===d?{}:d,f=r.watchSeconds,p=void 0===f?0:f,m=r.isCompleted,g=void 0!==m&&m,y=r.isLive,v=void 0!==y&&y,b=r.autoplay,x=void 0!==b&&b;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u$(this,E$),u$(this,w$),u$(this,x$),u$(this,b$),u$(this,v$),u$(this,y$),u$(this,g$),this.autoplay=x,this.startMuted=v,this.watchSeconds=p,this.isCompleted=g,this.bodyContent=document.querySelector(".body-content"),this.placeholder=document.querySelector("[video-placeholder]"),this.nextUpEl=document.getElementById("lessonVideoNextUp"),this.btnCompleted=document.querySelector("[btn-completed]"),this.btnNotCompleted=document.querySelector("[btn-not-completed]"),this.element=document.getElementById(i),this.elementInitialNodeName=this.element.nodeName,this.videoId=a,this.autoEmbed=o,this.http={method:u,url:c,payload:h},Ji.remove("playingId"),v&&(this.autoplay=!0),x)||(this.autoplay=null!==(t=window.$params.autoplay)&&void 0!==t?t:0,delete window.$params.autoplay);this.onInitVideo()}var t,r,n,i;return t=e,r=[{key:"isHlsVideo",get:function(){return"VIDEO"===this.elementInitialNodeName&&this.element.dataset.hlsUrl}},{key:"onInitVideo",value:(i=o$(i$().mark((function e(){var t,r,n,i,s=this,o=arguments;return i$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>0&&void 0!==o[0]?o[0]:this.autoplay,n=o.length>1&&void 0!==o[1]?o[1]:this.watchSeconds,p$=this.http.payload.postId,m$=!1,window.player&&"function"==typeof window.player.destroy&&window.player.destroy(),e.next=7,c$(this,g$,T$).call(this,r);case 7:this.player=e.sent,this.player.on("playing",c$(this,x$,k$).bind(this)),this.player.on("pause",c$(this,x$,k$).bind(this)),this.player.on("ended",c$(this,x$,k$).bind(this)),i=function(){s.isCompleted||!n||s.isLive||(s.player.currentTime=n),r&&player.play()},this.player.on("ready",(function(){return i()})),this.player.on("loadedmetadata",(function(){return i()})),this.nextUpEl&&this.player.on("timeupdate",c$(this,b$,C$).bind(this)),null===(t=this.bodyContent)||void 0===t||t.addEventListener("click",c$(this,E$,_$).bind(this));case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],r&&a$(t.prototype,r),n&&a$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function T$(e){return A$.apply(this,arguments)}function A$(){return A$=o$(i$().mark((function e(t){var r,n,i,s;return i$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={muted:this.startMuted,volume:null!==(r=null===(n=window.player)||void 0===n?void 0:n.volume)&&void 0!==r?r:1,controls:["play-large","play","progress","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed","loop"]},!this.isHlsVideo){e.next=7;break}return e.next=4,c$(this,y$,D$).call(this,i);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=c$(this,v$,N$).call(this,i);case 8:return s=e.t0,window.player=s,e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)}))),A$.apply(this,arguments)}function D$(e){var t=this;if(!YU.isSupported()){this.element.src=this.element.dataset.hlsUrl;var r=c$(this,v$,N$).call(this,e);return new Promise((function(e){return e(r)}))}var n=new YU;return n.loadSource(this.element.dataset.hlsUrl),n.attachMedia(this.element),n.on(YU.Events.LEVEL_SWITCHED,(function(e,t){document.querySelector('.plyr__menu__container [data-plyr="quality"][value="AUTO"] span').textContent=n.autoLevelEnabled?"Auto (".concat(n.levels[t.level].height,"p)"):"Auto"})),window.hls=n,new Promise((function(r){n.on(YU.Events.MANIFEST_PARSED,(function(i,s){var o=["AUTO"].concat(r$(n.levels.map((function(e){return e.height}))));e.quality={default:"AUTO",options:o,forced:!0,onChange:function(e){"AUTO"!==e?n.levels.map((function(t,r){t.height===e&&(n.currentLevel=r)})):n.currentLevel=-1}};var a=c$(t,v$,N$).call(t,e);a.on("languagechange",(function(){return setTimeout((function(){return n.subtitleTrack=a.currentTrack}),50)})),r(a)}))}))}function N$(e){return new(ZU())(this.element,e)}function C$(e){if(this.nextUpEl){var t=e.detail.plyr,r=Math.floor(t.currentTime);r!==this.lastTimeUpdate&&(this.lastTimeUpdate=r,h$&&this.nextUpEl.dispatchEvent(new CustomEvent("timeupdate",{detail:{player:t}})))}}function k$(e){var t=this,r=e.detail.plyr;if(h$=r.playing,location.pathname===this.placeholder.dataset.path&&(m$=h$,p$=this.http.payload.postId),!this.isLive)if(this.player||(Ji.remove("playingId"),m$=null,p$=null),h$)Ji.get("playingId")||Ji.set("playingId",this.http.payload.postId),f$=setInterval(o$(i$().mark((function e(){return i$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.duration<=0)){e.next=2;break}return e.abrupt("return");case 2:c$(t,w$,M$).call(t,r.currentTime,r.duration);case 3:case"end":return e.stop()}}),e)}))),5e3);else{if(clearInterval(f$),Ji.remove("playingId"),"number"!=typeof r.currentTime)return;c$(this,w$,M$).call(this,r.currentTime,r.duration)}}function M$(e,t){return O$.apply(this,arguments)}function O$(){return O$=o$(i$().mark((function e(t,r){var n,i,s,o;return i$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isAuthenticated){e.next=2;break}return e.abrupt("return");case 2:return n=Math.ceil(t/r*100),e.next=5,qe[this.http.method](this.http.url,e$(e$({},this.http.payload),{},{watchPercent:n,watchSeconds:Math.floor(t)}));case 5:if(i=e.sent,s=i.data,o=s.progression.isCompleted,this.btnCompleted&&this.btnNotCompleted){e.next=10;break}return e.abrupt("return");case 10:if(!o){e.next=14;break}return this.btnCompleted.classList.remove("hidden"),this.btnNotCompleted.classList.add("hidden"),e.abrupt("return");case 14:this.btnNotCompleted.classList.remove("hidden"),this.btnCompleted.classList.add("hidden");case 16:case"end":return e.stop()}}),e,this)}))),O$.apply(this,arguments)}function _$(e){var t,r=e.target.classList.contains("timestamp"),n=e.target.closest(".timestamp");if(r||n){var i=(r?e.target:n).textContent.split(":"),s=i[i.length];i.length>1&&(s=i.reduce((function(e,t,r){return r==i.length-1?e+parseInt(t):e+60*parseInt(t)}),0)),"function"==typeof(null===(t=this.player.embed)||void 0===t?void 0:t.seekTo)?this.player.embed.seekTo(s):this.player.currentTime=s,h$||this.player.play(),window.scrollTo({top:this.element.offsetTop,behavior:"smooth"})}}var L$=void 0;function R$(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.querySelector("[video-placeholder]");if(t){var r="true"===t.dataset.isEnabledMiniPlayer,n=t.dataset.path==location.pathname;if(e&&r&&!t.classList.contains("no-access"))return n?t.classList.add("video-noactions"):t.classList.remove("video-noactions"),t.classList.add("video-small"),t.classList.remove("aspect-video"),void t.removeAttribute("style");var i=function(e){if(!e)return;var t=e.getBoundingClientRect();return{top:t.top+window.scrollY,left:t.left+window.scrollX,width:t.width,height:t.height}}(document.getElementById("videoPlayerPosition"));i&&(t.classList.add("aspect-video"),t.classList.remove("video-small","video-noactions"),t.style.position="absolute",t.style.padding=0,t.style.width=i.width+"px",t.style.hight=i.height+"px",t.style.left=i.left+"px",t.style.top=i.top+"px")}}up.compiler("#lessonVideoEmbed",(function(e){var t=!!window.player;if(!!document.getElementById("videoPlayerPosition")||!t){var r=e.dataset;if(R$(),new S$({el:"lessonVideoEmbed",isLive:"true"==r.isLive,isCompleted:"true"==r.isCompleted,videoId:r.videoId,watchSeconds:parseInt(r.watchSeconds||"0"),httpUrl:r.httpUrl,httpPayload:{postId:r.payloadPostId,collectionId:r.payloadCollectionId,userId:r.payloadUserId,route:r.payloadRoute}}),window.ResizeObserver){var n=new ResizeObserver((function(e){void 0!==L$&&R$(!L$)}));n.observe(document.body),function(){return n.unobserve(document.body)}}}})),up.compiler("#videoPlayerPosition",(function(e){"function"==typeof d$&&d$();var t=document.querySelector("[video-placeholder]");if(null==t||t.dispatchEvent(new CustomEvent("open")),!h$){var r,n=null===(r=window.player)||void 0===r||null===(r=r.elements)||void 0===r?void 0:r.container;n&&(n.dataset.keepPlayer=!1)}if(window.IntersectionObserver){var i=new IntersectionObserver((function(e){e.forEach((function(e){L$=e.isIntersecting,R$(!e.isIntersecting)}))}),{rootMargin:"0px"});i.observe(e),d$=function(){return i.unobserve(e)}}})),up.on("up:location:changed",(function(e){var t=document.querySelector("[video-placeholder]"),r=!!window.player;if(t)if(t.classList.contains("no-access"))t.dispatchEvent(new CustomEvent("close"));else if(r&&!["/users/menu","/signin","/signup","/histories/","/watchlist/"].some((function(t){return e.url.toLowerCase().includes(t)}))){var n="true"===t.dataset.isEnabledMiniPlayer,i=t.dataset.path==location.pathname,s=!p$||p$==t.dataset.postId;m$&&n||i||!s||t.dispatchEvent(new CustomEvent("close"))}})),up.on("up:fragment:loaded",(function(e){setTimeout((function(){var e=document.querySelector("[up-main]"),t=Array.from(document.querySelectorAll("[up-main-header], [up-main-footer]"));e.classList.contains("lesson-wrapper")?t.map((function(e){return e.classList.add("lesson-wrapper")})):t.map((function(e){return e.classList.remove("lesson-wrapper")}))}),300);var t=e.request.url.toLowerCase();if(!["/users/menu","/signin","/signup","/histories/","/watchlist/"].some((function(e){return t.includes(e)}))){var r=["modal","drawer"].includes(e.request.mode),n=!e.response.text.includes('id="videoPlayerPosition"');R$(n&&!r),setTimeout((function(){return R$(n&&!r)}),600)}}));r(23166),r(76124);function I$(e){return I$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I$(e)}function F$(){F$=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var s=t&&t.prototype instanceof h?t:h,o=Object.create(s.prototype),a=new A(i||[]);return n(o,"_invoke",{value:w(e,r,a)}),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(D([])));y&&y!==t&&r.call(y,s)&&(m=y);var v=p.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(n,s,o,a){var l=c(e[n],e,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==I$(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,o,a)}),(function(e){i("throw",e,o,a)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return i("throw",e,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return s=s?s.then(n,n):n()}})}function w(e,t,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return{value:void 0,done:!0}}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=E(o,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}throw new TypeError(I$(e)+" is not iterable")}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new x(u(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=D,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function P$(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function B$(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){P$(s,n,i,o,a,"next",e)}function a(e){P$(s,n,i,o,a,"throw",e)}o(void 0)}))}}function U$(e){var t=new URL(e),r=new URLSearchParams(t.search);window.$params=Object.fromEntries(r.entries()),t.search&&(r.delete("autoplay"),t.search=r.toString(),window.history.replaceState({},document.title,t.toString()))}Ji.set("timezone",qi.now().zoneName),window.DateTime=qi,window.hideBanner=function(){var e=B$(F$().mark((function e(t){return F$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById(t).remove(),e.next=3,qe.post("/api/session/set",{target:t,value:!1});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.onfocus=B$(F$().mark((function e(){var t,r;return F$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe.get("/api/user/check");case 2:t=e.sent,r=t.data,window.isAuthenticated&&!r&&(window.location="/go/auth/reset");case 5:case"end":return e.stop()}}),e)}))),window.appWatchlist=function(e,t,r){return{payload:t,isInWatchlist:r,toggle:function(){var t=this;return B$(F$().mark((function r(){var n,i;return F$().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,qe.post(e,t.payload);case 2:n=r.sent,i=n.data,t.isInWatchlist=!i.wasDeleted;case 5:case"end":return r.stop()}}),r)})))()}}},window.appCompleted=function(e,t){return{payload:t,isCompleted:arguments.length>2&&void 0!==arguments[2]&&arguments[2],toggle:function(){var t=this;return B$(F$().mark((function r(){var n,i;return F$().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,qe.post(e,t.payload);case 2:n=r.sent,i=n.data,t.isCompleted=i.progression.isCompleted;case 5:case"end":return r.stop()}}),r)})))()},changeCompleted:function(e){this.isCompleted=e.detail.isCompleted}}},U$(location.href),up.on("up:location:changed",(function(e){return U$(e.target.location.href)}))})()})();